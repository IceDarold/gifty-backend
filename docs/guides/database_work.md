# –ì–∞–π–¥ –ø–æ —Ä–∞–±–æ—Ç–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Gifty: –∫–∞–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã, –≥–¥–µ –∏—Å–∫–∞—Ç—å —Å—Ö–µ–º—É –∏ –∫–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ.

## –ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±–∑–æ—Ä (Overview)

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö Gifty (PostgreSQL) ‚Äî —ç—Ç–æ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∑–Ω–∞–Ω–∏–π –æ —Ç–æ–≤–∞—Ä–∞—Ö, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –∏ –ª–æ–≥–∏–∫–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ –¥–∞–Ω–Ω—ã–µ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–ª—é—á–µ–≤—ã—Ö –¥–æ–º–µ–Ω–æ–≤:

1.  **–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤ (`products`)**: –°–µ—Ä–¥—Ü–µ —Å–∏—Å—Ç–µ–º—ã. –ó–¥–µ—Å—å —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ —Ç–æ–≤–∞—Ä–∞—Ö, –≤–∫–ª—é—á–∞—è —Ü–µ–Ω—ã, –æ–ø–∏—Å–∞–Ω–∏—è, —Å—Å—ã–ª–∫–∏ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
2.  **–°–∏—Å—Ç–µ–º–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ (`parsing`)**: –¢–∞–±–ª–∏—Ü—ã `parsing_sources` (—Ä–µ–µ—Å—Ç—Ä –º–∞–≥–∞–∑–∏–Ω–æ–≤) –∏ `category_map` (–º–∞–ø–ø–∏–Ω–≥ –≤–Ω–µ—à–Ω–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ).
3.  **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã–π –¥–≤–∏–∂–æ–∫ (`recsys`)**: –í–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è `product_embeddings` (–≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞) –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã —Ç–æ–≤–∞—Ä–æ–≤ (–ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ—Ñ–∏–ª–∏, "–≥–∏—Ñ—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å").
4.  **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ —Å–µ—Å—Å–∏–∏ (`users` & `auth`)**: –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø—Ä–∏–≤—è–∑–∫–∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π (OAuth) –∏ –∏—Å—Ç–æ—Ä–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π.

---

## –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ö–µ–º—ã

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—è—Ö, —Ç–∏–ø–∞—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Å–≤—è–∑—è—Ö –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Ä–∞–∑–¥–µ–ª—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –º–æ–¥–µ–ª–µ–π:

üëâ **[–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –ë–î](../api/models.md)**

---

## –†–æ–ª–∏ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å


- –î–æ—Å—Ç—É–ø –∫ –±–∞–∑–µ –≤—ã–¥–∞–µ—Ç—Å—è –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏ –≤ —Ä–∞–º–∫–∞—Ö –≤–∞—à–µ–π —Ä–æ–ª–∏.
- –õ—é–±—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã —Å –º–µ–Ω—Ç–æ—Ä–æ–º –∏–ª–∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º –∑–∞ –ë–î.

## –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏

1. –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ä–∞–±–æ—Ç–∞–µ—Ç–µ.
2. –ò–∑–±–µ–≥–∞–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ø—Ä–æ–¥–µ –±–µ–∑ —è–≤–Ω–æ–≥–æ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è.
3. –î–ª—è –º–∞—Å—Å–æ–≤—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ –¥–µ–ª–∞–π—Ç–µ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π `SELECT`.
4. –ù–µ –≤—ã–≥—Ä—É–∂–∞–π—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–Ω–µ –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤.

## –ö–∞–∫ —Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ö–µ–º—É

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ DataGrip –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ —Ç–∞–±–ª–∏—Ü–∞–º, –∏–Ω–¥–µ–∫—Å–∞–º –∏ —Å–≤—è–∑—è–º.
- –î–ª—è —Å–ª–æ–∂–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –∏—â–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (–∫–∞—Ç–∞–ª–æ–≥ `alembic`).

## –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã (–º–∏–≥—Ä–∞—Ü–∏–∏)

–î–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º **Alembic**. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å—Ö–µ–º—É –Ω–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö.

### –ó–æ–ª–æ—Ç—ã–µ –ø—Ä–∞–≤–∏–ª–∞:
1.  **–ù–ò–ö–û–ì–î–ê** –Ω–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π –≤ `alembic/versions`. –ï—Å–ª–∏ –æ—à–∏–±–ª–∏—Å—å ‚Äî —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é, –∏—Å–ø—Ä–∞–≤–ª—è—é—â—É—é –æ—à–∏–±–∫—É.
2.  –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥ –º–∏–≥—Ä–∞—Ü–∏–∏. Alembic –º–æ–∂–µ—Ç –Ω–µ –∑–∞–º–µ—Ç–∏—Ç—å –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫ –∏–ª–∏ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö.
3.  –ú–∏–≥—Ä–∞—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
```bash
# –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é (–∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–æ–¥–µ–ª–µ–π)
alembic revision --autogenerate -m "–æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–æ —Å–∞–º–æ–π –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏
alembic upgrade head

# –û—Ç–∫–∞—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –º–∏–≥—Ä–∞—Ü–∏—é (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)
alembic downgrade -1
```

!!! tip
    –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î (`alembic upgrade head`) –ø–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å Pull Request.

## –ü—Ä–∞–∫—Ç–∏–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –¥–∞–Ω–Ω—ã—Ö

- –í—Å–µ–≥–¥–∞ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π—Ç–µ –≤—ã–±–æ—Ä–∫—É (`LIMIT`), –ø–æ–∫–∞ –Ω–µ —É–≤–µ—Ä–µ–Ω—ã –≤ –æ–±—ä–µ–º–µ.
- –î–æ–±–∞–≤–ª—è–π—Ç–µ —É—Å–ª–æ–≤–∏—è –ø–æ –∫–ª—é—á–∞–º/–∏–Ω–¥–µ–∫—Å–∞–º.
- –î–ª—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –≤–∏—Ç—Ä–∏–Ω—ã, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å.

## –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

**–ì–¥–µ –≤–∑—è—Ç—å –¥–æ—Å—Ç—É–ø?**

–ß–µ—Ä–µ–∑ —Ç–µ–ª–µ–≥—Ä–∞–º‚Äë–±–æ—Ç–∞ –∏–ª–∏ —É –º–µ–Ω—Ç–æ—Ä–∞. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—é –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–µ.

**–ö–æ–≥–æ —Å–ø—Ä–æ—Å–∏—Ç—å, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫?**

–û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –º–µ–Ω—Ç–æ—Ä—É –∏ –æ–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É, —É–∫–∞–∂–∏—Ç–µ –æ—à–∏–±–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏–ª–∏ —Ç–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞.

