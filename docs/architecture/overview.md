# –û–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

–°–∏—Å—Ç–µ–º–∞ Gifty —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–ª—é—á–µ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º:

```mermaid
graph TD
    subgraph "Client Layer"
        User[User Web App]
        Admin[Telegram Admin Bot]
        MiniApp[Parsing Dashboard]
    end

    subgraph "Core API Layer"
        API[Core API / FastAPI]
        Auth[OAuth & Sessions]
        Analytics[Internal Analytics]
    end

    subgraph "Processing Layer"
        Scheduler[Cron Scheduler]
        RabbitMQ[RabbitMQ Queue]
        Workers[Scrapy Workers]
        Intelligence[Intelligence API / LLM]
    end

    subgraph "Data Layer"
        DB[(PostgreSQL + pgvector)]
        Redis[Redis Cache]
    end

    %% User Flow
    User -->|1. Submit Quiz| API
    API -->|2. Vector Search| DB
    API -->|3. Filter by 10D Matrix| DB
    API -->|4. Return Recommendations| User

    %% Admin Flow
    Admin -->|Manage Spiders| API
    Admin -->|View Health/Stats| API
    MiniApp -->|Edit Config| API

    %% Parsing Flow
    Scheduler -->|Schedule Sync| RabbitMQ
    RabbitMQ -->|Task| Workers
    Workers -->|Extract Data| API
    API -->|Validation & Normalization| API
    API -->|Request Scoring| Intelligence
    Intelligence -->|Score & Tags| API
    API -->|Save Product| DB

    %% Service Interaction
    API <-->|Sessions / Cache| Redis
```


### –û—Å–Ω–æ–≤–Ω—ã–µ —Å–ª–æ–∏

1.  **–ü–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö**: –°–±–æ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–æ–≤–∞—Ä–∞—Ö —Å —Å–∞–π—Ç–æ–≤-–¥–æ–Ω–æ—Ä–æ–≤.
    *   üëâ **[–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞](parsing.md)**
    *   üëâ **[–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –ø–∞—Ä—Å–µ—Ä](../guides/parsing.md)**
2.  **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –æ–±–æ–≥–∞—â–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ LLM –¥–ª—è –æ—Ü–µ–Ω–∫–∏ "–ø–æ–¥–∞—Ä–æ—á–Ω–æ—Å—Ç–∏" —Ç–æ–≤–∞—Ä–∞ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º.
    *   üëâ **[Gifty Intelligence API](intelligence.md)**
3.  **–í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**: –ü—Ä–µ–≤—Ä–∞—â–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏–π –≤ –≤–µ–∫—Ç–æ—Ä—ã –∏ –ø–æ–¥–±–æ—Ä –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∫–µ—Ç—ã.
    *   üëâ **[–¢–µ–æ—Ä–∏—è GUTG](grand_unified_theory.md)**
    *   üëâ **[–ê–ª–≥–æ—Ä–∏—Ç–º—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π](recommendations.md)**
4.  **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã**: 
    *   **Web App**: –§—Ä–æ–Ω—Ç–µ–Ω–¥ –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ –ø–æ–¥–∞—Ä–∫–æ–≤.
    *   **Telegram Admin Bot**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥. 
        *   üëâ **[–ì–∞–π–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è](../guides/telegram_bot.md)**
        *   üëâ **[–í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (Internals) (New!)](telegram_bot_internals.md)**

### –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ üìä

–í —Å–∏—Å—Ç–µ–º–µ –≤–Ω–µ–¥—Ä–µ–Ω–∞ —Å–∫–≤–æ–∑–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –¥–ª—è –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫ –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:

- **PostHog**: –ü—Ä–æ–¥—É–∫—Ç–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ (—Å–æ–±—ã—Ç–∏—è, –≤–æ—Ä–æ–Ω–∫–∏, –∫–æ–≥–æ—Ä—Ç—ã).
- **Prometheus & Grafana**: –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–≤, –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ API, RAM/CPU.
- **Loki**: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å–±–æ—Ä –ª–æ–≥–æ–≤ —Å–æ –≤—Å–µ—Ö –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤.

üëâ **[–ì–∞–π–¥ –ø–æ Analytics API](../guides/analytics_api_quickstart.md)**

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ CI/CD

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç –Ω–∞ –±–∞–∑–µ Docker Compose –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏:

*   **GitHub Actions**: –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª CI (Continuous Integration) –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ø—É—à–µ. –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≥–æ–Ω—è—é—Ç—Å—è —Ç–µ—Å—Ç—ã, –∑–∞—Ç–µ–º –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –¥–µ–ø–ª–æ–π.
*   **Blue-Green Deployment**: –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –±–µ–∑ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è. –°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –º–µ–∂–¥—É –¥–≤—É–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –ø–æ—Ä—Ç–∞—Ö —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è (Health Check).
*   **Nginx Proxy**: –í–Ω–µ—à–Ω–∏–π –ø—Ä–æ–∫—Å–∏ –Ω–∞ —Ö–æ—Å—Ç–µ, –∫–æ—Ç–æ—Ä—ã–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç SSL –∏ –±–µ—Å—à–æ–≤–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π —á–µ—Ä–µ–∑ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç–∞ –≤ upstream.
