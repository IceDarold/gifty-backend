# Discovery API Reference

–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã ¬´Discovery via Dialogue¬ª –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º –ø–æ–¥–±–æ—Ä–∞ –ø–æ–¥–∞—Ä–∫–æ–≤.

---

## 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Å—Å–∏–∏

`POST /recommendations/init`

–ú–µ—Ç–æ–¥ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–æ–ª–Ω–∏–ª –∫–≤–∏–∑. –û–Ω —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–≤—ã–π —à–∞–≥ –¥–∏–∞–ª–æ–≥–∞.

### Request Body (`QuizAnswers`)
–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –æ–±—ä–µ–∫—Ç –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –∫–≤–∏–∑.

### Response (`RecommendationSession`)
```json
{
  "session_id": "uuid-string",
  "state": "branching",
  "selected_topic": "–ú—É–∑—ã–∫–∞",
  "current_probe": {
    "question": "–¢–∞–∫, –¥–∞–≤–∞–π —É—Ç–æ—á–Ω–∏–º –Ω–∞—Å—á–µ—Ç –º—É–∑—ã–∫–∏ üéµ",
    "options": ["–ü—Ä–æ—Å—Ç–æ —Å–ª—É—à–∞–µ—Ç", "–ò–≥—Ä–∞–µ—Ç —Å–∞–º", "–§–∞–Ω–∞—Ç–µ–µ—Ç"],
    "can_skip": true
  }
}
```

---

## 2. –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ (Interaction)

`POST /recommendations/interact`

–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –ø–æ–∏—Å–∫–∞.

### Request Body
| Field | Type | Description |
| :--- | :--- | :--- |
| `session_id` | `uuid` | ID —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ |
| `action` | `string` | –¢–∏–ø –¥–µ–π—Å—Ç–≤–∏—è (—Å–º. –Ω–∏–∂–µ) |
| `value` | `string` | –ó–Ω–∞—á–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—ã–±—Ä–∞–Ω–Ω–∞—è –æ–ø—Ü–∏—è –∏–ª–∏ ID –≥–∏–ø–æ—Ç–µ–∑—ã) |

### –î–æ–ø—É—Å—Ç–∏–º—ã–µ Actions:

| Action | Value | –≠—Ñ—Ñ–µ–∫—Ç |
| :--- | :--- | :--- |
| `answer_probe` | –¢–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞ / –û–ø—Ü–∏—è | –ü–µ—Ä–µ—Ö–æ–¥ –∫ –≥–∏–ø–æ—Ç–µ–∑–∞–º –∏–ª–∏ —É—Ç–æ—á–Ω–µ–Ω–∏–µ —Ç–æ–ø–∏–∫–∞. |
| `like_hypothesis` | `hypothesis_id` | –ü–µ—Ä–µ—Ö–æ–¥ –≤ —Ä–µ–∂–∏–º Deep Dive (–ø—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤ –∏–¥–µ–∏). |
| `dislike_hypothesis` | `hypothesis_id` | –°–∫—Ä—ã—Ç–∏–µ –∏–¥–µ–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã/–ø–∏–≤–æ—Ç–∞. |
| `pivot` | "new_topic" / "psychology" | –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —Å–º–µ–Ω—ã –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–∑ —Ç—É–ø–∏–∫–∞. |

---

## 3. –ú–∞—à–∏–Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (DiscoveryState)

–°–µ—Å—Å–∏—è –º–æ–∂–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –æ–¥–Ω–æ–º –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π:

1.  **`quiz`**: –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.
2.  **`branching`**: –°–∏—Å—Ç–µ–º–∞ —É—Ç–æ—á–Ω—è–µ—Ç —à–∏—Ä–æ–∫–∏–π –∏–Ω—Ç–µ—Ä–µ—Å (–≤—ã–≤–µ–¥–µ–Ω `current_probe`).
3.  **`showing_hypotheses`**: –ù–∞ —ç–∫—Ä–∞–Ω–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –∏–¥–µ–π (–Ω–∞–ø–æ–ª–Ω–µ–Ω —Å–ø–∏—Å–æ–∫ `current_hypotheses`).
4.  **`deep_dive`**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª –∏–¥–µ—é –∏ —Å–º–æ—Ç—Ä–∏—Ç —Ç–æ–ª—å–∫–æ —Ç–æ–≤–∞—Ä—ã –ø–æ –Ω–µ–π.
5.  **`dead_end`**: –°–∏—Å—Ç–µ–º–∞ –Ω–µ –Ω–∞—à–ª–∞ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç ¬´–°–ø–∞—Å-–∫–∞—Ä—Ç—É¬ª.

---

## 4. –û–±—ä–µ–∫—Ç Hypothesis (–ö–∞—Ä—Ç–æ—á–∫–∞ –ò–¥–µ–∏)

–û–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ (–°–∫—Ä–∏–Ω 3):

*   `title`: –ó–∞–≥–æ–ª–æ–≤–æ–∫ (–Ω–∞–ø—Ä., ¬´–í –ø–æ–∏—Å–∫–∞—Ö —Ç–æ–≥–æ —Å–∞–º–æ–≥–æ –∑–≤—É–∫–∞¬ª).
*   `description`: –û–ø–∏—Å–∞–Ω–∏–µ –∏–¥–µ–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
*   `primary_gap`: –ú–µ—Ç–∫–∞ GUTG (`catalyst`, `optimizer` –∏ —Ç.–¥.).
*   `preview_products`: –°–ø–∏—Å–æ–∫ –∏–∑ 3-—Ö —Ç–æ–≤–∞—Ä–æ–≤ (`GiftDTO`) –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏.
*   `search_queries`: –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∑–∞–ø—Ä–æ—Å—ã, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –Ω–∞–π–¥–µ–Ω—ã –ø—Ä–µ–≤—å—é.
