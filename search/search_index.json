{"config":{"lang":["en","ru"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Gifty Engineering Docs \ud83c\udf81","text":"<p>\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c \u0432 \u0446\u0435\u043d\u0442\u0440 \u0437\u043d\u0430\u043d\u0438\u0439 Gifty \u2014 \u044d\u043a\u043e\u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0434\u043b\u044f \u0443\u043c\u043d\u043e\u0433\u043e \u043f\u043e\u0434\u0431\u043e\u0440\u0430 \u043f\u043e\u0434\u0430\u0440\u043a\u043e\u0432. \u042d\u0442\u043e\u0442 \u043f\u043e\u0440\u0442\u0430\u043b \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u044f\u0435\u0442 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u044f, \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0433\u0430\u0439\u0434\u044b \u0438 API-\u0441\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u0438 \u0434\u043b\u044f \u0432\u0441\u0435\u0439 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438.</p>"},{"location":"#_1","title":"\ud83e\udded \u0411\u044b\u0441\u0442\u0440\u0430\u044f \u043d\u0430\u0432\u0438\u0433\u0430\u0446\u0438\u044f","text":"\u0420\u0430\u0437\u0434\u0435\u043b \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0421\u0441\u044b\u043b\u043a\u0430 \u041e\u043d\u0431\u043e\u0440\u0434\u0438\u043d\u0433 \u041f\u043e\u0448\u0430\u0433\u043e\u0432\u044b\u0439 \u043f\u043b\u0430\u043d \u0434\u043b\u044f \u043d\u043e\u0432\u044b\u0445 \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u043e\u0432: \u0434\u043e\u0441\u0442\u0443\u043f\u044b, \u0447\u0430\u0442\u044b, \u043f\u0435\u0440\u0432\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430. \u041e\u0442\u043a\u0440\u044b\u0442\u044c \u2192 \u041b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0441\u0435\u0442\u0430\u043f \u0417\u0430\u043f\u0443\u0441\u043a \u0432\u0441\u0435\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b (Docker, API, Bot) \u0437\u0430 5 \u043c\u0438\u043d\u0443\u0442. \u041e\u0442\u043a\u0440\u044b\u0442\u044c \u2192 \u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 \u0412\u0435\u0440\u0445\u043d\u0435\u0443\u0440\u043e\u0432\u043d\u0435\u0432\u044b\u0439 \u043e\u0431\u0437\u043e\u0440 \u0442\u043e\u0433\u043e, \u043a\u0430\u043a \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u0440\u0435\u0432\u0440\u0430\u0449\u0430\u044e\u0442\u0441\u044f \u0432 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0438. \u041e\u0442\u043a\u0440\u044b\u0442\u044c \u2192 \u0414\u0430\u043d\u043d\u044b\u0435 \u0438 \u0411\u0414 \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0434\u043e\u043c\u0435\u043d\u043e\u0432 \u0434\u0430\u043d\u043d\u044b\u0445, \u0441\u0445\u0435\u043c\u044b PostgreSQL \u0438 \u043f\u0440\u0430\u0432\u0438\u043b \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u0439. \u041e\u0442\u043a\u0440\u044b\u0442\u044c \u2192"},{"location":"#_2","title":"\ud83c\udfd7 \u041a\u043b\u044e\u0447\u0435\u0432\u044b\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u044b","text":""},{"location":"#recommendation-engine","title":"\ud83e\udde0 Recommendation Engine","text":"<p>\u041d\u0430\u0448 SOTA-\u0434\u0432\u0438\u0436\u043e\u043a \u043d\u0430 \u0431\u0430\u0437\u0435 Qwen2-VL \u0438 Vector Search. \u041c\u044b \u043d\u0435 \u043f\u0440\u043e\u0441\u0442\u043e \u0438\u0449\u0435\u043c \u0442\u043e\u0432\u0430\u0440\u044b, \u043c\u044b \u0430\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c \u0438\u0445 \u043f\u043e 10 \u043f\u0441\u0438\u0445\u043e\u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u043e\u0441\u044f\u043c (GUTG). \ud83d\udc49 \u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435 \u043e RecSys \u2192</p>"},{"location":"#parsing-system","title":"\ud83d\udd77 Parsing System","text":"<p>\u041c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u0443\u0435\u043c\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0441\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u043d\u0430 Scrapy \u0438 RabbitMQ. \u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u043c\u0430\u043f\u043f\u0438\u043d\u0433 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u0438 AI-\u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044f. \ud83d\udc49 \u041a\u0430\u043a \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0442 \u043f\u0430\u0440\u0441\u0435\u0440\u044b \u2192</p>"},{"location":"#telegram-admin-bot","title":"\ud83e\udd16 Telegram Admin Bot","text":"<p>\u0426\u0435\u043d\u0442\u0440 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u043e\u043b\u0435\u0442\u0430\u043c\u0438. \u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u0437\u0434\u043e\u0440\u043e\u0432\u044c\u044f, \u0440\u0443\u0447\u043d\u043e\u0435 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u043e\u043c \u0438 \u0432\u044b\u0434\u0430\u0447\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u043e\u0432. \ud83d\udc49 \u0413\u0430\u0439\u0434 \u043f\u043e \u0431\u043e\u0442\u0443 \u2192</p>"},{"location":"#_3","title":"\ud83e\uddea \u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u0438 \u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433","text":"<p>\u041c\u044b \u0432\u0435\u0440\u0438\u043c \u0432 TDD \u0438 \u043d\u0430\u0431\u043b\u044e\u0434\u0430\u0435\u043c\u043e\u0441\u0442\u044c (Observability):</p> <ul> <li>\u0422\u0435\u0441\u0442\u044b: \u041a\u0430\u0436\u0434\u0430\u044f \u0444\u0438\u0447\u0430 \u043f\u043e\u043a\u0440\u044b\u0432\u0430\u0435\u0442\u0441\u044f <code>pytest</code>. \u0413\u0430\u0439\u0434 \u043f\u043e \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044e \u2192</li> <li>\u0410\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0430: \u041c\u044b \u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0435\u043c \u0431\u0438\u0437\u043d\u0435\u0441-\u0443\u0441\u043f\u0435\u0445 \u0447\u0435\u0440\u0435\u0437 PostHog. \u0417\u0430\u0447\u0435\u043c \u043d\u0430\u043c \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0430? \u2192</li> <li>CI/CD: \u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0434\u0435\u043f\u043b\u043e\u0439 \u043f\u0440\u0438 \u043a\u0430\u0436\u0434\u043e\u043c \u043f\u0443\u0448\u0435. \u041f\u0440\u043e\u0446\u0435\u0441\u0441 \u0434\u0435\u043f\u043b\u043e\u044f \u2192</li> </ul> <p>\u0415\u0441\u0442\u044c \u0432\u043e\u043f\u0440\u043e\u0441\u044b?</p> <p>\u041f\u0438\u0448\u0438\u0442\u0435 \u0441\u0432\u043e\u0435\u043c\u0443 \u043c\u0435\u043d\u0442\u043e\u0440\u0443 \u2014 \u043c\u044b \u0432\u0441\u0435\u0433\u0434\u0430 \u0440\u0430\u0434\u044b \u043f\u043e\u043c\u043e\u0447\u044c!</p> <p>\u0412\u043a\u043b\u0430\u0434 \u0432 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044e</p> <p>\u0415\u0441\u043b\u0438 \u0432\u044b \u043d\u0430\u0448\u043b\u0438 \u043e\u0448\u0438\u0431\u043a\u0443 \u0438\u043b\u0438 \u0445\u043e\u0442\u0438\u0442\u0435 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0440\u0430\u0437\u0434\u0435\u043b, \u043d\u0435 \u0441\u0442\u0435\u0441\u043d\u044f\u0439\u0442\u0435\u0441\u044c \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0442\u044c Pull Request!</p>"},{"location":"analytics_monitoring/dashboard/","title":"\u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0438 Gifty \ud83d\udcca","text":""},{"location":"analytics_monitoring/dashboard/#_1","title":"\u0424\u0438\u043b\u043e\u0441\u043e\u0444\u0438\u044f \u0438 \u0446\u0435\u043b\u0438","text":"<p>\u0410\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0430 \u0432 Gifty \u2014 \u044d\u0442\u043e \u043d\u0435 \u043f\u0440\u043e\u0441\u0442\u043e \u0441\u0431\u043e\u0440 \u0446\u0438\u0444\u0440, \u044d\u0442\u043e \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442 \u0434\u043b\u044f \u043f\u043e\u043d\u0438\u043c\u0430\u043d\u0438\u044f \u0442\u043e\u0433\u043e, \u043d\u0430\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043d\u0430\u0448\u0438 \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u044b \u0440\u0435\u0448\u0430\u044e\u0442 \u0437\u0430\u0434\u0430\u0447\u0443 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (\u043f\u043e\u0438\u0441\u043a \u043f\u043e\u0434\u0430\u0440\u043a\u0430). \u041c\u044b \u0440\u0430\u0437\u0434\u0435\u043b\u044f\u0435\u043c \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u043d\u0430 \u0434\u0432\u0430 \u0443\u0440\u043e\u0432\u043d\u044f: \u0431\u0438\u0437\u043d\u0435\u0441-\u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0430 (\u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439) \u0438 \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0437\u0434\u043e\u0440\u043e\u0432\u044c\u0435 (\u0441\u0442\u0430\u0431\u0438\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432).</p>"},{"location":"analytics_monitoring/dashboard/#_2","title":"\u041f\u043e\u0447\u0435\u043c\u0443 \u043c\u044b \u044d\u0442\u043e \u0438\u0437\u043c\u0435\u0440\u044f\u0435\u043c?","text":"<ol> <li>Quiz Completion Rate: \u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442, \u043d\u0430\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0441\u043b\u043e\u0436\u043d\u043e\u0439 \u0438\u043b\u0438 \u0434\u043b\u0438\u043d\u043d\u043e\u0439 \u043a\u0430\u0436\u0435\u0442\u0441\u044f \u0430\u043d\u043a\u0435\u0442\u0430. \u0415\u0441\u043b\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0443\u0445\u043e\u0434\u0438\u0442 \u043d\u0430 3-\u043c \u0432\u043e\u043f\u0440\u043e\u0441\u0435, \u043d\u0430\u043c \u043d\u0443\u0436\u043d\u043e \u0443\u043f\u0440\u043e\u0449\u0430\u0442\u044c UI.</li> <li>Gift CTR (Click-Through Rate): \u0413\u043b\u0430\u0432\u043d\u0430\u044f \u043c\u0435\u0442\u0440\u0438\u043a\u0430 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0430 \u043d\u0430\u0448\u0438\u0445 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439. \u0415\u0441\u043b\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043a\u043b\u0438\u043a\u0430\u0435\u0442 \u043d\u0430 \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u043d\u044b\u0435 \u0442\u043e\u0432\u0430\u0440\u044b, \u0437\u043d\u0430\u0447\u0438\u0442, LLM \u0438 \u0432\u0435\u043a\u0442\u043e\u0440\u043d\u044b\u0439 \u043f\u043e\u0438\u0441\u043a \u0441\u0440\u0430\u0431\u043e\u0442\u0430\u043b\u0438 \u0432\u0435\u0440\u043d\u043e.</li> <li>Accuracy of Categories: \u041c\u044b \u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0435\u043c, \u043d\u0430\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e AI-\u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0437\u0430\u0442\u043e\u0440 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u0442\u043e\u0432\u0430\u0440\u044b \u043f\u043e \u043d\u0430\u0448\u0435\u043c\u0443 \"\u0434\u0435\u0440\u0435\u0432\u0443 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439\".</li> </ol>"},{"location":"analytics_monitoring/dashboard/#kpi","title":"\u041a\u043b\u044e\u0447\u0435\u0432\u044b\u0435 \u043c\u0435\u0442\u0440\u0438\u043a\u0438 (KPI)","text":"<p>\u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0430\u0433\u0440\u0435\u0433\u0438\u0440\u0443\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0447\u0435\u0440\u0435\u0437 API \u0438 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u0435\u043b\u0438:</p> \u041c\u0435\u0442\u0440\u0438\u043a\u0430 \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0417\u0430\u0447\u0435\u043c \u044d\u0442\u043e \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0443? DAU \u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0432 \u0434\u0435\u043d\u044c. \u041f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043d\u0430 \u0431\u0430\u0437\u0443 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 API. Sessions \u041e\u0431\u0449\u0435\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043d\u0430\u0447\u0430\u0442\u044b\u0445 \u0441\u0435\u0441\u0441\u0438\u0439. \u0411\u0430\u0437\u043e\u0432\u0430\u044f \u043c\u0435\u0442\u0440\u0438\u043a\u0430 \u0432\u043e\u0432\u043b\u0435\u0447\u0435\u043d\u043d\u043e\u0441\u0442\u0438. Completion Rate % \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u043d\u044b\u0445 \u043a\u0432\u0438\u0437\u043e\u0432. \u0411\u0430\u0440\u043e\u043c\u0435\u0442\u0440 \"\u0443\u0441\u0442\u0430\u043b\u043e\u0441\u0442\u0438\" \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043e\u0442 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430. Gift CTR % \u043a\u043b\u0438\u043a\u043e\u0432 \u043f\u043e \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430\u043c \u0432\u044b\u0434\u0430\u0447\u0438. \u0413\u043b\u0430\u0432\u043d\u044b\u0439 \u0438\u043d\u0434\u0438\u043a\u0430\u0442\u043e\u0440 \u0437\u0434\u043e\u0440\u043e\u0432\u044c\u044f RecSys-\u0434\u0432\u0438\u0436\u043a\u0430."},{"location":"analytics_monitoring/dashboard/#funnel","title":"\u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0432\u043e\u0440\u043e\u043d\u043a\u0438 (Funnel)","text":"<p>\u041c\u044b \u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0435\u043c \u043f\u0443\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043f\u043e \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u043c \u044d\u0442\u0430\u043f\u0430\u043c:</p> <ol> <li><code>quiz_started</code> \u2014 \u0432\u0445\u043e\u0434 \u0432 \u0432\u043e\u0440\u043e\u043d\u043a\u0443.</li> <li><code>quiz_completed</code> \u2014 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0435 \u0430\u043d\u043a\u0435\u0442\u044b, \u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0444\u0438\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u044f.</li> <li><code>results_shown</code> \u2014 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0441\u043f\u0438\u0441\u043a\u0430 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439.</li> <li><code>gift_clicked</code> \u2014 \u0446\u0435\u043b\u0435\u0432\u043e\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 (\u043f\u0435\u0440\u0435\u0445\u043e\u0434 \u043d\u0430 \u0441\u0430\u0439\u0442 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0430).</li> </ol>"},{"location":"analytics_monitoring/dashboard/#_3","title":"\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 \u0441\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445","text":"<p>\u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u043f\u043e\u0441\u0442\u0440\u043e\u0435\u043d\u0430 \u043d\u0430 \u0431\u0430\u0437\u0435 PostHog:</p> <ul> <li>Backend Tracking: \u041c\u044b \u043b\u043e\u0433\u0438\u0440\u0443\u0435\u043c \u0441\u043e\u0431\u044b\u0442\u0438\u044f \u043d\u0430 \u0441\u0442\u043e\u0440\u043e\u043d\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 (\u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0441\u0435\u0441\u0441\u0438\u0439, \u0432\u044b\u0434\u0430\u0447\u0430 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439), \u0447\u0442\u043e\u0431\u044b \u0438\u043c\u0435\u0442\u044c 100% \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0445 \u0431\u0435\u0437 \u0432\u043b\u0438\u044f\u043d\u0438\u044f \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0449\u0438\u043a\u043e\u0432 \u0440\u0435\u043a\u043b\u0430\u043c\u044b.</li> <li>Async Processing: \u0421\u043e\u0431\u044b\u0442\u0438\u044f \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u0432 PostHog \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e, \u0447\u0442\u043e \u043d\u0435 \u0437\u0430\u043c\u0435\u0434\u043b\u044f\u0435\u0442 \u043e\u0442\u0432\u0435\u0442 API \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e.</li> <li>Data Enrichment: \u0412 \u0441\u043e\u0431\u044b\u0442\u0438\u044f \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 (\u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f \u0442\u043e\u0432\u0430\u0440\u0430, ID \u0441\u0435\u0441\u0441\u0438\u0438, \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043a\u0432\u0438\u0437\u0430) \u0434\u043b\u044f \u0433\u043b\u0443\u0431\u043e\u043a\u043e\u0433\u043e \u0430\u043d\u0430\u043b\u0438\u0437\u0430.</li> </ul>"},{"location":"analytics_monitoring/dashboard/#_4","title":"\u0422\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433","text":"<p>\u0412 \u043e\u0442\u043b\u0438\u0447\u0438\u0435 \u043e\u0442 \u0431\u0438\u0437\u043d\u0435\u0441-\u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0438, \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 (Prometheus + Grafana) \u0441\u043b\u0435\u0434\u0438\u0442 \u0437\u0430:</p> <ul> <li>\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c\u044e \u043e\u0442\u0432\u0435\u0442\u0430 Intelligence API (LLM).</li> <li>\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e\u043c \u043e\u0448\u0438\u0431\u043e\u043a \u0432 \u043f\u0430\u0440\u0441\u0435\u0440\u0430\u0445.</li> <li>\u041e\u0431\u044a\u0435\u043c\u043e\u043c \u043f\u0430\u043c\u044f\u0442\u0438, \u043f\u043e\u0442\u0440\u0435\u0431\u043b\u044f\u0435\u043c\u043e\u0439 \u0432\u0435\u043a\u0442\u043e\u0440\u043d\u043e\u0439 \u0431\u0430\u0437\u043e\u0439 \u0434\u0430\u043d\u043d\u044b\u0445.</li> </ul> <p>\ud83d\udcd6 \u041f\u043e\u0434\u0440\u043e\u0431\u043d\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0432\u0441\u0435\u0445 \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u043e\u0432 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e \u0432 API Reference.</p> <p>Tip</p> <p>\u0414\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0434\u0430\u0448\u0431\u043e\u0440\u0434\u0443 PostHog \u043e\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044c \u043a \u0432\u0430\u0448\u0435\u043c\u0443 \u043c\u0435\u043d\u0442\u043e\u0440\u0443 \u0438\u043b\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u0438\u0442\u0435 \u0447\u0435\u0440\u0435\u0437 Telegram \u0431\u043e\u0442\u0430.</p>"},{"location":"analytics_monitoring/telegram_bot/dev/","title":"Telegram Bot Development Guide \ud83d\udee0","text":"<p>\u0420\u0443\u043a\u043e\u0432\u043e\u0434\u0441\u0442\u0432\u043e \u043f\u043e \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0435 \u0438 \u043e\u0442\u043b\u0430\u0434\u043a\u0435 Telegram-\u0431\u043e\u0442\u0430 Gifty.</p>"},{"location":"analytics_monitoring/telegram_bot/dev/#_1","title":"\ud83d\ude80 \u041b\u043e\u043a\u0430\u043b\u044c\u043d\u0430\u044f \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0430","text":"<p>\u0415\u0441\u0442\u044c \u0434\u0432\u0430 \u0441\u043f\u043e\u0441\u043e\u0431\u0430 \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0431\u043e\u0442\u0430 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e:</p>"},{"location":"analytics_monitoring/telegram_bot/dev/#a-docker-compose","title":"\u0412\u0430\u0440\u0438\u0430\u043d\u0442 A: \u0427\u0435\u0440\u0435\u0437 Docker Compose (\u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043f\u043e\u043b\u043d\u043e\u0439 \u0441\u0440\u0435\u0434\u044b)","text":"<p>\u0415\u0441\u043b\u0438 \u0432\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0432\u0435\u0441\u044c \u0441\u0442\u0435\u043a (API, \u0411\u0414, RabbitMQ, \u0431\u043e\u0442) \u043e\u0434\u043d\u043e\u0439 \u043a\u043e\u043c\u0430\u043d\u0434\u043e\u0439:</p> <pre><code>docker compose up -d\n</code></pre> <p>\u0411\u043e\u0442 \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0441\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0432 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0435 <code>telegram-bot</code> \u0432\u043c\u0435\u0441\u0442\u0435 \u0441 \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u043c\u0438 \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c\u0438.</p> <p>\u041f\u043b\u044e\u0441\u044b:</p> <ul> <li>\u2705 \u041f\u043e\u043b\u043d\u0430\u044f \u0438\u0437\u043e\u043b\u044f\u0446\u0438\u044f, \u043d\u0435 \u043d\u0443\u0436\u043d\u043e \u043d\u0430\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u0442\u044c Python \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u0435</li> <li>\u2705 \u0412\u0441\u0435 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 (RabbitMQ, Redis, Postgres) \u043f\u043e\u0434\u043d\u0438\u043c\u0430\u044e\u0442\u0441\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438</li> <li>\u2705 \u0421\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u043f\u0440\u043e\u0434\u0430\u043a\u0448\u043d-\u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044e</li> </ul> <p>\u041c\u0438\u043d\u0443\u0441\u044b:</p> <ul> <li>\u274c \u041c\u0435\u0434\u043b\u0435\u043d\u043d\u0430\u044f \u0438\u0442\u0435\u0440\u0430\u0446\u0438\u044f (\u043d\u0443\u0436\u043d\u043e \u043f\u0435\u0440\u0435\u0441\u043e\u0431\u0438\u0440\u0430\u0442\u044c \u043e\u0431\u0440\u0430\u0437 \u043f\u0440\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0438 \u043a\u043e\u0434\u0430)</li> <li>\u274c \u0421\u043b\u043e\u0436\u043d\u0435\u0435 \u0434\u0435\u0431\u0430\u0436\u0438\u0442\u044c (\u043d\u0435\u0442 \u043f\u0440\u044f\u043c\u043e\u0433\u043e \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a debugger)</li> </ul>"},{"location":"analytics_monitoring/telegram_bot/dev/#b-python","title":"\u0412\u0430\u0440\u0438\u0430\u043d\u0442 B: \u041d\u0430\u0442\u0438\u0432\u043d\u043e \u0447\u0435\u0440\u0435\u0437 Python (\u0434\u043b\u044f \u0431\u044b\u0441\u0442\u0440\u043e\u0439 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438)","text":"<p>\u0415\u0441\u043b\u0438 \u0432\u044b \u0430\u043a\u0442\u0438\u0432\u043d\u043e \u043c\u0435\u043d\u044f\u0435\u0442\u0435 \u043a\u043e\u0434 \u0431\u043e\u0442\u0430 \u0438 \u0445\u043e\u0442\u0438\u0442\u0435 \u0432\u0438\u0434\u0435\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e:</p> <ol> <li> <p>\u041f\u043e\u0434\u043d\u0438\u043c\u0438\u0442\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0443 (\u0411\u0414, Redis, RabbitMQ):     <pre><code>docker compose up -d postgres redis rabbitmq api\n</code></pre></p> </li> <li> <p>\u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u0442\u0435\u0441\u0442\u043e\u0432\u043e\u0433\u043e \u0431\u043e\u0442\u0430 \u0447\u0435\u0440\u0435\u0437 <code>@BotFather</code> (\u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u043a\u043e\u043d\u0444\u043b\u0438\u043a\u0442\u043e\u0432\u0430\u0442\u044c \u0441 \u043f\u0440\u043e\u0434\u043e\u043c).</p> </li> <li> <p>\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u0442\u0435 <code>.env</code> \u0434\u043b\u044f \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430:     <pre><code>TELEGRAM_BOT_TOKEN=\u0432\u0430\u0448_\u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0439_\u0442\u043e\u043a\u0435\u043d\nINTERNAL_API_TOKEN=\u0442\u043e\u043a\u0435\u043d_\u0438\u0437_.env\nRABBITMQ_URL=amqp://guest:guest@localhost:5672/\nAPI_BASE=http://localhost:8000\nTELEGRAM_WEBAPP_URL=http://localhost:5173  # \u0418\u043b\u0438 ngrok URL \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f Mini App\n</code></pre></p> </li> <li> <p>\u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0435 \u0431\u043e\u0442\u0430 \u043d\u0430\u0442\u0438\u0432\u043d\u043e:     <pre><code>cd services/telegram_bot\npython -m app.main\n</code></pre></p> </li> </ol> <p>\u041f\u043b\u044e\u0441\u044b:</p> <ul> <li>\u2705 \u041c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u044b\u0439 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a \u043f\u0440\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0438 \u043a\u043e\u0434\u0430</li> <li>\u2705 \u041c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c debugger (PyCharm, VS Code)</li> <li>\u2705 \u0412\u0438\u0434\u043d\u044b \u0432\u0441\u0435 print-\u043b\u043e\u0433\u0438 \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438</li> </ul> <p>\u041c\u0438\u043d\u0443\u0441\u044b:</p> <ul> <li>\u274c \u041d\u0443\u0436\u043d\u043e \u0432\u0440\u0443\u0447\u043d\u0443\u044e \u043d\u0430\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u0442\u044c Python \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u0435</li> <li>\u274c \u041c\u043e\u0436\u0435\u0442 \u043e\u0442\u043b\u0438\u0447\u0430\u0442\u044c\u0441\u044f \u043e\u0442 \u043f\u0440\u043e\u0434\u0430\u043a\u0448\u043d-\u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f</li> </ul> <p>\u041a\u043e\u043d\u0444\u043b\u0438\u043a\u0442 \u043f\u043e\u043b\u043b\u0438\u043d\u0433\u0430</p> <p>\u041d\u0438\u043a\u043e\u0433\u0434\u0430 \u043d\u0435 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0439\u0442\u0435 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0431\u043e\u0442\u0430 \u0441 \u043f\u0440\u043e\u0434\u043e\u0432\u044b\u043c \u0442\u043e\u043a\u0435\u043d\u043e\u043c, \u0435\u0441\u043b\u0438 \u043f\u0440\u043e\u0434 \u0443\u0436\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442. Telegram \u0431\u0443\u0434\u0435\u0442 \u0441\u043b\u0430\u0442\u044c \u0430\u043f\u0434\u0435\u0439\u0442\u044b \u0442\u043e \u043e\u0434\u043d\u043e\u043c\u0443, \u0442\u043e \u0434\u0440\u0443\u0433\u043e\u043c\u0443, \u0438 \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u0431\u0443\u0434\u0435\u0442 \u043d\u0435\u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0443\u0435\u043c\u044b\u043c.</p> <p>\u0420\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u044f</p> <ul> <li>\u0414\u043b\u044f \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0438 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0439 \u2192 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 Docker Compose.</li> <li>\u0414\u043b\u044f \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0439 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438 (\u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043d\u043e\u0432\u044b\u0445 \u043a\u043e\u043c\u0430\u043d\u0434, FSM) \u2192 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043d\u0430\u0442\u0438\u0432\u043d\u044b\u0439 Python.</li> </ul>"},{"location":"analytics_monitoring/telegram_bot/dev/#frontend-mini-app-dashboard","title":"\u269b\ufe0f Frontend (Mini App Dashboard)","text":"<p>\u0412 \u043f\u0430\u043f\u043a\u0435 <code>services/telegram_bot/dashboard</code> \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u0441\u044f React-\u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 (Vite), \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0432\u043d\u0443\u0442\u0440\u0438 Telegram Web App.</p> <p>\u0421\u0442\u0435\u043a: React 18, Vite, TailwindCSS (\u0435\u0441\u043b\u0438 \u0435\u0441\u0442\u044c), Telegram WebApp SDK.</p> <p>\u0417\u0430\u043f\u0443\u0441\u043a \u0434\u043b\u044f \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438: <pre><code>cd services/telegram_bot/dashboard\nnpm install\nnpm run dev\n</code></pre> \u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0431\u0443\u0434\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e \u043f\u043e \u0430\u0434\u0440\u0435\u0441\u0443 <code>http://localhost:5173</code>. \u0427\u0442\u043e\u0431\u044b \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0435\u0433\u043e \u0432 Telegram, \u0432\u0430\u043c \u043f\u043e\u043d\u0430\u0434\u043e\u0431\u0438\u0442\u0441\u044f https \u0442\u0443\u043d\u043d\u0435\u043b\u044c (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, ngrok), \u0442\u0430\u043a \u043a\u0430\u043a Telegram WebApp \u0442\u0440\u0435\u0431\u0443\u0435\u0442 HTTPS.</p> <p>\u0421\u0431\u043e\u0440\u043a\u0430: <pre><code>npm run build\n</code></pre></p> <p>\u0421\u043e\u0431\u0440\u0430\u043d\u043d\u044b\u0435 \u0444\u0430\u0439\u043b\u044b (<code>dist/</code>) \u0434\u043e\u043b\u0436\u043d\u044b \u0440\u0430\u0437\u0434\u0430\u0432\u0430\u0442\u044c\u0441\u044f FastAPI \u0438\u043b\u0438 Nginx. \u0411\u043e\u0442 \u043e\u0436\u0438\u0434\u0430\u0435\u0442, \u0447\u0442\u043e \u0441\u0442\u0430\u0442\u0438\u043a\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0430 \u043f\u043e URL, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0443\u043a\u0430\u0437\u0430\u043d \u0432 <code>WEBAPP_URL</code>.</p>"},{"location":"analytics_monitoring/telegram_bot/dev/#ngrok-mini-app","title":"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 ngrok \u0434\u043b\u044f \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438 Mini App","text":"<p>\u0417\u0430\u0447\u0435\u043c \u043d\u0443\u0436\u0435\u043d ngrok?</p> <p>Telegram Web App \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e HTTPS. \u041a\u043e\u0433\u0434\u0430 \u0432\u044b \u0440\u0430\u0437\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442\u0435 Mini App \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e (<code>localhost:5173</code>), Telegram \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u0435\u0433\u043e, \u043f\u043e\u0442\u043e\u043c\u0443 \u0447\u0442\u043e:</p> <ol> <li><code>localhost</code> \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u0438\u0437\u0432\u043d\u0435 (\u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430 \u0432\u0430\u0448\u0435\u0439 \u043c\u0430\u0448\u0438\u043d\u0435)</li> <li>\u041d\u0435\u0442 SSL-\u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 (\u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f <code>https://</code>)</li> </ol> <p>ngrok \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u044b\u0439 HTTPS-\u0442\u0443\u043d\u043d\u0435\u043b\u044c \u043a \u0432\u0430\u0448\u0435\u043c\u0443 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u043c\u0443 \u0441\u0435\u0440\u0432\u0435\u0440\u0443, \u0440\u0435\u0448\u0430\u044f \u043e\u0431\u0435 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b.</p>"},{"location":"analytics_monitoring/telegram_bot/dev/#ngrok","title":"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 ngrok","text":"<p>macOS (Homebrew): <pre><code>brew install ngrok\n</code></pre></p> <p>Linux/Windows: \u0421\u043a\u0430\u0447\u0430\u0439\u0442\u0435 \u0441 ngrok.com/download \u0438 \u0434\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0432 PATH.</p>"},{"location":"analytics_monitoring/telegram_bot/dev/#_2","title":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435","text":"<ol> <li> <p>\u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0435 Mini App \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e: <pre><code>cd services/telegram_bot/dashboard\nnpm run dev\n# Vite \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0441\u044f \u043d\u0430 http://localhost:5173\n</code></pre></p> </li> <li> <p>\u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u0442\u0443\u043d\u043d\u0435\u043b\u044c: <pre><code>ngrok http 5173\n</code></pre></p> </li> <li> <p>\u0421\u043a\u043e\u043f\u0438\u0440\u0443\u0439\u0442\u0435 HTTPS URL \u0438\u0437 \u0432\u044b\u0432\u043e\u0434\u0430 ngrok:     <pre><code>Forwarding   https://abc123.ngrok.io -&gt; http://localhost:5173\n</code></pre></p> </li> <li> <p>\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f \u0432 <code>.env</code>:     <pre><code>TELEGRAM_WEBAPP_URL=https://abc123.ngrok.io\n</code></pre></p> <p>\u0411\u043e\u0442 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u044d\u0442\u0443 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u043a\u043d\u043e\u043f\u043a\u0438 Mini App: <pre><code># services/telegram_bot/app/main.py (\u0443\u0436\u0435 \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043e)\nKeyboardButton(\n    text=t(\"btn_scraping\", lang), \n    web_app=WebAppInfo(url=settings.telegram_webapp_url)\n)\n</code></pre></p> </li> <li> <p>\u041f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0435 \u0431\u043e\u0442\u0430 \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043a\u043d\u043e\u043f\u043a\u0443 \u0432 Telegram.</p> </li> </ol> <p>\u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u044f \u0431\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u043e\u0439 \u0432\u0435\u0440\u0441\u0438\u0438 ngrok</p> <ul> <li>URL \u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f \u043f\u0440\u0438 \u043a\u0430\u0436\u0434\u043e\u043c \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u0435 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, <code>abc123.ngrok.io</code> \u2192 <code>xyz789.ngrok.io</code>)</li> <li>\u0415\u0441\u0442\u044c \u043b\u0438\u043c\u0438\u0442 \u043d\u0430 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u0432 \u043c\u0438\u043d\u0443\u0442\u0443</li> <li>\u0414\u043b\u044f \u043f\u043e\u0441\u0442\u043e\u044f\u043d\u043d\u043e\u0433\u043e URL \u043d\u0443\u0436\u0435\u043d \u043f\u043b\u0430\u0442\u043d\u044b\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442 \u0438\u043b\u0438 \u0430\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u044b (localtunnel, serveo)</li> </ul> <p>\u0410\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u044b ngrok</p> <ul> <li>localtunnel: <code>npx localtunnel --port 5173</code></li> <li>Cloudflare Tunnel: \u0411\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u044b\u0439, \u0431\u0435\u0437 \u043b\u0438\u043c\u0438\u0442\u043e\u0432, \u043d\u043e \u0441\u043b\u043e\u0436\u043d\u0435\u0435 \u0432 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0435</li> </ul>"},{"location":"analytics_monitoring/telegram_bot/dev/#i18n","title":"\ud83c\udf0d \u041b\u043e\u043a\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f (i18n)","text":"<p>\u0412\u0441\u0435 \u0442\u0435\u043a\u0441\u0442\u044b \u0431\u043e\u0442\u0430 \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u0432 \u0444\u0430\u0439\u043b\u0435 <code>services/telegram_bot/app/strings.py</code> \u0432 \u0441\u043b\u043e\u0432\u0430\u0440\u0435 <code>STRINGS</code>.</p> <p>\u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430: <pre><code>STRINGS = {\n    \"ru\": {\n        \"hello\": \"\u041f\u0440\u0438\u0432\u0435\u0442, {name}!\",\n        ...\n    },\n    \"en\": {\n        \"hello\": \"Hello, {name}!\",\n        ...\n    }\n}\n</code></pre></p> <p>\u041a\u0430\u043a \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0442\u0435\u043a\u0441\u0442: 1.  \u041f\u0440\u0438\u0434\u0443\u043c\u0430\u0439\u0442\u0435 \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u043a\u043b\u044e\u0447 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, <code>error_database</code>). 2.  \u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0435\u0433\u043e \u0432 \u043e\u0431\u0430 \u0441\u043b\u043e\u0432\u0430\u0440\u044f (<code>ru</code> \u0438 <code>en</code>). 3.  \u0412 \u043a\u043e\u0434\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u044e-\u0445\u0435\u043b\u043f\u0435\u0440 <code>t()</code>:     <pre><code>text = t(\"error_database\", lang, name=\"Ivan\")\n</code></pre></p> <p>\u0424\u043e\u0440\u043c\u0430\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435</p> <p>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 <code>{variable}</code> \u0434\u043b\u044f \u043f\u043e\u0434\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439. Aiogram \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 Markdown \u0438\u043b\u0438 HTML (\u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u043e\u0442 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a), \u0443\u0431\u0435\u0434\u0438\u0442\u0435\u0441\u044c, \u0447\u0442\u043e \u0441\u043f\u0435\u0446\u0441\u0438\u043c\u0432\u043e\u043b\u044b \u044d\u043a\u0440\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u044b, \u0435\u0441\u043b\u0438 \u0432\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0439 \u0432\u0432\u043e\u0434.</p>"},{"location":"analytics_monitoring/telegram_bot/dev/#_3","title":"\ud83d\udc1b \u041e\u0442\u043b\u0430\u0434\u043a\u0430","text":""},{"location":"analytics_monitoring/telegram_bot/dev/#_4","title":"\u041b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435","text":"<p>\u0411\u043e\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0439 \u043c\u043e\u0434\u0443\u043b\u044c <code>logging</code>. \u0423\u0440\u043e\u0432\u0435\u043d\u044c \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043d\u0430\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u0432 <code>main.py</code>:</p> <pre><code>logging.basicConfig(level=logging.INFO)\n</code></pre> <p>\u0414\u043b\u044f \u0434\u0435\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u043e\u0442\u043b\u0430\u0434\u043a\u0438 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u0435 \u043d\u0430 <code>logging.DEBUG</code>.</p>"},{"location":"analytics_monitoring/telegram_bot/dev/#_5","title":"\u0422\u0438\u043f\u0438\u0447\u043d\u044b\u0435 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b","text":"<p>1. \u0411\u043e\u0442 \u043d\u0435 \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u043d\u0430 \u043a\u043e\u043c\u0430\u043d\u0434\u044b</p> <ul> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435, \u0447\u0442\u043e \u0442\u043e\u043a\u0435\u043d \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439: <code>echo $TELEGRAM_BOT_TOKEN</code></li> <li>\u0423\u0431\u0435\u0434\u0438\u0442\u0435\u0441\u044c, \u0447\u0442\u043e \u043d\u0435\u0442 \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430 \u0431\u043e\u0442\u0430 \u0441 \u0442\u0435\u043c \u0436\u0435 \u0442\u043e\u043a\u0435\u043d\u043e\u043c</li> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043b\u043e\u0433\u0438: <code>docker compose logs telegram-bot</code></li> </ul> <p>2. \u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a RabbitMQ</p> <ul> <li>\u0423\u0431\u0435\u0434\u0438\u0442\u0435\u0441\u044c, \u0447\u0442\u043e RabbitMQ \u0437\u0430\u043f\u0443\u0449\u0435\u043d: <code>docker compose ps rabbitmq</code></li> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 URL: \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c <code>amqp://guest:guest@localhost:5672/</code> \u0434\u043b\u044f \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430</li> </ul> <p>3. Internal API \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d</p> <ul> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435, \u0447\u0442\u043e Core API \u0437\u0430\u043f\u0443\u0449\u0435\u043d: <code>curl http://localhost:8000/health</code></li> <li>\u0423\u0431\u0435\u0434\u0438\u0442\u0435\u0441\u044c, \u0447\u0442\u043e <code>INTERNAL_API_TOKEN</code> \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u0435\u0442 \u0432 <code>.env</code> \u0431\u043e\u0442\u0430 \u0438 API</li> </ul>"},{"location":"analytics_monitoring/telegram_bot/internals/","title":"Telegram Bot Internals \ud83e\udd16","text":"<p>\u0420\u0430\u0437\u0434\u0435\u043b \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u0435 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e Telegram-\u0431\u043e\u0442\u0430 Gifty. \u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0430 \u0434\u043b\u044f \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u043e\u0432, \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u044e\u0449\u0438\u0445 \u0431\u043e\u0442\u0430 \u0438 \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u044e\u0449\u0438\u0445 \u0435\u0433\u043e \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b.</p>"},{"location":"analytics_monitoring/telegram_bot/internals/#_1","title":"\ud83c\udfd7 \u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430","text":"<p>\u0411\u043e\u0442 \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d \u043d\u0430 \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u0435 Aiogram 3.x \u0438 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043a\u0430\u043a \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0439 \u043c\u0438\u043a\u0440\u043e\u0441\u0435\u0440\u0432\u0438\u0441 \u0432 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0435 <code>gifty-bot</code>. \u041e\u043d \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442 \u0434\u0432\u0435 \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438:</p> <ol> <li>Admin Interface: \u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u043e\u0439 \u0447\u0435\u0440\u0435\u0437 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u0438 \u043c\u0435\u043d\u044e (Polling).</li> <li>Notification Center: \u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0438 \u0440\u0430\u0441\u0441\u044b\u043b\u043a\u0430 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0439 \u0438\u0437 \u0441\u0438\u0441\u0442\u0435\u043c\u044b (RabbitMQ Consumer).</li> </ol>"},{"location":"analytics_monitoring/telegram_bot/internals/#_2","title":"\u0421\u0445\u0435\u043c\u0430 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f","text":"graph TD     User[Telegram User] &lt;--&gt;|Polling| Bot[Telegram Bot Service]     Backend[Backend API] --&gt;|AMQP| RabbitMQ[(RabbitMQ)]     RabbitMQ --&gt;|Consume| Bot     Bot --&gt;|HTTP| InternalAPI[\"Internal API (/internal/*)\"]     Bot --&gt;|HTTP| WeeekAPI[Weeek API via Proxy]"},{"location":"analytics_monitoring/telegram_bot/internals/#_3","title":"\ud83d\udcc2 \u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u043f\u0440\u043e\u0435\u043a\u0442\u0430","text":"<p>\u041a\u043e\u0434 \u0431\u043e\u0442\u0430 \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u0441\u044f \u0432 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 <code>services/telegram_bot/</code>:</p> <ul> <li><code>app/main.py</code>: \u0422\u043e\u0447\u043a\u0430 \u0432\u0445\u043e\u0434\u0430. \u0421\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044e <code>Bot</code>, <code>Dispatcher</code>, \u0432\u0441\u0435 \u0445\u0435\u043d\u0434\u043b\u0435\u0440\u044b (\u043a\u043e\u043c\u0430\u043d\u0434 \u0438 callback) \u0438 FSM.</li> <li><code>app/client.py</code>: <code>TelegramInternalClient</code> \u2014 \u043e\u0431\u0435\u0440\u0442\u043a\u0430 \u043d\u0430\u0434 <code>httpx</code> \u0434\u043b\u044f \u043e\u0431\u0449\u0435\u043d\u0438\u044f \u0441 \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u043c \u0431\u0435\u043a\u0435\u043d\u0434\u043e\u043c (Internal API).</li> <li><code>app/strings.py</code>: \u0424\u0430\u0439\u043b \u043b\u043e\u043a\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 (RU/EN). \u0412\u0441\u0435 \u0442\u0435\u043a\u0441\u0442\u044b \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u0437\u0434\u0435\u0441\u044c.</li> <li><code>app/dashboard/</code>: \u0418\u0441\u0445\u043e\u0434\u043d\u044b\u0439 \u043a\u043e\u0434 Mini App (React) \u0434\u043b\u044f \u0432\u0435\u0431-\u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430.</li> </ul>"},{"location":"analytics_monitoring/telegram_bot/internals/#_4","title":"\ud83e\udde9 \u041a\u043b\u044e\u0447\u0435\u0432\u044b\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u044b","text":""},{"location":"analytics_monitoring/telegram_bot/internals/#1-notification-system","title":"1. \u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0439 (Notification System)","text":"<p>\u0411\u043e\u0442 \u0441\u043b\u0443\u0448\u0430\u0435\u0442 \u043e\u0447\u0435\u0440\u0435\u0434\u044c <code>notifications</code> \u0432 RabbitMQ.</p> <p>\u0424\u043e\u0440\u043c\u0430\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f (JSON): <pre><code>{\n  \"topic\": \"investors\",\n  \"text\": \"New investor lead: John Doe\",\n  \"data\": { \"id\": 123 },\n  \"timestamp\": \"2024-02-10T12:00:00\"\n}\n</code></pre></p> <p>\u041b\u043e\u0433\u0438\u043a\u0430 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438:</p> <ol> <li>\u041f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u0431\u043e\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u0435\u0433\u043e <code>topic</code>.</li> <li>\u0417\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0435\u0442 \u0438\u0437 \u0411\u0414 (\u0447\u0435\u0440\u0435\u0437 Internal API) \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u0434\u043f\u0438\u0441\u0447\u0438\u043a\u043e\u0432 \u043d\u0430 \u044d\u0442\u043e\u0442 \u0442\u043e\u043f\u0438\u043a.</li> <li>\u0420\u0430\u0441\u0441\u044b\u043b\u0430\u0435\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043a\u0430\u0436\u0434\u043e\u043c\u0443 \u043f\u043e\u0434\u043f\u0438\u0441\u0447\u0438\u043a\u0443.</li> </ol> <p>\u0422\u043e\u043f\u0438\u043a\u0438 (<code>TOPICS</code>):</p> <ul> <li><code>investors</code>, <code>partners</code>, <code>newsletter</code> \u2014 \u0431\u0438\u0437\u043d\u0435\u0441\u043e\u0432\u044b\u0435 \u043b\u0438\u0434\u044b.</li> <li><code>system</code>, <code>scraping</code> \u2014 \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0430\u043b\u0435\u0440\u0442\u044b.</li> </ul>"},{"location":"analytics_monitoring/telegram_bot/internals/#2-rbac","title":"2. \u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043e\u043c (RBAC)","text":"<p>\u0411\u043e\u0442 \u0438\u043c\u0435\u0435\u0442 \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u0443\u044e \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u043f\u0440\u0430\u0432, \u043e\u0441\u043d\u043e\u0432\u0430\u043d\u043d\u0443\u044e \u043d\u0430 \u0444\u043b\u0430\u0433\u0430\u0445. \u0414\u0430\u043d\u043d\u044b\u0435 \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u0432 \u043c\u043e\u0434\u0435\u043b\u0438 <code>TelegramSubscriber</code> \u0432 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0411\u0414.</p> <p>\u0420\u043e\u043b\u0438:</p> <ul> <li><code>guest</code>: \u041d\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u0430.</li> <li><code>admin</code>: \u0411\u0430\u0437\u043e\u0432\u044b\u0439 \u0434\u043e\u0441\u0442\u0443\u043f.</li> <li><code>superadmin</code>: \u041f\u043e\u043b\u043d\u044b\u0439 \u0434\u043e\u0441\u0442\u0443\u043f, \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0434\u0440\u0443\u0433\u0438\u043c\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c\u0438.</li> </ul> <p>Permissions:</p> <ul> <li><code>stats:view</code>: \u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0438.</li> <li><code>system:health</code>: \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0437\u0434\u043e\u0440\u043e\u0432\u044c\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u044b.</li> <li><code>parsing:manage</code>: \u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u0441\u0435\u0440\u0430\u043c\u0438.</li> <li><code>notifications:manage</code>: \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u0441\u0432\u043e\u0438\u0445 \u043f\u043e\u0434\u043f\u0438\u0441\u043e\u043a.</li> <li><code>tasks:manage</code>: \u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438 Weeek.</li> </ul>"},{"location":"analytics_monitoring/telegram_bot/internals/#3-weeek","title":"3. \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 Weeek","text":"<p>\u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u0430 \u0447\u0435\u0440\u0435\u0437 FSM <code>ConnectWeeek</code>.</p> <ol> <li>\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0432\u0432\u043e\u0434\u0438\u0442 API-\u0442\u043e\u043a\u0435\u043d Weeek.</li> <li>\u0411\u043e\u0442 \u0432\u0430\u043b\u0438\u0434\u0438\u0440\u0443\u0435\u0442 \u0435\u0433\u043e \u0447\u0435\u0440\u0435\u0437 \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442 <code>/internal/weeek/connect</code>.</li> <li>\u041f\u0440\u0438 \u0443\u0441\u043f\u0435\u0445\u0435 \u0441\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f \u0441\u0432\u044f\u0437\u044c <code>WeeekAccount</code> -&gt; <code>TelegramSubscriber</code>.</li> </ol>"},{"location":"analytics_monitoring/telegram_bot/internals/#state-machines-fsm","title":"\u2699\ufe0f State Machines (FSM)","text":"<p>\u0411\u043e\u0442\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 <code>aiogram.fsm</code> \u0434\u043b\u044f \u0432\u0435\u0434\u0435\u043d\u0438\u044f \u0434\u0438\u0430\u043b\u043e\u0433\u043e\u0432.</p> \u041a\u043b\u0430\u0441\u0441 FSM \u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u042d\u0442\u0430\u043f\u044b <code>AddUser</code> \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0433\u043e \u0430\u0434\u043c\u0438\u043d\u0430 <code>username</code> -&gt; <code>password</code> -&gt; <code>name</code> -&gt; <code>mentor</code> -&gt; <code>permissions</code> <code>EditSpider</code> \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u043f\u0430\u0440\u0441\u0435\u0440\u0430 <code>waiting_for_value</code> (interval/priority) <code>ConnectWeeek</code> \u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 <code>waiting_for_token</code> <code>NewTask</code> \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 <code>waiting_for_title</code> <code>RescheduleTask</code> \u041f\u0435\u0440\u0435\u043d\u043e\u0441 \u0434\u0435\u0434\u043b\u0430\u0439\u043d\u0430 <code>waiting_for_date</code> -&gt; <code>waiting_for_reason</code>"},{"location":"analytics_monitoring/telegram_bot/internals/#_5","title":"\ud83c\udfae \u041c\u0435\u043d\u044e \u0438 \u041a\u043b\u0430\u0432\u0438\u0430\u0442\u0443\u0440\u044b","text":"<p>\u041a\u043b\u0430\u0432\u0438\u0430\u0442\u0443\u0440\u044b \u0441\u0442\u0440\u043e\u044f\u0442\u0441\u044f \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438 \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u043f\u0440\u0430\u0432 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 (<code>has_permission</code>) \u0438 \u044f\u0437\u044b\u043a\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (<code>get_lang</code>).</p> <ul> <li>Main Menu: \u041a\u043d\u043e\u043f\u043a\u0438 \"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430\", \"\u041f\u0430\u0440\u0441\u0438\u043d\u0433\", \"\u0417\u0430\u0434\u0430\u0447\u0438\", \"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438\".</li> <li>Settings: \u0421\u043c\u0435\u043d\u0430 \u044f\u0437\u044b\u043a\u0430, \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0430\u043c\u0438.</li> <li>Inline Keyboards: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u0434\u043b\u044f \u0441\u043f\u0438\u0441\u043a\u043e\u0432 (\u0441\u043f\u0438\u0441\u043e\u043a \u044e\u0437\u0435\u0440\u043e\u0432, \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u0430\u0440\u0441\u0435\u0440\u043e\u0432) \u0441 \u043f\u0430\u0433\u0438\u043d\u0430\u0446\u0438\u0435\u0439 \u0438 callback-\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f\u043c\u0438.</li> </ul>"},{"location":"analytics_monitoring/telegram_bot/internals/#deployment","title":"\ud83d\udee0 Deployment","text":"<p>\u0411\u043e\u0442 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u0432 Docker-\u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0435 <code>gifty-bot</code>. \u041f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f:</p> <ul> <li><code>TELEGRAM_BOT_TOKEN</code>: \u0422\u043e\u043a\u0435\u043d \u043e\u0442 BotFather.</li> <li><code>INTERNAL_API_TOKEN</code>: \u0422\u043e\u043a\u0435\u043d \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a Internal API.</li> <li><code>RABBITMQ_URL</code>: \u0410\u0434\u0440\u0435\u0441 \u043e\u0447\u0435\u0440\u0435\u0434\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439.</li> </ul>"},{"location":"analytics_monitoring/telegram_bot/internals/#_6","title":"\ud83d\udcbb \u0420\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0430","text":"<p>\u0414\u043b\u044f \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438, \u043e\u0442\u043b\u0430\u0434\u043a\u0438 \u0438 \u0440\u0430\u0431\u043e\u0442\u044b \u0441 Mini App \u0441\u043c. \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0439 \u0433\u0430\u0439\u0434:</p> <p>\ud83d\udc49 Development Guide</p>"},{"location":"analytics_monitoring/telegram_bot/user_guide/","title":"Telegram Admin Bot \ud83e\udd16","text":"<p>Gifty Admin Bot \u2014 \u044d\u0442\u043e \u0432\u0430\u0448 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u0430\u0441\u0441\u0438\u0441\u0442\u0435\u043d\u0442 \u0438 \u043f\u0430\u043d\u0435\u043b\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0432\u0441\u0435\u0439 \u044d\u043a\u043e\u0441\u0438\u0441\u0442\u0435\u043c\u043e\u0439 Gifty. \u041e\u043d \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d \u0434\u043b\u044f \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430 \u0441\u0438\u0441\u0442\u0435\u043c\u044b, \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u043e\u043c, \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0441 \u043a\u043e\u043c\u0430\u043d\u0434\u043e\u0439 \u0447\u0435\u0440\u0435\u0437 Weeek \u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u043e\u043f\u0435\u0440\u0430\u0442\u0438\u0432\u043d\u044b\u0445 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0439.</p>"},{"location":"analytics_monitoring/telegram_bot/user_guide/#_1","title":"\ud83d\ude80 \u041d\u0430\u0447\u0430\u043b\u043e \u0440\u0430\u0431\u043e\u0442\u044b (\u041e\u043d\u0431\u043e\u0440\u0434\u0438\u043d\u0433)","text":""},{"location":"analytics_monitoring/telegram_bot/user_guide/#_2","title":"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f","text":"<p>\u0414\u043b\u044f \u0432\u0445\u043e\u0434\u0430 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0432\u0430\u043c \u043f\u043e\u043d\u0430\u0434\u043e\u0431\u0438\u0442\u0441\u044f \u0441\u0435\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u043a\u043b\u044e\u0447 (\u0434\u043b\u044f \u0441\u0443\u043f\u0435\u0440\u0430\u0434\u043c\u0438\u043d\u0430) \u0438\u043b\u0438 \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435 \u0441 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u043c \u043f\u0430\u0440\u043e\u043b\u0435\u043c \u043e\u0442 \u043c\u0435\u043d\u0442\u043e\u0440\u0430.</p> <ol> <li>\u041d\u0430\u0439\u0434\u0438\u0442\u0435 \u0431\u043e\u0442\u0430 <code>@giftyai_team_bot</code> \u0432 Telegram \u0438 \u043d\u0430\u0436\u043c\u0438\u0442\u0435 /start.</li> <li>\u0415\u0441\u043b\u0438 \u0443 \u0432\u0430\u0441 \u0435\u0441\u0442\u044c \u0441\u0435\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u043a\u043b\u044e\u0447 (\u0438\u0437 <code>.env</code> \u0444\u0430\u0439\u043b\u0430), \u0432\u0432\u0435\u0434\u0438\u0442\u0435:     <code>/start &lt;\u0432\u0430\u0448_\u0441\u0435\u043a\u0440\u0435\u0442\u043d\u044b\u0439_\u043a\u043b\u044e\u0447&gt;</code></li> <li>\u0415\u0441\u043b\u0438 \u0432\u044b \u043d\u043e\u0432\u044b\u0439 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a \u043a\u043e\u043c\u0430\u043d\u0434\u044b, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u044b\u0439 \u043e\u0442 \u043c\u0435\u043d\u0442\u043e\u0440\u0430 \u043f\u0430\u0440\u043e\u043b\u044c:     <code>/start &lt;\u043f\u0430\u0440\u043e\u043b\u044c_\u0438\u0437_\u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u044f&gt;</code></li> <li>\u0414\u043e\u0436\u0434\u0438\u0442\u0435\u0441\u044c \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438.</li> </ol> <p>IMPORTANT</p> <p>\u0414\u043b\u044f \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u043f\u043e \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u044e \u0443 \u0432\u0430\u0441 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d Telegram username.</p>"},{"location":"analytics_monitoring/telegram_bot/user_guide/#_3","title":"\u0417\u0430\u043f\u0440\u043e\u0441 \u0434\u043e\u0441\u0442\u0443\u043f\u043e\u0432","text":"<p>\u0427\u0435\u0440\u0435\u0437 \u0431\u043e\u0442\u0430 \u043c\u043e\u0436\u043d\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043d\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u044b (GitHub, SSH-\u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0431\u0430\u0437\u0435 \u0438 \u0434\u0440.). \u041e\u0440\u0438\u0435\u043d\u0442\u0438\u0440\u0443\u0439\u0442\u0435\u0441\u044c \u043d\u0430 \u043c\u0435\u043d\u044e \u0438 \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0435 \u043f\u043e\u0434\u0441\u043a\u0430\u0437\u043a\u0438 \u0431\u043e\u0442\u0430.</p>"},{"location":"analytics_monitoring/telegram_bot/user_guide/#_4","title":"\ud83d\udd10 \u0420\u043e\u043b\u0438 \u0438 \u043f\u0440\u0430\u0432\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430","text":"<p>\u0414\u043e\u0441\u0442\u0443\u043f \u0432 \u0431\u043e\u0442\u0435 \u0440\u0430\u0437\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u0440\u043e\u043b\u0435\u0439 \u0438 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0439 (permissions).</p> \u041f\u0440\u0430\u0432\u043e \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 <code>all</code> \u041f\u043e\u043b\u043d\u044b\u0439 \u0434\u043e\u0441\u0442\u0443\u043f \u043a\u043e \u0432\u0441\u0435\u043c \u0444\u0443\u043d\u043a\u0446\u0438\u044f\u043c \u0441\u0438\u0441\u0442\u0435\u043c\u044b. <code>stats:view</code> \u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 (DAU/MAU) \u0438 \u043a\u043e\u043d\u0432\u0435\u0440\u0441\u0438\u0439. <code>system:health</code> \u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f (\u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430, \u043f\u0430\u043c\u044f\u0442\u044c, \u043e\u0448\u0438\u0431\u043a\u0438). <code>parsing:manage</code> \u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0430\u0443\u043a\u0430\u043c\u0438, \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 URL \u0438 \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u043d\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f. <code>tasks:manage</code> \u041f\u043e\u043b\u043d\u0430\u044f \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 Weeek (\u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435, \u043f\u0435\u0440\u0435\u043d\u043e\u0441, \u0437\u0430\u043a\u0440\u044b\u0442\u0438\u0435 \u0437\u0430\u0434\u0430\u0447). <code>notifications:manage</code> \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u043f\u043e\u0434\u043f\u0438\u0441\u043e\u043a \u043d\u0430 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f."},{"location":"analytics_monitoring/telegram_bot/user_guide/#_5","title":"\ud83d\udee0 \u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438","text":""},{"location":"analytics_monitoring/telegram_bot/user_guide/#stats","title":"\ud83d\udcca \u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 (Stats)","text":"<p>\u0420\u0430\u0437\u0434\u0435\u043b \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439:</p> <ul> <li>Summary: \u041a\u0440\u0430\u0442\u043a\u0430\u044f \u0441\u0432\u043e\u0434\u043a\u0430 \u0437\u0430 24 \u0447\u0430\u0441\u0430.</li> <li>DAU (7d): \u0413\u0440\u0430\u0444\u0438\u043a \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0437\u0430 \u043d\u0435\u0434\u0435\u043b\u044e.</li> <li>MAU (12m): \u0422\u0440\u0435\u043d\u0434 \u0440\u043e\u0441\u0442\u0430 \u0431\u0430\u0437\u044b \u0437\u0430 \u0433\u043e\u0434.</li> <li>Technical: \u0422\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f API.</li> </ul>"},{"location":"analytics_monitoring/telegram_bot/user_guide/#health","title":"\ud83d\ude80 \u0421\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 (Health)","text":"<p>\u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438:</p> <ul> <li>\u0412\u0440\u0435\u043c\u044f \u043e\u0442\u043a\u043b\u0438\u043a\u0430 (Latency) \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0433\u043e API.</li> <li>\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0448\u0438\u0431\u043e\u043a (5xx).</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 (Redis, \u0414\u0438\u0441\u043a).</li> </ul>"},{"location":"analytics_monitoring/telegram_bot/user_guide/#scraping","title":"\ud83d\udd77 \u041f\u0430\u0440\u0441\u0438\u043d\u0433 (Scraping)","text":"<p>\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0431\u043e\u0440\u043e\u043c \u0434\u0430\u043d\u043d\u044b\u0445 \u0441 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u043e\u0432-\u043f\u0430\u0440\u0442\u043d\u0435\u0440\u043e\u0432:</p> <ul> <li>\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0432\u043e\u0440\u043a\u0435\u0440\u043e\u0432.</li> <li>\u0421\u043f\u0438\u0441\u043e\u043a \"\u0441\u043b\u043e\u043c\u0430\u043d\u043d\u044b\u0445\" \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u043e\u0432, \u0442\u0440\u0435\u0431\u0443\u044e\u0449\u0438\u0445 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u044f.</li> <li>Mini App Dashboard: \u0412\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u043e\u0435 \u0432\u0435\u0431-\u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u0434\u0435\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u0430\u0443\u043a\u043e\u0432 (\u0442\u0440\u0435\u0431\u0443\u0435\u0442 HTTPS).</li> </ul>"},{"location":"analytics_monitoring/telegram_bot/user_guide/#tasks","title":"\ud83d\udcdd \u0417\u0430\u0434\u0430\u0447\u0438 (Tasks)","text":"<p>\u041f\u043e\u043b\u043d\u0430\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u0441 Weeek:</p> <ul> <li>\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0441\u043f\u0438\u0441\u043a\u0430 \u0441\u0432\u043e\u0438\u0445 \u0437\u0430\u0434\u0430\u0447.</li> <li>\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u043e\u0432\u044b\u0445 \u0437\u0430\u0434\u0430\u0447 \u043f\u0440\u044f\u043c\u043e \u0438\u0437 Telegram.</li> <li>\u0421\u043c\u0435\u043d\u0430 \u0434\u0435\u0434\u043b\u0430\u0439\u043d\u043e\u0432 \u0438 \u0437\u0430\u043a\u0440\u044b\u0442\u0438\u0435 \u0437\u0430\u0434\u0430\u0447.</li> <li>\u041e\u043d\u0431\u043e\u0440\u0434\u0438\u043d\u0433: \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0439 \u0447\u0435\u043a\u043b\u0438\u0441\u0442 \u0434\u043b\u044f \u043d\u043e\u0432\u044b\u0445 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432 \u043a\u043e\u043c\u0430\u043d\u0434\u044b.</li> </ul>"},{"location":"analytics_monitoring/telegram_bot/user_guide/#_6","title":"\ud83d\udd14 \u041f\u043e\u0434\u043f\u0438\u0441\u043a\u0438","text":"<p>\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u044b\u0445 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0439 \u0432 Telegram \u043f\u043e \u0442\u0435\u043c\u0430\u043c:</p> <ul> <li><code>investors</code>: \u041d\u043e\u0432\u044b\u0435 \u0437\u0430\u044f\u0432\u043a\u0438 \u043e\u0442 \u0438\u043d\u0432\u0435\u0441\u0442\u043e\u0440\u043e\u0432.</li> <li><code>partners</code>: \u041f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u043e \u043f\u0430\u0440\u0442\u043d\u0435\u0440\u0441\u0442\u0432\u0435.</li> <li><code>system</code>: \u041a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u043e\u0448\u0438\u0431\u043a\u0438 \u0438 \u0430\u043b\u0435\u0440\u0442\u044b \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430.</li> <li><code>scraping</code>: \u041e\u0442\u0447\u0435\u0442\u044b \u043e \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0438 \u0446\u0438\u043a\u043b\u043e\u0432 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0430.</li> </ul>"},{"location":"analytics_monitoring/telegram_bot/user_guide/#_7","title":"\ud83c\udf10 \u042f\u0437\u044b\u043a\u0438","text":"<p>\u0411\u043e\u0442 \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e \u043b\u043e\u043a\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d \u043d\u0430 \u0420\u0443\u0441\u0441\u043a\u0438\u0439 (\ud83c\uddf7\ud83c\uddfa) \u0438 \u0410\u043d\u0433\u043b\u0438\u0439\u0441\u043a\u0438\u0439 (\ud83c\uddfa\ud83c\uddf8) \u044f\u0437\u044b\u043a\u0438. \u0421\u043c\u0435\u043d\u0438\u0442\u044c \u044f\u0437\u044b\u043a \u043c\u043e\u0436\u043d\u043e \u0432 \u0433\u043b\u0430\u0432\u043d\u043e\u043c \u043c\u0435\u043d\u044e \u043a\u043d\u043e\u043f\u043a\u043e\u0439 \"\u042f\u0437\u044b\u043a\".</p>"},{"location":"analytics_monitoring/telegram_bot/user_guide/#_8","title":"\ud83d\udcbb \u0420\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0438 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0437\u0430\u043f\u0443\u0441\u043a","text":""},{"location":"analytics_monitoring/telegram_bot/user_guide/#_9","title":"\u0417\u0430\u043f\u0443\u0441\u043a \u0431\u043e\u0442\u0430","text":"<p>\u0411\u043e\u0442 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u0438\u0437 \u043a\u043e\u0440\u043d\u044f \u043f\u0440\u043e\u0435\u043a\u0442\u0430: <pre><code>python -m services.telegram_bot.app.main\n</code></pre></p>"},{"location":"analytics_monitoring/telegram_bot/user_guide/#web-app-dashboard","title":"\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 Web App (Dashboard)","text":"<p>Telegram Web App \u0442\u0440\u0435\u0431\u0443\u0435\u0442 HTTPS. \u0414\u043b\u044f \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 <code>ngrok</code> \u0438\u043b\u0438 <code>localtunnel</code>:</p> <ol> <li>\u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0435 \u0444\u0440\u043e\u043d\u0442\u0435\u043d\u0434 \u0434\u0430\u0448\u0431\u043e\u0440\u0434\u0430 \u043d\u0430 \u043f\u043e\u0440\u0442\u0443 5173.</li> <li>\u041f\u0440\u043e\u0431\u0440\u043e\u0441\u044c\u0442\u0435 \u043f\u043e\u0440\u0442 \u0447\u0435\u0440\u0435\u0437 ngrok: <code>ngrok http 5173</code>.</li> <li>\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u044b\u0439 HTTPS URL \u0432 \u043f\u043e\u043b\u0435 <code>TELEGRAM_WEBAPP_URL</code> \u0432 \u043a\u043e\u043d\u0441\u0442\u0440\u0443\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u043a\u043d\u043e\u043f\u043a\u0438 (\u0438\u043b\u0438 \u0432 <code>.env</code>).</li> </ol>"},{"location":"analytics_monitoring/telegram_bot/user_guide/#i","title":"\u2139\ufe0f \u041f\u043e\u043c\u043e\u0449\u044c \u0438 \u0441\u043f\u0440\u0430\u0432\u043a\u0430","text":"<p>\u041a\u043e\u043c\u0430\u043d\u0434\u0430 <code>/help</code> \u0432\u0441\u0435\u0433\u0434\u0430 \u0432\u044b\u0432\u0435\u0434\u0435\u0442 \u043a\u0440\u0430\u0442\u043a\u0443\u044e \u0438\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044e \u0438 \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439.</p>"},{"location":"api/","title":"API Reference Overview \ud83d\ude80","text":"<p>\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c \u0432 \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0441\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a API Gifty. \u041d\u0430\u0448\u0430 \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u043f\u043e\u0441\u0442\u0440\u043e\u0435\u043d\u0430 \u043f\u043e \u0441\u043b\u043e\u0438\u0441\u0442\u043e\u0439 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0435, \u0433\u0434\u0435 \u043a\u0430\u0436\u0434\u044b\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u0438\u043c\u0435\u0435\u0442 \u0447\u0435\u0442\u043a\u0443\u044e \u0437\u043e\u043d\u0443 \u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0441\u0442\u0438.</p>"},{"location":"api/#_1","title":"\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f","text":"graph TD     UI[Frontend / Dashboard] --&gt; API[API Layer]     Bot[Telegram Bot] --&gt; API     Workers[Scrapy Workers] --&gt; InternalAPI[Internal API]      subgraph \"Backend Core\"         API --&gt; Services[Services Layer]         InternalAPI --&gt; Services         Services --&gt; Repositories[Repositories Layer]         Repositories --&gt; DB[(PostgreSQL + pgvector)]         Models[Data Models] -.-&gt; API         Models -.-&gt; Services     end      subgraph \"External Systems\"         Services --&gt; Weeek[Weeek CRM]         API --&gt; PostHog[PostHog Analytics]     end"},{"location":"api/#_2","title":"\u0420\u0430\u0437\u0434\u0435\u043b\u044b \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438","text":""},{"location":"api/#api-playground","title":"\ud83d\udd79 API Playground","text":"<p>\u0418\u043d\u0442\u0435\u0440\u0430\u043a\u0442\u0438\u0432\u043d\u0430\u044f \u043a\u043e\u043d\u0441\u043e\u043b\u044c Swagger UI \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u043e\u0432 \u043f\u0440\u044f\u043c\u043e \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435 (Localhost / Production).</p>"},{"location":"api/#data-models","title":"\ud83d\udce6 Data Models","text":"<p>\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 Pydantic-\u0441\u0445\u0435\u043c \u0438 SQLAlchemy \u043c\u043e\u0434\u0435\u043b\u0439. \u0417\u0434\u0435\u0441\u044c \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u044b \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b \u0434\u0430\u043d\u043d\u044b\u0445, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u044e\u0442\u0441\u044f \u043c\u0435\u0436\u0434\u0443 \u0444\u0440\u043e\u043d\u0442\u0435\u043d\u0434\u043e\u043c \u0438 \u0431\u044d\u043a\u0435\u043d\u0434\u043e\u043c, \u0430 \u0442\u0430\u043a\u0436\u0435 \u0441\u043f\u043e\u0441\u043e\u0431 \u0438\u0445 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0432 \u0431\u0430\u0437\u0435.</p>"},{"location":"api/#services","title":"\u2699\ufe0f Services","text":"<p>\u0411\u0438\u0437\u043d\u0435\u0441-\u043b\u043e\u0433\u0438\u043a\u0430 \u0441\u0438\u0441\u0442\u0435\u043c\u044b. \u0421\u0435\u0440\u0432\u0438\u0441\u044b \u043a\u043e\u043e\u0440\u0434\u0438\u043d\u0438\u0440\u0443\u044e\u0442 \u0440\u0430\u0431\u043e\u0442\u0443 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0435\u0432, \u0432\u043d\u0435\u0448\u043d\u0438\u0445 \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0439 \u0438 \u0440\u0435\u0448\u0430\u044e\u0442 \u0432\u044b\u0441\u043e\u043a\u043e\u0443\u0440\u043e\u0432\u043d\u0435\u0432\u044b\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0438\u043d\u0436\u0435\u0441\u0442\u0430 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0438\u043b\u0438 \u043b\u043e\u0433\u0438\u043a\u0430 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439).</p>"},{"location":"api/#repositories","title":"\ud83d\uddc4 Repositories","text":"<p>\u0421\u043b\u043e\u0439 \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0434\u0430\u043d\u043d\u044b\u043c\u0438. \u041f\u0440\u044f\u043c\u043e\u0435 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u0441 \u0431\u0430\u0437\u043e\u0439 \u0434\u0430\u043d\u043d\u044b\u0445 \u0447\u0435\u0440\u0435\u0437 SQLAlchemy. \u0420\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438 \u0438\u043d\u043a\u0430\u043f\u0441\u0443\u043b\u0438\u0440\u0443\u044e\u0442 \u0441\u043b\u043e\u0436\u043d\u044b\u0435 SQL-\u0437\u0430\u043f\u0440\u043e\u0441\u044b \u0438 \u0432\u0435\u043a\u0442\u043e\u0440\u043d\u044b\u0439 \u043f\u043e\u0438\u0441\u043a.</p>"},{"location":"api/#integrations-weeek","title":"\ud83d\udd0c Integrations &amp; Weeek","text":"<p>\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 Weeek \u0434\u043b\u044f \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438: \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0435 \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u044b \u0434\u043b\u044f \u0431\u043e\u0442\u0430 \u0438 \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u044b\u0435 \u043f\u0440\u043e\u043a\u0441\u0438 \u0434\u043b\u044f \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438.</p>"},{"location":"api/#auth-api","title":"\ud83d\udee1\ufe0f Auth API","text":"<p>\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0435\u0441\u0441\u0438\u044f\u043c\u0438 \u0438 \u0432\u0445\u043e\u0434 \u0447\u0435\u0440\u0435\u0437 OAuth 2.0 (Google, Yandex, VK).</p>"},{"location":"api/#public-api","title":"\ud83c\udf10 Public API","text":"<p>\u0418\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u044b \u0434\u043b\u044f \u0432\u043d\u0435\u0448\u043d\u0435\u0433\u043e \u0444\u0440\u043e\u043d\u0442\u0435\u043d\u0434\u0430: \u0444\u043e\u0440\u043c\u044b \u043e\u0431\u0440\u0430\u0442\u043d\u043e\u0439 \u0441\u0432\u044f\u0437\u0438 (\u043b\u0438\u0434\u044b), \u0441\u043f\u0438\u0441\u043e\u043a \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u0438 \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439.</p>"},{"location":"api/#analytics-api","title":"\ud83d\udcca Analytics API","text":"<p>\u0413\u0438\u0431\u043a\u0438\u0439 GraphQL API \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432\u044b\u0445 \u043c\u0435\u0442\u0440\u0438\u043a \u0438\u0437 PostHog \u0438 \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438\u0437 Prometheus/Loki.</p>"},{"location":"api/#internal-api","title":"\ud83d\udd10 Internal API","text":"<p>\u0418\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u044b \u0434\u043b\u044f \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0445 \u043d\u0443\u0436\u0434: \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0432\u043e\u0440\u043a\u0435\u0440\u0430\u043c\u0438, \u043f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0437\u0430\u043f\u0443\u0441\u043a \u043f\u0430\u0440\u0441\u0435\u0440\u043e\u0432, \u043f\u0440\u0438\u0435\u043c \u043f\u0430\u0440\u0442\u0438\u0439 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0438 \u0437\u0430\u0434\u0430\u0447\u0438 \u0434\u043b\u044f AI-\u0441\u043a\u043e\u0440\u0438\u043d\u0433\u0430.</p> <p>\u0410\u0432\u0442\u043e\u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f</p> <p>\u0411\u043e\u043b\u044c\u0448\u0430\u044f \u0447\u0430\u0441\u0442\u044c \u044d\u0442\u043e\u0433\u043e \u0440\u0430\u0437\u0434\u0435\u043b\u0430 \u0433\u0435\u043d\u0435\u0440\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 docstrings \u0432 \u043a\u043e\u0434\u0435 Python \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e <code>mkdocstrings</code>.</p>"},{"location":"api/auth/","title":"Auth API Reference \ud83d\udd10","text":"<p>\u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 Gifty \u043f\u043e\u0441\u0442\u0440\u043e\u0435\u043d\u0430 \u043d\u0430 \u0431\u0430\u0437\u0435 \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0430 OAuth 2.0 \u0441 PKCE. \u041c\u044b \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c \u0432\u0445\u043e\u0434 \u0447\u0435\u0440\u0435\u0437 Google, Yandex \u0438 VK. \u0421\u0435\u0441\u0441\u0438\u0438 \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u0432 Redis \u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u044e\u0442\u0441\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u0443 \u0447\u0435\u0440\u0435\u0437 HttpOnly Secure \u043a\u0443\u043a\u0438.</p>"},{"location":"api/auth/#flow","title":"\ud83d\ude80 \u041f\u0440\u043e\u0442\u043e\u043a\u043e\u043b \u0432\u0445\u043e\u0434\u0430 (Flow)","text":"<p>\u0414\u043b\u044f \u0444\u0440\u043e\u043d\u0442\u0435\u043d\u0434-\u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u043e\u0432 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0432\u0445\u043e\u0434\u0430 \u0432\u044b\u0433\u043b\u044f\u0434\u0438\u0442 \u0442\u0430\u043a: 1. \u041f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043d\u0430 <code>/auth/{provider}/start</code>. 2. \u0411\u0435\u043a\u0435\u043d\u0434 \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442 \u0440\u0435\u0434\u0438\u0440\u0435\u043a\u0442 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u043b\u043e\u0433\u0438\u043d\u0430 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u0430. 3. \u041f\u043e\u0441\u043b\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e\u0433\u043e \u0432\u0445\u043e\u0434\u0430 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440 \u0432\u0435\u0440\u043d\u0435\u0442 \u044e\u0437\u0435\u0440\u0430 \u043d\u0430 \u043d\u0430\u0448 Callback. 4. \u0411\u0435\u043a\u0435\u043d\u0434 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442 \u0441\u0435\u0441\u0441\u0438\u043e\u043d\u043d\u0443\u044e \u043a\u0443\u043a\u0443 <code>gifty_session</code> \u0438 \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u0438\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043e\u0431\u0440\u0430\u0442\u043d\u043e \u043d\u0430 \u0444\u0440\u043e\u043d\u0442\u0435\u043d\u0434.</p>"},{"location":"api/auth/#_1","title":"\ud83d\udd11 \u042d\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u044b","text":""},{"location":"api/auth/#1-providerstart","title":"1. \u0417\u0430\u043f\u0443\u0441\u043a \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 (<code>/{provider}/start</code>)","text":"<p>\u0418\u043d\u0438\u0446\u0438\u0438\u0440\u0443\u0435\u0442 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0432\u0445\u043e\u0434\u0430.</p> <ul> <li>URL: <code>/api/v1/auth/{provider}/start</code></li> <li>\u041c\u0435\u0442\u043e\u0434: <code>GET</code></li> <li>\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b:<ul> <li><code>provider</code>: <code>google</code>, <code>yandex</code> \u0438\u043b\u0438 <code>vk</code>.</li> <li><code>return_to</code> (query, optional): URL \u043d\u0430 \u0444\u0440\u043e\u043d\u0442\u0435\u043d\u0434\u0435, \u043a\u0443\u0434\u0430 \u043d\u0443\u0436\u043d\u043e \u0432\u0435\u0440\u043d\u0443\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043f\u043e\u0441\u043b\u0435 \u0432\u0445\u043e\u0434\u0430 (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e <code>/</code>).</li> </ul> </li> <li>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442: 302 Redirect.</li> </ul>"},{"location":"api/auth/#2-me","title":"2. \u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0441\u0435\u0431\u0435 (<code>/me</code>)","text":"<p>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0441\u0442\u0430\u0442\u0443\u0441\u0430 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f.</p> <ul> <li>URL: <code>/api/v1/auth/me</code></li> <li>\u041c\u0435\u0442\u043e\u0434: <code>GET</code></li> <li>Response: <code>UserDTO</code> <pre><code>{\n  \"id\": \"uuid\",\n  \"name\": \"\u0418\u043c\u044f \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\",\n  \"email\": \"user@example.com\",\n  \"avatar_url\": \"https://...\",\n  \"is_active\": true\n}\n</code></pre></li> <li>\u041e\u0448\u0438\u0431\u043a\u0438:<ul> <li><code>401 Unauthorized</code>: \u0415\u0441\u043b\u0438 \u0441\u0435\u0441\u0441\u0438\u044f \u043d\u0435\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u0430 \u0438\u043b\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442.</li> </ul> </li> </ul>"},{"location":"api/auth/#3-logout","title":"3. \u0412\u044b\u0445\u043e\u0434 (<code>/logout</code>)","text":"<p>\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0435 \u0441\u0435\u0441\u0441\u0438\u0438.</p> <ul> <li>URL: <code>/api/v1/auth/logout</code></li> <li>\u041c\u0435\u0442\u043e\u0434: <code>POST</code></li> <li>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442: \u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u043a\u0443\u043a\u0438 \u0438 \u043e\u0447\u0438\u0441\u0442\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 Redis.</li> </ul>"},{"location":"api/auth/#_2","title":"\ud83d\udee1 \u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c","text":"<ul> <li>Cookies: \u041a\u0443\u043a\u0430 <code>gifty_session</code> \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u0441 \u0444\u043b\u0430\u0433\u0430\u043c\u0438 <code>HttpOnly</code>, <code>Secure</code>, <code>SameSite=Lax</code>.</li> <li>PKCE: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0437\u0430\u0449\u0438\u0442\u044b \u043e\u0442 \u043f\u0435\u0440\u0435\u0445\u0432\u0430\u0442\u0430 \u043a\u043e\u0434\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438.</li> <li>State: \u0417\u0430\u0449\u0438\u0442\u0430 \u043e\u0442 CSRF \u0430\u0442\u0430\u043a \u0447\u0435\u0440\u0435\u0437 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f.</li> </ul>"},{"location":"api/discovery/","title":"Discovery API Reference","text":"<p>\u042d\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u044b \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u00abDiscovery via Dialogue\u00bb \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u044b \u0434\u043b\u044f \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0438\u043d\u0442\u0435\u0440\u0430\u043a\u0442\u0438\u0432\u043d\u044b\u043c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u043c \u043f\u043e\u0434\u0431\u043e\u0440\u0430 \u043f\u043e\u0434\u0430\u0440\u043a\u043e\u0432.</p>"},{"location":"api/discovery/#1","title":"1. \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0441\u0435\u0441\u0441\u0438\u0438","text":"<p><code>POST /recommendations/init</code></p> <p>\u041c\u0435\u0442\u043e\u0434 \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0441\u0440\u0430\u0437\u0443 \u043f\u043e\u0441\u043b\u0435 \u0442\u043e\u0433\u043e, \u043a\u0430\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u043b \u043a\u0432\u0438\u0437. \u041e\u043d \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u043d\u043e\u0432\u0443\u044e \u0441\u0435\u0441\u0441\u0438\u044e \u0438 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043f\u0435\u0440\u0432\u044b\u0439 \u0448\u0430\u0433 \u0434\u0438\u0430\u043b\u043e\u0433\u0430.</p>"},{"location":"api/discovery/#request-body-quizanswers","title":"Request Body (<code>QuizAnswers</code>)","text":"<p>\u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0439 \u043e\u0431\u044a\u0435\u043a\u0442 \u043e\u0442\u0432\u0435\u0442\u043e\u0432 \u043d\u0430 \u043a\u0432\u0438\u0437.</p>"},{"location":"api/discovery/#response-recommendationsession","title":"Response (<code>RecommendationSession</code>)","text":"<pre><code>{\n  \"session_id\": \"uuid-string\",\n  \"state\": \"branching\",\n  \"selected_topic\": \"\u041c\u0443\u0437\u044b\u043a\u0430\",\n  \"current_probe\": {\n    \"question\": \"\u0422\u0430\u043a, \u0434\u0430\u0432\u0430\u0439 \u0443\u0442\u043e\u0447\u043d\u0438\u043c \u043d\u0430\u0441\u0447\u0435\u0442 \u043c\u0443\u0437\u044b\u043a\u0438 \ud83c\udfb5\",\n    \"options\": [\"\u041f\u0440\u043e\u0441\u0442\u043e \u0441\u043b\u0443\u0448\u0430\u0435\u0442\", \"\u0418\u0433\u0440\u0430\u0435\u0442 \u0441\u0430\u043c\", \"\u0424\u0430\u043d\u0430\u0442\u0435\u0435\u0442\"],\n    \"can_skip\": true\n  }\n}\n</code></pre>"},{"location":"api/discovery/#2-interaction","title":"2. \u0412\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 (Interaction)","text":"<p><code>POST /recommendations/interact</code></p> <p>\u0423\u043d\u0438\u0432\u0435\u0440\u0441\u0430\u043b\u044c\u043d\u044b\u0439 \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442 \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0432 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435 \u043f\u043e\u0438\u0441\u043a\u0430.</p>"},{"location":"api/discovery/#request-body","title":"Request Body","text":"Field Type Description <code>session_id</code> <code>uuid</code> ID \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0441\u0435\u0441\u0441\u0438\u0438 <code>action</code> <code>string</code> \u0422\u0438\u043f \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f (\u0441\u043c. \u043d\u0438\u0436\u0435) <code>value</code> <code>string</code> \u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u0430\u044f \u043e\u043f\u0446\u0438\u044f \u0438\u043b\u0438 ID \u0433\u0438\u043f\u043e\u0442\u0435\u0437\u044b)"},{"location":"api/discovery/#actions","title":"\u0414\u043e\u043f\u0443\u0441\u0442\u0438\u043c\u044b\u0435 Actions:","text":"Action Value \u042d\u0444\u0444\u0435\u043a\u0442 <code>answer_probe</code> \u0422\u0435\u043a\u0441\u0442 \u043e\u0442\u0432\u0435\u0442\u0430 / \u041e\u043f\u0446\u0438\u044f \u041f\u0435\u0440\u0435\u0445\u043e\u0434 \u043a \u0433\u0438\u043f\u043e\u0442\u0435\u0437\u0430\u043c \u0438\u043b\u0438 \u0443\u0442\u043e\u0447\u043d\u0435\u043d\u0438\u0435 \u0442\u043e\u043f\u0438\u043a\u0430. <code>like_hypothesis</code> <code>hypothesis_id</code> \u041f\u0435\u0440\u0435\u0445\u043e\u0434 \u0432 \u0440\u0435\u0436\u0438\u043c Deep Dive (\u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0432\u0441\u0435\u0445 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0438\u0434\u0435\u0438). <code>dislike_hypothesis</code> <code>hypothesis_id</code> \u0421\u043a\u0440\u044b\u0442\u0438\u0435 \u0438\u0434\u0435\u0438 \u0438 \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0430\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u044b/\u043f\u0438\u0432\u043e\u0442\u0430. <code>pivot</code> \"new_topic\" / \"psychology\" \u0420\u0443\u0447\u043d\u043e\u0439 \u0437\u0430\u043f\u0443\u0441\u043a \u0441\u043c\u0435\u043d\u044b \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0438\u0437 \u0442\u0443\u043f\u0438\u043a\u0430."},{"location":"api/discovery/#3-discoverystate","title":"3. \u041c\u0430\u0448\u0438\u043d\u0430 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0439 (DiscoveryState)","text":"<p>\u0421\u0435\u0441\u0441\u0438\u044f \u043c\u043e\u0436\u0435\u0442 \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u044c\u0441\u044f \u0432 \u043e\u0434\u043d\u043e\u043c \u0438\u0437 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0445 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0439:</p> <ol> <li><code>quiz</code>: \u041d\u0430\u0447\u0430\u043b\u044c\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445.</li> <li><code>branching</code>: \u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0443\u0442\u043e\u0447\u043d\u044f\u0435\u0442 \u0448\u0438\u0440\u043e\u043a\u0438\u0439 \u0438\u043d\u0442\u0435\u0440\u0435\u0441 (\u0432\u044b\u0432\u0435\u0434\u0435\u043d <code>current_probe</code>).</li> <li><code>showing_hypotheses</code>: \u041d\u0430 \u044d\u043a\u0440\u0430\u043d\u0435 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438 \u0438\u0434\u0435\u0439 (\u043d\u0430\u043f\u043e\u043b\u043d\u0435\u043d \u0441\u043f\u0438\u0441\u043e\u043a <code>current_hypotheses</code>).</li> <li><code>deep_dive</code>: \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0432\u044b\u0431\u0440\u0430\u043b \u0438\u0434\u0435\u044e \u0438 \u0441\u043c\u043e\u0442\u0440\u0438\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u0442\u043e\u0432\u0430\u0440\u044b \u043f\u043e \u043d\u0435\u0439.</li> <li><code>dead_end</code>: \u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u043d\u0435 \u043d\u0430\u0448\u043b\u0430 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432 \u0438 \u043f\u0440\u0435\u0434\u043b\u0430\u0433\u0430\u0435\u0442 \u00ab\u0421\u043f\u0430\u0441-\u043a\u0430\u0440\u0442\u0443\u00bb.</li> </ol>"},{"location":"api/discovery/#4-hypothesis","title":"4. \u041e\u0431\u044a\u0435\u043a\u0442 Hypothesis (\u041a\u0430\u0440\u0442\u043e\u0447\u043a\u0430 \u0418\u0434\u0435\u0438)","text":"<p>\u041e\u0431\u044a\u0435\u043a\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0440\u0435\u043d\u0434\u0435\u0440\u0438\u0442\u0441\u044f \u0432 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0435 (\u0421\u043a\u0440\u0438\u043d 3):</p> <ul> <li><code>title</code>: \u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a (\u043d\u0430\u043f\u0440., \u00ab\u0412 \u043f\u043e\u0438\u0441\u043a\u0430\u0445 \u0442\u043e\u0433\u043e \u0441\u0430\u043c\u043e\u0433\u043e \u0437\u0432\u0443\u043a\u0430\u00bb).</li> <li><code>description</code>: \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0438\u0434\u0435\u0438 \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f.</li> <li><code>primary_gap</code>: \u041c\u0435\u0442\u043a\u0430 \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0438 (<code>catalyst</code>, <code>optimizer</code> \u0438 \u0442.\u0434.).</li> <li><code>preview_products</code>: \u0421\u043f\u0438\u0441\u043e\u043a \u0438\u0437 3-\u0445 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 (<code>GiftDTO</code>) \u0434\u043b\u044f \u043d\u0430\u0433\u043b\u044f\u0434\u043d\u043e\u0441\u0442\u0438.</li> <li><code>search_queries</code>: \u0412\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b, \u043f\u043e \u043a\u043e\u0442\u043e\u0440\u044b\u043c \u043d\u0430\u0439\u0434\u0435\u043d\u044b \u043f\u0440\u0435\u0432\u044c\u044e.</li> </ul>"},{"location":"api/discovery_guide/","title":"Frontend Integration Guide: Discovery Engine v2","text":"<p>This document describes how the frontend (Web App / Mobile) should interact with the Gifty Discovery Engine.</p>"},{"location":"api/discovery_guide/#1-high-level-flow","title":"1. High-Level Flow","text":"<p>The discovery process is a dialogue-driven state machine. Unlike a simple search, it guides the user through psychological hypotheses (Gaps) and interactive steps.</p> <ol> <li>Init: Send Quiz data -&gt; Obtain <code>session_id</code> and initial state.</li> <li>Dialogue Step (Optional): If the system returns a <code>current_probe</code>, show a question with options.</li> <li>Overview: Show \"Topic Tracks\". Each track contains several \"Hypothesis Cards\" with product previews.</li> <li>Interaction: User likes/dislikes/interacts with hypotheses.</li> <li>Deep Dive: If the user clicks on a hypothesis title/preview, fetch a full list of products for that specific idea.</li> </ol>"},{"location":"api/discovery_guide/#2-interface-definitions-typescript-style","title":"2. Interface Definitions (TypeScript Style)","text":""},{"location":"api/discovery_guide/#recommendationsession","title":"RecommendationSession","text":"<p>The main object returned by almost every endpoint.</p> <pre><code>interface RecommendationSession {\n  session_id: string;\n  recipient: {\n    id: string;\n    name?: string;\n  };\n\n  // Parallel topics explored\n  tracks: TopicTrack[];\n\n  // Discovery Helpers (Suggesting new directions)\n  topic_hints: Array&lt;{\n    id: string;\n    title: string;\n    description: string;\n  }&gt;;\n\n  // Active Dialogue (If not null, MUST show this to the user as a blocking screen)\n  current_probe?: DialogueStep;\n\n  // Selected state (for deep dive context)\n  selected_topic_id?: string;\n  selected_hypothesis_id?: string;\n}\n\ninterface TopicTrack {\n  topic_id: string;\n  title: string;\n  hypotheses: GiftHypothesis[];\n}\n\ninterface GiftHypothesis {\n  id: string;\n  title: string;\n  description: string;\n  preview_products: GiftDTO[]; // Array of 3 items for preview\n}\n\ninterface DialogueStep {\n  question: string;\n  options: string[];\n  can_skip: boolean;\n  type: 'topic_clarification' | 'gap_refinement' | 'pivot';\n}\n\ninterface GiftDTO {\n  id: string;\n  title: string;\n  description: string;\n  price: number;\n  currency: string;\n  product_url: string;\n  image_url?: string;\n  store_name?: string;\n}\n</code></pre>"},{"location":"api/discovery_guide/#3-endpoints-actions","title":"3. Endpoints &amp; Actions","text":""},{"location":"api/discovery_guide/#1-initialize-session","title":"1. Initialize Session","text":"<p><code>POST /api/v1/recommendations/init</code></p> <p>Call this after the user completes the initial landing quiz.</p> <p>Request: <pre><code>{\n  \"answers\": {\n    \"age\": 30,\n    \"gender\": \"male\",\n    \"relation\": \"friend\",\n    \"interests\": \"coffee, tech, travel\",\n    \"budget\": 5000\n  }\n}\n</code></pre></p> <p>Behavior: - Creates a <code>RecipientProfile</code> in the database. - Starts the AI analysis. - Returns the first <code>RecommendationSession</code>. </p> <p>Action Item: Check if <code>current_probe</code> is present. If yes -&gt; Show question. If no -&gt; Show tracks.</p>"},{"location":"api/discovery_guide/#2-interaction-the-heart-of-discovery","title":"2. Interaction (The Heart of Discovery)","text":"<p><code>POST /api/v1/recommendations/interact</code></p> <p>This endpoint handles ANY button click in the UI.</p> <p>Action Matrix:</p> User Action <code>action</code> param <code>value</code> param Description Answer Probe <code>answer_probe</code> Selected option text Submits answer to AI question. Select Topic <code>select_track</code> <code>topic_id</code> Highlights a specific topic track. Suggest Topics <code>suggest_topics</code> (empty) Force AI to generate new <code>topic_hints</code>. Manual Refine <code>refine_topic</code> <code>topic_id</code> Triggers a clarification probe for topic. <p>Request Example: <pre><code>{\n  \"session_id\": \"...\",\n  \"action\": \"answer_probe\",\n  \"value\": \"Play board games often\"\n}\n</code></pre></p>"},{"location":"api/discovery_guide/#3-record-reactions","title":"3. Record Reactions","text":"<p><code>POST /api/v1/recommendations/hypothesis/{hypothesis_id}/react</code></p> <p>Use this for the small \u2764\ufe0f / \ud83d\udc4e buttons on cards. It doesn't trigger a dialogue transition immediately but helps the AI learn.</p> <p>Params: - <code>reaction</code>: <code>\"like\"</code>, <code>\"dislike\"</code>, <code>\"shortlist\"</code></p>"},{"location":"api/discovery_guide/#4-deep-dive-full-product-list","title":"4. Deep Dive (Full Product List)","text":"<p><code>GET /api/v1/recommendations/hypothesis/{hypothesis_id}/products</code></p> <p>When a user wants to see MORE than 3 items for an idea.</p> <p>Response: Returns <code>List[GiftDTO]</code> (usually 15-20 items).</p>"},{"location":"api/discovery_guide/#4-ui-transition-logic-frontend-pseudocode","title":"4. UI Transition Logic (Frontend pseudocode)","text":"<pre><code>function handleSessionUpdate(session) {\n    // 1. Check for Active Dialogue\n    if (session.current_probe) {\n        renderProbeModal(session.current_probe);\n        return;\n    }\n\n    // 2. Render Main View\n    if (session.tracks.length &gt; 0) {\n        renderHorizontalTracks(session.tracks);\n    } else {\n        // Fallback or \"Thinking\" state\n        renderEmptyDiscoveryState();\n    }\n\n    // 3. Render Helpers\n    if (session.topic_hints.length &gt; 0) {\n        renderRecommendationShortcuts(session.topic_hints);\n    }\n}\n</code></pre>"},{"location":"api/discovery_guide/#5-security-delimiters","title":"5. Security &amp; Delimiters","text":"<p>IMPORTANT: All user inputs provided through the UI are sanitized on the backend. If you attempt to send tags like <code>&lt;system&gt;</code> or <code>&lt;user_data&gt;</code> in answers, they will be stripped.</p> <ul> <li>Max input length: 500 chars (truncated automatically).</li> <li>Suspicious patterns (e.g. \"ignore instructions\") trigger aggressive filtering.</li> </ul>"},{"location":"api/discovery_guide/#6-error-handling","title":"6. Error Handling","text":"<ul> <li>404 Not Found: Session expired or invalid ID. Frontend should redirect to the start of the quiz.</li> <li>422 Validation Error: Malformed JSON or invalid action type.</li> <li>500 Internal Error: AI failure or DB issue. Show a \"Our brain is a bit tired, try again in a moment\" message.</li> </ul>"},{"location":"api/internal/","title":"Internal API Reference \ud83d\udd10","text":"<p>Internal API \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d \u0434\u043b\u044f \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u043c\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u044b Gifty: \u0430\u0434\u043c\u0438\u043d-\u043f\u0430\u043d\u0435\u043b\u044c\u044e (Dashboard), \u0432\u043e\u0440\u043a\u0435\u0440\u0430\u043c\u0438 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0430 \u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u043e\u0439 \u0441\u043a\u043e\u0440\u0438\u043d\u0433\u0430 (Intelligence). </p> <p>\u042d\u0442\u0438 \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u044b \u0442\u0440\u0435\u0431\u0443\u044e\u0442 \u0432\u044b\u0441\u043e\u043a\u043e\u0433\u043e \u0443\u0440\u043e\u0432\u043d\u044f \u043f\u0440\u0438\u0432\u0438\u043b\u0435\u0433\u0438\u0439 \u0438 \u043d\u0435 \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u044b \u0434\u043b\u044f \u0432\u044b\u0437\u043e\u0432\u0430 \u0438\u0437 \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u043e\u0433\u043e \u0444\u0440\u043e\u043d\u0442\u0435\u043d\u0434\u0430.</p>"},{"location":"api/internal/#_1","title":"\u0410\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f","text":"<p>\u0412\u0441\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043a Internal API \u0442\u0440\u0435\u0431\u0443\u044e\u0442 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0442\u043e\u043a\u0435\u043d\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0432 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0435 <code>X-Internal-Token</code>.</p> \u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 <code>X-Internal-Token</code> \u0421\u0435\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u0442\u043e\u043a\u0435\u043d, \u0437\u0430\u0434\u0430\u043d\u043d\u044b\u0439 \u0432 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430\u0445 (<code>INTERNAL_API_TOKEN</code>)."},{"location":"api/internal/#sources","title":"\ud83d\udd77 \u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u041f\u0430\u0440\u0441\u0438\u043d\u0433\u043e\u043c (Sources)","text":""},{"location":"api/internal/#1-sources","title":"1. \u0421\u043f\u0438\u0441\u043e\u043a \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u043e\u0432 (<code>/sources</code>)","text":"<p>\u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0432\u0441\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0441\u0430\u0439\u0442\u044b \u0438 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u0434\u043b\u044f \u0441\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445.</p> <ul> <li>URL: <code>/internal/sources</code></li> <li>\u041c\u0435\u0442\u043e\u0434: <code>GET</code></li> <li>Response: <code>List[ParsingSourceSchema]</code></li> </ul>"},{"location":"api/internal/#2-sourcessource_id","title":"2. \u0414\u0435\u0442\u0430\u043b\u044c\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f (<code>/sources/{source_id}</code>)","text":"<p>\u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043f\u043e\u043b\u043d\u0443\u044e \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u0437\u0430\u043f\u0443\u0441\u043a\u043e\u0432, \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u043a\u043e\u043d\u0444\u0438\u0433 \u0438 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u043f\u0430\u0440\u0441\u0435\u0440\u0430.</p> <ul> <li>URL: <code>/internal/sources/{source_id}</code></li> <li>\u041c\u0435\u0442\u043e\u0434: <code>GET</code></li> <li>Response: <code>ParsingSourceSchema</code> (\u0432\u043a\u043b\u044e\u0447\u0430\u044f \u043c\u0430\u0441\u0441\u0438\u0432 <code>history</code> \u0438 <code>total_items</code>).</li> </ul>"},{"location":"api/internal/#3-sourcesbacklog","title":"3. \u0411\u044d\u043a\u043b\u043e\u0433 \u043e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u0438\u044f (<code>/sources/backlog</code>)","text":"<p>\u0421\u043f\u0438\u0441\u043e\u043a \u043d\u043e\u0432\u044b\u0445 \u0441\u0430\u0439\u0442\u043e\u0432 \u0438\u043b\u0438 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u043d\u0430\u0448\u043b\u0430 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438, \u043d\u043e \u0435\u0449\u0435 \u043d\u0435 \u043d\u0430\u0447\u0430\u043b\u0430 \u043f\u0430\u0440\u0441\u0438\u0442\u044c.</p> <ul> <li>URL: <code>/internal/sources/backlog</code></li> <li>\u041c\u0435\u0442\u043e\u0434: <code>GET</code></li> <li>Response: <code>List[ParsingSourceSchema]</code> (\u043e\u0431\u044a\u0435\u043a\u0442\u044b \u0441\u043e \u0441\u0442\u0430\u0442\u0443\u0441\u043e\u043c <code>discovered</code>).</li> </ul>"},{"location":"api/internal/#4-sourcesbacklogactivate","title":"4. \u0410\u043a\u0442\u0438\u0432\u0430\u0446\u0438\u044f \u043e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u043d\u043e\u0433\u043e (<code>/sources/backlog/activate</code>)","text":"<p>\u041c\u0430\u0441\u0441\u043e\u0432\u044b\u0439 \u043f\u0435\u0440\u0435\u0432\u043e\u0434 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u043e\u0432 \u0438\u0437 \u0431\u044d\u043a\u043b\u043e\u0433\u0430 \u0432 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0439 \u0440\u0435\u0436\u0438\u043c.</p> <ul> <li>URL: <code>/internal/sources/backlog/activate</code></li> <li>\u041c\u0435\u0442\u043e\u0434: <code>POST</code></li> <li>Body: <code>{ \"source_ids\": [1, 2, 3] }</code></li> </ul>"},{"location":"api/internal/#5-idforce-run","title":"5. \u041f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0437\u0430\u043f\u0443\u0441\u043a (<code>/{id}/force-run</code>)","text":"<p>\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0443 \u043d\u0430 \u043f\u0430\u0440\u0441\u0438\u043d\u0433 \u0432 RabbitMQ \u043d\u0435\u043c\u0435\u0434\u043b\u0435\u043d\u043d\u043e, \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u0443\u044f \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435.</p> <ul> <li>URL: <code>/internal/sources/{source_id}/force-run</code></li> <li>\u041c\u0435\u0442\u043e\u0434: <code>POST</code></li> <li>\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b:<ul> <li><code>strategy</code> (optional): \u041f\u0435\u0440\u0435\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0438 (<code>discovery</code> \u0438\u043b\u0438 <code>deep</code>).</li> </ul> </li> </ul>"},{"location":"api/internal/#6-idtoggle","title":"6. \u0412\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435/\u0412\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 (<code>/{id}/toggle</code>)","text":"<p>\u0410\u043a\u0442\u0438\u0432\u0438\u0440\u0443\u0435\u0442 \u0438\u043b\u0438 \u0434\u0435\u0430\u043a\u0442\u0438\u0432\u0438\u0440\u0443\u0435\u0442 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0437\u0430\u043f\u0443\u0441\u043a \u043f\u0430\u0440\u0441\u0435\u0440\u0430 \u043f\u043e \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044e.</p> <ul> <li>URL: <code>/internal/sources/{source_id}/toggle</code></li> <li>\u041c\u0435\u0442\u043e\u0434: <code>POST</code></li> <li>Body: <code>{ \"is_active\": bool }</code></li> </ul>"},{"location":"api/internal/#_2","title":"\ud83d\udce6 \u0421\u0431\u043e\u0440 \u0438 \u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445","text":""},{"location":"api/internal/#1-ingest-batch","title":"1. \u041f\u0440\u0438\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0445 (<code>/ingest-batch</code>)","text":"<p>\u041e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442, \u0447\u0435\u0440\u0435\u0437 \u043a\u043e\u0442\u043e\u0440\u044b\u0439 Scrapy-\u0432\u043e\u0440\u043a\u0435\u0440\u044b \u043f\u0435\u0440\u0435\u0434\u0430\u044e\u0442 \u0441\u043e\u0431\u0440\u0430\u043d\u043d\u044b\u0435 \u0442\u043e\u0432\u0430\u0440\u044b \u0438 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u0432 \u043e\u0441\u043d\u043e\u0432\u043d\u0443\u044e \u0411\u0414.</p> <ul> <li>URL: <code>/internal/ingest-batch</code></li> <li>\u041c\u0435\u0442\u043e\u0434: <code>POST</code></li> <li>Body: <code>IngestBatchRequest</code> (\u0441\u043f\u0438\u0441\u043e\u043a \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0438 \u043d\u0430\u0439\u0434\u0435\u043d\u043d\u044b\u0445 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439).</li> </ul>"},{"location":"api/internal/#2-workers","title":"2. \u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u0432\u043e\u0440\u043a\u0435\u0440\u043e\u0432 (<code>/workers</code>)","text":"<p>\u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0445 \u0432 \u0434\u0430\u043d\u043d\u044b\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 Scrapy-\u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432 \u0438 \u0438\u0445 \u0442\u0435\u043a\u0443\u0449\u0443\u044e \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0443.</p> <ul> <li>URL: <code>/internal/workers</code></li> <li>\u041c\u0435\u0442\u043e\u0434: <code>GET</code></li> </ul>"},{"location":"api/internal/#_3","title":"\ud83e\udde0 \u0418\u043d\u0442\u0435\u043b\u043b\u0435\u043a\u0442 \u0438 \u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f","text":""},{"location":"api/internal/#1-scoringtasks","title":"1. \u0417\u0430\u0434\u0430\u0447\u0438 \u043d\u0430 \u0441\u043a\u043e\u0440\u0438\u043d\u0433\u0430 (<code>/scoring/tasks</code>)","text":"<p>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0432\u043d\u0435\u0448\u043d\u0438\u043c\u0438 LLM-\u0432\u043e\u0440\u043a\u0435\u0440\u0430\u043c\u0438 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0432 Kaggle/Colab) \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0442\u043e\u0432\u0430\u0440\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0435\u0449\u0435 \u043d\u0435 \u043f\u0440\u043e\u0448\u043b\u0438 \u043e\u0446\u0435\u043d\u043a\u0443 \u043f\u043e 10 \u043e\u0441\u044f\u043c GUTG.</p> <ul> <li>URL: <code>/internal/scoring/tasks</code></li> <li>\u041c\u0435\u0442\u043e\u0434: <code>GET</code></li> <li>\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b: <code>limit</code> (default: 50).</li> </ul>"},{"location":"api/internal/#2-categoriestasks","title":"2. \u0417\u0430\u0434\u0430\u0447\u0438 \u043d\u0430 \u043c\u0430\u043f\u043f\u0438\u043d\u0433 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 (<code>/categories/tasks</code>)","text":"<p>\u0421\u043f\u0438\u0441\u043e\u043a \u00ab\u0441\u044b\u0440\u044b\u0445\u00bb \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439, \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u044b\u0445 \u043e\u0442 \u043f\u0430\u0440\u0441\u0435\u0440\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0443\u0436\u043d\u043e \u0441\u043e\u043f\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0441 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u043c \u0434\u0435\u0440\u0435\u0432\u043e\u043c \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 Gifty \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e AI.</p> <ul> <li>URL: <code>/internal/categories/tasks</code></li> <li>\u041c\u0435\u0442\u043e\u0434: <code>GET</code></li> </ul>"},{"location":"api/internal/#telegram","title":"\ud83d\udee1 \u0414\u043e\u0441\u0442\u0443\u043f \u0438 Telegram","text":""},{"location":"api/internal/#1-telegramsubscribers","title":"1. \u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u043e\u0434\u043f\u0438\u0441\u0447\u0438\u043a\u0430\u043c\u0438 (<code>/telegram/subscribers</code>)","text":"<p>\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0440\u0430\u0432\u0430\u043c\u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 Telegram-\u0431\u043e\u0442\u0430 \u0438 \u0430\u0434\u043c\u0438\u043d-\u043f\u0430\u043d\u0435\u043b\u0438 (\u0440\u043e\u043b\u0438 <code>admin</code>, <code>superadmin</code>).</p>"},{"location":"api/internal/#2-webapp-webappauth","title":"2. \u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f WebApp (<code>/webapp/auth</code>)","text":"<p>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 <code>initData</code> \u043e\u0442 Telegram Mini App \u0434\u043b\u044f \u0432\u0445\u043e\u0434\u0430 \u0432 Dashboard.</p> <ul> <li>URL: <code>/internal/webapp/auth</code></li> <li>\u041c\u0435\u0442\u043e\u0434: <code>POST</code></li> <li>Body: <code>{ \"init_data\": \"...\" }</code></li> </ul>"},{"location":"api/models/","title":"\u041c\u043e\u0434\u0435\u043b\u0438 (Models)","text":"<p>\u0412 \u044d\u0442\u043e\u043c \u0440\u0430\u0437\u0434\u0435\u043b\u0435 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0433\u0435\u043d\u0435\u0440\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u0432\u0441\u0435\u0445 SQLAlchemy \u043c\u043e\u0434\u0435\u043b\u0435\u0439, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0445 \u0432 \u043f\u0440\u043e\u0435\u043a\u0442\u0435 Gifty.</p>"},{"location":"api/models/#app.models","title":"<code>app.models</code>","text":""},{"location":"api/models/#app.models-classes","title":"Classes","text":""},{"location":"api/models/#app.models.User","title":"<code>User</code>","text":"<p>               Bases: <code>TimestampMixin</code>, <code>Base</code></p> <p>\u041c\u043e\u0434\u0435\u043b\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u044b Gifty. \u0425\u0440\u0430\u043d\u0438\u0442 \u0431\u0430\u0437\u043e\u0432\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435 \u0438 \u0441\u0432\u044f\u0437\u0438 \u0441 OAuth \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430\u043c\u0438.</p> Source code in <code>app/models.py</code> <pre><code>class User(TimestampMixin, Base):\n    \"\"\"\n    \u041c\u043e\u0434\u0435\u043b\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u044b Gifty.\n    \u0425\u0440\u0430\u043d\u0438\u0442 \u0431\u0430\u0437\u043e\u0432\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435 \u0438 \u0441\u0432\u044f\u0437\u0438 \u0441 OAuth \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430\u043c\u0438.\n    \"\"\"\n    __tablename__ = \"users\"\n\n    id: Mapped[uuid.UUID] = mapped_column(PG_UUID(as_uuid=True), primary_key=True, default=uuid.uuid4)\n    name: Mapped[Optional[str]] = mapped_column(String, nullable=True)\n    email: Mapped[Optional[str]] = mapped_column(String, nullable=True)\n    avatar_url: Mapped[Optional[str]] = mapped_column(Text, nullable=True)\n\n    oauth_accounts: Mapped[list[\"OAuthAccount\"]] = relationship(\n        back_populates=\"user\", cascade=\"all, delete-orphan\"\n    )\n\n    # New relationship\n    recipients: Mapped[list[\"Recipient\"]] = relationship(\n        back_populates=\"user\", cascade=\"all, delete-orphan\"\n    )\n</code></pre>"},{"location":"api/models/#app.models.OAuthAccount","title":"<code>OAuthAccount</code>","text":"<p>               Bases: <code>TimestampMixin</code>, <code>Base</code></p> <p>\u0421\u0432\u044f\u0437\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441 \u0432\u043d\u0435\u0448\u043d\u0438\u043c\u0438 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u0430\u043c\u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 (Google, Yandex, VK). \u0425\u0440\u0430\u043d\u0438\u0442 \u0442\u043e\u043a\u0435\u043d\u044b \u0438 \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u044b \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u043e\u0432.</p> Source code in <code>app/models.py</code> <pre><code>class OAuthAccount(TimestampMixin, Base):\n    \"\"\"\n    \u0421\u0432\u044f\u0437\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441 \u0432\u043d\u0435\u0448\u043d\u0438\u043c\u0438 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u0430\u043c\u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 (Google, Yandex, VK).\n    \u0425\u0440\u0430\u043d\u0438\u0442 \u0442\u043e\u043a\u0435\u043d\u044b \u0438 \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u044b \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u043e\u0432.\n    \"\"\"\n    __tablename__ = \"oauth_accounts\"\n    __table_args__ = (\n        UniqueConstraint(\"provider\", \"provider_user_id\", name=\"uq_oauth_provider_user\"),\n    )\n\n    id: Mapped[uuid.UUID] = mapped_column(PG_UUID(as_uuid=True), primary_key=True, default=uuid.uuid4)\n    user_id: Mapped[uuid.UUID] = mapped_column(\n        PG_UUID(as_uuid=True), ForeignKey(\"users.id\", ondelete=\"CASCADE\"), nullable=False, index=True\n    )\n    provider: Mapped[str] = mapped_column(String, nullable=False)\n    provider_user_id: Mapped[str] = mapped_column(String, nullable=False)\n    email_at_provider: Mapped[Optional[str]] = mapped_column(String, nullable=True)\n    access_token: Mapped[Optional[str]] = mapped_column(Text, nullable=True)\n    refresh_token: Mapped[Optional[str]] = mapped_column(Text, nullable=True)\n    expires_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True), nullable=True)\n\n    user: Mapped[User] = relationship(back_populates=\"oauth_accounts\")\n</code></pre>"},{"location":"api/models/#app.models.Recipient","title":"<code>Recipient</code>","text":"<p>               Bases: <code>TimestampMixin</code>, <code>Base</code></p> <p>\u041f\u0440\u043e\u0444\u0438\u043b\u044c \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0430, \u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u0438\u0449\u0443\u0442 \u043f\u043e\u0434\u0430\u0440\u043e\u043a (\u041c\u0430\u043c\u0430, \u0414\u0440\u0443\u0433, \u041a\u043e\u043b\u043b\u0435\u0433\u0430). \u0421\u0432\u044f\u0437\u0430\u043d \u0441 User (Giver).</p> Source code in <code>app/models.py</code> <pre><code>class Recipient(TimestampMixin, Base):\n    \"\"\"\n    \u041f\u0440\u043e\u0444\u0438\u043b\u044c \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0430, \u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u0438\u0449\u0443\u0442 \u043f\u043e\u0434\u0430\u0440\u043e\u043a (\u041c\u0430\u043c\u0430, \u0414\u0440\u0443\u0433, \u041a\u043e\u043b\u043b\u0435\u0433\u0430).\n    \u0421\u0432\u044f\u0437\u0430\u043d \u0441 User (Giver).\n    \"\"\"\n    __tablename__ = \"recipients\"\n\n    id: Mapped[uuid.UUID] = mapped_column(PG_UUID(as_uuid=True), primary_key=True, default=uuid.uuid4)\n    user_id: Mapped[Optional[uuid.UUID]] = mapped_column(\n        PG_UUID(as_uuid=True), ForeignKey(\"users.id\", ondelete=\"CASCADE\"), nullable=True, index=True\n    )\n\n    # Basic Info\n    name: Mapped[Optional[str]] = mapped_column(String, nullable=True)\n    relation: Mapped[Optional[str]] = mapped_column(String, nullable=True) # friend, partner, etc.\n    gender: Mapped[Optional[str]] = mapped_column(String, nullable=True)\n    age: Mapped[Optional[int]] = mapped_column(sa.Integer, nullable=True)\n    birth_date: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True), nullable=True)\n\n    # Preferences / Context\n    interests: Mapped[list[str]] = mapped_column(\n        JSONB, server_default='[]', nullable=False\n    )\n\n    user: Mapped[Optional[User]] = relationship(back_populates=\"recipients\")\n    interactions: Mapped[list[\"Interaction\"]] = relationship(\n        back_populates=\"recipient\", cascade=\"all, delete-orphan\"\n    )\n</code></pre>"},{"location":"api/models/#app.models.Interaction","title":"<code>Interaction</code>","text":"<p>               Bases: <code>TimestampMixin</code>, <code>Base</code></p> <p>\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u044f\u043c\u0438 \u0434\u043b\u044f \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e Recipient.</p> Source code in <code>app/models.py</code> <pre><code>class Interaction(TimestampMixin, Base):\n    \"\"\"\n    \u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u044f\u043c\u0438 \u0434\u043b\u044f \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e Recipient.\n    \"\"\"\n    __tablename__ = \"interactions\"\n\n    id: Mapped[uuid.UUID] = mapped_column(PG_UUID(as_uuid=True), primary_key=True, default=uuid.uuid4)\n    recipient_id: Mapped[uuid.UUID] = mapped_column(\n        PG_UUID(as_uuid=True), ForeignKey(\"recipients.id\", ondelete=\"CASCADE\"), nullable=False, index=True\n    )\n    session_id: Mapped[str] = mapped_column(String, nullable=False, index=True)\n\n    action_type: Mapped[str] = mapped_column(String, nullable=False) # like, dislike, view, purchase\n    target_type: Mapped[str] = mapped_column(String, nullable=False) # hypothesis, product\n    target_id: Mapped[str] = mapped_column(String, nullable=False)\n\n    value: Mapped[Optional[str]] = mapped_column(Text, nullable=True) # comment text or value\n    metadata_json: Mapped[Optional[dict]] = mapped_column(JSONB, nullable=True)\n\n    recipient: Mapped[Recipient] = relationship(back_populates=\"interactions\")\n</code></pre>"},{"location":"api/models/#app.models.Hypothesis","title":"<code>Hypothesis</code>","text":"<p>               Bases: <code>TimestampMixin</code>, <code>Base</code></p> <p>\u041c\u043e\u0434\u0435\u043b\u044c \u0433\u0438\u043f\u043e\u0442\u0435\u0437\u044b (\u0438\u0434\u0435\u0438 \u043f\u043e\u0434\u0430\u0440\u043a\u0430), \u0441\u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0439 \u0418\u0418. \u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0430\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u044d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u0438\u0434\u0435\u0439 \u0438 \u0441\u043e\u0431\u0438\u0440\u0430\u0442\u044c \u0444\u0438\u0434\u0431\u044d\u043a.</p> Source code in <code>app/models.py</code> <pre><code>class Hypothesis(TimestampMixin, Base):\n    \"\"\"\n    \u041c\u043e\u0434\u0435\u043b\u044c \u0433\u0438\u043f\u043e\u0442\u0435\u0437\u044b (\u0438\u0434\u0435\u0438 \u043f\u043e\u0434\u0430\u0440\u043a\u0430), \u0441\u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0439 \u0418\u0418.\n    \u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0430\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u044d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u0438\u0434\u0435\u0439 \u0438 \u0441\u043e\u0431\u0438\u0440\u0430\u0442\u044c \u0444\u0438\u0434\u0431\u044d\u043a.\n    \"\"\"\n    __tablename__ = \"hypotheses\"\n\n    id: Mapped[uuid.UUID] = mapped_column(PG_UUID(as_uuid=True), primary_key=True, default=uuid.uuid4)\n    session_id: Mapped[str] = mapped_column(String, nullable=False, index=True)\n    recipient_id: Mapped[Optional[uuid.UUID]] = mapped_column(\n        PG_UUID(as_uuid=True), ForeignKey(\"recipients.id\", ondelete=\"CASCADE\"), nullable=True, index=True\n    )\n\n    track_title: Mapped[str] = mapped_column(String, nullable=False) # \u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0442\u043e\u043f\u0438\u043a\u0430 (\u041a\u043e\u0444\u0435, \u0421\u043f\u043e\u0440\u0442)\n    title: Mapped[str] = mapped_column(String, nullable=False)       # \u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0433\u0438\u043f\u043e\u0442\u0435\u0437\u044b\n    description: Mapped[Optional[str]] = mapped_column(Text, nullable=True)\n    reasoning: Mapped[Optional[str]] = mapped_column(Text, nullable=True)   # \u041e\u0431\u043e\u0441\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u0418\u0418\n    search_queries: Mapped[list[str]] = mapped_column(\n        JSONB, server_default='[]', nullable=False\n    )\n\n    # Feedback tracking\n    user_reaction: Mapped[Optional[str]] = mapped_column(String, nullable=True) # like, dislike, shortlist\n    is_shown: Mapped[bool] = mapped_column(sa.Boolean, server_default=\"true\")\n\n    # AI Metadata\n    model_name: Mapped[Optional[str]] = mapped_column(String, nullable=True)\n    raw_response: Mapped[Optional[dict]] = mapped_column(JSONB, nullable=True)\n\n    recipient: Mapped[Optional[Recipient]] = relationship()\n</code></pre>"},{"location":"api/models/#app.models.Product","title":"<code>Product</code>","text":"<p>               Bases: <code>TimestampMixin</code>, <code>Base</code></p> <p>\u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c \u0442\u043e\u0432\u0430\u0440\u0430 \u0432 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0435. \u0421\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u0442\u043e\u0432\u0430\u0440\u0430, \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043c\u0435\u0440\u0447\u0430\u043d\u0442\u0435 \u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043e\u0446\u0435\u043d\u043a\u0438 LLM.</p> Source code in <code>app/models.py</code> <pre><code>class Product(TimestampMixin, Base):\n    \"\"\"\n    \u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c \u0442\u043e\u0432\u0430\u0440\u0430 \u0432 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0435.\n    \u0421\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u0442\u043e\u0432\u0430\u0440\u0430, \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043c\u0435\u0440\u0447\u0430\u043d\u0442\u0435 \u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043e\u0446\u0435\u043d\u043a\u0438 LLM.\n    \"\"\"\n    __tablename__ = \"products\"\n\n    gift_id: Mapped[str] = mapped_column(Text, primary_key=True)\n    title: Mapped[str] = mapped_column(Text, nullable=False)\n    description: Mapped[Optional[str]] = mapped_column(Text, nullable=True)\n    price: Mapped[Optional[float]] = mapped_column(sa.Numeric, nullable=True)\n    currency: Mapped[Optional[str]] = mapped_column(Text, nullable=True)\n    image_url: Mapped[Optional[str]] = mapped_column(Text, nullable=True)\n    product_url: Mapped[str] = mapped_column(Text, nullable=False)\n    merchant: Mapped[Optional[str]] = mapped_column(Text, nullable=True, index=True)\n    category: Mapped[Optional[str]] = mapped_column(Text, nullable=True, index=True)\n    raw: Mapped[Optional[dict]] = mapped_column(JSONB, nullable=True)\n    is_active: Mapped[bool] = mapped_column(sa.Boolean, server_default=\"true\", default=True, index=True)\n    content_text: Mapped[Optional[str]] = mapped_column(Text, nullable=True)\n    content_hash: Mapped[Optional[str]] = mapped_column(Text, nullable=True)\n\n    # LLM Scoring\n    llm_gift_score: Mapped[Optional[float]] = mapped_column(sa.Float, nullable=True, index=True)\n    llm_gift_reasoning: Mapped[Optional[str]] = mapped_column(Text, nullable=True)\n    llm_gift_vector: Mapped[Optional[dict]] = mapped_column(JSONB, nullable=True)\n    llm_scoring_model: Mapped[Optional[str]] = mapped_column(Text, nullable=True)\n    llm_scoring_version: Mapped[Optional[str]] = mapped_column(Text, nullable=True)\n    llm_scored_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True), nullable=True)\n</code></pre>"},{"location":"api/models/#app.models.ProductEmbedding","title":"<code>ProductEmbedding</code>","text":"<p>               Bases: <code>TimestampMixin</code>, <code>Base</code></p> <p>\u0412\u0435\u043a\u0442\u043e\u0440\u043d\u044b\u0435 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0434\u043b\u044f \u0441\u0435\u043c\u0430\u043d\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u043f\u043e\u0438\u0441\u043a\u0430. \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 pgvector \u0434\u043b\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u044d\u043c\u0431\u0435\u0434\u0434\u0438\u043d\u0433\u043e\u0432.</p> Source code in <code>app/models.py</code> <pre><code>class ProductEmbedding(TimestampMixin, Base):\n    \"\"\"\n    \u0412\u0435\u043a\u0442\u043e\u0440\u043d\u044b\u0435 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0434\u043b\u044f \u0441\u0435\u043c\u0430\u043d\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u043f\u043e\u0438\u0441\u043a\u0430.\n    \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 pgvector \u0434\u043b\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u044d\u043c\u0431\u0435\u0434\u0434\u0438\u043d\u0433\u043e\u0432.\n    \"\"\"\n    __tablename__ = \"product_embeddings\"\n\n    gift_id: Mapped[str] = mapped_column(Text, ForeignKey(\"products.gift_id\", ondelete=\"CASCADE\"), primary_key=True)\n    model_name: Mapped[str] = mapped_column(Text, nullable=False, primary_key=True)\n    model_version: Mapped[str] = mapped_column(Text, nullable=False, primary_key=True)\n    dim: Mapped[int] = mapped_column(sa.Integer, nullable=False)\n    embedding: Mapped[list[float]] = mapped_column(Vector(1024), nullable=False)\n    content_hash: Mapped[str] = mapped_column(Text, nullable=False)\n    embedded_at: Mapped[datetime] = mapped_column(DateTime(timezone=True), server_default=func.now())\n</code></pre>"},{"location":"api/models/#app.models.ParsingSource","title":"<code>ParsingSource</code>","text":"<p>               Bases: <code>TimestampMixin</code>, <code>Base</code></p> <p>\u0420\u0435\u0435\u0441\u0442\u0440 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u043e\u0432 \u0434\u043b\u044f \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0430 (\u043c\u0430\u0433\u0430\u0437\u0438\u043d\u043e\u0432 \u0438 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439). \u0423\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435\u043c \u0438 \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0435\u0439 \u0441\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445.</p> Source code in <code>app/models.py</code> <pre><code>class ParsingSource(TimestampMixin, Base):\n    \"\"\"\n    \u0420\u0435\u0435\u0441\u0442\u0440 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u043e\u0432 \u0434\u043b\u044f \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0430 (\u043c\u0430\u0433\u0430\u0437\u0438\u043d\u043e\u0432 \u0438 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439).\n    \u0423\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435\u043c \u0438 \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0435\u0439 \u0441\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445.\n    \"\"\"\n    __tablename__ = \"parsing_sources\"\n\n    id: Mapped[int] = mapped_column(sa.Integer, primary_key=True, autoincrement=True)\n    url: Mapped[str] = mapped_column(Text, nullable=False, unique=True)\n    type: Mapped[str] = mapped_column(String, nullable=False)  # hub, list, product, sitemap\n    site_key: Mapped[str] = mapped_column(String, nullable=False, index=True)  # mrgeek, ozon, etc.\n    strategy: Mapped[str] = mapped_column(String, server_default=\"deep\")  # deep, discovery\n    priority: Mapped[int] = mapped_column(sa.Integer, server_default=\"50\", index=True)\n    refresh_interval_hours: Mapped[int] = mapped_column(sa.Integer, server_default=\"24\")\n    last_synced_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True), nullable=True)\n    next_sync_at: Mapped[datetime] = mapped_column(DateTime(timezone=True), server_default=func.now(), index=True)\n    is_active: Mapped[bool] = mapped_column(sa.Boolean, server_default=\"true\", default=True, index=True)\n    status: Mapped[str] = mapped_column(String, server_default=\"waiting\", index=True) # waiting, running, error, broken\n    config: Mapped[Optional[dict]] = mapped_column(JSONB, nullable=True)\n</code></pre>"},{"location":"api/models/#app.models.ParsingRun","title":"<code>ParsingRun</code>","text":"<p>               Bases: <code>TimestampMixin</code>, <code>Base</code></p> <p>\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0437\u0430\u043f\u0443\u0441\u043a\u043e\u0432 \u043f\u0430\u0440\u0441\u0435\u0440\u043e\u0432. \u0425\u0440\u0430\u043d\u0438\u0442 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443 \u043f\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0443 \u0441\u043f\u0430\u0440\u0448\u0435\u043d\u043d\u044b\u0445 \u0438 \u043d\u043e\u0432\u044b\u0445 \u0442\u043e\u0432\u0430\u0440\u043e\u0432.</p> Source code in <code>app/models.py</code> <pre><code>class ParsingRun(TimestampMixin, Base):\n    \"\"\"\n    \u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0437\u0430\u043f\u0443\u0441\u043a\u043e\u0432 \u043f\u0430\u0440\u0441\u0435\u0440\u043e\u0432.\n    \u0425\u0440\u0430\u043d\u0438\u0442 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443 \u043f\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0443 \u0441\u043f\u0430\u0440\u0448\u0435\u043d\u043d\u044b\u0445 \u0438 \u043d\u043e\u0432\u044b\u0445 \u0442\u043e\u0432\u0430\u0440\u043e\u0432.\n    \"\"\"\n    __tablename__ = \"parsing_runs\"\n\n    id: Mapped[int] = mapped_column(sa.Integer, primary_key=True, autoincrement=True)\n    source_id: Mapped[int] = mapped_column(sa.Integer, ForeignKey(\"parsing_sources.id\", ondelete=\"CASCADE\"), index=True)\n    status: Mapped[str] = mapped_column(String, nullable=False) # processing, completed, error\n    items_scraped: Mapped[int] = mapped_column(sa.Integer, default=0)\n    items_new: Mapped[int] = mapped_column(sa.Integer, default=0)\n    error_message: Mapped[Optional[str]] = mapped_column(Text, nullable=True)\n    duration_seconds: Mapped[Optional[float]] = mapped_column(sa.Float, nullable=True)\n</code></pre>"},{"location":"api/models/#app.models.CategoryMap","title":"<code>CategoryMap</code>","text":"<p>               Bases: <code>TimestampMixin</code>, <code>Base</code></p> <p>\u041c\u0430\u043f\u043f\u0438\u043d\u0433 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u0432\u043d\u0435\u0448\u043d\u0438\u0445 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u043e\u0432 \u0432\u043e \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 Gifty. \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430.</p> Source code in <code>app/models.py</code> <pre><code>class CategoryMap(TimestampMixin, Base):\n    \"\"\"\n    \u041c\u0430\u043f\u043f\u0438\u043d\u0433 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u0432\u043d\u0435\u0448\u043d\u0438\u0445 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u043e\u0432 \u0432\u043e \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 Gifty.\n    \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430.\n    \"\"\"\n    __tablename__ = \"category_maps\"\n\n    id: Mapped[int] = mapped_column(sa.Integer, primary_key=True, autoincrement=True)\n    external_name: Mapped[str] = mapped_column(String, nullable=False, unique=True)\n    internal_category_id: Mapped[Optional[int]] = mapped_column(sa.Integer, nullable=True)\n    is_verified: Mapped[bool] = mapped_column(sa.Boolean, server_default=\"false\")\n</code></pre>"},{"location":"api/models/#app.models.TelegramSubscriber","title":"<code>TelegramSubscriber</code>","text":"<p>               Bases: <code>TimestampMixin</code>, <code>Base</code></p> <p>\u041f\u043e\u0434\u043f\u0438\u0441\u0447\u0438\u043a\u0438 \u0438 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u044b Telegram \u0431\u043e\u0442\u0430. \u0423\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0440\u043e\u043b\u044f\u043c\u0438, \u043f\u0440\u0430\u0432\u0430\u043c\u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0438 \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0430\u043c\u0438 \u043d\u0430 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f.</p> Source code in <code>app/models.py</code> <pre><code>class TelegramSubscriber(TimestampMixin, Base):\n    \"\"\"\n    \u041f\u043e\u0434\u043f\u0438\u0441\u0447\u0438\u043a\u0438 \u0438 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u044b Telegram \u0431\u043e\u0442\u0430.\n    \u0423\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0440\u043e\u043b\u044f\u043c\u0438, \u043f\u0440\u0430\u0432\u0430\u043c\u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0438 \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0430\u043c\u0438 \u043d\u0430 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f.\n    \"\"\"\n    __tablename__ = \"telegram_subscribers\"\n\n    id: Mapped[int] = mapped_column(sa.Integer, primary_key=True, autoincrement=True)\n    chat_id: Mapped[Optional[int]] = mapped_column(sa.BigInteger, unique=True, nullable=True, index=True)\n    slug: Mapped[Optional[str]] = mapped_column(String, nullable=True)  # TG Username or similar\n    name: Mapped[Optional[str]] = mapped_column(String, nullable=True)\n    invite_password_hash: Mapped[Optional[str]] = mapped_column(Text, nullable=True)\n    mentor_id: Mapped[Optional[int]] = mapped_column(\n        sa.Integer, ForeignKey(\"telegram_subscribers.id\", ondelete=\"SET NULL\"), nullable=True\n    )\n    subscriptions: Mapped[list[str]] = mapped_column(\n        JSONB, server_default='[]', nullable=False\n    )\n    language: Mapped[str] = mapped_column(String, server_default=\"ru\", nullable=False)\n    is_active: Mapped[bool] = mapped_column(sa.Boolean, server_default=\"true\", default=True)\n    role: Mapped[str] = mapped_column(String, server_default=\"user\", nullable=False) # user, admin, superadmin\n    permissions: Mapped[list[str]] = mapped_column(\n        JSONB, server_default='[]', nullable=False\n    )\n</code></pre>"},{"location":"api/models/#app.models.WeeekAccount","title":"<code>WeeekAccount</code>","text":"<p>               Bases: <code>TimestampMixin</code>, <code>Base</code></p> <p>\u0421\u0432\u044f\u0437\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430 Telegram \u0441 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u043c Weeek. \u0425\u0440\u0430\u043d\u0438\u0442 \u0442\u043e\u043a\u0435\u043d\u044b \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0434\u043b\u044f \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438.</p> Source code in <code>app/models.py</code> <pre><code>class WeeekAccount(TimestampMixin, Base):\n    \"\"\"\n    \u0421\u0432\u044f\u0437\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430 Telegram \u0441 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u043c Weeek.\n    \u0425\u0440\u0430\u043d\u0438\u0442 \u0442\u043e\u043a\u0435\u043d\u044b \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0434\u043b\u044f \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438.\n    \"\"\"\n    __tablename__ = \"weeek_accounts\"\n\n    id: Mapped[int] = mapped_column(sa.Integer, primary_key=True, autoincrement=True)\n    telegram_chat_id: Mapped[int] = mapped_column(sa.BigInteger, ForeignKey(\"telegram_subscribers.chat_id\"), unique=True, index=True)\n\n    # Weeek credentials\n    weeek_api_token: Mapped[str] = mapped_column(String, nullable=False)  # Encrypted!\n    weeek_user_id: Mapped[str] = mapped_column(String, nullable=True)    # ID \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0432 Weeek\n    weeek_workspace_id: Mapped[Optional[int]] = mapped_column(sa.Integer, nullable=True)\n\n    # Personal project setup\n    personal_project_id: Mapped[Optional[int]] = mapped_column(sa.Integer, nullable=True)  # \u041f\u0440\u043e\u0435\u043a\u0442 \"Gifty\" \u0443 \u044e\u0437\u0435\u0440\u0430\n    personal_board_id: Mapped[Optional[int]] = mapped_column(sa.Integer, nullable=True)    # \u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0434\u043e\u0441\u043a\u0430\n\n    # Preferences\n    reminder_time: Mapped[str] = mapped_column(String, server_default=\"09:00\")  # \u0412\u0440\u0435\u043c\u044f \u043d\u0430\u043f\u043e\u043c\u0438\u043d\u0430\u043d\u0438\u0439\n    timezone: Mapped[str] = mapped_column(String, server_default=\"Europe/Moscow\")\n\n    is_active: Mapped[bool] = mapped_column(sa.Boolean, server_default=\"true\", default=True)\n</code></pre>"},{"location":"api/models/#app.models.ComputeTask","title":"<code>ComputeTask</code>","text":"<p>               Bases: <code>TimestampMixin</code>, <code>Base</code></p> <p>Queue for offline compute tasks (embeddings, reranking, etc.). External workers (Kaggle, home clusters) poll this table via API.</p> Source code in <code>app/models.py</code> <pre><code>class ComputeTask(TimestampMixin, Base):\n    \"\"\"\n    Queue for offline compute tasks (embeddings, reranking, etc.).\n    External workers (Kaggle, home clusters) poll this table via API.\n    \"\"\"\n    __tablename__ = \"compute_tasks\"\n\n    id: Mapped[uuid.UUID] = mapped_column(PG_UUID(as_uuid=True), primary_key=True, default=uuid.uuid4)\n    task_type: Mapped[str] = mapped_column(String, nullable=False, index=True)  # 'embedding', 'rerank'\n    priority: Mapped[str] = mapped_column(String, server_default=\"low\", index=True)  # 'low', 'high'\n    status: Mapped[str] = mapped_column(String, server_default=\"pending\", nullable=False, index=True)  # 'pending', 'processing', 'completed', 'failed'\n\n    # Task data\n    payload: Mapped[dict] = mapped_column(JSONB, nullable=False)  # Input data (texts, queries, etc.)\n    result: Mapped[Optional[dict]] = mapped_column(JSONB, nullable=True)  # Output data (vectors, scores, etc.)\n    error: Mapped[Optional[str]] = mapped_column(Text, nullable=True)  # Error message if failed\n\n    # Worker tracking\n    worker_id: Mapped[Optional[str]] = mapped_column(String, nullable=True)  # ID of worker that picked up the task\n\n    # Timing\n    started_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True), nullable=True)\n    completed_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True), nullable=True)\n</code></pre>"},{"location":"api/models/#app.models.SearchLog","title":"<code>SearchLog</code>","text":"<p>               Bases: <code>TimestampMixin</code>, <code>Base</code></p> <p>\u041b\u043e\u0433\u0438 \u043f\u043e\u0438\u0441\u043a\u043e\u0432\u044b\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439. \u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0430\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u043b\u043d\u043e\u0442\u0443 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430 \u0438 \u0440\u0435\u043b\u0435\u0432\u0430\u043d\u0442\u043d\u043e\u0441\u0442\u044c \u0432\u044b\u0434\u0430\u0447\u0438.</p> Source code in <code>app/models.py</code> <pre><code>class SearchLog(TimestampMixin, Base):\n    \"\"\"\n    \u041b\u043e\u0433\u0438 \u043f\u043e\u0438\u0441\u043a\u043e\u0432\u044b\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439.\n    \u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0430\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u043b\u043d\u043e\u0442\u0443 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430 \u0438 \u0440\u0435\u043b\u0435\u0432\u0430\u043d\u0442\u043d\u043e\u0441\u0442\u044c \u0432\u044b\u0434\u0430\u0447\u0438.\n    \"\"\"\n    __tablename__ = \"search_logs\"\n\n    id: Mapped[uuid.UUID] = mapped_column(PG_UUID(as_uuid=True), primary_key=True, default=uuid.uuid4)\n    session_id: Mapped[Optional[str]] = mapped_column(String, nullable=True, index=True)\n    hypothesis_id: Mapped[Optional[uuid.UUID]] = mapped_column(PG_UUID(as_uuid=True), index=True, nullable=True)\n\n    # Context\n    track_title: Mapped[Optional[str]] = mapped_column(String, nullable=True)\n    hypothesis_title: Mapped[Optional[str]] = mapped_column(String, nullable=True)\n    search_context: Mapped[Optional[str]] = mapped_column(String, nullable=True) # e.g. 'preview', 'deep_dive'\n    llm_model: Mapped[Optional[str]] = mapped_column(String, nullable=True)\n\n    search_query: Mapped[str] = mapped_column(Text, nullable=False)\n    results_count: Mapped[int] = mapped_column(Integer, default=0)\n\n    # Metrics\n    avg_similarity: Mapped[Optional[float]] = mapped_column(Float, nullable=True)\n    top_similarity: Mapped[Optional[float]] = mapped_column(Float, nullable=True)\n    top_gift_id: Mapped[Optional[str]] = mapped_column(Text, nullable=True)\n\n    # User state at search time\n    max_price: Mapped[Optional[int]] = mapped_column(Integer, nullable=True)\n    execution_time_ms: Mapped[Optional[int]] = mapped_column(Integer, nullable=True)\n\n    # Metadata\n    engine_version: Mapped[Optional[str]] = mapped_column(String, nullable=True)\n</code></pre>"},{"location":"api/models/#app.models.HypothesisProductLink","title":"<code>HypothesisProductLink</code>","text":"<p>               Bases: <code>TimestampMixin</code>, <code>Base</code></p> <p>\u0421\u0432\u044f\u0437\u044c \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0439 \u0433\u0438\u043f\u043e\u0442\u0435\u0437\u044b \u0441 \u043d\u0430\u0439\u0434\u0435\u043d\u043d\u044b\u043c\u0438 \u0442\u043e\u0432\u0430\u0440\u0430\u043c\u0438. \u041d\u0443\u0436\u043d\u0430 \u0434\u043b\u044f \u0430\u043d\u0430\u043b\u0438\u0437\u0430 \u0432\u043e\u0440\u043e\u043d\u043a\u0438 \"\u0413\u0438\u043f\u043e\u0442\u0435\u0437\u0430 -&gt; \u041d\u0430\u0439\u0434\u0435\u043d\u043d\u044b\u0435 \u0440\u0435\u043b\u0435\u0432\u0430\u043d\u0442\u043d\u044b\u0435 \u0442\u043e\u0432\u0430\u0440\u044b\".</p> Source code in <code>app/models.py</code> <pre><code>class HypothesisProductLink(TimestampMixin, Base):\n    \"\"\"\n    \u0421\u0432\u044f\u0437\u044c \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0439 \u0433\u0438\u043f\u043e\u0442\u0435\u0437\u044b \u0441 \u043d\u0430\u0439\u0434\u0435\u043d\u043d\u044b\u043c\u0438 \u0442\u043e\u0432\u0430\u0440\u0430\u043c\u0438.\n    \u041d\u0443\u0436\u043d\u0430 \u0434\u043b\u044f \u0430\u043d\u0430\u043b\u0438\u0437\u0430 \u0432\u043e\u0440\u043e\u043d\u043a\u0438 \"\u0413\u0438\u043f\u043e\u0442\u0435\u0437\u0430 -&gt; \u041d\u0430\u0439\u0434\u0435\u043d\u043d\u044b\u0435 \u0440\u0435\u043b\u0435\u0432\u0430\u043d\u0442\u043d\u044b\u0435 \u0442\u043e\u0432\u0430\u0440\u044b\".\n    \"\"\"\n    __tablename__ = \"hypothesis_product_links\"\n\n    id: Mapped[uuid.UUID] = mapped_column(PG_UUID(as_uuid=True), primary_key=True, default=uuid.uuid4)\n    hypothesis_id: Mapped[uuid.UUID] = mapped_column(PG_UUID(as_uuid=True), index=True, nullable=False)\n    gift_id: Mapped[str] = mapped_column(String, index=True, nullable=False)\n\n    similarity_score: Mapped[float] = mapped_column(Float, nullable=False)\n    rank_position: Mapped[int] = mapped_column(Integer, nullable=False) # \u041f\u043e\u0437\u0438\u0446\u0438\u044f \u0432 \u0432\u044b\u0434\u0430\u0447\u0435\n\n    was_shown: Mapped[bool] = mapped_column(Boolean, default=True)\n    was_clicked: Mapped[bool] = mapped_column(Boolean, default=False)\n</code></pre>"},{"location":"api/playground/","title":"\ud83d\udd79 API Playground","text":"<p>\u0417\u0434\u0435\u0441\u044c \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043a API \u043f\u0440\u044f\u043c\u043e \u0438\u0437 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0430.</p> <p>CORS &amp; Localhost</p> <p>\u0414\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441 Localhost \u0443\u0431\u0435\u0434\u0438\u0442\u0435\u0441\u044c, \u0447\u0442\u043e \u0432\u0430\u0448 \u0431\u0435\u043a\u0435\u043d\u0434 \u0437\u0430\u043f\u0443\u0449\u0435\u043d (<code>make run</code> \u0438\u043b\u0438 <code>docker compose up</code>) \u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u043f\u043e \u0430\u0434\u0440\u0435\u0441\u0443 <code>http://localhost:8000</code>. \u0415\u0441\u043b\u0438 \u0432\u044b \u0432\u0438\u0434\u0438\u0442\u0435 \u043e\u0448\u0438\u0431\u043a\u0443 \"Failed to load\", \u0441\u043a\u043e\u0440\u0435\u0435 \u0432\u0441\u0435\u0433\u043e, \u0441\u0435\u0440\u0432\u0435\u0440 \u043d\u0435 \u0437\u0430\u043f\u0443\u0449\u0435\u043d \u0438\u043b\u0438 \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d CORS.</p> <p></p> \ud83d\udd27 Backend URL Load API \ud83c\udf0d Production \ud83d\udd12 Localhost"},{"location":"api/public/","title":"Public API Reference \ud83c\udf10","text":"<p>\u041f\u0443\u0431\u043b\u0438\u0447\u043d\u044b\u0439 API Gifty \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d \u0434\u043b\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0432\u043d\u0435\u0448\u043d\u0438\u043c \u0444\u0440\u043e\u043d\u0442\u0435\u043d\u0434\u043e\u043c (\u043b\u0435\u043d\u0434\u0438\u043d\u0433\u043e\u043c). \u042d\u0442\u0438 \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u044b \u043e\u0442\u043a\u0440\u044b\u0442\u044b \u0438 \u043d\u0435 \u0442\u0440\u0435\u0431\u0443\u044e\u0442 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438, \u043d\u043e \u0437\u0430\u0449\u0438\u0449\u0435\u043d\u044b \u043e\u0442 \u0441\u043f\u0430\u043c\u0430 \u0438 \u0437\u043b\u043e\u0443\u043f\u043e\u0442\u0440\u0435\u0431\u043b\u0435\u043d\u0438\u0439 (Rate Limiting, Honeypot).</p>"},{"location":"api/public/#team","title":"\ud83d\udc65 \u041a\u043e\u043c\u0430\u043d\u0434\u0430 (Team)","text":""},{"location":"api/public/#1-team","title":"1. \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043a\u043e\u043c\u0430\u043d\u0434\u044b (<code>/team</code>)","text":"<p>\u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432 \u043a\u043e\u043c\u0430\u043d\u0434\u044b Gifty \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u043d\u0430 \u043b\u0435\u043d\u0434\u0438\u043d\u0433\u0435.</p> <ul> <li>URL: <code>/api/v1/public/team</code></li> <li>\u041c\u0435\u0442\u043e\u0434: <code>GET</code></li> <li>Response: <code>List[TeamMemberSchema]</code> <pre><code>[\n  {\n    \"id\": \"uuid\",\n    \"slug\": \"ivan-ivanov\",\n    \"name\": \"\u0418\u0432\u0430\u043d \u0418\u0432\u0430\u043d\u043e\u0432\",\n    \"role\": \"CEO\",\n    \"bio\": \"...\",\n    \"linkedin_url\": \"...\",\n    \"photo_public_id\": \"...\",\n    \"sort_order\": 0\n  }\n]\n</code></pre></li> </ul>"},{"location":"api/public/#contacts","title":"\ud83d\udce9 \u041b\u0438\u0434\u044b \u0438 \u041e\u0431\u0440\u0430\u0442\u043d\u0430\u044f \u0441\u0432\u044f\u0437\u044c (Contacts)","text":"<p>\u0412\u0441\u0435 \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u044b \u0432 \u044d\u0442\u043e\u043c \u0440\u0430\u0437\u0434\u0435\u043b\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u044e\u0442 Honeypot protection. \u0415\u0441\u043b\u0438 \u043f\u043e\u043b\u0435 <code>hp</code> \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043e, \u0437\u0430\u043f\u0440\u043e\u0441 \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f \u0441\u043f\u0430\u043c\u043e\u043c \u0438 \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u0443\u0435\u0442\u0441\u044f (\u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442\u0441\u044f \u0443\u0441\u043f\u0435\u0445, \u043d\u043e \u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u044e\u0442\u0441\u044f).</p>"},{"location":"api/public/#1-investor-contact","title":"1. \u0417\u0430\u044f\u0432\u043a\u0430 \u0438\u043d\u0432\u0435\u0441\u0442\u043e\u0440\u0430 (<code>/investor-contact</code>)","text":"<p>\u0422\u0440\u0438\u0433\u0433\u0435\u0440\u0438\u0442 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0435 \u0432 Telegram \u043f\u043e \u0442\u043e\u043f\u0438\u043a\u0443 <code>investors</code>. \u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442 \u043a\u043e\u043d\u0442\u0430\u043a\u0442 \u0432 \u0431\u0430\u0437\u0443 \u0434\u0430\u043d\u043d\u044b\u0445.</p> <ul> <li>URL: <code>/api/v1/public/investor-contact</code></li> <li>\u041c\u0435\u0442\u043e\u0434: <code>POST</code></li> <li>Body (<code>InvestorContactCreate</code>):<ul> <li><code>name</code> (string, min 2): \u0418\u043c\u044f \u0438\u043d\u0432\u0435\u0441\u0442\u043e\u0440\u0430.</li> <li><code>company</code> (string, optional): \u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0444\u043e\u043d\u0434\u0430 \u0438\u043b\u0438 \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0438.</li> <li><code>email</code> (EmailStr): \u041a\u043e\u043d\u0442\u0430\u043a\u0442\u043d\u0430\u044f \u043f\u043e\u0447\u0442\u0430.</li> <li><code>linkedin</code> (HttpUrl, optional): \u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043f\u0440\u043e\u0444\u0438\u043b\u044c.</li> <li><code>hp</code> (string, optional): Honeypot (\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c).</li> </ul> </li> </ul>"},{"location":"api/public/#2-partner-contact","title":"2. \u0417\u0430\u044f\u0432\u043a\u0430 \u043f\u0430\u0440\u0442\u043d\u0435\u0440\u0430 (<code>/partner-contact</code>)","text":"<p>\u0422\u0440\u0438\u0433\u0433\u0435\u0440\u0438\u0442 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0435 \u0432 Telegram \u043f\u043e \u0442\u043e\u043f\u0438\u043a\u0443 <code>partners</code> \u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u0411\u0414.</p> <ul> <li>URL: <code>/api/v1/public/partner-contact</code></li> <li>\u041c\u0435\u0442\u043e\u0434: <code>POST</code></li> <li>Body (<code>PartnerContactCreate</code>):<ul> <li><code>name</code> (string): \u0418\u043c\u044f \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u0438\u0442\u0435\u043b\u044f.</li> <li><code>email</code> (EmailStr): \u041f\u043e\u0447\u0442\u0430.</li> <li><code>message</code> (string, min 10): \u0421\u0443\u0442\u044c \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u044f.</li> <li><code>website</code> (HttpUrl, optional): \u0421\u0430\u0439\u0442 \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0438.</li> </ul> </li> </ul>"},{"location":"api/public/#3-newsletter-subscribe","title":"3. \u041f\u043e\u0434\u043f\u0438\u0441\u043a\u0430 \u043d\u0430 \u0440\u0430\u0441\u0441\u044b\u043b\u043a\u0443 (<code>/newsletter-subscribe</code>)","text":"<p>\u0422\u0440\u0438\u0433\u0433\u0435\u0440\u0438\u0442 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0435 \u0432 Telegram \u043f\u043e \u0442\u043e\u043f\u0438\u043a\u0443 <code>newsletter</code>.</p> <ul> <li>URL: <code>/api/v1/public/newsletter-subscribe</code></li> <li>\u041c\u0435\u0442\u043e\u0434: <code>POST</code></li> <li>Body (<code>NewsletterSubscribe</code>):<ul> <li><code>email</code> (EmailStr): \u041f\u043e\u0447\u0442\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0438.</li> </ul> </li> </ul>"},{"location":"api/public/#recommendations","title":"\ud83c\udf81 \u0420\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0438 (Recommendations)","text":""},{"location":"api/public/#1-generate","title":"1. \u0413\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u043f\u043e\u0434\u0431\u043e\u0440\u043a\u0438 (<code>/generate</code>)","text":"<p>\u041e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442 \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u043a\u0432\u0438\u0437\u0430.</p> <ul> <li>URL: <code>/api/v1/recommendations/generate</code></li> <li>\u041c\u0435\u0442\u043e\u0434: <code>POST</code></li> <li>Headers: <code>X-Anon-Id</code> (UUID \u0434\u043b\u044f \u0430\u043d\u043e\u043d\u0438\u043c\u043d\u043e\u0433\u043e \u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u043d\u0438\u044f \u0441\u0435\u0441\u0441\u0438\u0438).</li> <li>Body: <code>RecommendationRequest</code> (\u043e\u0442\u0432\u0435\u0442\u044b \u043d\u0430 \u0432\u043e\u043f\u0440\u043e\u0441\u044b \u043a\u0432\u0438\u0437\u0430).</li> <li>Response: <code>RecommendationResponse</code> (Hero-\u043f\u043e\u0434\u0430\u0440\u043e\u043a \u0438 \u0441\u043f\u0438\u0441\u043e\u043a \u0430\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432).</li> </ul> <p>\ud83d\udc49 \u0414\u0435\u0442\u0430\u043b\u044c\u043d\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043b\u043e\u0433\u0438\u043a\u0438 \u0440\u0430\u0431\u043e\u0442\u044b \u0434\u0432\u0438\u0436\u043a\u0430 \u0441\u043c. \u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u0435 Recommendation Engine.</p>"},{"location":"api/repositories/","title":"\u0420\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438 (Repositories)","text":"<p>\u0421\u043b\u043e\u0439 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0434\u0430\u043d\u043d\u044b\u043c.</p>"},{"location":"api/repositories/#app.repositories.parsing.ParsingRepository","title":"<code>app.repositories.parsing.ParsingRepository</code>","text":"Source code in <code>app/repositories/parsing.py</code> <pre><code>class ParsingRepository:\n    def __init__(self, session: AsyncSession, redis: Optional[Any] = None):\n        self.session = session\n        self.redis = redis\n\n    async def get_due_sources(self, limit: int = 10) -&gt; Sequence[ParsingSource]:\n        stmt = (\n            select(ParsingSource)\n            .where(\n                and_(\n                    ParsingSource.is_active.is_(True),\n                    ParsingSource.next_sync_at &lt;= func.now()\n                )\n            )\n            .order_by(ParsingSource.priority.desc(), ParsingSource.next_sync_at.asc())\n            .limit(limit)\n            .with_for_update(skip_locked=True)\n        )\n        result = await self.session.execute(stmt)\n        return result.scalars().all()\n\n    async def update_source_stats(self, source_id: int, stats: dict):\n        stmt = select(ParsingSource).where(ParsingSource.id == source_id)\n        result = await self.session.execute(stmt)\n        source = result.scalar_one_or_none()\n\n        if source:\n            source.last_synced_at = func.now()\n            source.next_sync_at = datetime.now() + timedelta(hours=source.refresh_interval_hours)\n            source.status = \"waiting\"\n            if source.config is None:\n                source.config = {}\n            cfg = dict(source.config)\n            cfg[\"last_stats\"] = stats\n            source.config = cfg\n\n        await self.session.commit()\n\n    async def set_queued(self, source_id: int):\n        \"\"\"Marks source as queued in RabbitMQ. Status 'running' will be set by worker.\"\"\"\n        stmt = update(ParsingSource).where(ParsingSource.id == source_id).values(\n            status=\"queued\", \n            next_sync_at=datetime.now() + timedelta(minutes=15)\n        )\n        await self.session.execute(stmt)\n        await self.session.commit()\n\n    async def get_or_create_category_maps(self, names: List[str]) -&gt; List[CategoryMap]:\n        if not names:\n            return []\n\n        # Bulk get existing\n        stmt = select(CategoryMap).where(CategoryMap.external_name.in_(names))\n        result = await self.session.execute(stmt)\n        existing = {m.external_name: m for m in result.scalars().all()}\n\n        new_names = [n for n in names if n not in existing]\n        if new_names:\n            # Bulk insert new ones\n            if self.session.bind.dialect.name == \"postgresql\":\n                from sqlalchemy.dialects.postgresql import insert as pg_insert\n                insert_stmt = pg_insert(CategoryMap).values([\n                    {\"external_name\": name, \"internal_category_id\": None}\n                    for name in new_names\n                ]).on_conflict_do_nothing()\n                await self.session.execute(insert_stmt)\n            else:\n                # SQLite fallback: manual loop or simple insert (ignoring conflicts if we already filtered)\n                for name in new_names:\n                    self.session.add(CategoryMap(external_name=name, internal_category_id=None))\n                await self.session.flush()\n\n            # Fetch again to get all (including newly created)\n            stmt = select(CategoryMap).where(CategoryMap.external_name.in_(names))\n            result = await self.session.execute(stmt)\n            return list(result.scalars().all())\n\n        return list(existing.values())\n\n    async def get_unmapped_categories(self, limit: int = 100) -&gt; Sequence[CategoryMap]:\n        \"\"\"\u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438, \u0443 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0435\u0449\u0435 \u043d\u0435\u0442 \u043f\u0440\u0438\u0432\u044f\u0437\u043a\u0438 \u043a \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u0439 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 Gifty.\"\"\"\n        stmt = (\n            select(CategoryMap)\n            .where(CategoryMap.internal_category_id.is_(None))\n            .limit(limit)\n        )\n        result = await self.session.execute(stmt)\n        return result.scalars().all()\n\n    async def update_category_mappings(self, mappings: List[dict]) -&gt; int:\n        \"\"\"\n        \u041c\u0430\u0441\u0441\u043e\u0432\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442 \u043f\u0440\u0438\u0432\u044f\u0437\u043a\u0438 \u0432\u043d\u0435\u0448\u043d\u0438\u0445 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u043a \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u043c.\n        mappings: [{\"external_name\": \"...\", \"internal_category_id\": 123}, ...]\n        \"\"\"\n        if not mappings:\n            return 0\n\n        count = 0\n        for m in mappings:\n            stmt = (\n                update(CategoryMap)\n                .where(CategoryMap.external_name == m[\"external_name\"])\n                .values(internal_category_id=m[\"internal_category_id\"])\n            )\n            await self.session.execute(stmt)\n            count += 1\n\n        await self.session.commit()\n        return count\n\n    async def get_all_sources(self) -&gt; Sequence[ParsingSource]:\n        stmt = select(ParsingSource).order_by(ParsingSource.id.asc())\n        result = await self.session.execute(stmt)\n        return result.scalars().all()\n\n    async def upsert_source(self, data: dict) -&gt; ParsingSource:\n        url = data.get(\"url\")\n        if not url:\n            raise ValueError(\"URL is required\")\n\n        stmt = select(ParsingSource).where(ParsingSource.url == url)\n        result = await self.session.execute(stmt)\n        source = result.scalar_one_or_none()\n\n        if source:\n            for key, value in data.items():\n                if hasattr(source, key):\n                    setattr(source, key, value)\n        else:\n            source = ParsingSource(**data)\n            self.session.add(source)\n\n        await self.session.commit()\n        await self.session.refresh(source)\n        return source\n\n    async def get_source_by_id(self, source_id: int) -&gt; Optional[ParsingSource]:\n        stmt = select(ParsingSource).where(ParsingSource.id == source_id)\n        result = await self.session.execute(stmt)\n        return result.scalar_one_or_none()\n\n    async def get_source(self, source_id: int) -&gt; Optional[ParsingSource]:\n        \"\"\"Alias for get_source_by_id used by IngestionService.\"\"\"\n        return await self.get_source_by_id(source_id)\n\n    async def report_source_error(self, source_id: int, error_msg: str, is_broken: bool = True) -&gt; Optional[ParsingSource]:\n        stmt = select(ParsingSource).where(ParsingSource.id == source_id)\n        result = await self.session.execute(stmt)\n        source = result.scalar_one_or_none()\n\n        if source:\n            if source.config is None:\n                source.config = {}\n\n            cfg = dict(source.config)\n            cfg[\"last_error\"] = error_msg\n\n            # Simple retry logic: if it's not a discovery (hub) which we want to be more careful with,\n            # or if it's discovery-deep, we can allow a few retries before marking as broken.\n            retries = cfg.get(\"retry_count\", 0)\n\n            if is_broken or retries &gt;= 3:\n                cfg[\"fix_required\"] = True\n                source.is_active = False\n                source.status = \"broken\"\n                cfg[\"retry_count\"] = 0 # reset for next manual fix\n            else:\n                cfg[\"retry_count\"] = retries + 1\n                source.status = \"error\"\n                # Back-off: wait 10 mins * retries\n                source.next_sync_at = datetime.now() + timedelta(minutes=10 * (retries + 1))\n\n            source.config = cfg\n            await self.session.commit()\n            return source\n        return None\n\n    async def sync_spiders(self, available_spiders: List[str]) -&gt; List[str]:\n        \"\"\"\n        Synchronizes the list of spiders from the scraper with the database.\n        Returns a list of NEW spider keys that were not in the database.\n        \"\"\"\n        stmt = select(ParsingSource.site_key)\n        result = await self.session.execute(stmt)\n        existing_keys = set(result.scalars().all())\n\n        new_spiders = []\n        for spider_key in available_spiders:\n            if spider_key not in existing_keys:\n                # Add new inactive source\n                new_source = ParsingSource(\n                    site_key=spider_key,\n                    url=f\"https://{spider_key}.placeholder\", # Needs to be filled\n                    type=\"hub\",\n                    strategy=\"discovery\",\n                    is_active=False,\n                    config={\"is_new\": True, \"note\": \"Automatically detected, please configure\"}\n                )\n                self.session.add(new_source)\n                new_spiders.append(spider_key)\n\n        if new_spiders:\n            await self.session.commit()\n\n        return new_spiders\n\n    async def set_source_active_status(self, source_id: int, is_active: bool) -&gt; bool:\n        stmt = update(ParsingSource).where(ParsingSource.id == source_id).values(\n            is_active=is_active,\n            status=\"waiting\" if is_active else \"disabled\"\n        )\n        result = await self.session.execute(stmt)\n        await self.session.commit()\n        return result.rowcount &gt; 0\n\n    async def set_source_status(self, source_id: int, status: str):\n        stmt = update(ParsingSource).where(ParsingSource.id == source_id).values(status=status)\n        await self.session.execute(stmt)\n        await self.session.commit()\n\n    async def update_source_logs(self, source_id: int, logs: str):\n        stmt = select(ParsingSource).where(ParsingSource.id == source_id)\n        result = await self.session.execute(stmt)\n        source = result.scalar_one_or_none()\n        if source:\n            if source.config is None:\n                source.config = {}\n            cfg = dict(source.config)\n            cfg[\"last_logs\"] = logs\n            source.config = cfg\n            await self.session.commit()\n\n    async def reset_source_error(self, source_id: int):\n        stmt = select(ParsingSource).where(ParsingSource.id == source_id)\n        result = await self.session.execute(stmt)\n        source = result.scalar_one_or_none()\n        if source:\n            if source.config is None:\n                source.config = {}\n            # Update dictionary directly as SQLAlchemy handles change tracking for JSONB\n            cfg = dict(source.config)\n            cfg.pop(\"last_error\", None)\n            cfg.pop(\"fix_required\", None)\n            source.config = cfg\n            await self.session.commit()\n\n    async def update_source(self, source_id: int, data: dict) -&gt; Optional[ParsingSource]:\n        stmt = select(ParsingSource).where(ParsingSource.id == source_id)\n        result = await self.session.execute(stmt)\n        source = result.scalar_one_or_none()\n\n        if source:\n            for key, value in data.items():\n                if hasattr(source, key):\n                    setattr(source, key, value)\n            await self.session.commit()\n            await self.session.refresh(source)\n            return source\n        return None\n\n    async def log_parsing_run(self, source_id: int, status: str, items_scraped: int, items_new: int, error_message: str = None):\n        from app.models import ParsingRun\n        run = ParsingRun(\n            source_id=source_id,\n            status=status,\n            items_scraped=items_scraped,\n            items_new=items_new,\n            error_message=error_message\n        )\n        self.session.add(run)\n        await self.session.commit()\n\n    async def get_source_history(self, source_id: int, limit: int = 15):\n        from app.models import ParsingRun\n        stmt = (\n            select(ParsingRun)\n            .where(ParsingRun.source_id == source_id)\n            .order_by(ParsingRun.created_at.desc())\n            .limit(limit)\n        )\n        result = await self.session.execute(stmt)\n        return result.scalars().all()\n\n    async def get_total_products_count(self, site_key: str) -&gt; int:\n        from app.models import Product, ParsingSource, ParsingRun\n        # Approximate count based on gift_id prefix\n        stmt = select(func.count()).select_from(Product).where(Product.gift_id.like(f\"{site_key}:%\"))\n        result = await self.session.execute(stmt)\n        return result.scalar() or 0\n\n    async def get_aggregate_status(self, site_key: str) -&gt; str:\n        \"\"\"Returns 'running' if any source for this site is running, else 'waiting' or 'error'.\"\"\"\n        stmt = select(ParsingSource.status).where(ParsingSource.site_key == site_key)\n        result = await self.session.execute(stmt)\n        statuses = result.scalars().all()\n        if \"running\" in statuses:\n            return \"running\"\n        if \"queued\" in statuses:\n            return \"queued\"\n        if \"error\" in statuses:\n            return \"error\"\n        if \"broken\" in statuses:\n            return \"broken\"\n        return \"waiting\"\n\n    async def get_sites_monitoring(self) -&gt; List[dict]:\n        \"\"\"Returns aggregate health and stats for all sites efficiently via SQL.\"\"\"\n        # This performs GROUP BY on database side\n        # statuses per site\n        stmt_stats = (\n            select(\n                ParsingSource.site_key,\n                func.count(ParsingSource.id).label(\"total_sources\"),\n                func.sum(case((ParsingSource.status == 'running', 1), else_=0)).label(\"running_count\"),\n                func.sum(case((ParsingSource.status == 'queued', 1), else_=0)).label(\"queued_count\"),\n                func.sum(case((ParsingSource.status == 'error', 1), else_=0)).label(\"error_count\"),\n                func.sum(case((ParsingSource.status == 'broken', 1), else_=0)).label(\"broken_count\"),\n                func.max(ParsingSource.last_synced_at).label(\"last_synced_at\")\n            )\n            .group_by(ParsingSource.site_key)\n        )\n\n        result = await self.session.execute(stmt_stats)\n        rows = result.all()\n\n        monitoring = []\n        for row in rows:\n            status = \"waiting\"\n            if row.running_count &gt; 0: status = \"running\"\n            elif row.queued_count &gt; 0: status = \"queued\"\n            elif row.error_count &gt; 0: status = \"error\"\n            elif row.broken_count &gt; 0: status = \"broken\"\n\n            monitoring.append({\n                \"site_key\": row.site_key,\n                \"total_sources\": row.total_sources,\n                \"status\": status,\n                \"last_synced_at\": row.last_synced_at.isoformat() if row.last_synced_at else None,\n                \"is_active\": True # Simplified for summary\n            })\n        return monitoring\n\n    async def get_24h_stats(self) -&gt; dict:\n        \"\"\"Returns scraped items count for the last 24h from DB ParsingRuns.\"\"\"\n        since = datetime.now() - timedelta(hours=24)\n        stmt = select(\n            func.sum(ParsingRun.items_scraped).label(\"scraped\"),\n            func.sum(ParsingRun.items_new).label(\"new\")\n        ).where(ParsingRun.created_at &gt;= since)\n\n        result = await self.session.execute(stmt)\n        row = result.one_or_none()\n        return {\n            \"scraped_24h\": int(row.scraped or 0) if row else 0,\n            \"new_24h\": int(row.new or 0) if row else 0\n        }\n\n    async def get_aggregate_history(self, site_key: str, limit_days: int = 15):\n        \"\"\"Returns runs aggregated by day for the entire site.\"\"\"\n        from app.models import ParsingRun, ParsingSource\n        # Aggregate by date (truncated created_at)\n        date_trunc = func.date_trunc('day', ParsingRun.created_at)\n        stmt = (\n            select(\n                date_trunc.label(\"day\"),\n                func.sum(ParsingRun.items_new).label(\"items_new\"),\n                func.sum(ParsingRun.items_scraped).label(\"items_scraped\")\n            )\n            .join(ParsingSource, ParsingRun.source_id == ParsingSource.id)\n            .where(ParsingSource.site_key == site_key)\n            .group_by(date_trunc)\n            .order_by(date_trunc.desc())\n            .limit(limit_days)\n        )\n        result = await self.session.execute(stmt)\n        return result.all()\n\n    async def get_last_full_cycle_stats(self, site_key: str) -&gt; int:\n        \"\"\"\n        Calculates how many new items were added since the last 'discovery' run started.\n        \"\"\"\n        from app.models import ParsingRun, ParsingSource\n        # Find the last successful discovery run for this site\n        last_hub_run_stmt = (\n            select(ParsingRun.created_at)\n            .join(ParsingSource, ParsingRun.source_id == ParsingSource.id)\n            .where(ParsingSource.site_key == site_key)\n            .where(ParsingSource.type == \"hub\")\n            .order_by(ParsingRun.created_at.desc())\n            .limit(1)\n        )\n        last_hub_run_res = await self.session.execute(last_hub_run_stmt)\n        last_hub_time = last_hub_run_res.scalar()\n\n        if not last_hub_time:\n            return 0\n\n        # Sum all new items since that time for this site_key\n        stmt = (\n            select(func.sum(ParsingRun.items_new))\n            .join(ParsingSource, ParsingRun.source_id == ParsingSource.id)\n            .where(ParsingSource.site_key == site_key)\n            .where(ParsingRun.created_at &gt;= last_hub_time)\n        )\n        result = await self.session.execute(stmt)\n        return result.scalar() or 0\n\n    async def get_total_category_products_count(self, site_key: str, category_name: str) -&gt; int:\n        from app.models import Product\n        # Try to match by category name stored in Product.category\n        stmt = select(func.count()).select_from(Product).where(\n            and_(\n                Product.gift_id.like(f\"{site_key}:%\"),\n                Product.category == category_name\n            )\n        )\n        result = await self.session.execute(stmt)\n        return result.scalar() or 0\n\n    async def get_source_daily_history(self, source_id: int, limit_days: int = 15):\n        from app.models import ParsingRun\n        date_trunc = func.date_trunc('day', ParsingRun.created_at)\n        stmt = (\n            select(\n                date_trunc.label(\"day\"),\n                func.sum(ParsingRun.items_new).label(\"items_new\"),\n                func.sum(ParsingRun.items_scraped).label(\"items_scraped\")\n            )\n            .where(ParsingRun.source_id == source_id)\n            .group_by(date_trunc)\n            .order_by(date_trunc.desc())\n            .limit(limit_days)\n        )\n        result = await self.session.execute(stmt)\n        return result.all()\n\n    async def get_active_workers(self) -&gt; List[dict]:\n        \"\"\"Fetches active workers from Redis heartbeats.\"\"\"\n        if not self.redis:\n            return []\n\n        workers = []\n        try:\n            keys = await self.redis.keys(\"worker_heartbeat:*\")\n            for key in keys:\n                data = await self.redis.get(key)\n                if data:\n                    workers.append(json.loads(data))\n        except Exception as e:\n            logger.error(f\"Error fetching workers from Redis: {e}\")\n        return workers\n\n    async def get_source_by_url(self, url: str) -&gt; Optional[ParsingSource]:\n        stmt = select(ParsingSource).where(ParsingSource.url == url)\n        result = await self.session.execute(stmt)\n        return result.scalar_one_or_none()\n\n    async def count_discovered_today(self) -&gt; int:\n        \"\"\"Counts how many sources were discovered/activated today.\"\"\"\n        stmt = select(func.count(ParsingSource.id)).where(\n            and_(\n                ParsingSource.status != \"discovered\", # already activated\n                ParsingSource.created_at &gt;= func.now() - timedelta(days=1)\n            )\n        )\n        result = await self.session.execute(stmt)\n        return result.scalar() or 0\n\n    async def get_discovered_sources(self, limit: int = 50) -&gt; List[ParsingSource]:\n        \"\"\"Fetches inactive 'discovered' sources from the backlog.\"\"\"\n        stmt = (\n            select(ParsingSource)\n            .where(ParsingSource.status == \"discovered\")\n            .order_by(ParsingSource.priority.desc(), ParsingSource.created_at.asc())\n            .limit(limit)\n        )\n        result = await self.session.execute(stmt)\n        return result.scalars().all()\n\n    async def activate_sources(self, source_ids: List[int]):\n        \"\"\"Activates sources from the backlog.\"\"\"\n        if not source_ids:\n            return\n        stmt = (\n            update(ParsingSource)\n            .where(ParsingSource.id.in_(source_ids))\n            .values(\n                is_active=True,\n                status=\"waiting\",\n                next_sync_at=func.now()\n            )\n        )\n        await self.session.execute(stmt)\n        await self.session.commit()\n</code></pre>"},{"location":"api/repositories/#app.repositories.parsing.ParsingRepository-functions","title":"Functions","text":""},{"location":"api/repositories/#app.repositories.parsing.ParsingRepository.activate_sources","title":"<code>activate_sources(source_ids)</code>  <code>async</code>","text":"<p>Activates sources from the backlog.</p> Source code in <code>app/repositories/parsing.py</code> <pre><code>async def activate_sources(self, source_ids: List[int]):\n    \"\"\"Activates sources from the backlog.\"\"\"\n    if not source_ids:\n        return\n    stmt = (\n        update(ParsingSource)\n        .where(ParsingSource.id.in_(source_ids))\n        .values(\n            is_active=True,\n            status=\"waiting\",\n            next_sync_at=func.now()\n        )\n    )\n    await self.session.execute(stmt)\n    await self.session.commit()\n</code></pre>"},{"location":"api/repositories/#app.repositories.parsing.ParsingRepository.count_discovered_today","title":"<code>count_discovered_today()</code>  <code>async</code>","text":"<p>Counts how many sources were discovered/activated today.</p> Source code in <code>app/repositories/parsing.py</code> <pre><code>async def count_discovered_today(self) -&gt; int:\n    \"\"\"Counts how many sources were discovered/activated today.\"\"\"\n    stmt = select(func.count(ParsingSource.id)).where(\n        and_(\n            ParsingSource.status != \"discovered\", # already activated\n            ParsingSource.created_at &gt;= func.now() - timedelta(days=1)\n        )\n    )\n    result = await self.session.execute(stmt)\n    return result.scalar() or 0\n</code></pre>"},{"location":"api/repositories/#app.repositories.parsing.ParsingRepository.get_24h_stats","title":"<code>get_24h_stats()</code>  <code>async</code>","text":"<p>Returns scraped items count for the last 24h from DB ParsingRuns.</p> Source code in <code>app/repositories/parsing.py</code> <pre><code>async def get_24h_stats(self) -&gt; dict:\n    \"\"\"Returns scraped items count for the last 24h from DB ParsingRuns.\"\"\"\n    since = datetime.now() - timedelta(hours=24)\n    stmt = select(\n        func.sum(ParsingRun.items_scraped).label(\"scraped\"),\n        func.sum(ParsingRun.items_new).label(\"new\")\n    ).where(ParsingRun.created_at &gt;= since)\n\n    result = await self.session.execute(stmt)\n    row = result.one_or_none()\n    return {\n        \"scraped_24h\": int(row.scraped or 0) if row else 0,\n        \"new_24h\": int(row.new or 0) if row else 0\n    }\n</code></pre>"},{"location":"api/repositories/#app.repositories.parsing.ParsingRepository.get_active_workers","title":"<code>get_active_workers()</code>  <code>async</code>","text":"<p>Fetches active workers from Redis heartbeats.</p> Source code in <code>app/repositories/parsing.py</code> <pre><code>async def get_active_workers(self) -&gt; List[dict]:\n    \"\"\"Fetches active workers from Redis heartbeats.\"\"\"\n    if not self.redis:\n        return []\n\n    workers = []\n    try:\n        keys = await self.redis.keys(\"worker_heartbeat:*\")\n        for key in keys:\n            data = await self.redis.get(key)\n            if data:\n                workers.append(json.loads(data))\n    except Exception as e:\n        logger.error(f\"Error fetching workers from Redis: {e}\")\n    return workers\n</code></pre>"},{"location":"api/repositories/#app.repositories.parsing.ParsingRepository.get_aggregate_history","title":"<code>get_aggregate_history(site_key, limit_days=15)</code>  <code>async</code>","text":"<p>Returns runs aggregated by day for the entire site.</p> Source code in <code>app/repositories/parsing.py</code> <pre><code>async def get_aggregate_history(self, site_key: str, limit_days: int = 15):\n    \"\"\"Returns runs aggregated by day for the entire site.\"\"\"\n    from app.models import ParsingRun, ParsingSource\n    # Aggregate by date (truncated created_at)\n    date_trunc = func.date_trunc('day', ParsingRun.created_at)\n    stmt = (\n        select(\n            date_trunc.label(\"day\"),\n            func.sum(ParsingRun.items_new).label(\"items_new\"),\n            func.sum(ParsingRun.items_scraped).label(\"items_scraped\")\n        )\n        .join(ParsingSource, ParsingRun.source_id == ParsingSource.id)\n        .where(ParsingSource.site_key == site_key)\n        .group_by(date_trunc)\n        .order_by(date_trunc.desc())\n        .limit(limit_days)\n    )\n    result = await self.session.execute(stmt)\n    return result.all()\n</code></pre>"},{"location":"api/repositories/#app.repositories.parsing.ParsingRepository.get_aggregate_status","title":"<code>get_aggregate_status(site_key)</code>  <code>async</code>","text":"<p>Returns 'running' if any source for this site is running, else 'waiting' or 'error'.</p> Source code in <code>app/repositories/parsing.py</code> <pre><code>async def get_aggregate_status(self, site_key: str) -&gt; str:\n    \"\"\"Returns 'running' if any source for this site is running, else 'waiting' or 'error'.\"\"\"\n    stmt = select(ParsingSource.status).where(ParsingSource.site_key == site_key)\n    result = await self.session.execute(stmt)\n    statuses = result.scalars().all()\n    if \"running\" in statuses:\n        return \"running\"\n    if \"queued\" in statuses:\n        return \"queued\"\n    if \"error\" in statuses:\n        return \"error\"\n    if \"broken\" in statuses:\n        return \"broken\"\n    return \"waiting\"\n</code></pre>"},{"location":"api/repositories/#app.repositories.parsing.ParsingRepository.get_discovered_sources","title":"<code>get_discovered_sources(limit=50)</code>  <code>async</code>","text":"<p>Fetches inactive 'discovered' sources from the backlog.</p> Source code in <code>app/repositories/parsing.py</code> <pre><code>async def get_discovered_sources(self, limit: int = 50) -&gt; List[ParsingSource]:\n    \"\"\"Fetches inactive 'discovered' sources from the backlog.\"\"\"\n    stmt = (\n        select(ParsingSource)\n        .where(ParsingSource.status == \"discovered\")\n        .order_by(ParsingSource.priority.desc(), ParsingSource.created_at.asc())\n        .limit(limit)\n    )\n    result = await self.session.execute(stmt)\n    return result.scalars().all()\n</code></pre>"},{"location":"api/repositories/#app.repositories.parsing.ParsingRepository.get_last_full_cycle_stats","title":"<code>get_last_full_cycle_stats(site_key)</code>  <code>async</code>","text":"<p>Calculates how many new items were added since the last 'discovery' run started.</p> Source code in <code>app/repositories/parsing.py</code> <pre><code>async def get_last_full_cycle_stats(self, site_key: str) -&gt; int:\n    \"\"\"\n    Calculates how many new items were added since the last 'discovery' run started.\n    \"\"\"\n    from app.models import ParsingRun, ParsingSource\n    # Find the last successful discovery run for this site\n    last_hub_run_stmt = (\n        select(ParsingRun.created_at)\n        .join(ParsingSource, ParsingRun.source_id == ParsingSource.id)\n        .where(ParsingSource.site_key == site_key)\n        .where(ParsingSource.type == \"hub\")\n        .order_by(ParsingRun.created_at.desc())\n        .limit(1)\n    )\n    last_hub_run_res = await self.session.execute(last_hub_run_stmt)\n    last_hub_time = last_hub_run_res.scalar()\n\n    if not last_hub_time:\n        return 0\n\n    # Sum all new items since that time for this site_key\n    stmt = (\n        select(func.sum(ParsingRun.items_new))\n        .join(ParsingSource, ParsingRun.source_id == ParsingSource.id)\n        .where(ParsingSource.site_key == site_key)\n        .where(ParsingRun.created_at &gt;= last_hub_time)\n    )\n    result = await self.session.execute(stmt)\n    return result.scalar() or 0\n</code></pre>"},{"location":"api/repositories/#app.repositories.parsing.ParsingRepository.get_sites_monitoring","title":"<code>get_sites_monitoring()</code>  <code>async</code>","text":"<p>Returns aggregate health and stats for all sites efficiently via SQL.</p> Source code in <code>app/repositories/parsing.py</code> <pre><code>async def get_sites_monitoring(self) -&gt; List[dict]:\n    \"\"\"Returns aggregate health and stats for all sites efficiently via SQL.\"\"\"\n    # This performs GROUP BY on database side\n    # statuses per site\n    stmt_stats = (\n        select(\n            ParsingSource.site_key,\n            func.count(ParsingSource.id).label(\"total_sources\"),\n            func.sum(case((ParsingSource.status == 'running', 1), else_=0)).label(\"running_count\"),\n            func.sum(case((ParsingSource.status == 'queued', 1), else_=0)).label(\"queued_count\"),\n            func.sum(case((ParsingSource.status == 'error', 1), else_=0)).label(\"error_count\"),\n            func.sum(case((ParsingSource.status == 'broken', 1), else_=0)).label(\"broken_count\"),\n            func.max(ParsingSource.last_synced_at).label(\"last_synced_at\")\n        )\n        .group_by(ParsingSource.site_key)\n    )\n\n    result = await self.session.execute(stmt_stats)\n    rows = result.all()\n\n    monitoring = []\n    for row in rows:\n        status = \"waiting\"\n        if row.running_count &gt; 0: status = \"running\"\n        elif row.queued_count &gt; 0: status = \"queued\"\n        elif row.error_count &gt; 0: status = \"error\"\n        elif row.broken_count &gt; 0: status = \"broken\"\n\n        monitoring.append({\n            \"site_key\": row.site_key,\n            \"total_sources\": row.total_sources,\n            \"status\": status,\n            \"last_synced_at\": row.last_synced_at.isoformat() if row.last_synced_at else None,\n            \"is_active\": True # Simplified for summary\n        })\n    return monitoring\n</code></pre>"},{"location":"api/repositories/#app.repositories.parsing.ParsingRepository.get_source","title":"<code>get_source(source_id)</code>  <code>async</code>","text":"<p>Alias for get_source_by_id used by IngestionService.</p> Source code in <code>app/repositories/parsing.py</code> <pre><code>async def get_source(self, source_id: int) -&gt; Optional[ParsingSource]:\n    \"\"\"Alias for get_source_by_id used by IngestionService.\"\"\"\n    return await self.get_source_by_id(source_id)\n</code></pre>"},{"location":"api/repositories/#app.repositories.parsing.ParsingRepository.get_unmapped_categories","title":"<code>get_unmapped_categories(limit=100)</code>  <code>async</code>","text":"<p>\u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438, \u0443 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0435\u0449\u0435 \u043d\u0435\u0442 \u043f\u0440\u0438\u0432\u044f\u0437\u043a\u0438 \u043a \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u0439 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 Gifty.</p> Source code in <code>app/repositories/parsing.py</code> <pre><code>async def get_unmapped_categories(self, limit: int = 100) -&gt; Sequence[CategoryMap]:\n    \"\"\"\u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438, \u0443 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0435\u0449\u0435 \u043d\u0435\u0442 \u043f\u0440\u0438\u0432\u044f\u0437\u043a\u0438 \u043a \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u0439 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 Gifty.\"\"\"\n    stmt = (\n        select(CategoryMap)\n        .where(CategoryMap.internal_category_id.is_(None))\n        .limit(limit)\n    )\n    result = await self.session.execute(stmt)\n    return result.scalars().all()\n</code></pre>"},{"location":"api/repositories/#app.repositories.parsing.ParsingRepository.set_queued","title":"<code>set_queued(source_id)</code>  <code>async</code>","text":"<p>Marks source as queued in RabbitMQ. Status 'running' will be set by worker.</p> Source code in <code>app/repositories/parsing.py</code> <pre><code>async def set_queued(self, source_id: int):\n    \"\"\"Marks source as queued in RabbitMQ. Status 'running' will be set by worker.\"\"\"\n    stmt = update(ParsingSource).where(ParsingSource.id == source_id).values(\n        status=\"queued\", \n        next_sync_at=datetime.now() + timedelta(minutes=15)\n    )\n    await self.session.execute(stmt)\n    await self.session.commit()\n</code></pre>"},{"location":"api/repositories/#app.repositories.parsing.ParsingRepository.sync_spiders","title":"<code>sync_spiders(available_spiders)</code>  <code>async</code>","text":"<p>Synchronizes the list of spiders from the scraper with the database. Returns a list of NEW spider keys that were not in the database.</p> Source code in <code>app/repositories/parsing.py</code> <pre><code>async def sync_spiders(self, available_spiders: List[str]) -&gt; List[str]:\n    \"\"\"\n    Synchronizes the list of spiders from the scraper with the database.\n    Returns a list of NEW spider keys that were not in the database.\n    \"\"\"\n    stmt = select(ParsingSource.site_key)\n    result = await self.session.execute(stmt)\n    existing_keys = set(result.scalars().all())\n\n    new_spiders = []\n    for spider_key in available_spiders:\n        if spider_key not in existing_keys:\n            # Add new inactive source\n            new_source = ParsingSource(\n                site_key=spider_key,\n                url=f\"https://{spider_key}.placeholder\", # Needs to be filled\n                type=\"hub\",\n                strategy=\"discovery\",\n                is_active=False,\n                config={\"is_new\": True, \"note\": \"Automatically detected, please configure\"}\n            )\n            self.session.add(new_source)\n            new_spiders.append(spider_key)\n\n    if new_spiders:\n        await self.session.commit()\n\n    return new_spiders\n</code></pre>"},{"location":"api/repositories/#app.repositories.parsing.ParsingRepository.update_category_mappings","title":"<code>update_category_mappings(mappings)</code>  <code>async</code>","text":"<p>\u041c\u0430\u0441\u0441\u043e\u0432\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442 \u043f\u0440\u0438\u0432\u044f\u0437\u043a\u0438 \u0432\u043d\u0435\u0448\u043d\u0438\u0445 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u043a \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u043c. mappings: [{\"external_name\": \"...\", \"internal_category_id\": 123}, ...]</p> Source code in <code>app/repositories/parsing.py</code> <pre><code>async def update_category_mappings(self, mappings: List[dict]) -&gt; int:\n    \"\"\"\n    \u041c\u0430\u0441\u0441\u043e\u0432\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442 \u043f\u0440\u0438\u0432\u044f\u0437\u043a\u0438 \u0432\u043d\u0435\u0448\u043d\u0438\u0445 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u043a \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u043c.\n    mappings: [{\"external_name\": \"...\", \"internal_category_id\": 123}, ...]\n    \"\"\"\n    if not mappings:\n        return 0\n\n    count = 0\n    for m in mappings:\n        stmt = (\n            update(CategoryMap)\n            .where(CategoryMap.external_name == m[\"external_name\"])\n            .values(internal_category_id=m[\"internal_category_id\"])\n        )\n        await self.session.execute(stmt)\n        count += 1\n\n    await self.session.commit()\n    return count\n</code></pre>"},{"location":"api/repositories/#app.repositories.catalog.PostgresCatalogRepository","title":"<code>app.repositories.catalog.PostgresCatalogRepository</code>","text":"<p>               Bases: <code>CatalogRepository</code></p> Source code in <code>app/repositories/catalog.py</code> <pre><code>class PostgresCatalogRepository(CatalogRepository):\n    def __init__(self, session: AsyncSession):\n        self.session = session\n\n    async def upsert_products(self, products: list[dict]) -&gt; int:\n        if not products:\n            return 0\n\n        # Construct values for upsert.\n        # We assume products list contains dicts matching Product model fields.\n        stmt = insert(Product).values(products)\n\n        # On conflict do update\n        # We update everything except created_at (and gift_id obviously)\n        update_dict = {\n            col.name: col\n            for col in stmt.excluded\n            if col.name not in (\"created_at\", \"gift_id\")\n        }\n\n        stmt = stmt.on_conflict_do_update(\n            index_elements=[Product.gift_id],\n            set_=update_dict\n        )\n\n        # RETURNING xmax is specific to PostgreSQL for counting inserts vs updates\n        if self.session.bind.dialect.name == \"postgresql\":\n            stmt = stmt.returning(sa.literal_column(\"xmax\"))\n            result = await self.session.execute(stmt)\n            rows = result.scalars().all()\n            inserted_count = sum(1 for xmax in rows if xmax == 0)\n            return inserted_count\n        else:\n            # Fallback for SQLite/others: just return rowcount\n            result = await self.session.execute(stmt)\n            return result.rowcount\n\n    async def mark_inactive_except(self, seen_ids: set[str]) -&gt; int:\n        \"\"\"\n        Mark all products NOT in the provided set of gift_ids as inactive.\n        Used for soft-delete during full sync.\n        \"\"\"\n        if not seen_ids:\n            # If seen_ids is empty, we don't deactivate everything \n            # as it might be a failed sync. We require at least some IDs.\n            return 0\n\n        stmt = (\n            update(Product)\n            .where(Product.gift_id.notin_(seen_ids))\n            .where(Product.is_active.is_(True))\n            .values(is_active=False, updated_at=func.now())\n        )\n\n        result = await self.session.execute(stmt)\n        return result.rowcount\n\n    async def get_active_products_count(self) -&gt; int:\n        query = select(func.count(Product.gift_id)).where(Product.is_active.is_(True))\n        result = await self.session.execute(query)\n        return result.scalar() or 0\n\n    async def get_products_without_embeddings(self, model_version: str, limit: int = 100) -&gt; list[Product]:\n        \"\"\"\n        Fetch products that do not have an embedding for the specified model_version.\n        We check if `product_embeddings` entry exists OR if content_hash doesn't match.\n        \"\"\"\n        from sqlalchemy.orm import aliased\n        from sqlalchemy import and_, or_\n        from app.models import ProductEmbedding\n\n        p = aliased(Product)\n        pe = aliased(ProductEmbedding)\n\n        stmt = (\n            select(p)\n            .outerjoin(\n                pe,\n                and_(\n                    p.gift_id == pe.gift_id,\n                    pe.model_version == model_version\n                )\n            )\n            .where(\n                and_(\n                    p.is_active.is_(True),\n                    or_(\n                        pe.gift_id.is_(None),\n                        pe.content_hash != p.content_hash\n                    )\n                )\n            )\n            .limit(limit)\n        )\n\n        result = await self.session.execute(stmt)\n        return list(result.scalars().all())\n\n    async def save_embeddings(self, embeddings: list[dict]) -&gt; int:\n        \"\"\"\n        Upsert product embeddings.\n        embeddings list should contain dicts matching ProductEmbedding model.\n        \"\"\"\n        if not embeddings:\n            return 0\n\n        stmt = insert(ProductEmbedding).values(embeddings)\n\n        update_dict = {\n            \"embedding\": stmt.excluded.embedding, # This assumes we pass vector/list\n            \"content_hash\": stmt.excluded.content_hash,\n            \"embedded_at\": func.now(),\n            \"updated_at\": datetime.now(),\n        }\n\n        stmt = stmt.on_conflict_do_update(\n            index_elements=[\n                ProductEmbedding.gift_id,\n                ProductEmbedding.model_name,\n                ProductEmbedding.model_version\n            ],\n            set_=update_dict\n        )\n\n        try:\n            result = await self.session.execute(stmt)\n            return result.rowcount\n        except Exception as e:\n            logger.error(f\"Failed to upsert embeddings. Batch size: {len(embeddings)}. Error: {type(e).__name__}: {e}\")\n            raise e\n\n    async def search_similar_products(\n        self, \n        embedding: list[float], \n        limit: int = 10, \n        min_similarity: float = 0.0, \n        is_active_only: bool = True,\n        max_price: Optional[int] = None,\n        max_delivery_days: Optional[int] = None,\n        model_name: Optional[str] = None\n    ) -&gt; list[Product]:\n        # Perform vector search using cosine distance (operator &lt;=&gt;)\n        from app.core.logic_config import logic_config\n        target_model = model_name or logic_config.llm.model_embedding\n\n        stmt = (\n            select(Product)\n            .join(ProductEmbedding, and_(\n                Product.gift_id == ProductEmbedding.gift_id,\n                ProductEmbedding.model_name == target_model\n            ))\n        )\n\n        if is_active_only:\n            stmt = stmt.where(Product.is_active.is_(True))\n\n        if max_price:\n            stmt = stmt.where(Product.price &lt;= max_price)\n\n        if max_delivery_days:\n            stmt = stmt.where(Product.delivery_days &lt;= max_delivery_days)\n\n        distance_col = ProductEmbedding.embedding.cosine_distance(embedding)\n\n        if min_similarity &gt; 0:\n            # cosine_similarity = 1 - cosine_distance\n            stmt = stmt.where(1 - distance_col &gt;= min_similarity)\n\n        stmt = stmt.order_by(distance_col).limit(limit)\n        try:\n            result = await self.session.execute(stmt)\n            return list(result.scalars().all())\n        except Exception as e:\n            logger.error(f\"CatalogRepository.search_similar_products failed: {e}\")\n            from app.services.notifications import get_notification_service\n            notifier = get_notification_service()\n            # Send alert\n            if notifier:\n                await notifier.notify(\n                    topic=\"db_error\",\n                    message=\"Vector search failed in CatalogRepository\",\n                    data={\"error\": str(e)}\n                )\n\n            from app.config import get_settings\n            if get_settings().env == \"dev\":\n                logger.warning(\"DB search failed, returning empty list (dev mode)\")\n                return []\n            raise e\n\n    async def get_products_without_llm_score(self, limit: int = 100) -&gt; list[Product]:\n        \"\"\"\n        Fetch products that don't have an LLM gift score yet.\n        \"\"\"\n        stmt = (\n            select(Product)\n            .where(\n                and_(\n                    Product.is_active.is_(True),\n                    Product.llm_gift_score.is_(None)\n                )\n            )\n            .order_by(Product.updated_at.desc()) # Or some other priority\n            .limit(limit)\n        )\n\n        result = await self.session.execute(stmt)\n        return list(result.scalars().all())\n\n    async def save_llm_scores(self, scores: list[dict]) -&gt; int:\n        \"\"\"\n        Update product rows with LLM scores and reasoning.\n        scores list should contain dicts: {'gift_id': str, 'llm_gift_score': float, 'llm_gift_reasoning': str, ...}\n        Uses batch update (UPSERT) for efficiency.\n        \"\"\"\n        if not scores:\n            return 0\n\n        # Add timestamp to all items\n        now = datetime.now()\n        for s in scores:\n            s[\"llm_scored_at\"] = now\n            s[\"b_gift_id\"] = s[\"gift_id\"]\n\n        # Use session.execute with bindparam for batch update\n        # This is more robust as it doesn't require all columns for INSERT\n        from sqlalchemy import bindparam\n\n        stmt = (\n            sa.update(Product)\n            .where(Product.gift_id == bindparam(\"b_gift_id\"))\n            .values(\n                llm_gift_score=bindparam(\"llm_gift_score\"),\n                llm_gift_reasoning=bindparam(\"llm_gift_reasoning\"),\n                llm_scored_at=bindparam(\"llm_scored_at\"),\n                updated_at=func.now()\n            )\n            .execution_options(synchronize_session=None)\n        )\n\n        result = await self.session.execute(stmt, scores)\n        # For bulk updates, rowcount might not be directly available on IteratorResult\n        try:\n            return result.rowcount\n        except AttributeError:\n            return len(scores)\n</code></pre>"},{"location":"api/repositories/#app.repositories.catalog.PostgresCatalogRepository-functions","title":"Functions","text":""},{"location":"api/repositories/#app.repositories.catalog.PostgresCatalogRepository.get_products_without_embeddings","title":"<code>get_products_without_embeddings(model_version, limit=100)</code>  <code>async</code>","text":"<p>Fetch products that do not have an embedding for the specified model_version. We check if <code>product_embeddings</code> entry exists OR if content_hash doesn't match.</p> Source code in <code>app/repositories/catalog.py</code> <pre><code>async def get_products_without_embeddings(self, model_version: str, limit: int = 100) -&gt; list[Product]:\n    \"\"\"\n    Fetch products that do not have an embedding for the specified model_version.\n    We check if `product_embeddings` entry exists OR if content_hash doesn't match.\n    \"\"\"\n    from sqlalchemy.orm import aliased\n    from sqlalchemy import and_, or_\n    from app.models import ProductEmbedding\n\n    p = aliased(Product)\n    pe = aliased(ProductEmbedding)\n\n    stmt = (\n        select(p)\n        .outerjoin(\n            pe,\n            and_(\n                p.gift_id == pe.gift_id,\n                pe.model_version == model_version\n            )\n        )\n        .where(\n            and_(\n                p.is_active.is_(True),\n                or_(\n                    pe.gift_id.is_(None),\n                    pe.content_hash != p.content_hash\n                )\n            )\n        )\n        .limit(limit)\n    )\n\n    result = await self.session.execute(stmt)\n    return list(result.scalars().all())\n</code></pre>"},{"location":"api/repositories/#app.repositories.catalog.PostgresCatalogRepository.get_products_without_llm_score","title":"<code>get_products_without_llm_score(limit=100)</code>  <code>async</code>","text":"<p>Fetch products that don't have an LLM gift score yet.</p> Source code in <code>app/repositories/catalog.py</code> <pre><code>async def get_products_without_llm_score(self, limit: int = 100) -&gt; list[Product]:\n    \"\"\"\n    Fetch products that don't have an LLM gift score yet.\n    \"\"\"\n    stmt = (\n        select(Product)\n        .where(\n            and_(\n                Product.is_active.is_(True),\n                Product.llm_gift_score.is_(None)\n            )\n        )\n        .order_by(Product.updated_at.desc()) # Or some other priority\n        .limit(limit)\n    )\n\n    result = await self.session.execute(stmt)\n    return list(result.scalars().all())\n</code></pre>"},{"location":"api/repositories/#app.repositories.catalog.PostgresCatalogRepository.mark_inactive_except","title":"<code>mark_inactive_except(seen_ids)</code>  <code>async</code>","text":"<p>Mark all products NOT in the provided set of gift_ids as inactive. Used for soft-delete during full sync.</p> Source code in <code>app/repositories/catalog.py</code> <pre><code>async def mark_inactive_except(self, seen_ids: set[str]) -&gt; int:\n    \"\"\"\n    Mark all products NOT in the provided set of gift_ids as inactive.\n    Used for soft-delete during full sync.\n    \"\"\"\n    if not seen_ids:\n        # If seen_ids is empty, we don't deactivate everything \n        # as it might be a failed sync. We require at least some IDs.\n        return 0\n\n    stmt = (\n        update(Product)\n        .where(Product.gift_id.notin_(seen_ids))\n        .where(Product.is_active.is_(True))\n        .values(is_active=False, updated_at=func.now())\n    )\n\n    result = await self.session.execute(stmt)\n    return result.rowcount\n</code></pre>"},{"location":"api/repositories/#app.repositories.catalog.PostgresCatalogRepository.save_embeddings","title":"<code>save_embeddings(embeddings)</code>  <code>async</code>","text":"<p>Upsert product embeddings. embeddings list should contain dicts matching ProductEmbedding model.</p> Source code in <code>app/repositories/catalog.py</code> <pre><code>async def save_embeddings(self, embeddings: list[dict]) -&gt; int:\n    \"\"\"\n    Upsert product embeddings.\n    embeddings list should contain dicts matching ProductEmbedding model.\n    \"\"\"\n    if not embeddings:\n        return 0\n\n    stmt = insert(ProductEmbedding).values(embeddings)\n\n    update_dict = {\n        \"embedding\": stmt.excluded.embedding, # This assumes we pass vector/list\n        \"content_hash\": stmt.excluded.content_hash,\n        \"embedded_at\": func.now(),\n        \"updated_at\": datetime.now(),\n    }\n\n    stmt = stmt.on_conflict_do_update(\n        index_elements=[\n            ProductEmbedding.gift_id,\n            ProductEmbedding.model_name,\n            ProductEmbedding.model_version\n        ],\n        set_=update_dict\n    )\n\n    try:\n        result = await self.session.execute(stmt)\n        return result.rowcount\n    except Exception as e:\n        logger.error(f\"Failed to upsert embeddings. Batch size: {len(embeddings)}. Error: {type(e).__name__}: {e}\")\n        raise e\n</code></pre>"},{"location":"api/repositories/#app.repositories.catalog.PostgresCatalogRepository.save_llm_scores","title":"<code>save_llm_scores(scores)</code>  <code>async</code>","text":"<p>Update product rows with LLM scores and reasoning. scores list should contain dicts: {'gift_id': str, 'llm_gift_score': float, 'llm_gift_reasoning': str, ...} Uses batch update (UPSERT) for efficiency.</p> Source code in <code>app/repositories/catalog.py</code> <pre><code>async def save_llm_scores(self, scores: list[dict]) -&gt; int:\n    \"\"\"\n    Update product rows with LLM scores and reasoning.\n    scores list should contain dicts: {'gift_id': str, 'llm_gift_score': float, 'llm_gift_reasoning': str, ...}\n    Uses batch update (UPSERT) for efficiency.\n    \"\"\"\n    if not scores:\n        return 0\n\n    # Add timestamp to all items\n    now = datetime.now()\n    for s in scores:\n        s[\"llm_scored_at\"] = now\n        s[\"b_gift_id\"] = s[\"gift_id\"]\n\n    # Use session.execute with bindparam for batch update\n    # This is more robust as it doesn't require all columns for INSERT\n    from sqlalchemy import bindparam\n\n    stmt = (\n        sa.update(Product)\n        .where(Product.gift_id == bindparam(\"b_gift_id\"))\n        .values(\n            llm_gift_score=bindparam(\"llm_gift_score\"),\n            llm_gift_reasoning=bindparam(\"llm_gift_reasoning\"),\n            llm_scored_at=bindparam(\"llm_scored_at\"),\n            updated_at=func.now()\n        )\n        .execution_options(synchronize_session=None)\n    )\n\n    result = await self.session.execute(stmt, scores)\n    # For bulk updates, rowcount might not be directly available on IteratorResult\n    try:\n        return result.rowcount\n    except AttributeError:\n        return len(scores)\n</code></pre>"},{"location":"api/repositories/#repositories.recommendations.create_quiz_run","title":"<code>repositories.recommendations.create_quiz_run(db, *, user_id, anon_id, answers_json)</code>  <code>async</code>","text":"Source code in <code>repositories/recommendations.py</code> <pre><code>async def create_quiz_run(\n    db: AsyncSession,\n    *,\n    user_id: Optional[UUID],\n    anon_id: Optional[str],\n    answers_json: dict[str, Any],\n) -&gt; QuizRun:\n    quiz_run = QuizRun(user_id=user_id, anon_id=anon_id, answers_json=answers_json)\n    db.add(quiz_run)\n    await db.commit()\n    await db.refresh(quiz_run)\n    return quiz_run\n</code></pre>"},{"location":"api/repositories/#repositories.recommendations.log_event","title":"<code>repositories.recommendations.log_event(db, event_name, *, user_id=None, anon_id=None, quiz_run_id=None, recommendation_run_id=None, gift_id=None, payload=None)</code>  <code>async</code>","text":"Source code in <code>repositories/recommendations.py</code> <pre><code>async def log_event(\n    db: AsyncSession,\n    event_name: str,\n    *,\n    user_id: Optional[UUID] = None,\n    anon_id: Optional[str] = None,\n    quiz_run_id: Optional[UUID] = None,\n    recommendation_run_id: Optional[UUID] = None,\n    gift_id: Optional[str] = None,\n    payload: Optional[dict[str, Any]] = None,\n) -&gt; None:\n    event = Event(\n        event_name=event_name,\n        user_id=user_id,\n        anon_id=anon_id,\n        quiz_run_id=quiz_run_id,\n        recommendation_run_id=recommendation_run_id,\n        gift_id=gift_id,\n        payload=payload,\n    )\n    db.add(event)\n    await db.commit()\n</code></pre>"},{"location":"api/services/","title":"\u0421\u0435\u0440\u0432\u0438\u0441\u044b (Services)","text":"<p>\u0412 \u044d\u0442\u043e\u043c \u0440\u0430\u0437\u0434\u0435\u043b\u0435 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0430 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u043f\u043e \u043a\u043b\u044e\u0447\u0435\u0432\u044b\u043c \u0441\u0435\u0440\u0432\u0438\u0441\u043d\u044b\u043c \u0441\u043b\u043e\u044f\u043c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f.</p>"},{"location":"api/services/#app.services.ingestion.IngestionService","title":"<code>app.services.ingestion.IngestionService</code>","text":"Source code in <code>app/services/ingestion.py</code> <pre><code>class IngestionService:\n    def __init__(self, db: AsyncSession, redis=None):\n        self.db = db\n        self.catalog_repo = PostgresCatalogRepository(db)\n        self.parsing_repo = ParsingRepository(db, redis=redis)\n\n    async def ingest_products(self, products: List[ScrapedProduct], source_id: int):\n        if not products:\n            return 0\n\n        # Fetch source config for custom normalization\n        source = await self.parsing_repo.get_source(source_id)\n        strip_params = DEFAULT_STRIP_PARAMS\n        if source and source.config:\n            custom_strip = source.config.get(\"strip_params\")\n            if isinstance(custom_strip, list):\n                strip_params = set(custom_strip)\n\n        # 1. Handle Categories\n        external_categories = list(set([p.category for p in products if p.category]))\n        if external_categories:\n            await self.parsing_repo.get_or_create_category_maps(external_categories)\n\n        # 2. Prepare Product data for Upsert\n        product_dicts = []\n        seen_gift_ids = set()\n\n        for p in products:\n            clean_url = normalize_url(p.product_url, strip_params=strip_params)\n            gift_id = f\"{p.site_key}:{clean_url}\" \n\n            if gift_id in seen_gift_ids:\n                continue\n            seen_gift_ids.add(gift_id)\n\n            product_dicts.append({\n                \"gift_id\": gift_id,\n                \"title\": p.title,\n                \"description\": p.description,\n                \"price\": p.price,\n                \"currency\": p.currency,\n                \"image_url\": p.image_url,\n                \"product_url\": clean_url,\n                \"merchant\": p.merchant,\n                \"category\": p.category, \n                \"raw\": p.raw_data,\n                \"is_active\": True\n            })\n\n        # 3. Bulk Upsert\n        count = await self.catalog_repo.upsert_products(product_dicts)\n\n        # 4. Update Source Stats\n        await self.parsing_repo.update_source_stats(source_id, {\n            \"processed_items\": len(products),\n            \"new_items\": count\n        })\n\n        # 5. Log Run History\n        await self.parsing_repo.log_parsing_run(\n            source_id=source_id,\n            status=\"completed\",\n            items_scraped=len(products),\n            items_new=count\n        )\n\n        await self.db.commit()\n        return count\n\n    async def ingest_categories(self, categories: List[ScrapedCategory], activation_quota: int = 50):\n        \"\"\"Discovers new ParsingSources. Activates some, puts others in backlog.\"\"\"\n        if not categories:\n            return 0\n\n        # Count how many we already activated today\n        activated_today = await self.parsing_repo.count_discovered_today()\n        remaining_quota = max(0, activation_quota - activated_today)\n\n        count = 0\n        for i, cat in enumerate(categories):\n            clean_url = normalize_url(cat.url)\n\n            # If within quota, status is 'waiting', else 'discovered' (backlog)\n            # hub (list) sources are activated by default if within quota\n            is_within_quota = (i &lt; remaining_quota)\n            status = \"waiting\" if is_within_quota else \"discovered\"\n            is_active = True if is_within_quota else False\n\n            # Check if source already exists\n            existing = await self.parsing_repo.get_source_by_url(clean_url)\n            if existing:\n                continue\n\n            source_data = {\n                \"url\": clean_url,\n                \"site_key\": cat.site_key,\n                \"type\": \"list\", \n                \"strategy\": \"deep\", \n                \"priority\": 50,\n                \"refresh_interval_hours\": 24,\n                \"is_active\": is_active,\n                \"status\": status,\n                \"config\": {\n                    \"discovery_name\": cat.name,\n                    \"parent_url\": cat.parent_url,\n                    \"discovered_at\": datetime.utcnow().isoformat()\n                }\n            }\n            try:\n                await self.parsing_repo.upsert_source(source_data)\n                count += 1\n            except Exception as e:\n                logger.error(f\"Failed to upsert discovered source {clean_url}: {e}\")\n\n        await self.db.commit()\n        return count\n</code></pre>"},{"location":"api/services/#app.services.ingestion.IngestionService-functions","title":"Functions","text":""},{"location":"api/services/#app.services.ingestion.IngestionService.ingest_categories","title":"<code>ingest_categories(categories, activation_quota=50)</code>  <code>async</code>","text":"<p>Discovers new ParsingSources. Activates some, puts others in backlog.</p> Source code in <code>app/services/ingestion.py</code> <pre><code>async def ingest_categories(self, categories: List[ScrapedCategory], activation_quota: int = 50):\n    \"\"\"Discovers new ParsingSources. Activates some, puts others in backlog.\"\"\"\n    if not categories:\n        return 0\n\n    # Count how many we already activated today\n    activated_today = await self.parsing_repo.count_discovered_today()\n    remaining_quota = max(0, activation_quota - activated_today)\n\n    count = 0\n    for i, cat in enumerate(categories):\n        clean_url = normalize_url(cat.url)\n\n        # If within quota, status is 'waiting', else 'discovered' (backlog)\n        # hub (list) sources are activated by default if within quota\n        is_within_quota = (i &lt; remaining_quota)\n        status = \"waiting\" if is_within_quota else \"discovered\"\n        is_active = True if is_within_quota else False\n\n        # Check if source already exists\n        existing = await self.parsing_repo.get_source_by_url(clean_url)\n        if existing:\n            continue\n\n        source_data = {\n            \"url\": clean_url,\n            \"site_key\": cat.site_key,\n            \"type\": \"list\", \n            \"strategy\": \"deep\", \n            \"priority\": 50,\n            \"refresh_interval_hours\": 24,\n            \"is_active\": is_active,\n            \"status\": status,\n            \"config\": {\n                \"discovery_name\": cat.name,\n                \"parent_url\": cat.parent_url,\n                \"discovered_at\": datetime.utcnow().isoformat()\n            }\n        }\n        try:\n            await self.parsing_repo.upsert_source(source_data)\n            count += 1\n        except Exception as e:\n            logger.error(f\"Failed to upsert discovered source {clean_url}: {e}\")\n\n    await self.db.commit()\n    return count\n</code></pre>"},{"location":"api/services/#app.services.intelligence.IntelligenceAPIClient","title":"<code>app.services.intelligence.IntelligenceAPIClient</code>","text":"<p>Hybrid Intelligence Client supporting both online (RunPod/API) and offline (DB queue) execution.</p> <ul> <li>Online (priority='high'): Immediate execution via RunPod or Intelligence API</li> <li>Offline (priority='low'): Task queued in database for external workers</li> </ul> Source code in <code>app/services/intelligence.py</code> <pre><code>class IntelligenceAPIClient:\n    \"\"\"\n    Hybrid Intelligence Client supporting both online (RunPod/API) and offline (DB queue) execution.\n\n    - Online (priority='high'): Immediate execution via RunPod or Intelligence API\n    - Offline (priority='low'): Task queued in database for external workers\n    \"\"\"\n    def __init__(self):\n        settings = get_settings()\n        self.intelligence_api_base = settings.intelligence_api_base\n        self.intelligence_api_token = settings.intelligence_api_token\n        self.runpod_api_key = settings.runpod_api_key\n        self.runpod_endpoint_id = settings.runpod_endpoint_id\n        self.together_api_key = settings.together_api_key\n        self.timeout = 10.0\n\n    async def get_embeddings(\n        self, \n        texts: List[str], \n        priority: str = \"high\",\n        db: Optional[AsyncSession] = None\n    ) -&gt; Optional[List[List[float]]]:\n        \"\"\"\n        Get embeddings for texts.\n\n        Args:\n            texts: List of texts to embed\n            priority: 'high' for online execution, 'low' for offline queue\n            db: Database session (required if priority='low')\n\n        Returns:\n            List of embedding vectors if priority='high', None if priority='low' (task queued)\n        \"\"\"\n        if priority == \"low\":\n            if db is None:\n                raise ValueError(\"Database session required for offline task scheduling\")\n            await self._schedule_task(\n                db=db,\n                task_type=\"embedding\",\n                payload={\"texts\": texts, \"model\": logic_config.model_embedding}\n            )\n            return None\n\n        # Online execution\n        return await self._get_embeddings_online(texts)\n\n    async def _get_embeddings_online(self, texts: List[str]) -&gt; List[List[float]]:\n        \"\"\"Execute embeddings based on configured provider in logic_config.\"\"\"\n        provider = logic_config.llm.embedding_provider\n\n        if provider == \"runpod\":\n            if self.runpod_api_key and self.runpod_endpoint_id:\n                try:\n                    return await self._call_runpod_embeddings(texts)\n                except Exception as e:\n                    logger.warning(f\"RunPod embeddings failed, falling back to Intelligence API: {e}\")\n            else:\n                logger.warning(\"RunPod provider selected but credentials missing, falling back.\")\n\n        if provider == \"together\":\n            if self.together_api_key:\n                try:\n                    return await self._call_together_embeddings(texts)\n                except Exception as e:\n                    logger.warning(f\"Together AI embeddings failed, falling back to Intelligence API: {e}\")\n            else:\n                logger.warning(\"Together provider selected but credentials missing, falling back.\")\n\n        # Default fallback to Intelligence API\n        return await self._call_intelligence_api_embeddings(texts)\n\n    async def _call_runpod_embeddings(self, texts: List[str]) -&gt; List[List[float]]:\n        \"\"\"Call RunPod serverless endpoint for embeddings.\"\"\"\n        async with httpx.AsyncClient(timeout=30.0) as client:\n            response = await client.post(\n                f\"https://api.runpod.ai/v2/{self.runpod_endpoint_id}/runsync\",\n                json={\n                    \"input\": {\n                        \"texts\": texts,\n                        \"model\": logic_config.model_embedding\n                    }\n                },\n                headers={\"Authorization\": f\"Bearer {self.runpod_api_key}\"}\n            )\n            response.raise_for_status()\n            data = response.json()\n            return data[\"output\"][\"embeddings\"]\n\n    async def _call_together_embeddings(self, texts: List[str]) -&gt; List[List[float]]:\n        \"\"\"Call Together AI for embeddings.\"\"\"\n        async with httpx.AsyncClient(timeout=30.0) as client:\n            response = await client.post(\n                \"https://api.together.xyz/v1/embeddings\",\n                json={\n                    \"input\": texts,\n                    \"model\": logic_config.model_embedding\n                },\n                headers={\"Authorization\": f\"Bearer {self.together_api_key}\"}\n            )\n            response.raise_for_status()\n            data = response.json()\n            # Together API returns format: {\"data\": [{\"embedding\": [...]}, ...]}\n            return [item[\"embedding\"] for item in data.get(\"data\", [])]\n\n    async def _call_intelligence_api_embeddings(self, texts: List[str]) -&gt; List[List[float]]:\n        \"\"\"Call Intelligence API for embeddings.\"\"\"\n        if not self.intelligence_api_token:\n            logger.warning(\"IntelligenceAPI token missing, using dummy embeddings.\")\n            return [[0.0] * 1024 for _ in texts]\n\n        try:\n            async with httpx.AsyncClient(timeout=self.timeout) as client:\n                response = await client.post(\n                    f\"{self.intelligence_api_base}/v1/embeddings\",\n                    json={\"input\": texts, \"model\": logic_config.model_embedding},\n                    headers={\"Authorization\": f\"Bearer {self.intelligence_api_token}\"}\n                )\n                response.raise_for_status()\n                data = response.json()\n                return [item[\"embedding\"] for item in data.get(\"data\", [])]\n        except Exception as e:\n            logger.error(f\"IntelligenceAPI embeddings call failed: {e}\")\n            return [[0.0] * 1024 for _ in texts]\n\n    async def rerank(\n        self, \n        query: str, \n        documents: List[str],\n        priority: str = \"high\",\n        db: Optional[AsyncSession] = None\n    ) -&gt; Optional[List[float]]:\n        \"\"\"\n        Rerank documents relative to a query.\n\n        Args:\n            query: Query text\n            documents: List of documents to rerank\n            priority: 'high' for online execution, 'low' for offline queue\n            db: Database session (required if priority='low')\n\n        Returns:\n            List of relevance scores if priority='high', None if priority='low' (task queued)\n        \"\"\"\n        if priority == \"low\":\n            if db is None:\n                raise ValueError(\"Database session required for offline task scheduling\")\n            await self._schedule_task(\n                db=db,\n                task_type=\"rerank\",\n                payload={\"query\": query, \"documents\": documents}\n            )\n            return None\n\n        # Online execution\n        return await self._rerank_online(query, documents)\n\n    async def _rerank_online(self, query: str, documents: List[str]) -&gt; List[float]:\n        \"\"\"Execute reranking via Intelligence API.\"\"\"\n        if not self.intelligence_api_token:\n            return [0.0] * len(documents)\n\n        try:\n            async with httpx.AsyncClient(timeout=self.timeout) as client:\n                response = await client.post(\n                    f\"{self.intelligence_api_base}/v1/rerank\",\n                    json={\"query\": query, \"documents\": documents},\n                    headers={\"Authorization\": f\"Bearer {self.intelligence_api_token}\"}\n                )\n                response.raise_for_status()\n                return response.json().get(\"scores\", [0.0] * len(documents))\n        except Exception as e:\n            logger.error(f\"IntelligenceAPI rerank call failed: {e}\")\n            return [0.0] * len(documents)\n\n    async def _schedule_task(self, db: AsyncSession, task_type: str, payload: dict) -&gt; None:\n        \"\"\"Schedule a task in the database queue for offline processing.\"\"\"\n        task = ComputeTask(\n            id=uuid.uuid4(),\n            task_type=task_type,\n            priority=\"low\",\n            status=\"pending\",\n            payload=payload\n        )\n        db.add(task)\n        await db.commit()\n        logger.info(f\"Scheduled {task_type} task {task.id} for offline processing\")\n</code></pre>"},{"location":"api/services/#app.services.intelligence.IntelligenceAPIClient-functions","title":"Functions","text":""},{"location":"api/services/#app.services.intelligence.IntelligenceAPIClient.get_embeddings","title":"<code>get_embeddings(texts, priority='high', db=None)</code>  <code>async</code>","text":"<p>Get embeddings for texts.</p> <p>Parameters:</p> Name Type Description Default <code>texts</code> <code>List[str]</code> <p>List of texts to embed</p> required <code>priority</code> <code>str</code> <p>'high' for online execution, 'low' for offline queue</p> <code>'high'</code> <code>db</code> <code>Optional[AsyncSession]</code> <p>Database session (required if priority='low')</p> <code>None</code> <p>Returns:</p> Type Description <code>Optional[List[List[float]]]</code> <p>List of embedding vectors if priority='high', None if priority='low' (task queued)</p> Source code in <code>app/services/intelligence.py</code> <pre><code>async def get_embeddings(\n    self, \n    texts: List[str], \n    priority: str = \"high\",\n    db: Optional[AsyncSession] = None\n) -&gt; Optional[List[List[float]]]:\n    \"\"\"\n    Get embeddings for texts.\n\n    Args:\n        texts: List of texts to embed\n        priority: 'high' for online execution, 'low' for offline queue\n        db: Database session (required if priority='low')\n\n    Returns:\n        List of embedding vectors if priority='high', None if priority='low' (task queued)\n    \"\"\"\n    if priority == \"low\":\n        if db is None:\n            raise ValueError(\"Database session required for offline task scheduling\")\n        await self._schedule_task(\n            db=db,\n            task_type=\"embedding\",\n            payload={\"texts\": texts, \"model\": logic_config.model_embedding}\n        )\n        return None\n\n    # Online execution\n    return await self._get_embeddings_online(texts)\n</code></pre>"},{"location":"api/services/#app.services.intelligence.IntelligenceAPIClient.rerank","title":"<code>rerank(query, documents, priority='high', db=None)</code>  <code>async</code>","text":"<p>Rerank documents relative to a query.</p> <p>Parameters:</p> Name Type Description Default <code>query</code> <code>str</code> <p>Query text</p> required <code>documents</code> <code>List[str]</code> <p>List of documents to rerank</p> required <code>priority</code> <code>str</code> <p>'high' for online execution, 'low' for offline queue</p> <code>'high'</code> <code>db</code> <code>Optional[AsyncSession]</code> <p>Database session (required if priority='low')</p> <code>None</code> <p>Returns:</p> Type Description <code>Optional[List[float]]</code> <p>List of relevance scores if priority='high', None if priority='low' (task queued)</p> Source code in <code>app/services/intelligence.py</code> <pre><code>async def rerank(\n    self, \n    query: str, \n    documents: List[str],\n    priority: str = \"high\",\n    db: Optional[AsyncSession] = None\n) -&gt; Optional[List[float]]:\n    \"\"\"\n    Rerank documents relative to a query.\n\n    Args:\n        query: Query text\n        documents: List of documents to rerank\n        priority: 'high' for online execution, 'low' for offline queue\n        db: Database session (required if priority='low')\n\n    Returns:\n        List of relevance scores if priority='high', None if priority='low' (task queued)\n    \"\"\"\n    if priority == \"low\":\n        if db is None:\n            raise ValueError(\"Database session required for offline task scheduling\")\n        await self._schedule_task(\n            db=db,\n            task_type=\"rerank\",\n            payload={\"query\": query, \"documents\": documents}\n        )\n        return None\n\n    # Online execution\n    return await self._rerank_online(query, documents)\n</code></pre>"},{"location":"api/services/#app.services.recommendation.RecommendationService","title":"<code>app.services.recommendation.RecommendationService</code>","text":"Source code in <code>app/services/recommendation.py</code> <pre><code>class RecommendationService:\n    def __init__(self, session: AsyncSession, embedding_service: EmbeddingService):\n        self.session = session\n        self.repo = PostgresCatalogRepository(session)\n        self.embedding_service = embedding_service\n        self.intelligence_client = get_intelligence_client()\n\n    async def generate_recommendations(\n        self, \n        request: RecommendationRequest,\n        engine_version: str = \"vector_v1\"\n    ) -&gt; RecommendationResponse:\n        \"\"\"\n        Main orchestration method for recommendation generation.\n        Implements Stages A, B, C, D from the roadmap.\n        \"\"\"\n        logger.info(f\"Generating recommendations for request: {request}\")\n\n        # Stage A: Vector Retrieval\n        candidates = await self._retrieve_candidates(request)\n\n        # Stage B: CPU Ranker\n        ranked_candidates = await self._rank_candidates(request, candidates)\n\n        # Stage C: LLM-as-judge Rerank (Stub)\n        final_candidates = await self._judge_rerank(request, ranked_candidates)\n\n        # Stage D: Constraints Re-ranking (Diversity)\n        final_gifts_data = self._apply_final_rank_and_diversity(request, final_candidates)\n\n        gifts = [\n            GiftDTO(\n                id=g.gift_id,\n                title=g.title,\n                description=g.description,\n                price=g.price,\n                currency=g.currency,\n                image_url=g.image_url,\n                product_url=g.product_url,\n                merchant=g.merchant,\n                category=g.category\n            ) for g in final_gifts_data\n        ]\n        featured_gift = gifts[0] if gifts else None\n\n        return RecommendationResponse(\n            quiz_run_id=\"stub-id\", # TODO: integrate with quiz_run repo\n            engine_version=engine_version,\n            featured_gift=featured_gift,\n            gifts=gifts,\n            debug={\"status\": \"candidates_retrieved\", \"count\": len(candidates)} if request.debug else None\n        )\n\n    def _build_query_text(self, request: RecommendationRequest) -&gt; str:\n        \"\"\"Construct semantic search query from quiz answers.\"\"\"\n        parts = [\n            f\"Gift for {request.relationship or 'someone'}\",\n            f\"Occasion: {request.occasion}\" if request.occasion else \"\",\n            f\"Age: {request.recipient_age}\",\n            f\"Gender: {request.recipient_gender}\" if request.recipient_gender else \"\",\n            f\"Interests: {', '.join(request.interests)}\" if request.interests else \"\",\n            f\"Description: {request.interests_description}\" if request.interests_description else \"\",\n            f\"Vibe: {request.vibe}\" if request.vibe else \"\",\n        ]\n        return \" \".join([p for p in parts if p]).strip()\n\n    async def _retrieve_candidates(self, request: RecommendationRequest) -&gt; list[Any]:\n        \"\"\"Stage A: Vector Retrieval (pgvector)\"\"\"\n        query_text = self._build_query_text(request)\n        logger.info(f\"Retrieving candidates for query: '{query_text}'\")\n\n        # 1. Generate Query Embedding\n        query_vector = await self.embedding_service.embed_batch_async([query_text])\n        query_vector = query_vector[0]\n\n        # 2. Search in Repo (Top 50 candidates for further ranking)\n        candidates = await self.repo.search_similar_products(\n            embedding=query_vector, \n            limit=50,\n            is_active_only=True\n        )\n        return candidates\n\n    async def _rank_candidates(self, request: RecommendationRequest, candidates: list[Any]) -&gt; list[Any]:\n        \"\"\"Stage B: CPU Ranker (Logic from SoT Section 5)\"\"\"\n        return candidates\n\n    async def _judge_rerank(self, request: RecommendationRequest, candidates: list[Any]) -&gt; list[Any]:\n        \"\"\"Stage C: LLM-as-judge Rerank (Stub for now)\"\"\"\n        return candidates\n\n    def _apply_final_rank_and_diversity(self, request: RecommendationRequest, candidates: list[Any]) -&gt; list[Any]:\n        \"\"\"Stage D: Constraints Re-ranking &amp; Diversity\"\"\"\n        return candidates[:request.top_n]\n\n    async def find_preview_products(\n        self, \n        search_queries: List[str], \n        hypothesis_title: str = \"\", \n        max_price: Optional[int] = None,\n        session_id: Optional[str] = None,\n        hypothesis_id: Optional[uuid.UUID] = None,\n        track_title: Optional[str] = None,\n        llm_model: Optional[str] = None,\n        search_context: str = \"preview\",\n        limit_per_query: Optional[int] = None\n    ) -&gt; List[GiftDTO]:\n        \"\"\"\n        Advanced retrieval for previews:\n        1. Flexible budget (max_price + margin from logic_config)\n        2. Parallel multi-query vector search\n        3. Global reranking and Interleaving\n        \"\"\"\n        from app.core.logic_config import logic_config\n\n        # Override config with parameter if provided\n        final_limit_per_query = limit_per_query or logic_config.items_per_query\n        target_queries = search_queries[:logic_config.max_queries_for_preview]\n\n        # 1. Flexible Budget\n        effective_max_price = None\n        if max_price:\n            effective_max_price = int(max_price * (1 + logic_config.budget_margin_fraction))\n\n        # 2. Parallel Vector Search for all queries\n        async def _fetch_for_query(query: str):\n            query_vectors = await self.embedding_service.embed_batch_async([query])\n            if not query_vectors:\n                return query, []\n\n            candidates = await self.repo.search_similar_products(\n                embedding=query_vectors[0],\n                limit=logic_config.rerank_candidate_limit,\n                is_active_only=True,\n                max_price=effective_max_price\n            )\n            return query, candidates\n\n        search_tasks = [_fetch_for_query(q) for q in target_queries]\n        search_results_raw = await asyncio.gather(*search_tasks, return_exceptions=True)\n\n        search_results = []\n        for res in search_results_raw:\n            if isinstance(res, Exception):\n                logger.error(f\"Search task failed in find_preview_products: {res}\")\n            else:\n                search_results.append(res)\n\n        # Map queries to their candidates and gather ALL unique candidates for reranking\n        query_to_results = {}\n        all_unique_candidates = {}\n\n        # LOGGING: Track coverage for each query\n        for res in search_results:\n            if isinstance(res, tuple):\n                query, candidates = res\n                query_to_results[query] = candidates\n\n                # Calculate simple metrics for logging\n                results_count = len(candidates)\n                top_sim = 0.0\n                avg_sim = 0.0\n                top_id = None\n\n                if candidates:\n                    # In vector search similarity is not directly in Product model, \n                    # but we can log that it found results.\n                    # If we had access to the raw similarity scores from the repo, we'd log them here.\n                    top_id = candidates[0].gift_id\n\n                # Create SearchLog entry\n                try:\n                    log_entry = SearchLog(\n                        session_id=session_id,\n                        hypothesis_id=hypothesis_id,\n                        track_title=track_title,\n                        hypothesis_title=hypothesis_title,\n                        search_context=search_context,\n                        llm_model=llm_model or logic_config.model_smart,\n                        search_query=query,\n                        results_count=results_count,\n                        top_gift_id=top_id,\n                        max_price=max_price,\n                        engine_version=\"advanced_v1\"\n                    )\n                    self.session.add(log_entry)\n                except Exception as e:\n                    logger.warning(f\"Failed to log search result: {e}\")\n\n                for c in candidates:\n                    if c.gift_id not in all_unique_candidates:\n                        all_unique_candidates[c.gift_id] = c\n\n        candidates_list = list(all_unique_candidates.values())\n        if not candidates_list:\n            return []\n\n        # 3. Global Reranking\n        doc_texts = [f\"{c.title} {c.description or ''}\" for c in candidates_list]\n        query_context = hypothesis_title or \" \".join(target_queries[:2])\n\n        try:\n            scores = await self.intelligence_client.rerank(query_context, doc_texts)\n            id_to_score = {c.gift_id: score for c, score in zip(candidates_list, scores)}\n        except Exception as e:\n            logger.error(f\"RecommendationService: Reranking failed, falling back to vector scores: {e}\")\n            # Proactive notification\n            notifier = get_notification_service()\n            await notifier.notify(\n                topic=\"intelligence_error\",\n                message=f\"Reranking failed for hypothesis: {hypothesis_title}\",\n                data={\"error\": str(e), \"doc_count\": len(doc_texts)}\n            )\n            # Fallback: assign scores based on original retrieval order to maintain some ranking\n            id_to_score = {c.gift_id: (1.0 - (idx / len(candidates_list))) for idx, c in enumerate(candidates_list)}\n\n        # 4. Filter, Sort and pick Top N per query\n        per_query_final = []\n        for query in target_queries:\n            candidates = query_to_results.get(query, [])\n            scored = sorted(candidates, key=lambda x: id_to_score.get(x.gift_id, 0.0), reverse=True)\n            per_query_final.append(scored[:final_limit_per_query])\n\n        # 5. Interleave with Deduplication\n        final_list = []\n        seen_ids = set()\n\n        for i in range(final_limit_per_query):\n            for q_list in per_query_final:\n                if i &lt; len(q_list):\n                    p = q_list[i]\n                    if p.gift_id not in seen_ids:\n                        seen_ids.add(p.gift_id)\n                        final_list.append(GiftDTO(\n                            id=p.gift_id,\n                            title=p.title,\n                            description=p.description,\n                            price=float(p.price) if p.price else None,\n                            currency=p.currency or \"RUB\",\n                            image_url=p.image_url,\n                            product_url=p.product_url,\n                            merchant=p.merchant,\n                            category=p.category\n                        ))\n\n        # 6. Create HypothesisProductLink entries for the final list\n        if hypothesis_id:\n            try:\n                for idx, gift_dto in enumerate(final_list[:10]): # Log top 10 shown products\n                    link = HypothesisProductLink(\n                        hypothesis_id=hypothesis_id,\n                        gift_id=gift_dto.id,\n                        similarity_score=id_to_score.get(gift_dto.id, 0.0), # Use reranker score if available\n                        rank_position=idx + 1,\n                        was_shown=True\n                    )\n                    self.session.add(link)\n            except Exception as e:\n                logger.warning(f\"Failed to link products to hypothesis in find_preview_products: {e}\")\n\n        return final_list\n\n    async def get_deep_dive_products(\n        self, \n        search_queries: List[str], \n        hypothesis_title: str,\n        hypothesis_description: str,\n        max_price: Optional[int] = None,\n        session_id: Optional[str] = None,\n        hypothesis_id: Optional[uuid.UUID] = None,\n        track_title: Optional[str] = None,\n        llm_model: Optional[str] = None,\n        limit: int = 15\n    ) -&gt; List[GiftDTO]:\n        \"\"\"\n        Stage E: Deep Dive - Multi-query expansion + Reranking.\n        \"\"\"\n        logger.info(f\"Deep dive for hypothesis: {hypothesis_title}\")\n\n        # 1. Multi-query search (Parallel)\n        from app.core.logic_config import logic_config\n        effective_max_price = None\n        if max_price:\n            effective_max_price = int(max_price * (1 + logic_config.budget_margin_fraction))\n\n        async def _search_one(query: str):\n            query_vectors = await self.embedding_service.embed_batch_async([query])\n            if not query_vectors:\n                return []\n            return await self.repo.search_similar_products(\n                embedding=query_vectors[0],\n                limit=15,\n                is_active_only=True,\n                max_price=effective_max_price\n            )\n\n        search_tasks = [_search_one(q) for q in search_queries[:3]]\n        search_results_raw = await asyncio.gather(*search_tasks, return_exceptions=True)\n\n        search_results = []\n        for res in search_results_raw:\n            if isinstance(res, Exception):\n                logger.error(f\"Search task failed in get_deep_dive_products: {res}\")\n            else:\n                search_results.append(res)\n\n        all_candidates = {}\n        for results in search_results:\n            for c in results:\n                if c.gift_id not in all_candidates:\n                    all_candidates[c.gift_id] = c\n\n        candidates_list = list(all_candidates.values())\n        if not candidates_list:\n            # Log zero results for all queries\n            for q in search_queries[:3]:\n                 self.session.add(SearchLog(\n                     search_query=q,\n                     results_count=0,\n                     engine_version=\"deep_dive_v1\"\n                 ))\n            return []\n\n        # LOGGING: Log aggregate for deep dive\n        for q in search_queries[:3]:\n            self.session.add(SearchLog(\n                session_id=session_id,\n                hypothesis_id=hypothesis_id,\n                track_title=track_title,\n                hypothesis_title=hypothesis_title,\n                search_context=\"deep_dive\",\n                llm_model=llm_model or logic_config.model_smart,\n                search_query=q,\n                results_count=len(search_results[0]) if len(search_results) &gt; 0 else 0,\n                max_price=max_price,\n                engine_version=\"advanced_v1\"\n            ))\n\n        # 2. Reranking\n        doc_texts = [f\"{c.title} {c.description or ''}\" for c in candidates_list]\n        query_context = f\"{hypothesis_title} {hypothesis_description}\"\n\n        try:\n            scores = await self.intelligence_client.rerank(query_context, doc_texts)\n            id_to_score = {c.gift_id: score for c, score in zip(candidates_list, scores)}\n        except Exception as e:\n            logger.error(f\"RecommendationService: Deep dive reranking failed, falling back to vector order: {e}\")\n            # Proactive notification\n            notifier = get_notification_service()\n            await notifier.notify(\n                topic=\"intelligence_error\",\n                message=f\"Deep dive reranking failed for: {hypothesis_title}\",\n                data={\"error\": str(e)}\n            )\n            id_to_score = {c.gift_id: (1.0 - (idx / len(candidates_list))) for idx, c in enumerate(candidates_list)}\n\n        # Sort candidates list based on scores\n        candidates_list.sort(key=lambda x: id_to_score.get(x.gift_id, 0.0), reverse=True)\n        scored_products = candidates_list[:limit]\n\n        # 3. Final DTO conversion\n        results = []\n        for p in scored_products:\n            results.append(GiftDTO(\n                id=p.gift_id,\n                title=p.title,\n                description=p.description,\n                price=float(p.price) if p.price else None,\n                currency=p.currency or \"RUB\",\n                image_url=p.image_url,\n                product_url=p.product_url,\n                merchant=p.merchant,\n                category=p.category\n            ))\n\n        return results\n</code></pre>"},{"location":"api/services/#app.services.recommendation.RecommendationService-functions","title":"Functions","text":""},{"location":"api/services/#app.services.recommendation.RecommendationService.find_preview_products","title":"<code>find_preview_products(search_queries, hypothesis_title='', max_price=None, session_id=None, hypothesis_id=None, track_title=None, llm_model=None, search_context='preview', limit_per_query=None)</code>  <code>async</code>","text":"<p>Advanced retrieval for previews: 1. Flexible budget (max_price + margin from logic_config) 2. Parallel multi-query vector search 3. Global reranking and Interleaving</p> Source code in <code>app/services/recommendation.py</code> <pre><code>async def find_preview_products(\n    self, \n    search_queries: List[str], \n    hypothesis_title: str = \"\", \n    max_price: Optional[int] = None,\n    session_id: Optional[str] = None,\n    hypothesis_id: Optional[uuid.UUID] = None,\n    track_title: Optional[str] = None,\n    llm_model: Optional[str] = None,\n    search_context: str = \"preview\",\n    limit_per_query: Optional[int] = None\n) -&gt; List[GiftDTO]:\n    \"\"\"\n    Advanced retrieval for previews:\n    1. Flexible budget (max_price + margin from logic_config)\n    2. Parallel multi-query vector search\n    3. Global reranking and Interleaving\n    \"\"\"\n    from app.core.logic_config import logic_config\n\n    # Override config with parameter if provided\n    final_limit_per_query = limit_per_query or logic_config.items_per_query\n    target_queries = search_queries[:logic_config.max_queries_for_preview]\n\n    # 1. Flexible Budget\n    effective_max_price = None\n    if max_price:\n        effective_max_price = int(max_price * (1 + logic_config.budget_margin_fraction))\n\n    # 2. Parallel Vector Search for all queries\n    async def _fetch_for_query(query: str):\n        query_vectors = await self.embedding_service.embed_batch_async([query])\n        if not query_vectors:\n            return query, []\n\n        candidates = await self.repo.search_similar_products(\n            embedding=query_vectors[0],\n            limit=logic_config.rerank_candidate_limit,\n            is_active_only=True,\n            max_price=effective_max_price\n        )\n        return query, candidates\n\n    search_tasks = [_fetch_for_query(q) for q in target_queries]\n    search_results_raw = await asyncio.gather(*search_tasks, return_exceptions=True)\n\n    search_results = []\n    for res in search_results_raw:\n        if isinstance(res, Exception):\n            logger.error(f\"Search task failed in find_preview_products: {res}\")\n        else:\n            search_results.append(res)\n\n    # Map queries to their candidates and gather ALL unique candidates for reranking\n    query_to_results = {}\n    all_unique_candidates = {}\n\n    # LOGGING: Track coverage for each query\n    for res in search_results:\n        if isinstance(res, tuple):\n            query, candidates = res\n            query_to_results[query] = candidates\n\n            # Calculate simple metrics for logging\n            results_count = len(candidates)\n            top_sim = 0.0\n            avg_sim = 0.0\n            top_id = None\n\n            if candidates:\n                # In vector search similarity is not directly in Product model, \n                # but we can log that it found results.\n                # If we had access to the raw similarity scores from the repo, we'd log them here.\n                top_id = candidates[0].gift_id\n\n            # Create SearchLog entry\n            try:\n                log_entry = SearchLog(\n                    session_id=session_id,\n                    hypothesis_id=hypothesis_id,\n                    track_title=track_title,\n                    hypothesis_title=hypothesis_title,\n                    search_context=search_context,\n                    llm_model=llm_model or logic_config.model_smart,\n                    search_query=query,\n                    results_count=results_count,\n                    top_gift_id=top_id,\n                    max_price=max_price,\n                    engine_version=\"advanced_v1\"\n                )\n                self.session.add(log_entry)\n            except Exception as e:\n                logger.warning(f\"Failed to log search result: {e}\")\n\n            for c in candidates:\n                if c.gift_id not in all_unique_candidates:\n                    all_unique_candidates[c.gift_id] = c\n\n    candidates_list = list(all_unique_candidates.values())\n    if not candidates_list:\n        return []\n\n    # 3. Global Reranking\n    doc_texts = [f\"{c.title} {c.description or ''}\" for c in candidates_list]\n    query_context = hypothesis_title or \" \".join(target_queries[:2])\n\n    try:\n        scores = await self.intelligence_client.rerank(query_context, doc_texts)\n        id_to_score = {c.gift_id: score for c, score in zip(candidates_list, scores)}\n    except Exception as e:\n        logger.error(f\"RecommendationService: Reranking failed, falling back to vector scores: {e}\")\n        # Proactive notification\n        notifier = get_notification_service()\n        await notifier.notify(\n            topic=\"intelligence_error\",\n            message=f\"Reranking failed for hypothesis: {hypothesis_title}\",\n            data={\"error\": str(e), \"doc_count\": len(doc_texts)}\n        )\n        # Fallback: assign scores based on original retrieval order to maintain some ranking\n        id_to_score = {c.gift_id: (1.0 - (idx / len(candidates_list))) for idx, c in enumerate(candidates_list)}\n\n    # 4. Filter, Sort and pick Top N per query\n    per_query_final = []\n    for query in target_queries:\n        candidates = query_to_results.get(query, [])\n        scored = sorted(candidates, key=lambda x: id_to_score.get(x.gift_id, 0.0), reverse=True)\n        per_query_final.append(scored[:final_limit_per_query])\n\n    # 5. Interleave with Deduplication\n    final_list = []\n    seen_ids = set()\n\n    for i in range(final_limit_per_query):\n        for q_list in per_query_final:\n            if i &lt; len(q_list):\n                p = q_list[i]\n                if p.gift_id not in seen_ids:\n                    seen_ids.add(p.gift_id)\n                    final_list.append(GiftDTO(\n                        id=p.gift_id,\n                        title=p.title,\n                        description=p.description,\n                        price=float(p.price) if p.price else None,\n                        currency=p.currency or \"RUB\",\n                        image_url=p.image_url,\n                        product_url=p.product_url,\n                        merchant=p.merchant,\n                        category=p.category\n                    ))\n\n    # 6. Create HypothesisProductLink entries for the final list\n    if hypothesis_id:\n        try:\n            for idx, gift_dto in enumerate(final_list[:10]): # Log top 10 shown products\n                link = HypothesisProductLink(\n                    hypothesis_id=hypothesis_id,\n                    gift_id=gift_dto.id,\n                    similarity_score=id_to_score.get(gift_dto.id, 0.0), # Use reranker score if available\n                    rank_position=idx + 1,\n                    was_shown=True\n                )\n                self.session.add(link)\n        except Exception as e:\n            logger.warning(f\"Failed to link products to hypothesis in find_preview_products: {e}\")\n\n    return final_list\n</code></pre>"},{"location":"api/services/#app.services.recommendation.RecommendationService.generate_recommendations","title":"<code>generate_recommendations(request, engine_version='vector_v1')</code>  <code>async</code>","text":"<p>Main orchestration method for recommendation generation. Implements Stages A, B, C, D from the roadmap.</p> Source code in <code>app/services/recommendation.py</code> <pre><code>async def generate_recommendations(\n    self, \n    request: RecommendationRequest,\n    engine_version: str = \"vector_v1\"\n) -&gt; RecommendationResponse:\n    \"\"\"\n    Main orchestration method for recommendation generation.\n    Implements Stages A, B, C, D from the roadmap.\n    \"\"\"\n    logger.info(f\"Generating recommendations for request: {request}\")\n\n    # Stage A: Vector Retrieval\n    candidates = await self._retrieve_candidates(request)\n\n    # Stage B: CPU Ranker\n    ranked_candidates = await self._rank_candidates(request, candidates)\n\n    # Stage C: LLM-as-judge Rerank (Stub)\n    final_candidates = await self._judge_rerank(request, ranked_candidates)\n\n    # Stage D: Constraints Re-ranking (Diversity)\n    final_gifts_data = self._apply_final_rank_and_diversity(request, final_candidates)\n\n    gifts = [\n        GiftDTO(\n            id=g.gift_id,\n            title=g.title,\n            description=g.description,\n            price=g.price,\n            currency=g.currency,\n            image_url=g.image_url,\n            product_url=g.product_url,\n            merchant=g.merchant,\n            category=g.category\n        ) for g in final_gifts_data\n    ]\n    featured_gift = gifts[0] if gifts else None\n\n    return RecommendationResponse(\n        quiz_run_id=\"stub-id\", # TODO: integrate with quiz_run repo\n        engine_version=engine_version,\n        featured_gift=featured_gift,\n        gifts=gifts,\n        debug={\"status\": \"candidates_retrieved\", \"count\": len(candidates)} if request.debug else None\n    )\n</code></pre>"},{"location":"api/services/#app.services.recommendation.RecommendationService.get_deep_dive_products","title":"<code>get_deep_dive_products(search_queries, hypothesis_title, hypothesis_description, max_price=None, session_id=None, hypothesis_id=None, track_title=None, llm_model=None, limit=15)</code>  <code>async</code>","text":"<p>Stage E: Deep Dive - Multi-query expansion + Reranking.</p> Source code in <code>app/services/recommendation.py</code> <pre><code>async def get_deep_dive_products(\n    self, \n    search_queries: List[str], \n    hypothesis_title: str,\n    hypothesis_description: str,\n    max_price: Optional[int] = None,\n    session_id: Optional[str] = None,\n    hypothesis_id: Optional[uuid.UUID] = None,\n    track_title: Optional[str] = None,\n    llm_model: Optional[str] = None,\n    limit: int = 15\n) -&gt; List[GiftDTO]:\n    \"\"\"\n    Stage E: Deep Dive - Multi-query expansion + Reranking.\n    \"\"\"\n    logger.info(f\"Deep dive for hypothesis: {hypothesis_title}\")\n\n    # 1. Multi-query search (Parallel)\n    from app.core.logic_config import logic_config\n    effective_max_price = None\n    if max_price:\n        effective_max_price = int(max_price * (1 + logic_config.budget_margin_fraction))\n\n    async def _search_one(query: str):\n        query_vectors = await self.embedding_service.embed_batch_async([query])\n        if not query_vectors:\n            return []\n        return await self.repo.search_similar_products(\n            embedding=query_vectors[0],\n            limit=15,\n            is_active_only=True,\n            max_price=effective_max_price\n        )\n\n    search_tasks = [_search_one(q) for q in search_queries[:3]]\n    search_results_raw = await asyncio.gather(*search_tasks, return_exceptions=True)\n\n    search_results = []\n    for res in search_results_raw:\n        if isinstance(res, Exception):\n            logger.error(f\"Search task failed in get_deep_dive_products: {res}\")\n        else:\n            search_results.append(res)\n\n    all_candidates = {}\n    for results in search_results:\n        for c in results:\n            if c.gift_id not in all_candidates:\n                all_candidates[c.gift_id] = c\n\n    candidates_list = list(all_candidates.values())\n    if not candidates_list:\n        # Log zero results for all queries\n        for q in search_queries[:3]:\n             self.session.add(SearchLog(\n                 search_query=q,\n                 results_count=0,\n                 engine_version=\"deep_dive_v1\"\n             ))\n        return []\n\n    # LOGGING: Log aggregate for deep dive\n    for q in search_queries[:3]:\n        self.session.add(SearchLog(\n            session_id=session_id,\n            hypothesis_id=hypothesis_id,\n            track_title=track_title,\n            hypothesis_title=hypothesis_title,\n            search_context=\"deep_dive\",\n            llm_model=llm_model or logic_config.model_smart,\n            search_query=q,\n            results_count=len(search_results[0]) if len(search_results) &gt; 0 else 0,\n            max_price=max_price,\n            engine_version=\"advanced_v1\"\n        ))\n\n    # 2. Reranking\n    doc_texts = [f\"{c.title} {c.description or ''}\" for c in candidates_list]\n    query_context = f\"{hypothesis_title} {hypothesis_description}\"\n\n    try:\n        scores = await self.intelligence_client.rerank(query_context, doc_texts)\n        id_to_score = {c.gift_id: score for c, score in zip(candidates_list, scores)}\n    except Exception as e:\n        logger.error(f\"RecommendationService: Deep dive reranking failed, falling back to vector order: {e}\")\n        # Proactive notification\n        notifier = get_notification_service()\n        await notifier.notify(\n            topic=\"intelligence_error\",\n            message=f\"Deep dive reranking failed for: {hypothesis_title}\",\n            data={\"error\": str(e)}\n        )\n        id_to_score = {c.gift_id: (1.0 - (idx / len(candidates_list))) for idx, c in enumerate(candidates_list)}\n\n    # Sort candidates list based on scores\n    candidates_list.sort(key=lambda x: id_to_score.get(x.gift_id, 0.0), reverse=True)\n    scored_products = candidates_list[:limit]\n\n    # 3. Final DTO conversion\n    results = []\n    for p in scored_products:\n        results.append(GiftDTO(\n            id=p.gift_id,\n            title=p.title,\n            description=p.description,\n            price=float(p.price) if p.price else None,\n            currency=p.currency or \"RUB\",\n            image_url=p.image_url,\n            product_url=p.product_url,\n            merchant=p.merchant,\n            category=p.category\n        ))\n\n    return results\n</code></pre>"},{"location":"api/weeek/","title":"Weeek Integration API \ud83d\udd0c","text":"<p>\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u043c Weeek \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0432 \u0434\u0432\u0443\u0445 \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f\u0445:</p> <ol> <li>Internal API: \u0414\u043b\u044f \u0433\u043b\u0443\u0431\u043e\u043a\u043e\u0433\u043e \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f Telegram-\u0431\u043e\u0442\u0430 \u0441 \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438 \u043a\u043e\u043c\u0430\u043d\u0434\u044b.</li> <li>Integrations API: \u041f\u0440\u043e\u043a\u0441\u0438-\u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u044b \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u0441\u0442\u0430\u0442\u0443\u0441\u0430 \u0437\u0430\u0434\u0430\u0447 \u043f\u0440\u044f\u043c\u043e \u0432 \u044d\u0442\u043e\u0439 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438.</li> </ol>"},{"location":"api/weeek/#internal-weeek-api-telegram-bot","title":"\ud83d\udee0 Internal Weeek API (Telegram Bot)","text":"<p>\u042d\u0442\u0438 \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u044b \u0442\u0440\u0435\u0431\u0443\u044e\u0442 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0430 <code>X-Internal-Token</code> \u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u0431\u043e\u0442\u043e\u043c \u0434\u043b\u044f \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0440\u0430\u0431\u043e\u0447\u0438\u043c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u043c.</p>"},{"location":"api/weeek/#1-connect","title":"1. \u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430 (<code>/connect</code>)","text":"<p>\u041f\u0440\u0438\u0432\u044f\u0437\u044b\u0432\u0430\u0435\u0442 Telegram Chat ID \u043a API-\u0442\u043e\u043a\u0435\u043d\u0443 Weeek.</p> <ul> <li>URL: <code>/internal/weeek/connect</code></li> <li>\u041c\u0435\u0442\u043e\u0434: <code>POST</code></li> <li>Body:     <pre><code>{\n  \"telegram_chat_id\": 12345678,\n  \"weeek_api_token\": \"your_token_here\"\n}\n</code></pre></li> </ul>"},{"location":"api/weeek/#2-tasks","title":"2. \u0421\u043f\u0438\u0441\u043e\u043a \u0437\u0430\u0434\u0430\u0447 (<code>/tasks</code>)","text":"<p>\u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0438, \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u043d\u044b\u0435 \u043d\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f.</p> <ul> <li>URL: <code>/internal/weeek/tasks</code></li> <li>\u041c\u0435\u0442\u043e\u0434: <code>GET</code></li> <li>\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b:<ul> <li><code>telegram_chat_id</code>: ID \u0447\u0430\u0442\u0430 \u0422\u0413.</li> <li><code>type</code>: <code>all</code>, <code>today</code>, <code>tomorrow</code>, <code>overdue</code>.</li> </ul> </li> </ul>"},{"location":"api/weeek/#3","title":"3. \u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0435\u0439","text":"<ul> <li>\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435: <code>POST /internal/weeek/tasks</code> \u2014 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438.</li> <li>\u041f\u0435\u0440\u0435\u043d\u043e\u0441 \u0434\u0435\u0434\u043b\u0430\u0439\u043d\u0430: <code>POST /internal/weeek/tasks/{id}/reschedule</code> \u2014 \u043c\u0435\u043d\u044f\u0435\u0442 \u0434\u0430\u0442\u0443 \u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439 \u0441 \u043f\u0440\u0438\u0447\u0438\u043d\u043e\u0439.</li> <li>\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0435: <code>POST /internal/weeek/tasks/{id}/complete</code> \u2014 \u043e\u0442\u043c\u0435\u0447\u0430\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0443 \u043a\u0430\u043a \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u0443\u044e.</li> </ul>"},{"location":"api/weeek/#integrations-api-public-proxy","title":"\ud83c\udf10 Integrations API (Public Proxy)","text":"<p>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0444\u0440\u043e\u043d\u0442\u0435\u043d\u0434\u043e\u043c \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438 \u0434\u043b\u044f \u0432\u0441\u0442\u0430\u0432\u043a\u0438 \u0432\u0438\u0434\u0436\u0435\u0442\u043e\u0432 \u0441 \u0436\u0438\u0432\u044b\u043c \u0441\u0442\u0430\u0442\u0443\u0441\u043e\u043c \u0437\u0430\u0434\u0430\u0447.</p>"},{"location":"api/weeek/#1-weeektasks","title":"1. \u041f\u0440\u043e\u043a\u0441\u0438 \u0437\u0430\u0434\u0430\u0447 (<code>/weeek/tasks</code>)","text":"<p>\u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0437\u0430\u0434\u0430\u0447 \u0431\u0435\u0437 \u0440\u0430\u0441\u043a\u0440\u044b\u0442\u0438\u044f API-\u043a\u043b\u044e\u0447\u0430 \u043d\u0430 \u0444\u0440\u043e\u043d\u0442\u0435\u043d\u0434\u0435.</p> <ul> <li>URL: <code>/api/v1/integrations/weeek/tasks</code></li> <li>\u041c\u0435\u0442\u043e\u0434: <code>GET</code></li> <li>\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b: <code>projectId</code>, <code>boardId</code>, <code>tagNames</code>.</li> </ul>"},{"location":"api/weeek/#2-weeekdiscovery","title":"2. \u0414\u0438\u0441\u043a\u0430\u0432\u0435\u0440\u0438 (<code>/weeek/discovery</code>)","text":"<p>\u0412\u0441\u043f\u043e\u043c\u043e\u0433\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442 \u0434\u043b\u044f \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u043e\u0432, \u0447\u0442\u043e\u0431\u044b \u043d\u0430\u0439\u0442\u0438 ID \u043d\u0443\u0436\u043d\u044b\u0445 \u043f\u0440\u043e\u0435\u043a\u0442\u043e\u0432 \u0438 \u0434\u043e\u0441\u043e\u043a.</p> <ul> <li>URL: <code>/api/v1/integrations/weeek/discovery</code></li> <li>\u041c\u0435\u0442\u043e\u0434: <code>GET</code></li> </ul>"},{"location":"api/weeek_external/","title":"Weeek API Reference (Gifty Integration)","text":"<p>This document describes the Weeek API integration used in Gifty to provide live implementation status in the documentation.</p>"},{"location":"api/weeek_external/#base-url","title":"Base URL","text":"<p><code>https://api.weeek.net/public/v1</code></p>"},{"location":"api/weeek_external/#authentication","title":"Authentication","text":"<p>Bearer Token in <code>Authorization</code> header. Token is managed via <code>WEEEK_API_TOKEN</code> environment variable.</p>"},{"location":"api/weeek_external/#used-endpoints","title":"Used Endpoints","text":""},{"location":"api/weeek_external/#task-management-tm","title":"Task Management (TM)","text":""},{"location":"api/weeek_external/#get-tmtasks","title":"[GET] <code>/tm/tasks</code>","text":"<ul> <li>Purpose: Fetch tasks for a project/board/tags.</li> <li>Gifty Proxy: <code>GET /api/v1/integrations/weeek/tasks</code></li> </ul>"},{"location":"api/weeek_external/#get-tmtasksid","title":"[GET] <code>/tm/tasks/:id</code>","text":"<ul> <li>Purpose: Fetch a single task detail.</li> </ul>"},{"location":"api/weeek_external/#post-tmtasks","title":"[POST] <code>/tm/tasks</code>","text":"<ul> <li>Purpose: Create a new task.</li> </ul>"},{"location":"api/weeek_external/#put-tmtasksid","title":"[PUT] <code>/tm/tasks/:id</code>","text":"<ul> <li>Purpose: Update an existing task.</li> </ul>"},{"location":"api/weeek_external/#delete-tmtasksid","title":"[DELETE] <code>/tm/tasks/:id</code>","text":"<ul> <li>Purpose: Delete a task.</li> </ul>"},{"location":"api/weeek_external/#post-tmtasksidcomplete","title":"[POST] <code>/tm/tasks/:id/complete</code>","text":"<ul> <li>Purpose: Mark a task as completed.</li> </ul>"},{"location":"api/weeek_external/#post-tmtasksidun-complete","title":"[POST] <code>/tm/tasks/:id/un-complete</code>","text":"<ul> <li>Purpose: Mark a task as incomplete.</li> </ul>"},{"location":"api/weeek_external/#post-tmtasksidboard","title":"[POST] <code>/tm/tasks/:id/board</code>","text":"<ul> <li>Purpose: Move task to another board.</li> </ul>"},{"location":"api/weeek_external/#post-tmtasksidboard-column","title":"[POST] <code>/tm/tasks/:id/board-column</code>","text":"<ul> <li>Purpose: Move task to another column.</li> </ul>"},{"location":"api/weeek_external/#postdelete-tmtasksidassignees","title":"[POST/DELETE] <code>/tm/tasks/:id/assignees</code>","text":"<ul> <li>Purpose: Manage task assignees.</li> </ul>"},{"location":"api/weeek_external/#board-column-management","title":"Board &amp; Column Management","text":""},{"location":"api/weeek_external/#get-tmboards","title":"[GET] <code>/tm/boards</code>","text":"<ul> <li>Purpose: List boards (supports <code>projectId</code> filter).</li> </ul>"},{"location":"api/weeek_external/#post-tmboards","title":"[POST] <code>/tm/boards</code>","text":"<ul> <li>Purpose: Create a new board.</li> </ul>"},{"location":"api/weeek_external/#delete-tmboardsid","title":"[DELETE] <code>/tm/boards/:id</code>","text":"<ul> <li>Purpose: Delete a board.</li> </ul>"},{"location":"api/weeek_external/#get-tmboard-columns","title":"[GET] <code>/tm/board-columns</code>","text":"<ul> <li>Purpose: List columns for a board.</li> </ul>"},{"location":"api/weeek_external/#postputdelete-tmboard-columns","title":"[POST/PUT/DELETE] <code>/tm/board-columns</code>","text":"<ul> <li>Purpose: Manage columns within a board.</li> </ul>"},{"location":"api/weeek_external/#workspace-tags-ws","title":"Workspace &amp; Tags (WS)","text":""},{"location":"api/weeek_external/#get-wstags","title":"[GET] <code>/ws/tags</code>","text":"<ul> <li>Purpose: List all workspace tags.</li> </ul>"},{"location":"api/weeek_external/#post-wstags","title":"[POST] <code>/ws/tags</code>","text":"<ul> <li>Purpose: Create a new tag.</li> </ul>"},{"location":"api/weeek_external/#gifty-integration-logic","title":"Gifty Integration Logic","text":""},{"location":"api/weeek_external/#backend-proxy-approutesintegrationspy","title":"Backend Proxy (<code>app/routes/integrations.py</code>)","text":"<p>To avoid exposing the API key to the frontend, all documentation requests are proxied through our backend.</p>"},{"location":"api/weeek_external/#cleanup-script-scriptscleanup_weeekpy","title":"Cleanup Script (<code>scripts/cleanup_weeek.py</code>)","text":"<p>A maintenance script to remove duplicate boards and maintain workspace hygiene.</p>"},{"location":"api/weeek_external/#frontend-widget-docsjavascriptsweeekjs","title":"Frontend Widget (<code>docs/javascripts/weeek.js</code>)","text":"<p>A lightweight JS component that scans for <code>&lt;div class=\"weeek-tracker\"&gt;</code> and renders a live status list. It supports: - <code>data-project-id</code> - <code>data-tags</code> (by ID) - <code>data-tag-names</code> (by name, resolved on backend)</p>"},{"location":"api/analytics/coverage/","title":"\u041e\u0445\u0432\u0430\u0442 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430 \ud83d\udce6","text":"<p>\u0410\u043d\u0430\u043b\u0438\u0437 \u0442\u043e\u0433\u043e, \u043d\u0430\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0442\u043e\u0432\u0430\u0440\u044b \u0432 \u0431\u0430\u0437\u0435 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u043f\u043e\u0438\u0441\u043a\u043e\u0432\u044b\u043c \u0437\u0430\u043f\u0440\u043e\u0441\u0430\u043c \u043e\u0442 \u0418\u0418.</p>"},{"location":"api/analytics/coverage/#catalogcoverage","title":"\u041e\u0431\u0437\u043e\u0440 \u043e\u0445\u0432\u0430\u0442\u0430 (<code>catalogCoverage</code>)","text":"<p>\u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0443\u0437\u043d\u0430\u0442\u044c Hit Rate (\u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u0443\u0441\u043f\u0435\u0448\u043d\u044b\u0445 \u043f\u043e\u0438\u0441\u043a\u043e\u0432) \u0438 \u0432\u044b\u044f\u0432\u0438\u0442\u044c \"\u0434\u044b\u0440\u044b\" \u0432 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0435.</p> <p>Query: <pre><code>query GetCoverage($days: Int!) {\n  catalogCoverage(days: $days) {\n    totalSearches\n    hitRate\n    avgResultsPerSearch\n    topCatalogGaps {\n      query\n      misses\n    }\n  }\n}\n</code></pre></p> <p>\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043f\u043e\u043b\u0435\u0439: - <code>hitRate</code>: \u041f\u0440\u043e\u0446\u0435\u043d\u0442 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432, \u043f\u043e \u043a\u043e\u0442\u043e\u0440\u044b\u043c \u0431\u044b\u043b \u043d\u0430\u0439\u0434\u0435\u043d \u0445\u043e\u0442\u044f \u0431\u044b \u043e\u0434\u0438\u043d \u0442\u043e\u0432\u0430\u0440. - <code>topCatalogGaps</code>: \u0421\u043f\u0438\u0441\u043e\u043a \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0447\u0430\u0449\u0435 \u0432\u0441\u0435\u0433\u043e \u0432\u044b\u0434\u0430\u0432\u0430\u043b\u0438 0 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432 (\u0441\u0438\u0433\u043d\u0430\u043b \u0434\u043b\u044f \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043d\u043e\u0432\u044b\u0445 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u043e\u0432 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0430).</p>"},{"location":"api/analytics/kpi/","title":"\u0411\u0438\u0437\u043d\u0435\u0441-\u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u0438 KPI \ud83d\udcca","text":"<p>\u0412\u0441\u0435 \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u0435\u043b\u0438 \u0442\u0435\u043f\u0435\u0440\u044c \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0447\u0435\u0440\u0435\u0437 \u043e\u0434\u0438\u043d GraphQL \u0437\u0430\u043f\u0440\u043e\u0441.</p>"},{"location":"api/analytics/kpi/#stats","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043c\u0435\u0442\u0440\u0438\u043a\u0438 (<code>stats</code>)","text":"<p>\u0417\u0430\u043f\u0440\u043e\u0441 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 DAU, \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u043a\u0432\u0438\u0437\u0430 \u0438 CTR \u043f\u043e\u0434\u0430\u0440\u043a\u043e\u0432.</p> <p>Query: <pre><code>query {\n  stats {\n    dau\n    quizCompletionRate\n    giftCtr\n    totalSessions\n    lastUpdated\n  }\n}\n</code></pre></p>"},{"location":"api/analytics/kpi/#trends","title":"\u0422\u0440\u0435\u043d\u0434\u044b \u0438 \u0413\u0440\u0430\u0444\u0438\u043a\u0438 (<code>trends</code>)","text":"<p>\u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0440\u044f\u0434\u044b \u0434\u043b\u044f \u043f\u043e\u0441\u0442\u0440\u043e\u0435\u043d\u0438\u044f \u0433\u0440\u0430\u0444\u0438\u043a\u043e\u0432.</p> <p>Query: <pre><code>query GetTrends($days: Int!) {\n  trends(days: $days) {\n    dates\n    dauTrend\n    quizStarts\n    lastUpdated\n  }\n}\n</code></pre></p>"},{"location":"api/analytics/kpi/#funnel","title":"\u0412\u043e\u0440\u043e\u043d\u043a\u0430 \u041a\u043e\u043d\u0432\u0435\u0440\u0441\u0438\u0438 (<code>funnel</code>)","text":"<p>\u0414\u0430\u043d\u043d\u044b\u0435 \u043e \u043f\u0440\u043e\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0445 \u044d\u0442\u0430\u043f\u043e\u0432 \u0437\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435 30 \u0434\u043d\u0435\u0439.</p> <p>Query: <pre><code>query {\n  funnel {\n    name\n    count\n    conversionRate\n  }\n}\n</code></pre></p>"},{"location":"api/analytics/monitoring/","title":"\u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u0438 \u0417\u0434\u043e\u0440\u043e\u0432\u044c\u0435 \ud83d\udee0\ufe0f","text":"<p>\u0422\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0438 \u0441\u0442\u0430\u0442\u0443\u0441 \u043f\u0430\u0440\u0441\u0435\u0440\u043e\u0432.</p>"},{"location":"api/analytics/monitoring/#technical","title":"\u0422\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 (<code>technical</code>)","text":"<p>\u0414\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 Prometheus \u0438 \u043b\u043e\u0433\u0438 \u043e\u0448\u0438\u0431\u043e\u043a \u0438\u0437 Loki.</p> <p>Query: <pre><code>query {\n  technical {\n    apiHealth\n    requestsPerMinute\n    errorRate5xx\n    lastErrors\n    lastUpdated\n  }\n}\n</code></pre></p>"},{"location":"api/analytics/monitoring/#scraping","title":"\u0421\u0442\u0430\u0442\u0443\u0441 \u041f\u0430\u0440\u0441\u0435\u0440\u043e\u0432 (<code>scraping</code>)","text":"<p>\u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 \u0441\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445.</p> <p>Query: <pre><code>query {\n  scraping {\n    activeSources\n    unmappedCategories\n    totalScrapedItems\n    ingestionErrors\n    spiders\n  }\n}\n</code></pre></p> <p>\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435: - <code>unmappedCategories</code>: \u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u0432\u043d\u0435\u0448\u043d\u0438\u0445 \u0441\u0430\u0439\u0442\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0435\u0449\u0435 \u043d\u0435 \u043f\u0440\u0438\u0432\u044f\u0437\u0430\u043d\u044b \u043a \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u0439 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0435 Gifty (\u0442\u0440\u0435\u0431\u0443\u044e\u0442 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u044f \u0418\u0418 \u0438\u043b\u0438 \u0430\u0434\u043c\u0438\u043d\u0430). - <code>spiders</code>: \u0414\u0435\u0442\u0430\u043b\u044c\u043d\u0430\u044f \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u043f\u043e \u043a\u0430\u0436\u0434\u043e\u043c\u0443 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u043c\u0443 \u043f\u0430\u0443\u043a\u0443 (Scrapy).</p>"},{"location":"api/analytics/overview/","title":"\u041e\u0431\u0437\u043e\u0440 Analytics API \ud83d\udcc8","text":"<p>\u0412\u0435\u0441\u044c \u0440\u0430\u0437\u0434\u0435\u043b \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0438 Gifty \u043f\u0435\u0440\u0435\u0432\u0435\u0434\u0435\u043d \u043d\u0430 GraphQL. \u042d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0444\u0440\u043e\u043d\u0442\u0435\u043d\u0434\u0443 \u0437\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0442\u044c \u0438\u043c\u0435\u043d\u043d\u043e \u0442\u0435 \u0434\u0430\u043d\u043d\u044b\u0435, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b \u0434\u043b\u044f \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0434\u0430\u0448\u0431\u043e\u0440\u0434\u0430, \u043c\u0438\u043d\u0438\u043c\u0438\u0437\u0438\u0440\u0443\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0443 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440.</p> <p>API \u0432\u044b\u0441\u0442\u0443\u043f\u0430\u0435\u0442 \u0432 \u0440\u043e\u043b\u0438 \u0437\u0430\u0449\u0438\u0449\u0435\u043d\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u043a\u0441\u0438 \u043c\u0435\u0436\u0434\u0443 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u043c \u0434\u0430\u0448\u0431\u043e\u0440\u0434\u043e\u043c \u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u0430\u043c\u0438 \u0441\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 (PostHog, Prometheus, PostgreSQL).</p>"},{"location":"api/analytics/overview/#_1","title":"\u0410\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f","text":"<p>\u0412\u0441\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043a Analytics GraphQL API \u0442\u0440\u0435\u0431\u0443\u044e\u0442 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0442\u043e\u043a\u0435\u043d\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0432 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0435 <code>X-Analytics-Token</code>.</p> \u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 <code>X-Analytics-Token</code> \u0421\u0435\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u0442\u043e\u043a\u0435\u043d, \u0437\u0430\u0434\u0430\u043d\u043d\u044b\u0439 \u0432 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430\u0445 (<code>ANALYTICS_API_TOKEN</code>)."},{"location":"api/analytics/overview/#_2","title":"\u042d\u043d\u0434\u043f\u043e\u0438\u043d\u0442","text":"<p>\u0412\u0441\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u043d\u0430 \u0435\u0434\u0438\u043d\u044b\u0439 \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442: - URL: <code>/api/v1/analytics/graphql</code> - \u041c\u0435\u0442\u043e\u0434: <code>POST</code> (\u0438\u043b\u0438 <code>GET</code> \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a GraphiQL \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435)</p>"},{"location":"api/analytics/overview/#_3","title":"\u041a\u044d\u0448\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435","text":"<p>\u0414\u043b\u044f \u0441\u043d\u0438\u0436\u0435\u043d\u0438\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043d\u0430 \u0432\u043d\u0435\u0448\u043d\u0438\u0435 \u0441\u0435\u0440\u0432\u0438\u0441\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f Redis:</p> <ul> <li>\u041f\u043e\u0432\u0435\u0434\u0435\u043d\u0447\u0435\u0441\u043a\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 (PostHog): 5-10 \u043c\u0438\u043d\u0443\u0442.</li> <li>\u0422\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u043c\u0435\u0442\u0440\u0438\u043a\u0438 (Prometheus): 1 \u043c\u0438\u043d\u0443\u0442\u0430.</li> <li>\u0417\u0434\u043e\u0440\u043e\u0432\u044c\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u044b (PostgreSQL): 5 \u043c\u0438\u043d\u0443\u0442.</li> </ul>"},{"location":"api/analytics/recommendations/","title":"AI-\u0413\u0438\u043f\u043e\u0442\u0435\u0437\u044b \u0438 \u0420\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0438 \u2728","text":"<p>\u0410\u043d\u0430\u043b\u0438\u0437 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0430 \u0440\u0430\u0431\u043e\u0442\u044b \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u0434\u0432\u0438\u0436\u043a\u0430.</p>"},{"location":"api/analytics/recommendations/#systemhealth","title":"\u0417\u0434\u043e\u0440\u043e\u0432\u044c\u0435 \u0421\u0438\u0441\u0442\u0435\u043c\u044b (<code>systemHealth</code>)","text":"<p>\u0421\u0432\u043e\u0434\u043d\u044b\u0439 \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u0435\u043b\u044c (Health Score), \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u044e\u0449\u0438\u0439 \u043e\u0445\u0432\u0430\u0442 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430 \u0438 \u0440\u0435\u0430\u043a\u0446\u0438\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439.</p> <p>Query: <pre><code>query {\n  systemHealth {\n    healthScore\n    status\n    catalogCoverage {\n      score\n      hitRate\n    }\n    recommendationRelevance {\n      score\n      likeRate\n    }\n    searchLatency {\n      avgMs\n    }\n  }\n}\n</code></pre></p>"},{"location":"api/analytics/recommendations/#hypothesisdetails","title":"\u0414\u0435\u0442\u0430\u043b\u0438 \u0413\u0438\u043f\u043e\u0442\u0435\u0437\u044b (<code>hypothesisDetails</code>)","text":"<p>\u0423\u0433\u043b\u0443\u0431\u043b\u0435\u043d\u043d\u044b\u0439 \u0430\u043d\u0430\u043b\u0438\u0437 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0439 \u0438\u0434\u0435\u0438 \u043f\u043e\u0434\u0430\u0440\u043a\u0430: \u043a\u0430\u043a\u0438\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u0434\u0435\u043b\u0430\u043b \u0418\u0418, \u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u043d\u0430\u0448\u0435\u043b \u0438 \u043a\u0430\u043a\u0438\u0435 \u0438\u043c\u0435\u043d\u043d\u043e \u0442\u043e\u0432\u0430\u0440\u044b \u0431\u044b\u043b\u0438 \u043f\u043e\u043a\u0430\u0437\u0430\u043d\u044b.</p> <p>Query: <pre><code>query GetHypothesis($id: UUID!) {\n  hypothesisDetails(id: $id) {\n    id\n    title\n    reaction\n    searchQueries\n    totalResultsFound\n    products\n  }\n}\n</code></pre></p>"},{"location":"engineering/configuration/","title":"\u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 (Tiered Config)","text":"<p>\u0412 Gifty \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0440\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a \u043d\u0430 \u0434\u0432\u0430 \u0443\u0440\u043e\u0432\u043d\u044f \u0434\u043b\u044f \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0435\u043d\u0438\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438, \u0433\u0438\u0431\u043a\u043e\u0441\u0442\u0438 \u0438 \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438.</p>"},{"location":"engineering/configuration/#1-env","title":"\u0423\u0440\u043e\u0432\u0435\u043d\u044c 1: \u0418\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0438 \u0421\u0435\u043a\u0440\u0435\u0442\u044b (<code>.env</code>)","text":"<p>\u042d\u0442\u043e\u0442 \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d \u0434\u043b\u044f \u0434\u0430\u043d\u043d\u044b\u0445, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0435 \u0434\u043e\u043b\u0436\u043d\u044b \u043f\u043e\u043f\u0430\u0434\u0430\u0442\u044c \u0432 Git \u0438 \u0437\u0430\u0432\u0438\u0441\u044f\u0442 \u043e\u0442 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0439 \u0441\u0440\u0435\u0434\u044b (dev, staging, prod).</p> <p>\u0424\u0430\u0439\u043b\u044b: <code>.env</code>, <code>.env.prod</code>.</p> <p>\u0427\u0442\u043e \u0437\u0434\u0435\u0441\u044c \u0445\u0440\u0430\u043d\u0438\u0442\u0441\u044f: - \u0421\u0435\u043a\u0440\u0435\u0442\u044b: API \u043a\u043b\u044e\u0447\u0438 (Anthropic, RunPod, Google \u0438 \u0442.\u0434.). - \u0414\u043e\u0441\u0442\u0443\u043f\u044b \u043a \u0411\u0414: <code>DATABASE_URL</code>, <code>REDIS_URL</code>, <code>RABBITMQ_URL</code>. - \u0424\u043b\u0430\u0433\u0438 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f: <code>DEBUG</code>, <code>ENV</code>.</p> <p>\u0414\u043e\u0441\u0442\u0443\u043f \u0432 \u043a\u043e\u0434\u0435: <pre><code>from app.config import get_settings\nsettings = get_settings()\nprint(settings.anthropic_api_key)\n</code></pre></p>"},{"location":"engineering/configuration/#2-configslogicyaml","title":"\u0423\u0440\u043e\u0432\u0435\u043d\u044c 2: \u0411\u0438\u0437\u043d\u0435\u0441-\u043b\u043e\u0433\u0438\u043a\u0430 \u0438 \u043c\u043e\u0434\u0435\u043b\u0438 (<code>configs/logic.yaml</code>)","text":"<p>\u042d\u0442\u043e\u0442 \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d \u0434\u043b\u044f \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u044e\u0442 \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f. \u042d\u0442\u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u044b \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u0441\u0440\u0435\u0434 \u0438 \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0432 Git.</p> <p>\u0424\u0430\u0439\u043b\u044b: <code>configs/logic.yaml</code>.</p> <p>\u0427\u0442\u043e \u0437\u0434\u0435\u0441\u044c \u0445\u0440\u0430\u043d\u0438\u0442\u0441\u044f: - \u0412\u044b\u0431\u043e\u0440 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u0430: \u041a\u0430\u043a\u0443\u044e LLM \u0438\u043b\u0438 \u0441\u0435\u0440\u0432\u0438\u0441 \u044d\u043c\u0431\u0435\u0434\u0434\u0438\u043d\u0433\u043e\u0432 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e. - \u041c\u043e\u0434\u0435\u043b\u0438: \u041d\u0430\u0437\u0432\u0430\u043d\u0438\u044f \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0445 \u043c\u043e\u0434\u0435\u043b\u0435\u0439 (<code>claude-3-haiku</code>, <code>bge-m3</code>). - \u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u044b: \u041f\u043e\u0440\u043e\u0433\u0438 (thresholds), \u043b\u0438\u043c\u0438\u0442\u044b \u0432\u044b\u0434\u0430\u0447\u0438, \u043a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442\u044b \u0431\u044e\u0434\u0436\u0435\u0442\u0430. - \u0412\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u0444\u0438\u0447: Feature flags.</p> <p>\u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 <code>logic.yaml</code>: <pre><code>recommendation:\n  budget_margin_fraction: 0.1 # \u041d\u0430 \u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043c\u043e\u0436\u043d\u043e \u043f\u0440\u0435\u0432\u044b\u0441\u0438\u0442\u044c \u0431\u044e\u0434\u0436\u0435\u0442\n  items_per_query: 4          # \u041a\u043e\u043b-\u0432\u043e \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u043d\u0430 \u043e\u0434\u0438\u043d \u0437\u0430\u043f\u0440\u043e\u0441\n\nllm:\n  default_provider: \"anthropic\"\n  embedding_provider: \"runpod\"\n  model_fast: \"claude-3-haiku-20240307\"\n</code></pre></p> <p>\u0414\u043e\u0441\u0442\u0443\u043f \u0432 \u043a\u043e\u0434\u0435: <pre><code>from app.core.logic_config import logic_config\n\n# \u0414\u043e\u0441\u0442\u0443\u043f \u043a \u0441\u0433\u0440\u0443\u043f\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u043c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430\u043c\nprint(logic_config.llm.default_provider)\nprint(logic_config.recommendation.items_per_query)\n\n# \u041e\u0431\u0440\u0430\u0442\u043d\u0430\u044f \u0441\u043e\u0432\u043c\u0435\u0441\u0442\u0438\u043c\u043e\u0441\u0442\u044c (\u043a\u043e\u0440\u043e\u0442\u043a\u0438\u0435 \u0430\u043b\u0438\u0430\u0441\u044b)\nprint(logic_config.model_fast)\n</code></pre></p>"},{"location":"engineering/configuration/#_1","title":"\u041f\u043e\u0447\u0435\u043c\u0443 \u044d\u0442\u043e \u0443\u0434\u043e\u0431\u043d\u043e?","text":"<ol> <li>\u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c: \u0412\u044b \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u043e \u043d\u0435 \u0437\u0430\u043a\u043e\u043c\u043c\u0438\u0442\u0438\u0442\u0435 API \u043a\u043b\u044e\u0447 \u0432 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439, \u0442\u0430\u043a \u043a\u0430\u043a \u043e\u043d\u0438 \u043e\u0442\u0434\u0435\u043b\u0435\u043d\u044b \u043e\u0442 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a \u043c\u043e\u0434\u0435\u043b\u0435\u0439.</li> <li>\u0413\u043e\u0440\u044f\u0447\u0430\u044f \u0437\u0430\u043c\u0435\u043d\u0430: \u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u0430 LLM (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0441 Anthropic \u043d\u0430 Groq \u0438\u043b\u0438 Gemini) \u043f\u0440\u043e\u0441\u0442\u044b\u043c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435\u043c \u0432 YAML-\u0444\u0430\u0439\u043b\u0435.</li> <li>\u0427\u0438\u0442\u0430\u0435\u043c\u043e\u0441\u0442\u044c: \u0412\u0441\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u0430 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439 \u0441\u043e\u0431\u0440\u0430\u043d\u044b \u0432 \u043e\u0434\u043d\u043e\u043c \u043d\u0430\u0433\u043b\u044f\u0434\u043d\u043e\u043c \u0444\u0430\u0439\u043b\u0435, \u0430 \u043d\u0435 \u0440\u0430\u0437\u0431\u0440\u043e\u0441\u0430\u043d\u044b \u043f\u043e \u0434\u043b\u0438\u043d\u043d\u043e\u043c\u0443 \u0441\u043f\u0438\u0441\u043a\u0443 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f.</li> <li>\u0422\u0438\u043f\u0438\u0437\u0430\u0446\u0438\u044f: \u0411\u043b\u0430\u0433\u043e\u0434\u0430\u0440\u044f Pydantic, \u0435\u0441\u043b\u0438 \u0432\u044b \u0441\u043e\u0432\u0435\u0440\u0448\u0438\u0442\u0435 \u043e\u043f\u0435\u0447\u0430\u0442\u043a\u0443 \u0432 \u0442\u0438\u043f\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u043d\u0430\u043f\u0438\u0448\u0435\u0442\u0435 \u0441\u0442\u0440\u043e\u043a\u0443 \u0432\u043c\u0435\u0441\u0442\u043e \u0447\u0438\u0441\u043b\u0430) \u0432 YAML, \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0432\u044b\u0434\u0430\u0441\u0442 \u043f\u043e\u043d\u044f\u0442\u043d\u0443\u044e \u043e\u0448\u0438\u0431\u043a\u0443 \u043f\u0440\u0438 \u0441\u0442\u0430\u0440\u0442\u0435.</li> </ol>"},{"location":"engineering/configuration/#smoke-tests","title":"\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 (Smoke Tests)","text":"<p>\u0427\u0442\u043e\u0431\u044b \u0443\u0431\u0435\u0434\u0438\u0442\u044c\u0441\u044f, \u0447\u0442\u043e \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0439 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d \u0432\u0435\u0440\u043d\u043e \u0438 \u043a\u043b\u044e\u0447\u0438 \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0442, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0435 smoke-\u0442\u0435\u0441\u0442\u044b:</p> <pre><code># \u041f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0439 LLM \u0438 Embedding \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\npytest tests/llm/test_providers_smoke.py -v -s\n</code></pre> <p>\u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0442\u044c \u0440\u0430\u0437\u043d\u044b\u0445 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u043e\u0432, \u043f\u0435\u0440\u0435\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u044f \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043f\u0440\u044f\u043c\u043e \u0432 \u043a\u043e\u043c\u0430\u043d\u0434\u0435:</p> <pre><code># \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 Together AI \u0434\u043b\u044f LLM\nLLM_PROVIDER=together TOGETHER_API_KEY=xxx pytest tests/llm/test_providers_smoke.py\n\n# \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 RunPod \u0434\u043b\u044f \u044d\u043c\u0431\u0435\u0434\u0434\u0438\u043d\u0433\u043e\u0432\nRUNPOD_API_KEY=xxx RUNPOD_ENDPOINT_ID=yyy pytest tests/llm/test_providers_smoke.py\n</code></pre> <p>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u0442\u0435\u0441\u0442\u043e\u0432 \u043f\u043e\u043a\u0430\u0436\u0443\u0442, \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043b\u0438 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043e\u0442\u0432\u0435\u0442 \u043e\u0442 API \u0438 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b \u043b\u0438 \u0444\u043e\u0440\u043c\u0430\u0442\u044b \u0434\u0430\u043d\u043d\u044b\u0445.</p>"},{"location":"engineering/deployment/","title":"\u0420\u0443\u043a\u043e\u0432\u043e\u0434\u0441\u0442\u0432\u043e \u043f\u043e \u0434\u0435\u043f\u043b\u043e\u044e (CI/CD)","text":"<p>\u0412 Gifty \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0441\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0439 \u043f\u0430\u0439\u043f\u043b\u0430\u0439\u043d \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0434\u0435\u043f\u043b\u043e\u044f, \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u044e\u0449\u0438\u0439 Zero-Downtime (\u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0438\u0435 \u043f\u0440\u043e\u0441\u0442\u043e\u0435\u0432) \u0438 \u0433\u0430\u0440\u0430\u043d\u0442\u0438\u0440\u0443\u044e\u0449\u0438\u0439 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u043a\u043e\u0434\u0430 \u0447\u0435\u0440\u0435\u0437 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435.</p>"},{"location":"engineering/deployment/#_1","title":"\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 \u0434\u0435\u043f\u043b\u043e\u044f","text":"<p>\u041c\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044e Blue-Green Deployment (\u0421\u0438\u043d\u0435-\u0437\u0435\u043b\u0435\u043d\u043e\u0435 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435) \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c Nginx \u043d\u0430 \u0445\u043e\u0441\u0442\u043e\u0432\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u0435 \u0438 Docker Compose \u0434\u043b\u044f \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0438\u0437\u0430\u0446\u0438\u0438.</p>"},{"location":"engineering/deployment/#_2","title":"\u041a\u0430\u043a \u044d\u0442\u043e \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442:","text":"<ol> <li>\u0414\u0432\u0430 \u0441\u043b\u043e\u0442\u0430: \u041d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 \u0437\u0430\u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u043e \u0434\u0432\u0430 \u043f\u043e\u0440\u0442\u0430: <code>8000</code> \u0438 <code>8001</code>.</li> <li>Health Checks: \u041d\u043e\u0432\u0430\u044f \u0432\u0435\u0440\u0441\u0438\u044f \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u0432 \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e\u043c \"\u0441\u043b\u043e\u0442\u0435\". Docker \u0438 \u043d\u0430\u0448 \u0441\u043a\u0440\u0438\u043f\u0442 \u0434\u0435\u043f\u043b\u043e\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u044e\u0442 \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442 <code>/health</code>.</li> <li>\u0411\u0435\u0441\u0448\u043e\u0432\u043d\u043e\u0435 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435: Nginx \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0442\u0440\u0430\u0444\u0438\u043a \u043d\u0430 \u043d\u043e\u0432\u044b\u0439 \u043f\u043e\u0440\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u0441\u043b\u0435 \u0442\u043e\u0433\u043e, \u043a\u0430\u043a \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u043b\u043e \u0441\u0432\u043e\u044e \u0433\u043e\u0442\u043e\u0432\u043d\u043e\u0441\u0442\u044c.</li> <li>\u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u044b\u0439 \u043e\u0442\u043a\u0430\u0442: \u0415\u0441\u043b\u0438 \u043d\u043e\u0432\u0430\u044f \u0432\u0435\u0440\u0441\u0438\u044f \u043d\u0435 \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u043b\u0430\u0441\u044c, \u0441\u0442\u0430\u0440\u0430\u044f \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0430\u0435\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0431\u0435\u0437 \u043f\u0440\u0435\u0440\u044b\u0432\u0430\u043d\u0438\u044f \u043e\u0431\u0441\u043b\u0443\u0436\u0438\u0432\u0430\u043d\u0438\u044f.</li> </ol>"},{"location":"engineering/deployment/#github-actions","title":"\u041f\u0430\u0439\u043f\u043b\u0430\u0439\u043d GitHub Actions","text":"<p>\u041f\u0440\u043e\u0446\u0435\u0441\u0441 \u0434\u0435\u043f\u043b\u043e\u044f \u043e\u043f\u0438\u0441\u0430\u043d \u0432 \u0444\u0430\u0439\u043b\u0435 <code>.github/workflows/deploy-prod.yml</code>. \u041e\u043d \u0441\u043e\u0441\u0442\u043e\u0438\u0442 \u0438\u0437 \u0434\u0432\u0443\u0445 \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0445 \u044d\u0442\u0430\u043f\u043e\u0432:</p>"},{"location":"engineering/deployment/#1-test","title":"1. \u042d\u0442\u0430\u043f \u0422\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f (<code>test</code>)","text":"<p>\u0417\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u043d\u0430 \u043a\u0430\u0436\u0434\u043e\u043c \u043f\u0443\u0448\u0435 \u0432 <code>main</code>. </p> <ul> <li>\u041f\u043e\u0434\u043d\u0438\u043c\u0430\u0435\u0442 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u0435 (Python 3.11).</li> <li>\u0423\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438.</li> <li>\u0417\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442 <code>pytest</code> \u0441 \u0443\u0447\u0435\u0442\u043e\u043c \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a \u0432 <code>tests_config.yaml</code>.</li> <li>\u0415\u0441\u043b\u0438 \u0442\u0435\u0441\u0442\u044b \u0443\u043f\u0430\u043b\u0438, \u0434\u0435\u043f\u043b\u043e\u0439 \u043d\u0435 \u043d\u0430\u0447\u043d\u0435\u0442\u0441\u044f.</li> </ul>"},{"location":"engineering/deployment/#2-deploy","title":"2. \u042d\u0442\u0430\u043f \u0414\u0435\u043f\u043b\u043e\u044f (<code>deploy</code>)","text":"<p>\u0417\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u043f\u043e SSH \u043d\u0430 \u0446\u0435\u043b\u0435\u0432\u043e\u043c \u0441\u0435\u0440\u0432\u0435\u0440\u0435:</p> <ul> <li>SCP: \u041a\u043e\u043f\u0438\u0440\u0443\u0435\u0442 \u0430\u043a\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u043a\u043e\u0434 \u0432 \u043f\u0430\u043f\u043a\u0443 <code>/app/gifty-backend</code>.</li> <li>Build: \u0421\u043e\u0431\u0438\u0440\u0430\u0435\u0442 \u043d\u043e\u0432\u044b\u0439 Docker-\u043e\u0431\u0440\u0430\u0437.</li> <li>Switch: \u0412\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442 \u0441\u043a\u0440\u0438\u043f\u0442 <code>scripts/deploy.sh</code> \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043f\u043e\u0440\u0442\u043e\u0432 \u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0430 Nginx.</li> </ul>"},{"location":"engineering/deployment/#_3","title":"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430","text":"<p>\u0414\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0434\u0435\u043f\u043b\u043e\u044f \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u044b \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u0443\u0441\u043b\u043e\u0432\u0438\u044f:</p>"},{"location":"engineering/deployment/#1-nginx","title":"1. \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f Nginx","text":"<p>Nginx \u0434\u043e\u043b\u0436\u0435\u043d \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0444\u0430\u0439\u043b <code>upstream</code>.  \u0412 \u043a\u043e\u043d\u0444\u0438\u0433\u0435 \u0441\u0430\u0439\u0442\u0430 (<code>/etc/nginx/sites-enabled/gifty</code>): <pre><code>include /etc/nginx/conf.d/gifty_upstream.conf;\n\nserver {\n    ...\n    location / {\n        proxy_pass http://gifty_backend;\n    }\n}\n</code></pre></p>"},{"location":"engineering/deployment/#2","title":"2. \u041f\u0440\u0430\u0432\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430","text":"<p>\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c, \u043f\u043e\u0434 \u043a\u043e\u0442\u043e\u0440\u044b\u043c GitHub \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u0442\u0441\u044f \u043f\u043e SSH, \u0434\u043e\u043b\u0436\u0435\u043d \u0438\u043c\u0435\u0442\u044c \u043f\u0440\u0430\u0432\u0430 \u043d\u0430:</p> <ul> <li>\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 <code>docker-compose</code>.</li> <li>\u041f\u0435\u0440\u0435\u0437\u0430\u043f\u0438\u0441\u044c \u0444\u0430\u0439\u043b\u0430 \u0432 <code>/etc/nginx/conf.d/</code>.</li> <li>\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 <code>sudo nginx -s reload</code> \u0431\u0435\u0437 \u043f\u0430\u0440\u043e\u043b\u044f (\u0438\u043b\u0438 \u0447\u0435\u0440\u0435\u0437 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 sudoers).</li> </ul>"},{"location":"engineering/deployment/#github-secrets","title":"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 GitHub Secrets","text":"<p>\u0412 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430\u0445 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f (Settings -&gt; Secrets) \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u044b:</p> \u0421\u0435\u043a\u0440\u0435\u0442 \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 <code>PROD_SSH_HOST</code> IP \u0438\u043b\u0438 \u0434\u043e\u043c\u0435\u043d \u0441\u0435\u0440\u0432\u0435\u0440\u0430 <code>PROD_SSH_PORT</code> \u041f\u043e\u0440\u0442 SSH (\u0435\u0441\u043b\u0438 \u043d\u0435 22) <code>PROD_SSH_USER</code> \u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f <code>PROD_SSH_KEY</code> \u041f\u0440\u0438\u0432\u0430\u0442\u043d\u044b\u0439 SSH \u043a\u043b\u044e\u0447 <code>PROD_ENV_FILE</code> \u0421\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0444\u0430\u0439\u043b\u0430 <code>.env</code> \u0434\u043b\u044f \u043f\u0440\u043e\u0434\u0430\u043a\u0448\u0435\u043d\u0430"},{"location":"engineering/deployment/#_4","title":"\u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u0434\u0435\u043f\u043b\u043e\u044f","text":"<p>\u0421\u0442\u0430\u0442\u0443\u0441 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0434\u0435\u043f\u043b\u043e\u044f \u043c\u043e\u0436\u043d\u043e \u043e\u0442\u0441\u043b\u0435\u0434\u0438\u0442\u044c \u0432\u043e \u0432\u043a\u043b\u0430\u0434\u043a\u0435 Actions \u0432 GitHub. </p>"},{"location":"engineering/deployment/#_5","title":"\u0414\u0435\u043f\u043b\u043e\u0439 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438","text":"<p>\u041f\u0440\u043e\u0446\u0435\u0441\u0441 \u0434\u0435\u043f\u043b\u043e\u044f \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438 \u043e\u043f\u0438\u0441\u0430\u043d \u0432 <code>.github/workflows/docs.yml</code> \u0438 \u043f\u0440\u0438\u0432\u044f\u0437\u0430\u043d \u043a \u0432\u0435\u0442\u043a\u0435 <code>documentation</code>.</p>"},{"location":"engineering/deployment/#_6","title":"\u041f\u0440\u0430\u0432\u0438\u043b\u0430 \u0440\u0430\u0431\u043e\u0442\u044b:","text":"<ol> <li>\u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0432\u0435\u0442\u043a\u0430: <code>documentation</code>. \u0422\u043e\u043b\u044c\u043a\u043e \u043f\u0443\u0448 \u0432 \u044d\u0442\u0443 \u0432\u0435\u0442\u043a\u0443 \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0430\u0439\u0442\u0430 <code>dev.giftyai.ru</code>.</li> <li>\u0420\u0430\u0431\u043e\u0447\u0438\u0435 \u0432\u0435\u0442\u043a\u0438: <code>documentation/*</code>. \u041f\u0440\u0438 \u043f\u0443\u0448\u0435 \u0432 \u044d\u0442\u0438 \u0432\u0435\u0442\u043a\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0441\u0431\u043e\u0440\u043a\u0438 (<code>mkdocs build</code>), \u0447\u0442\u043e\u0431\u044b \u0432\u044b \u043c\u043e\u0433\u043b\u0438 \u0443\u0431\u0435\u0434\u0438\u0442\u044c\u0441\u044f \u0432 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0438\u0438 \u043e\u0448\u0438\u0431\u043e\u043a.</li> <li>Pull Request: \u041f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 PR \u0432 \u0432\u0435\u0442\u043a\u0443 <code>documentation</code> \u0442\u0430\u043a\u0436\u0435 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430. \u0414\u0435\u043f\u043b\u043e\u0439 \u043f\u0440\u043e\u0438\u0437\u043e\u0439\u0434\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u0441\u043b\u0435 \u0441\u043b\u0438\u044f\u043d\u0438\u044f PR.</li> </ol>"},{"location":"engineering/infrastructure/","title":"\u0418\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0438 \u0441\u0435\u043a\u0440\u0435\u0442\u044b \ud83d\udd10","text":"<p>\u0412\u0441\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u044b Gifty \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f (<code>.env</code> \u0444\u0430\u0439\u043b). \u042d\u0442\u043e\u0442 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442 \u043e\u0431\u044a\u044f\u0441\u043d\u044f\u0435\u0442 \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043a\u043b\u044e\u0447\u0435\u0432\u044b\u0445 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0442\u043e\u043a\u0435\u043d\u0430\u043c\u0438.</p>"},{"location":"engineering/infrastructure/#_2","title":"\ud83d\udd11 \u0422\u043e\u043a\u0435\u043d\u044b \u0438 \u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c","text":""},{"location":"engineering/infrastructure/#1","title":"1. \u041c\u0435\u0436\u0441\u0435\u0440\u0432\u0438\u0441\u043d\u043e\u0435 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435","text":"<p>\u0414\u043b\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0445 \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u043e\u0432 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u043a\u043e\u0433\u0434\u0430 \u0421\u043a\u0440\u0430\u043f\u0435\u0440 \u0448\u043b\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 Core API) \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f Internal Token.</p> <ul> <li><code>INTERNAL_API_TOKEN</code>: \u041e\u0431\u0449\u0438\u0439 \u0441\u0435\u043a\u0440\u0435\u0442 \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u043c\u0438\u043a\u0440\u043e\u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432. \u0414\u043e\u043b\u0436\u0435\u043d \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0442\u044c\u0441\u044f \u0432 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0435 <code>X-Internal-Token</code>.</li> </ul>"},{"location":"engineering/infrastructure/#2-api","title":"2. \u0412\u043d\u0435\u0448\u043d\u0438\u0435 API \u0442\u043e\u043a\u0435\u043d\u044b","text":"<ul> <li><code>INTELLIGENCE_API_TOKEN</code>: \u0422\u043e\u043a\u0435\u043d \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a AI-\u0434\u0432\u0438\u0436\u043a\u0443 (\u043e\u0446\u0435\u043d\u043a\u0430 \u0442\u043e\u0432\u0430\u0440\u043e\u0432, \u0442\u0435\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435). \u0411\u0435\u0437 \u043d\u0435\u0433\u043e \u0444\u0443\u043d\u043a\u0446\u0438\u0438 ML \u0431\u0443\u0434\u0443\u0442 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b.</li> <li><code>WEEEK_API_TOKEN</code>: \u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0431\u043e\u0442\u0443 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438 \u0432 Weeek.</li> <li><code>ANALYTICS_API_TOKEN</code>: \u0422\u043e\u043a\u0435\u043d \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0441\u0435\u0440\u0432\u0438\u0441\u0443 \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0438 (DAU/MAU).</li> </ul>"},{"location":"engineering/infrastructure/#3-oauth","title":"3. \u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f (OAuth)","text":"<p>\u0414\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u0430 (Google, Yandex, VK) \u0442\u0440\u0435\u0431\u0443\u044e\u0442\u0441\u044f ID \u0438 Secret, \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u044b\u0435 \u0432 \u043a\u043e\u043d\u0441\u043e\u043b\u0438 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430.</p> <ul> <li><code>GOOGLE_CLIENT_ID</code>, <code>GOOGLE_CLIENT_SECRET</code></li> <li><code>YANDEX_CLIENT_ID</code>, <code>YANDEX_CLIENT_SECRET</code></li> <li><code>VK_CLIENT_ID</code>, <code>VK_CLIENT_SECRET</code></li> </ul>"},{"location":"engineering/infrastructure/#data-infra","title":"\ud83c\udfd7 \u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f (Data &amp; Infra)","text":"\u041f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0430\u044f \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0434\u043b\u044f Dev <code>DATABASE_URL</code> \u0421\u0442\u0440\u043e\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a PostgreSQL. <code>postgresql+asyncpg://user:pass@localhost:5432/db</code> <code>REDIS_URL</code> \u0410\u0434\u0440\u0435\u0441 Redis \u0434\u043b\u044f \u0441\u0435\u0441\u0441\u0438\u0439 \u0438 \u043e\u0447\u0435\u0440\u0435\u0434\u0435\u0439. <code>redis://localhost:6379/0</code> <code>RABBITMQ_URL</code> \u0411\u0440\u043e\u043a\u0435\u0440 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439 \u0434\u043b\u044f \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0430. <code>amqp://guest:guest@localhost:5672/</code> <code>API_BASE</code> \u041f\u0443\u0431\u043b\u0438\u0447\u043d\u044b\u0439 URL \u0431\u044d\u043a\u0435\u043d\u0434\u0430 (\u0434\u043b\u044f \u043a\u043e\u043b\u0431\u044d\u043a\u043e\u0432). <code>http://localhost:8000</code> <code>FRONTEND_BASE</code> URL \u0444\u0440\u043e\u043d\u0442\u0435\u043d\u0434\u0430 (React). <code>http://localhost:5173</code>"},{"location":"engineering/infrastructure/#telegram","title":"\ud83e\udd16 \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 Telegram","text":"<ul> <li><code>TELEGRAM_BOT_TOKEN</code>: \u0422\u043e\u043a\u0435\u043d \u0432\u0430\u0448\u0435\u0433\u043e \u0431\u043e\u0442\u0430 \u043e\u0442 @BotFather.</li> <li><code>TELEGRAM_ADMIN_SECRET</code>: \u0421\u0435\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u043a\u043b\u044e\u0447 \u0434\u043b\u044f \u043f\u0435\u0440\u0432\u043e\u0439 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u0441\u0443\u043f\u0435\u0440\u0430\u0434\u043c\u0438\u043d\u0430 \u0447\u0435\u0440\u0435\u0437 <code>/start &lt;secret&gt;</code>.</li> <li><code>TELEGRAM_WEBAPP_URL</code>: URL \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u043e\u0433\u043e \u0434\u0430\u0448\u0431\u043e\u0440\u0434\u0430 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0430 (\u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e HTTPS \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0432 \u0442\u0435\u043b\u0435\u0433\u0440\u0430\u043c\u0435).</li> </ul>"},{"location":"engineering/infrastructure/#_3","title":"\u2699\ufe0f \u0421\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0435 \u0444\u043b\u0430\u0433\u0438","text":"<ul> <li><code>ENV</code>: \u0420\u0435\u0436\u0438\u043c \u0440\u0430\u0431\u043e\u0442\u044b (<code>dev</code> \u0438\u043b\u0438 <code>prod</code>). \u0412\u043b\u0438\u044f\u0435\u0442 \u043d\u0430 \u0441\u0442\u0440\u043e\u0433\u043e\u0441\u0442\u044c \u043f\u0440\u043e\u0432\u0435\u0440\u043e\u043a SSL \u0438 \u043b\u043e\u0433\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435.</li> <li><code>DEBUG</code>: \u0415\u0441\u043b\u0438 <code>True</code>, FastAPI \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u044c \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u044b\u0435 \u043e\u0448\u0438\u0431\u043a\u0438 \u0438 \u0438\u043d\u0442\u0435\u0440\u0430\u043a\u0442\u0438\u0432\u043d\u0443\u044e \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044e.</li> <li><code>SECRET_KEY</code>: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043a\u0443\u043a\u0438 \u0438 \u043f\u043e\u0434\u043f\u0438\u0441\u0438 \u0441\u0435\u0441\u0441\u0438\u0439. \u0412 \u043f\u0440\u043e\u0434\u0430\u043a\u0448\u0435\u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0434\u043b\u0438\u043d\u043d\u043e\u0439 \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u043e\u0439.</li> </ul>"},{"location":"engineering/infrastructure/#_4","title":"\u26a0\ufe0f \u041f\u0440\u0430\u0432\u0438\u043b\u0430 \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0441\u0435\u043a\u0440\u0435\u0442\u0430\u043c\u0438","text":"<ol> <li>\u041d\u0438\u043a\u043e\u0433\u0434\u0430 \u043d\u0435 \u043f\u0443\u0448\u044c\u0442\u0435 <code>.env</code> \u0444\u0430\u0439\u043b \u0432 GitHub.</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 <code>.env.example</code> \u0434\u043b\u044f \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u044f \u043d\u043e\u0432\u044b\u0445 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445, \u043d\u043e \u0431\u0435\u0437 \u0436\u0438\u0432\u044b\u0445 \u043a\u043b\u044e\u0447\u0435\u0439.</li> <li>\u0415\u0441\u043b\u0438 \u0432\u044b \u0434\u043e\u0431\u0430\u0432\u0438\u043b\u0438 \u043d\u043e\u0432\u0443\u044e \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e \u0432 <code>app/config.py</code>, \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u0435 \u044d\u0442\u043e\u0442 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442 \u0438 <code>.env.example</code>.</li> </ol>"},{"location":"engineering/providers/","title":"\u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u043e\u0432 (AI Providers)","text":"<p>Gifty \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u0440\u0430\u0431\u043e\u0442\u0443 \u0441 \u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u043e\u043c \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u043e\u0432 \u0418\u0418 \"\u0438\u0437 \u043a\u043e\u0440\u043e\u0431\u043a\u0438\". \u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0432\u044b\u0431\u0438\u0440\u0430\u0442\u044c \u043e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0441\u043e\u0447\u0435\u0442\u0430\u043d\u0438\u0435 \u0446\u0435\u043d\u044b, \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0430 \u0438 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438.</p>"},{"location":"engineering/providers/#1-llm-reasoning","title":"1. \u041f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u044b \u0442\u0435\u043a\u0441\u0442\u0430 (LLM / Reasoning)","text":"<p>\u042d\u0442\u0438 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u0434\u043b\u044f \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 \u0438\u0434\u0435\u0439 \u043f\u043e\u0434\u0430\u0440\u043a\u043e\u0432, \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u0438 \u043e\u0431\u0449\u0435\u043d\u0438\u044f \u0441 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c. \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 <code>LLM_PROVIDER</code> \u0432 <code>.env</code>.</p> \u041f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440 \u041a\u043b\u044e\u0447 \u0432 \u043a\u043e\u043d\u0444\u0438\u0433\u0435 \u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0446\u0435\u043d\u043d\u043e\u0441\u0442\u044c \u0420\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u043c\u044b\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 Anthropic <code>anthropic</code> \u0412\u044b\u0441\u043e\u0447\u0430\u0439\u0448\u0435\u0435 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0442\u0432\u0435\u0442\u043e\u0432 \u0438 \u0441\u043b\u0435\u0434\u043e\u0432\u0430\u043d\u0438\u0435 \u0438\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f\u043c. <code>claude-3-5-sonnet-20240620</code>, <code>claude-3-haiku-20240307</code> Google Gemini <code>gemini</code> \u041e\u0433\u0440\u043e\u043c\u043d\u044b\u0435 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u044b \u0438 \u043d\u0438\u0437\u043a\u0430\u044f \u0446\u0435\u043d\u0430. <code>gemini-1.5-pro</code>, <code>gemini-1.5-flash</code> Groq Cloud <code>groq</code> \u041d\u0435\u0432\u0435\u0440\u043e\u044f\u0442\u043d\u0430\u044f \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 (\u0434\u043e 500 \u0442\u043e\u043a\u0435\u043d\u043e\u0432/\u0441\u0435\u043a). <code>llama-3.3-70b-versatile</code>, <code>mixtral-8x7b-32768</code> Together AI <code>together</code> \u0414\u043e\u0441\u0442\u0443\u043f \u043a \u043b\u0443\u0447\u0448\u0438\u043c Open Source \u043c\u043e\u0434\u0435\u043b\u044f\u043c \u0441 \u043d\u0438\u0437\u043a\u043e\u0439 \u0437\u0430\u0434\u0435\u0440\u0436\u043a\u043e\u0439. <code>meta-llama/Llama-3.3-70B-Instruct-Turbo</code> OpenRouter <code>openrouter</code> \u0410\u0433\u0440\u0435\u0433\u0430\u0442\u043e\u0440 \u0432\u0441\u0435\u0445 \u043c\u043e\u0434\u0435\u043b\u0435\u0439 \u0432 \u043e\u0434\u043d\u043e\u043c API. \u0418\u0434\u0435\u0430\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. \u041b\u044e\u0431\u0430\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c"},{"location":"engineering/providers/#2-embeddings","title":"2. \u041f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u044b \u044d\u043c\u0431\u0435\u0434\u0434\u0438\u043d\u0433\u043e\u0432 (Embeddings)","text":"<p>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u0434\u043b\u044f \u0432\u0435\u043a\u0442\u043e\u0440\u043d\u043e\u0433\u043e \u043f\u043e\u0438\u0441\u043a\u0430 \u0442\u043e\u0432\u0430\u0440\u043e\u0432. \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u0447\u0435\u0440\u0435\u0437 <code>embedding_provider</code> \u0432 <code>configs/logic.yaml</code>.</p>"},{"location":"engineering/providers/#intelligence-api-intelligence_api","title":"Intelligence API (<code>intelligence_api</code>)","text":"<p>\u0421\u0442\u0430\u0446\u0438\u043e\u043d\u0430\u0440\u043d\u044b\u0439 API Gifty. - \u041a\u043e\u0433\u0434\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c: \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u0447. - \u041c\u043e\u0434\u0435\u043b\u0438: <code>bge-m3</code>.</p>"},{"location":"engineering/providers/#runpod-serverless-runpod","title":"RunPod Serverless (<code>runpod</code>)","text":"<p>\u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0435 GPU-\u0432\u043e\u0440\u043a\u0435\u0440\u044b. - \u041a\u043e\u0433\u0434\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c: \u0412\u044b\u0441\u043e\u043a\u0430\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430, \u0441\u043f\u0435\u0446\u0438\u0444\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438, \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u044c \u043f\u043e\u043b\u043d\u043e\u0433\u043e \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044f \u043d\u0430\u0434 \u0434\u0430\u043d\u043d\u044b\u043c\u0438. - \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430: \u0422\u0440\u0435\u0431\u0443\u0435\u0442 <code>RUNPOD_API_KEY</code> \u0438 <code>RUNPOD_ENDPOINT_ID</code>.</p>"},{"location":"engineering/providers/#together-ai-together","title":"Together AI (<code>together</code>)","text":"<p>\u041e\u0431\u043b\u0430\u0447\u043d\u044b\u0435 \u044d\u043c\u0431\u0435\u0434\u0434\u0438\u043d\u0433\u0438 \u0432\u044b\u0441\u043e\u043a\u043e\u0439 \u043f\u043b\u043e\u0442\u043d\u043e\u0441\u0442\u0438. - \u041a\u043e\u0433\u0434\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c: \u041a\u043e\u0433\u0434\u0430 \u043d\u0435 \u0445\u043e\u0447\u0435\u0442\u0441\u044f \u043d\u0430\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u0442\u044c \u0441\u0435\u0440\u0432\u0435\u0440\u044b, \u043d\u043e \u043d\u0443\u0436\u043d\u044b \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0435 \u0430\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u043d\u044b\u0435 \u043c\u043e\u0434\u0435\u043b\u0438. - \u041c\u043e\u0434\u0435\u043b\u0438: <code>togethercomputer/m2-bert-80M-8k-retrieval</code>, <code>BAAI/bge-large-en-v1.5</code>.</p>"},{"location":"engineering/providers/#3","title":"3. \u0422\u0430\u0431\u043b\u0438\u0446\u0430 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f","text":"\u041f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440 \u041f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0430\u044f \u043a\u043b\u044e\u0447\u0430 \u041c\u0435\u0442\u043e\u0434 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 Anthropic <code>ANTHROPIC_API_KEY</code> Bearer (x-api-key) Gemini <code>GEMINI_API_KEY</code> x-goog-api-key Groq <code>GROQ_API_KEY</code> Bearer Together <code>TOGETHER_API_KEY</code> Bearer OpenRouter <code>OPENROUTER_API_KEY</code> Bearer RunPod <code>RUNPOD_API_KEY</code> API Key Header"},{"location":"engineering/providers/#_1","title":"\u041a\u0430\u043a \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u043e\u0433\u043e \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u0430?","text":"<p>\u0415\u0441\u043b\u0438 \u0432\u0430\u043c \u043d\u0443\u0436\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u043e\u0433\u043e \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u0430 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, OpenAI \u0438\u043b\u0438 Mistral): 1.  \u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u0432 <code>app/services/llm/&lt;provider&gt;_client.py</code> (\u043d\u0430\u0441\u043b\u0435\u0434\u0443\u0439\u0442\u0435\u0441\u044c \u043e\u0442 <code>LLMClient</code>). 2.  \u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 API \u043a\u043b\u044e\u0447 \u0432 <code>app/config.py</code>. 3.  \u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0443\u0439\u0442\u0435 \u043a\u043b\u0430\u0441\u0441 \u0432 <code>app/services/llm/factory.py</code>. 4.  \u041e\u0431\u043d\u043e\u0432\u0438\u0442\u0435 \u044d\u0442\u043e\u0442 \u0441\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a! \ud83d\ude80</p>"},{"location":"onboarding/database_work/","title":"\u0413\u0430\u0439\u0434 \u043f\u043e \u0440\u0430\u0431\u043e\u0442\u0435 \u0441 \u0431\u0430\u0437\u043e\u0439 \u0434\u0430\u043d\u043d\u044b\u0445","text":"<p>\u042d\u0442\u043e\u0442 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442 \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u0438 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0443 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 Gifty: \u043a\u0430\u043a \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b, \u0433\u0434\u0435 \u0438\u0441\u043a\u0430\u0442\u044c \u0441\u0445\u0435\u043c\u0443 \u0438 \u043a\u0430\u043a \u0443\u0441\u0442\u0440\u043e\u0435\u043d\u044b \u0434\u0430\u043d\u043d\u044b\u0435.</p>"},{"location":"onboarding/database_work/#overview","title":"\u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0439 \u043e\u0431\u0437\u043e\u0440 (Overview)","text":"<p>\u0411\u0430\u0437\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 Gifty (PostgreSQL) \u2014 \u044d\u0442\u043e \u0446\u0435\u043d\u0442\u0440\u0430\u043b\u044c\u043d\u043e\u0435 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0437\u043d\u0430\u043d\u0438\u0439 \u043e \u0442\u043e\u0432\u0430\u0440\u0430\u0445, \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u0445 \u0438 \u043b\u043e\u0433\u0438\u043a\u0435 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439. \u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u043e \u0434\u0430\u043d\u043d\u044b\u0435 \u0440\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u044b \u043d\u0430 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043a\u043b\u044e\u0447\u0435\u0432\u044b\u0445 \u0434\u043e\u043c\u0435\u043d\u043e\u0432:</p> <ol> <li>\u041a\u0430\u0442\u0430\u043b\u043e\u0433 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 (<code>products</code>): \u0421\u0435\u0440\u0434\u0446\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u044b. \u0417\u0434\u0435\u0441\u044c \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u0442\u043e\u0432\u0430\u0440\u0430\u0445, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0446\u0435\u043d\u044b, \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u044f, \u0441\u0441\u044b\u043b\u043a\u0438 \u0438 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f.</li> <li>\u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0430 (<code>parsing</code>): \u0422\u0430\u0431\u043b\u0438\u0446\u044b <code>parsing_sources</code> (\u0440\u0435\u0435\u0441\u0442\u0440 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u043e\u0432) \u0438 <code>category_map</code> (\u043c\u0430\u043f\u043f\u0438\u043d\u0433 \u0432\u043d\u0435\u0448\u043d\u0438\u0445 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u0432\u043e \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0435).</li> <li>\u0420\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0434\u0432\u0438\u0436\u043e\u043a (<code>recsys</code>): \u0412\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0432 \u0441\u0435\u0431\u044f <code>product_embeddings</code> (\u0432\u0435\u043a\u0442\u043e\u0440\u043d\u044b\u0435 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0441\u0435\u043c\u0430\u043d\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u043f\u043e\u0438\u0441\u043a\u0430) \u0438 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u043d\u044b\u0435 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u044b \u0442\u043e\u0432\u0430\u0440\u043e\u0432 (\u043f\u0441\u0438\u0445\u043e\u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u043f\u0440\u043e\u0444\u0438\u043b\u0438, \"\u0433\u0438\u0444\u0442\u0430\u0431\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c\").</li> <li>\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438 \u0438 \u0441\u0435\u0441\u0441\u0438\u0438 (<code>users</code> &amp; <code>auth</code>): \u041f\u0440\u043e\u0444\u0438\u043b\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439, \u043f\u0440\u0438\u0432\u044f\u0437\u043a\u0438 \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0445 \u0441\u0435\u0442\u0435\u0439 (OAuth) \u0438 \u0438\u0441\u0442\u043e\u0440\u0438\u044f \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439.</li> </ol>"},{"location":"onboarding/database_work/#_2","title":"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0441\u0445\u0435\u043c\u044b","text":"<p>\u0414\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u0435\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u043f\u043e\u043b\u044f\u0445, \u0442\u0438\u043f\u0430\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u0441\u0432\u044f\u0437\u044f\u0445 \u043c\u0435\u0436\u0434\u0443 \u0442\u0430\u0431\u043b\u0438\u0446\u0430\u043c\u0438, \u043e\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044c \u043a \u0440\u0430\u0437\u0434\u0435\u043b\u0443 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0435\u0439:</p> <p>\ud83d\udc49 \u041f\u043e\u0434\u0440\u043e\u0431\u043d\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0435\u0439 \u0411\u0414</p>"},{"location":"onboarding/database_work/#_3","title":"\u0420\u043e\u043b\u0438 \u0438 \u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0441\u0442\u044c","text":"<ul> <li>\u0414\u043e\u0441\u0442\u0443\u043f \u043a \u0431\u0430\u0437\u0435 \u0432\u044b\u0434\u0430\u0435\u0442\u0441\u044f \u043f\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u0438 \u0432 \u0440\u0430\u043c\u043a\u0430\u0445 \u0432\u0430\u0448\u0435\u0439 \u0440\u043e\u043b\u0438.</li> <li>\u041b\u044e\u0431\u044b\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0441\u0445\u0435\u043c\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0441\u043e\u0433\u043b\u0430\u0441\u043e\u0432\u0430\u043d\u044b \u0441 \u043c\u0435\u043d\u0442\u043e\u0440\u043e\u043c \u0438\u043b\u0438 \u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u043c \u0437\u0430 \u0411\u0414.</li> </ul>"},{"location":"onboarding/database_work/#_4","title":"\u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u0430\u044f \u0440\u0430\u0431\u043e\u0442\u0430 \u0441 \u0434\u0430\u043d\u043d\u044b\u043c\u0438","text":"<ol> <li>\u0412\u0441\u0435\u0433\u0434\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0439\u0442\u0435 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u0435, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442\u0435.</li> <li>\u0418\u0437\u0431\u0435\u0433\u0430\u0439\u0442\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439 \u0432 \u043f\u0440\u043e\u0434\u0435 \u0431\u0435\u0437 \u044f\u0432\u043d\u043e\u0433\u043e \u0441\u043e\u0433\u043b\u0430\u0441\u043e\u0432\u0430\u043d\u0438\u044f.</li> <li>\u0414\u043b\u044f \u043c\u0430\u0441\u0441\u043e\u0432\u044b\u0445 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0438 \u0438 \u0434\u0435\u043b\u0430\u0439\u0442\u0435 \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 <code>SELECT</code>.</li> <li>\u041d\u0435 \u0432\u044b\u0433\u0440\u0443\u0436\u0430\u0439\u0442\u0435 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0432\u043d\u0435 \u0437\u0430\u0449\u0438\u0449\u0435\u043d\u043d\u044b\u0445 \u043a\u0430\u043d\u0430\u043b\u043e\u0432.</li> </ol>"},{"location":"onboarding/database_work/#_5","title":"\u041a\u0430\u043a \u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0441\u0445\u0435\u043c\u0443","text":"<ul> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 DataGrip \u0434\u043b\u044f \u043d\u0430\u0432\u0438\u0433\u0430\u0446\u0438\u0438 \u043f\u043e \u0442\u0430\u0431\u043b\u0438\u0446\u0430\u043c, \u0438\u043d\u0434\u0435\u043a\u0441\u0430\u043c \u0438 \u0441\u0432\u044f\u0437\u044f\u043c.</li> <li>\u0414\u043b\u044f \u0441\u043b\u043e\u0436\u043d\u044b\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u0438\u0449\u0438\u0442\u0435 \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u0438 \u0432 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438 (\u043a\u0430\u0442\u0430\u043b\u043e\u0433 <code>alembic</code>).</li> </ul>"},{"location":"onboarding/database_work/#alembic","title":"Alembic","text":"<p>\u0414\u043b\u044f \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043e\u0439 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 \u043c\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c Alembic. \u042d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0442\u044c \u0441\u0445\u0435\u043c\u0443 \u043d\u0430 \u0432\u0441\u0435\u0445 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u0445.</p>"},{"location":"onboarding/database_work/#_6","title":"\u0417\u043e\u043b\u043e\u0442\u044b\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u0430:","text":"<ol> <li>\u041d\u0418\u041a\u041e\u0413\u0414\u0410 \u043d\u0435 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u0444\u0430\u0439\u043b\u044b \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u0439 \u0432 <code>alembic/versions</code>. \u0415\u0441\u043b\u0438 \u043e\u0448\u0438\u0431\u043b\u0438\u0441\u044c \u2014 \u0441\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u043d\u043e\u0432\u0443\u044e \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u044e, \u0438\u0441\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0449\u0443\u044e \u043e\u0448\u0438\u0431\u043a\u0443.</li> <li>\u0412\u0441\u0435\u0433\u0434\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0439\u0442\u0435 \u0441\u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u043a\u043e\u0434 \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u0438. Alembic \u043c\u043e\u0436\u0435\u0442 \u043d\u0435 \u0437\u0430\u043c\u0435\u0442\u0438\u0442\u044c \u043f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u043b\u043e\u043d\u043e\u043a \u0438\u043b\u0438 \u0441\u043f\u0435\u0446\u0438\u0444\u0438\u0447\u043d\u044b\u0435 \u0442\u0438\u043f\u044b \u0434\u0430\u043d\u043d\u044b\u0445.</li> <li>\u041c\u0438\u0433\u0440\u0430\u0446\u0438\u0438 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u044e\u0442\u0441\u044f \u0432 \u043f\u0440\u043e\u0434\u0430\u043a\u0448\u0435\u043d\u0435 \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432.</li> </ol>"},{"location":"onboarding/database_work/#_7","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u044b:","text":"<pre><code># \u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u044e (\u0430\u0432\u0442\u043e\u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u043c\u043e\u0434\u0435\u043b\u0435\u0439)\nalembic revision --autogenerate -m \"\u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439\"\n\n# \u041f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u0438 \u0434\u043e \u0441\u0430\u043c\u043e\u0439 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u0432\u0435\u0440\u0441\u0438\u0438\nalembic upgrade head\n\n# \u041e\u0442\u043a\u0430\u0442\u0438\u0442\u044c \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u044e\u044e \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u044e (\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043e\u0441\u0442\u043e\u0440\u043e\u0436\u043d\u043e!)\nalembic downgrade -1\n</code></pre> <p>Tip</p> <p>\u0422\u0435\u0441\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u0438 \u043d\u0430 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u0411\u0414 (<code>alembic upgrade head</code>) \u043f\u0435\u0440\u0435\u0434 \u0442\u0435\u043c, \u043a\u0430\u043a \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u0442\u044c Pull Request.</p>"},{"location":"onboarding/database_work/#_8","title":"\u041f\u0440\u0430\u043a\u0442\u0438\u043a\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0434\u0430\u043d\u043d\u044b\u0445","text":"<ul> <li>\u0412\u0441\u0435\u0433\u0434\u0430 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u0439\u0442\u0435 \u0432\u044b\u0431\u043e\u0440\u043a\u0443 (<code>LIMIT</code>), \u043f\u043e\u043a\u0430 \u043d\u0435 \u0443\u0432\u0435\u0440\u0435\u043d\u044b \u0432 \u043e\u0431\u044a\u0435\u043c\u0435.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u044f\u0439\u0442\u0435 \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u043f\u043e \u043a\u043b\u044e\u0447\u0430\u043c/\u0438\u043d\u0434\u0435\u043a\u0441\u0430\u043c.</li> <li>\u0414\u043b\u044f \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0435 \u0432\u0438\u0442\u0440\u0438\u043d\u044b, \u0435\u0441\u043b\u0438 \u043e\u043d\u0438 \u0435\u0441\u0442\u044c.</li> </ul>"},{"location":"onboarding/database_work/#_9","title":"\u0427\u0430\u0441\u0442\u044b\u0435 \u0432\u043e\u043f\u0440\u043e\u0441\u044b","text":"<p>\u0413\u0434\u0435 \u0432\u0437\u044f\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f?</p> <p>\u0427\u0435\u0440\u0435\u0437 \u0442\u0435\u043b\u0435\u0433\u0440\u0430\u043c\u2011\u0431\u043e\u0442\u0430 \u0438\u043b\u0438 \u0443 \u043c\u0435\u043d\u0442\u043e\u0440\u0430. \u0418\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u0438 \u043f\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044e \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0432 \u043e\u043d\u0431\u043e\u0440\u0434\u0438\u043d\u0433\u0435.</p> <p>\u041a\u043e\u0433\u043e \u0441\u043f\u0440\u043e\u0441\u0438\u0442\u044c, \u0435\u0441\u043b\u0438 \u0447\u0442\u043e-\u0442\u043e \u043d\u0435 \u0442\u0430\u043a?</p> <p>\u041e\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044c \u043a \u043c\u0435\u043d\u0442\u043e\u0440\u0443 \u0438 \u043e\u043f\u0438\u0448\u0438\u0442\u0435 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0443, \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u043e\u0448\u0438\u0431\u043a\u0443 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0438\u043b\u0438 \u0442\u0435\u043a\u0441\u0442 \u0437\u0430\u043f\u0440\u043e\u0441\u0430.</p>"},{"location":"onboarding/github_workflow/","title":"\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u043f\u043e \u0440\u0430\u0431\u043e\u0442\u0435 \u0441 GitHub","text":"<p>\u042d\u0442\u043e\u0442 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442 \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u0431\u0430\u0437\u043e\u0432\u044b\u0439 \u0440\u0430\u0431\u043e\u0447\u0438\u0439 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0432 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438 Gifty: \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u0430, \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0440\u0435\u0434\u044b, \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u0432\u0435\u0442\u0432\u043b\u0435\u043d\u0438\u044f \u0438 pull\u2011request.</p>"},{"location":"onboarding/github_workflow/#_1","title":"\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u0430","text":"<p>\u0414\u043e\u0441\u0442\u0443\u043f \u043a \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044e \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c:</p> <ul> <li>\u0447\u0435\u0440\u0435\u0437 \u0437\u0430\u043f\u0440\u043e\u0441 \u0432 \u0442\u0435\u043b\u0435\u0433\u0440\u0430\u043c\u2011\u0431\u043e\u0442\u0435,</li> <li>\u043b\u0438\u0431\u043e \u0447\u0435\u0440\u0435\u0437 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0432\u0430\u0448\u0438\u043c \u043c\u0435\u043d\u0442\u043e\u0440\u043e\u043c.</li> </ul> <p>\u041f\u043e\u0441\u043b\u0435 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435, \u0447\u0442\u043e \u0443 \u0432\u0430\u0441 \u0435\u0441\u0442\u044c \u043f\u0440\u0430\u0432\u0430 \u043d\u0430 \u0447\u0442\u0435\u043d\u0438\u0435 \u0438 \u0437\u0430\u043f\u0438\u0441\u044c \u0432 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439.</p>"},{"location":"onboarding/github_workflow/#_2","title":"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0440\u0435\u0434\u044b","text":"<ol> <li>\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 Git.</li> <li>\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u0442\u0435 \u0430\u0432\u0442\u043e\u0440\u0441\u0442\u0432\u043e:</li> </ol> <pre><code>git config --global user.name \"\u0412\u0430\u0448\u0435 \u0418\u043c\u044f\"\ngit config --global user.email \"you@example.com\"\n</code></pre> <ol> <li>\u041a\u043b\u043e\u043d\u0438\u0440\u0443\u0439\u0442\u0435 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439:</li> </ol> <pre><code>git clone git@github.com:IceDarold/gifty-backend.git\n</code></pre> <p>\u0415\u0441\u043b\u0438 SSH \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 HTTPS\u2011URL.</p>"},{"location":"onboarding/github_workflow/#_3","title":"\u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0432\u0435\u0442\u043e\u043a","text":"<p>\u0412 \u043f\u0440\u043e\u0435\u043a\u0442\u0435 Gifty \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043c\u043e\u0434\u0435\u043b\u044c \u0432\u0435\u0442\u0432\u043b\u0435\u043d\u0438\u044f, \u043e\u0441\u043d\u043e\u0432\u0430\u043d\u043d\u0430\u044f \u043d\u0430 Git Flow:</p> \u0412\u0435\u0442\u043a\u0430 \u0426\u0435\u043b\u044c \u0421\u0442\u0430\u0431\u0438\u043b\u044c\u043d\u043e\u0441\u0442\u044c <code>main</code> Production-\u043a\u043e\u0434. \u0421\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u0440\u0435\u043b\u0438\u0437\u043d\u044b\u0435 \u0432\u0435\u0440\u0441\u0438\u0438. Locked <code>develop</code> \u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0432\u0435\u0442\u043a\u0430 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438. \u0421\u044e\u0434\u0430 \u0432\u043b\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u0432\u0441\u0435 \u0444\u0438\u0447\u0438. \u0421\u0442\u0430\u0431\u0438\u043b\u044c\u043d\u0430\u044f <code>feature/*</code> \u0420\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u043d\u043e\u0432\u044b\u0445 \u0444\u0438\u0447 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, <code>feature/ai-scoring</code>). \u042d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u0430\u043b\u044c\u043d\u0430\u044f <code>research/*</code> \u0418\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u043d\u0438\u044f, ML \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u044b, \u043d\u043e\u0443\u0442\u0431\u0443\u043a\u0438. \u042d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u0430\u043b\u044c\u043d\u0430\u044f <code>hotfix/*</code> \u0421\u0440\u043e\u0447\u043d\u044b\u0435 \u0444\u0438\u043a\u0441\u044b \u0434\u043b\u044f \u043f\u0440\u043e\u0434\u0430\u043a\u0448\u0435\u043d\u0430. \u0421\u0442\u0430\u0431\u0438\u043b\u044c\u043d\u0430\u044f <code>docs/*</code> \u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438. \u0421\u0442\u0430\u0431\u0438\u043b\u044c\u043d\u0430\u044f"},{"location":"onboarding/github_workflow/#git-flow","title":"\u0420\u0430\u0431\u043e\u0447\u0438\u0439 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442 (Git Flow)","text":""},{"location":"onboarding/github_workflow/#1","title":"1. \u041d\u0430\u0447\u0430\u043b\u043e \u0440\u0430\u0431\u043e\u0442\u044b","text":"<p>\u0412\u0441\u0435 \u043d\u043e\u0432\u044b\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u043d\u0430\u0447\u0438\u043d\u0430\u044e\u0442\u0441\u044f \u043e\u0442 \u0432\u0435\u0442\u043a\u0438 <code>develop</code>: <pre><code>git checkout develop\ngit pull origin develop\ngit checkout -b feature/your-task-name\n</code></pre></p>"},{"location":"onboarding/github_workflow/#2","title":"2. \u041f\u0440\u0430\u0432\u0438\u043b\u0430 \u043a\u043e\u043c\u043c\u0438\u0442\u043e\u0432","text":"<ul> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043f\u043e\u043d\u044f\u0442\u043d\u044b\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u043d\u0430 \u0430\u043d\u0433\u043b\u0438\u0439\u0441\u043a\u043e\u043c \u0438\u043b\u0438 \u0440\u0443\u0441\u0441\u043a\u043e\u043c \u044f\u0437\u044b\u043a\u0435.</li> <li>\u0421\u0442\u0430\u0440\u0430\u0439\u0442\u0435\u0441\u044c \u0434\u0435\u043b\u0430\u0442\u044c \u0430\u0442\u043e\u043c\u0430\u0440\u043d\u044b\u0435 \u043a\u043e\u043c\u043c\u0438\u0442\u044b (\u043e\u0434\u043d\u0430 \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043f\u0440\u0430\u0432\u043a\u0430 = \u043e\u0434\u0438\u043d \u043a\u043e\u043c\u043c\u0438\u0442).</li> <li>\u041d\u0438\u043a\u043e\u0433\u0434\u0430 \u043d\u0435 \u043a\u043e\u043c\u043c\u0438\u0442\u044c\u0442\u0435 \u0444\u0430\u0439\u043b\u044b <code>.env</code>, \u0441\u0435\u043a\u0440\u0435\u0442\u044b \u0438 \u043f\u0440\u0438\u0432\u0430\u0442\u043d\u044b\u0435 \u043a\u043b\u044e\u0447\u0438.</li> </ul>"},{"location":"onboarding/github_workflow/#3-pull-request-pr","title":"3. Pull Request (PR)","text":"<ul> <li>PR \u0432\u0441\u0435\u0433\u0434\u0430 \u0441\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f \u0432 \u0432\u0435\u0442\u043a\u0443 <code>develop</code> (\u043a\u0440\u043e\u043c\u0435 \u0445\u043e\u0442\u0444\u0438\u043a\u0441\u043e\u0432).</li> <li>\u0412 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0438 PR \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u0441\u0441\u044b\u043b\u043a\u0443 \u043d\u0430 \u0437\u0430\u0434\u0430\u0447\u0443 \u0432 Weeek (\u0435\u0441\u043b\u0438 \u0435\u0441\u0442\u044c).</li> <li>\u041f\u043e\u0441\u043b\u0435 \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u044f PR \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0441\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 (GitHub Actions). \u0423\u0431\u0435\u0434\u0438\u0442\u0435\u0441\u044c, \u0447\u0442\u043e \u0442\u0435\u0441\u0442\u044b \u043f\u0440\u043e\u0448\u043b\u0438 (\u0437\u0435\u043b\u0435\u043d\u0430\u044f \u0433\u0430\u043b\u043e\u0447\u043a\u0430).</li> </ul>"},{"location":"onboarding/github_workflow/#4-code-review","title":"4. Code Review","text":"<ul> <li>\u0414\u043e\u0436\u0434\u0438\u0442\u0435\u0441\u044c \u043e\u0434\u043e\u0431\u0440\u0435\u043d\u0438\u044f (Approve) \u0445\u043e\u0442\u044f \u0431\u044b \u043e\u0442 \u043e\u0434\u043d\u043e\u0433\u043e \u043a\u043e\u043b\u043b\u0435\u0433\u0438 \u0438\u043b\u0438 \u043c\u0435\u043d\u0442\u043e\u0440\u0430.</li> <li>\u041f\u043e\u0441\u043b\u0435 \u0430\u043f\u0440\u0443\u0432\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 Rebase and Merge \u0438\u043b\u0438 \u043e\u0431\u044b\u0447\u043d\u044b\u0439 Merge, \u0435\u0441\u043b\u0438 \u0438\u043d\u043e\u0435 \u043d\u0435 \u043e\u0433\u043e\u0432\u043e\u0440\u0435\u043d\u043e \u043c\u0435\u043d\u0442\u043e\u0440\u043e\u043c.</li> </ul>"},{"location":"onboarding/github_workflow/#5-main","title":"5. \u0420\u0435\u043b\u0438\u0437\u044b (Main)","text":"<p>\u0412\u043b\u0438\u0432\u0430\u043d\u0438\u0435 \u0438\u0437 <code>develop</code> \u0432 <code>main</code> \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u0440\u0438 \u0440\u0435\u043b\u0438\u0437\u0435 \u043d\u043e\u0432\u043e\u0439 \u0432\u0435\u0440\u0441\u0438\u0438 \u0438 \u0441\u043e\u043f\u0440\u043e\u0432\u043e\u0436\u0434\u0430\u0435\u0442\u0441\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435\u043c \u0442\u0435\u0433\u0430: <pre><code>git tag -a v1.x.x -m \"Release description\"\ngit push origin --tags\n</code></pre></p>"},{"location":"onboarding/github_workflow/#_4","title":"\u0421\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f","text":"<p>\u0415\u0441\u043b\u0438 \u0432\u044b \u0434\u043e\u043b\u0433\u043e \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442\u0435 \u043d\u0430\u0434 \u0437\u0430\u0434\u0430\u0447\u0435\u0439, \u0432\u0430\u0448\u0430 \u0432\u0435\u0442\u043a\u0430 \u043c\u043e\u0436\u0435\u0442 \u0443\u0441\u0442\u0430\u0440\u0435\u0442\u044c. \u0420\u0435\u0433\u0443\u043b\u044f\u0440\u043d\u043e \u043f\u043e\u0434\u0442\u044f\u0433\u0438\u0432\u0430\u0439\u0442\u0435 \u0441\u0432\u0435\u0436\u0438\u0439 <code>develop</code>: <pre><code>git fetch origin\ngit merge origin/develop\n# \u0438\u043b\u0438 git rebase origin/develop, \u0435\u0441\u043b\u0438 \u0432\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b \u0432 \u0441\u0432\u043e\u0438\u0445 \u0441\u0438\u043b\u0430\u0445\n</code></pre></p>"},{"location":"onboarding/github_workflow/#_5","title":"\u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c","text":"<p>\u0415\u0441\u043b\u0438 \u0432\u044b \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u043e \u0437\u0430\u043a\u043e\u043c\u043c\u0438\u0442\u0438\u043b\u0438 \u0441\u0435\u043a\u0440\u0435\u0442:</p> <ol> <li>\u041d\u0435\u043c\u0435\u0434\u043b\u0435\u043d\u043d\u043e \u0441\u043e\u043e\u0431\u0449\u0438\u0442\u0435 \u043c\u0435\u043d\u0442\u043e\u0440\u0443.</li> <li>\u0421\u043c\u0435\u043d\u0438\u0442\u0435 \u0441\u043a\u043e\u043c\u043f\u0440\u043e\u043c\u0435\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c/\u043a\u043b\u044e\u0447.</li> <li>\u041d\u0435 \u043f\u044b\u0442\u0430\u0439\u0442\u0435\u0441\u044c \u043f\u0440\u043e\u0441\u0442\u043e \"\u0443\u0434\u0430\u043b\u0438\u0442\u044c\" \u0435\u0433\u043e \u0432 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u043c \u043a\u043e\u043c\u043c\u0438\u0442\u0435 \u2014 \u043e\u043d \u043e\u0441\u0442\u0430\u043d\u0435\u0442\u0441\u044f \u0432 \u0438\u0441\u0442\u043e\u0440\u0438\u0438 Git.</li> </ol>"},{"location":"onboarding/local_setup/","title":"\u041b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0437\u0430\u043f\u0443\u0441\u043a \u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \ud83d\udcbb","text":"<p>\u042d\u0442\u043e\u0442 \u0433\u0430\u0439\u0434 \u043f\u043e\u043c\u043e\u0436\u0435\u0442 \u0432\u0430\u043c \u0440\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u043f\u043e\u043b\u043d\u0443\u044e \u0441\u0440\u0435\u0434\u0443 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438 Gifty \u043d\u0430 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u0435 \u0437\u0430 5\u201310 \u043c\u0438\u043d\u0443\u0442.</p>"},{"location":"onboarding/local_setup/#_2","title":"\ud83d\udccb \u0422\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f","text":"<p>\u041f\u0435\u0440\u0435\u0434 \u043d\u0430\u0447\u0430\u043b\u043e\u043c \u0443\u0431\u0435\u0434\u0438\u0442\u0435\u0441\u044c, \u0447\u0442\u043e \u0443 \u0432\u0430\u0441 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u044b:</p> <ul> <li>Python 3.11+</li> <li>Docker &amp; Docker Compose</li> <li>Git</li> <li>Make (\u0436\u0435\u043b\u0430\u0442\u0435\u043b\u044c\u043d\u043e)</li> </ul>"},{"location":"onboarding/local_setup/#_3","title":"\ud83d\ude80 \u0411\u044b\u0441\u0442\u0440\u044b\u0439 \u0441\u0442\u0430\u0440\u0442","text":""},{"location":"onboarding/local_setup/#1","title":"1. \u041a\u043b\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0438 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u0435","text":"<pre><code>git clone git@github.com:IceDarold/gifty-backend.git\ncd gifty-backend\n\n# \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f\npython3 -m venv .venv\nsource .venv/bin/activate\npip install -r requirements.txt\n</code></pre>"},{"location":"onboarding/local_setup/#2","title":"2. \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f","text":"<p>\u0421\u043a\u043e\u043f\u0438\u0440\u0443\u0439\u0442\u0435 \u043f\u0440\u0438\u043c\u0435\u0440 \u043a\u043e\u043d\u0444\u0438\u0433\u0430 \u0438 \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0431\u0430\u0437\u043e\u0432\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f: <pre><code>cp .env.example .env\n</code></pre> \u0414\u043b\u044f \u0431\u0430\u0437\u043e\u0432\u043e\u0433\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e, \u043d\u043e \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b OAuth \u0438 Telegram \u043d\u0443\u0436\u043d\u043e \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u043e\u043f\u0438\u0441\u0430\u0442\u044c \u043d\u0430\u0441\u0442\u043e\u044f\u0449\u0438\u0435 \u0442\u043e\u043a\u0435\u043d\u044b.</p>"},{"location":"onboarding/local_setup/#3-docker","title":"3. \u0418\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 (Docker)","text":"<p>\u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0435 \u0431\u0430\u0437\u0443 \u0434\u0430\u043d\u043d\u044b\u0445, Redis \u0438 RabbitMQ: <pre><code>docker compose up -d\n</code></pre> \u042d\u0442\u043e \u043f\u043e\u0434\u043d\u0438\u043c\u0435\u0442:</p> <ul> <li>PostgreSQL (Port 5432) \u2014 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439.</li> <li>Redis (Port 6379) \u2014 \u0441\u0435\u0441\u0441\u0438\u0438 \u0438 \u043a\u0435\u0448.</li> <li>RabbitMQ (Port 5672, UI 15672) \u2014 \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u0437\u0430\u0434\u0430\u0447 \u0434\u043b\u044f \u043f\u0430\u0440\u0441\u0435\u0440\u043e\u0432.</li> </ul>"},{"location":"onboarding/local_setup/#4","title":"4. \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445","text":"<p>\u041f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u0435 \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u0438, \u0447\u0442\u043e\u0431\u044b \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0443 \u0442\u0430\u0431\u043b\u0438\u0446: <pre><code>alembic upgrade head\n</code></pre></p>"},{"location":"onboarding/local_setup/#5-seed","title":"5. \u041d\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u043c\u0438 (Seed)","text":"<p>\u0427\u0442\u043e\u0431\u044b \u0432 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0438 \u0441\u0440\u0430\u0437\u0443 \u043f\u043e\u044f\u0432\u0438\u043b\u0438\u0441\u044c \u0442\u043e\u0432\u0430\u0440\u044b \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u043e\u0432, \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0435 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044e: <pre><code>python scripts/run_sync.py\n</code></pre> \u042d\u0442\u043e\u0442 \u0441\u043a\u0440\u0438\u043f\u0442 \u043f\u043e\u0434\u0442\u044f\u043d\u0435\u0442 \u0431\u0430\u0437\u043e\u0432\u044b\u0439 \u043a\u0430\u0442\u0430\u043b\u043e\u0433 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0438\u0437 \u0432\u043d\u0435\u0448\u043d\u0435\u0433\u043e API (\u0435\u0441\u043b\u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d \u0442\u043e\u043a\u0435\u043d) \u0438\u043b\u0438 \u0441\u043e\u0437\u0434\u0430\u0441\u0442 \u043c\u043e\u043a\u2011\u0434\u0430\u043d\u043d\u044b\u0435.</p>"},{"location":"onboarding/local_setup/#_4","title":"\ud83d\udee0 \u0417\u0430\u043f\u0443\u0441\u043a \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432","text":"<p>\u041f\u0440\u043e\u0435\u043a\u0442 \u0441\u043e\u0441\u0442\u043e\u0438\u0442 \u0438\u0437 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u043d\u0435\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u044b\u0445 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0443\u0436\u043d\u043e \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c:</p>"},{"location":"onboarding/local_setup/#core-api","title":"Core API (\u041e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0431\u044d\u043a\u0435\u043d\u0434)","text":"<p><pre><code>uvicorn app.main:app --reload\n</code></pre> \u0414\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u043f\u043e \u0430\u0434\u0440\u0435\u0441\u0443: <code>http://localhost:8000</code>. \u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f Swagger: <code>http://localhost:8000/docs</code>.</p>"},{"location":"onboarding/local_setup/#scraper-worker","title":"Scraper Worker (\u041f\u0430\u0440\u0441\u0435\u0440)","text":"<p><pre><code>python -m services.run_worker\n</code></pre> \u0421\u043b\u0443\u0448\u0430\u0435\u0442 RabbitMQ \u0438 \u0436\u0434\u0435\u0442 \u0437\u0430\u0434\u0430\u0447 \u043d\u0430 \u043f\u0430\u0440\u0441\u0438\u043d\u0433.</p>"},{"location":"onboarding/local_setup/#telegram-bot","title":"Telegram Bot","text":"<pre><code>python -m services.telegram_bot.app.main\n</code></pre>"},{"location":"onboarding/local_setup/#_5","title":"\u2705 \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0440\u0430\u0431\u043e\u0442\u043e\u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u0438","text":"<p>\u0427\u0442\u043e\u0431\u044b \u0443\u0431\u0435\u0434\u0438\u0442\u044c\u0441\u044f, \u0447\u0442\u043e \u0432\u0441\u0451 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043e \u0432\u0435\u0440\u043d\u043e, \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u044b:</p> <ol> <li>Heartbeat: <code>GET http://localhost:8000/health</code> \u2014 \u0434\u043e\u043b\u0436\u0435\u043d \u0432\u0435\u0440\u043d\u0443\u0442\u044c <code>{\"status\": \"ok\"}</code>.</li> <li>RabbitMQ UI: <code>http://localhost:15672</code> (guest/guest) \u2014 \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435, \u0447\u0442\u043e \u0432\u043e\u0440\u043a\u0435\u0440 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u043b\u0441\u044f \u0438 \u0441\u043e\u0437\u0434\u0430\u043b \u043e\u0447\u0435\u0440\u0435\u0434\u044c.</li> <li>Internal Stats: <code>GET http://localhost:8000/internal/stats</code> (\u0442\u0440\u0435\u0431\u0443\u0435\u0442 <code>X-Internal-Token</code>) \u2014 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0441\u0432\u044f\u0437\u0438 Core API \u0441 \u0411\u0414 \u0438 \u043f\u0430\u0440\u0441\u0435\u0440\u0430\u043c\u0438.</li> </ol>"},{"location":"onboarding/local_setup/#_6","title":"\ud83d\udca1 \u041f\u043e\u043b\u0435\u0437\u043d\u044b\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u044b","text":"<ul> <li><code>docker compose logs -f</code> \u2014 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u043b\u043e\u0433\u043e\u0432 \u0431\u0430\u0437\u044b \u0438 \u043e\u0447\u0435\u0440\u0435\u0434\u0435\u0439.</li> <li><code>pip install -e .</code> \u2014 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043f\u0440\u043e\u0435\u043a\u0442\u0430 \u0432 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0435\u043c\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435 \u0434\u043b\u044f \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0433\u043e \u0438\u043c\u043f\u043e\u0440\u0442\u0430 \u043c\u043e\u0434\u0443\u043b\u0435\u0439.</li> <li><code>pytest</code> \u2014 \u0437\u0430\u043f\u0443\u0441\u043a \u0442\u0435\u0441\u0442\u043e\u0432 (\u0443\u0431\u0435\u0434\u0438\u0442\u0435\u0441\u044c, \u0447\u0442\u043e \u043f\u043e\u0434\u043d\u044f\u0442\u0430 \u0442\u0435\u0441\u0442\u043e\u0432\u0430\u044f \u0411\u0414).</li> </ul>"},{"location":"onboarding/quick_start/","title":"\u041e\u043d\u0431\u043e\u0440\u0434\u0438\u043d\u0433 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430","text":"<p>\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c \u0432 \u043a\u043e\u043c\u0430\u043d\u0434\u0443 Gifty. \u042d\u0442\u043e\u0442 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442 \u2014 \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u044b\u0439 \u043c\u0430\u0440\u0448\u0440\u0443\u0442 \u043d\u0430 \u043f\u0435\u0440\u0432\u044b\u0435 \u0434\u043d\u0438: \u0433\u0434\u0435 \u0438\u0441\u043a\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0438, \u043a\u0430\u043a \u0443\u0441\u0442\u0440\u043e\u0435\u043d\u044b \u0432\u0441\u0442\u0440\u0435\u0447\u0438 \u0438 \u043a\u0430\u043a\u0438\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u044b \u043d\u0443\u0436\u043d\u043e \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c. \u0415\u0441\u043b\u0438 \u0447\u0442\u043e-\u0442\u043e \u043d\u0435\u043f\u043e\u043d\u044f\u0442\u043d\u043e, \u043f\u0435\u0440\u0432\u044b\u043c \u043a\u043e\u043d\u0442\u0430\u043a\u0442\u043d\u044b\u043c \u043b\u0438\u0446\u043e\u043c \u0432\u0441\u0435\u0433\u0434\u0430 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0432\u0430\u0448 \u043c\u0435\u043d\u0442\u043e\u0440.</p>"},{"location":"onboarding/quick_start/#_2","title":"\u0411\u044b\u0441\u0442\u0440\u044b\u0439 \u0447\u0435\u043a\u2011\u043b\u0438\u0441\u0442 \u043d\u0430 \u0441\u0442\u0430\u0440\u0442","text":"<ul> <li> \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c \u0443 \u043c\u0435\u043d\u0442\u043e\u0440\u0430 \u0434\u043b\u044f \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u0432 \u0442\u0435\u043b\u0435\u0433\u0440\u0430\u043c\u2011\u0431\u043e\u0442\u0435.</li> <li> \u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0432 \u0431\u043e\u0442\u0435 \u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u0438\u0442\u044c \u043d\u0443\u0436\u043d\u044b\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u044b.</li> <li> \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043a GitHub\u2011\u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044e \u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u0443\u044e \u0441\u0440\u0435\u0434\u0443.</li> <li> \u041d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u0447\u0435\u0440\u0435\u0437 DataGrip + SSH.</li> <li> \u041e\u0437\u043d\u0430\u043a\u043e\u043c\u0438\u0442\u044c\u0441\u044f \u0441 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0438 \u0430\u043a\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u043c\u0438 \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f\u043c\u0438 \u0440\u0430\u0431\u043e\u0442\u044b.</li> </ul>"},{"location":"onboarding/quick_start/#_3","title":"\u0413\u0434\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u0438 \u043a\u0430\u043a \u043c\u044b \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u0443\u0435\u043c\u0441\u044f","text":""},{"location":"onboarding/quick_start/#_4","title":"\u0417\u0430\u0434\u0430\u0447\u0438","text":"<ul> <li>\u0412\u0441\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u0432\u0435\u0434\u0443\u0442\u0441\u044f \u0432 Weeek. \u0414\u043e\u0441\u0442\u0443\u043f \u043a \u0434\u043e\u0441\u043a\u0435 \u0438 \u043f\u0440\u043e\u0435\u043a\u0442\u0430\u043c \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u043c\u0435\u043d\u0442\u043e\u0440.</li> <li>\u0421\u0442\u0430\u0442\u0443\u0441\u044b \u0437\u0430\u0434\u0430\u0447, \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442\u044b \u0438 \u0434\u0435\u0434\u043b\u0430\u0439\u043d\u044b \u2014 \u0442\u043e\u043b\u044c\u043a\u043e \u0432 Weeek. \u0415\u0441\u043b\u0438 \u0437\u0430\u0434\u0430\u0447\u0430 \u043e\u0431\u0441\u0443\u0436\u0434\u0430\u0435\u0442\u0441\u044f \u0443\u0441\u0442\u043d\u043e, \u043f\u043e\u043f\u0440\u043e\u0441\u0438\u0442\u0435 \u0437\u0430\u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0435\u0435 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u043e\u0439.</li> </ul>"},{"location":"onboarding/quick_start/#_5","title":"\u0412\u0441\u0442\u0440\u0435\u0447\u0438","text":"<ul> <li>\u041f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a \u0438 \u0441\u0440\u0435\u0434\u0430: \u0432 20:30 \u043f\u043e \u041c\u0421\u041a, \u0444\u043e\u0440\u043c\u0430\u0442 15\u2011\u043c\u0438\u043d\u0443\u0442\u043d\u044b\u0445 \u0441\u0438\u043d\u043a\u043e\u0432.</li> <li>\u041f\u044f\u0442\u043d\u0438\u0446\u0430: \u0432 20:00 \u043f\u043e \u041c\u0421\u041a, \u043e\u0431\u0449\u0438\u0439 \u0441\u0442\u0430\u0442\u0443\u0441\u2011\u0430\u043f\u0434\u0435\u0439\u0442.</li> </ul> <p>\u0415\u0441\u043b\u0438 \u0432\u044b \u043d\u0435 \u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u2014 \u043d\u0430\u043f\u0438\u0448\u0438\u0442\u0435 \u0437\u0430\u0440\u0430\u043d\u0435\u0435 \u0432 \u043a\u043e\u043c\u0430\u043d\u0434\u043d\u044b\u0439 \u0447\u0430\u0442 \u0438 \u043e\u0441\u0442\u0430\u0432\u044c\u0442\u0435 \u043a\u0440\u0430\u0442\u043a\u0438\u0439 \u0430\u043f\u0434\u0435\u0439\u0442 \u043f\u043e \u0441\u0432\u043e\u0438\u043c \u0437\u0430\u0434\u0430\u0447\u0430\u043c.</p>"},{"location":"onboarding/quick_start/#_6","title":"\u0414\u043e\u0441\u0442\u0443\u043f\u044b \u0438 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438","text":""},{"location":"onboarding/quick_start/#1","title":"1) \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u0432 \u0442\u0435\u043b\u0435\u0433\u0440\u0430\u043c\u2011\u0431\u043e\u0442\u0435","text":"<p>\u0411\u043e\u0442 \u2014 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u043a\u0430\u043d\u0430\u043b \u0434\u043b\u044f \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0434\u043e\u0441\u0442\u0443\u043f\u043e\u0432 \u0438 \u043f\u0435\u0440\u0432\u0438\u0447\u043d\u044b\u0445 \u0438\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u0439.</p> <ul> <li>\u0411\u043e\u0442: <code>@giftyai_team_bot</code></li> <li>\u041f\u0430\u0440\u043e\u043b\u044c \u0432\u044b\u0434\u0430\u0435\u0442 \u0432\u0430\u0448 \u043c\u0435\u043d\u0442\u043e\u0440</li> <li>\u041a\u043e\u043c\u0430\u043d\u0434\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438:</li> </ul> <pre><code>/start &lt;\u043f\u0430\u0440\u043e\u043b\u044c&gt;\n</code></pre> <p>\u041f\u043e\u0441\u043b\u0435 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u043f\u0435\u0440\u0435\u0439\u0434\u0438\u0442\u0435 \u043a \u0433\u0430\u0439\u0434\u0443 \u043f\u043e \u0440\u0430\u0431\u043e\u0442\u0435 \u0441 \u0431\u043e\u0442\u043e\u043c \u0438 \u043e\u0437\u043d\u0430\u043a\u043e\u043c\u044c\u0442\u0435\u0441\u044c \u0441 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u043c\u0438 \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u044f\u043c\u0438 (\u0437\u0430\u043f\u0440\u043e\u0441\u044b \u0434\u043e\u0441\u0442\u0443\u043f\u043e\u0432, \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f, \u0441\u0442\u0430\u0442\u0443\u0441\u044b).</p> <p>\u0421\u0441\u044b\u043b\u043a\u0430: \u0413\u0430\u0439\u0434 \u043f\u043e \u0440\u0430\u0431\u043e\u0442\u0435 \u0441 \u0431\u043e\u0442\u043e\u043c</p>"},{"location":"onboarding/quick_start/#2-github","title":"2) \u0414\u043e\u0441\u0442\u0443\u043f \u043a GitHub","text":"<p>\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0434\u0432\u0443\u043c\u044f \u0441\u043f\u043e\u0441\u043e\u0431\u0430\u043c\u0438:</p> <ul> <li>\u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441 \u0447\u0435\u0440\u0435\u0437 \u0442\u0435\u043b\u0435\u0433\u0440\u0430\u043c\u2011\u0431\u043e\u0442\u0430,</li> <li>\u0438\u043b\u0438 \u0431\u044b\u0442\u044c \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u043c \u0432 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439 \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e \u0432\u0430\u0448\u0438\u043c \u043c\u0435\u043d\u0442\u043e\u0440\u043e\u043c.</li> </ul> <p>\u041f\u043e\u0441\u043b\u0435 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0439\u0442\u0435 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044e \u043f\u043e \u0440\u0430\u0431\u043e\u0447\u0435\u043c\u0443 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0443 \u0441 GitHub: \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0432\u0435\u0442\u043e\u043a, \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u043a\u043e\u043c\u043c\u0438\u0442\u043e\u0432, pull\u2011requests \u0438 \u0440\u0435\u0432\u044c\u044e.</p> <p>\u0421\u0441\u044b\u043b\u043a\u0430: \u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u043f\u043e \u0440\u0430\u0431\u043e\u0442\u0435 \u0441 GitHub</p>"},{"location":"onboarding/quick_start/#3-datagrip-ssh","title":"3) \u0414\u043e\u0441\u0442\u0443\u043f \u043a \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 (DataGrip + SSH)","text":"<p>\u0414\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0431\u0430\u0437\u043e\u0439 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c DataGrip \u0441 SSH\u2011\u0442\u0443\u043d\u043d\u0435\u043b\u0435\u043c.</p> <p>\u0427\u0442\u043e \u043d\u0443\u0436\u043d\u043e \u043e\u0442 \u043c\u0435\u043d\u0442\u043e\u0440\u0430 \u0438\u043b\u0438 \u0447\u0435\u0440\u0435\u0437 \u0431\u043e\u0442\u0430:</p> <ul> <li>SSH\u2011\u0445\u043e\u0441\u0442 \u0438 \u043f\u043e\u0440\u0442</li> <li>SSH\u2011\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c</li> <li>\u043f\u0440\u0438\u0432\u0430\u0442\u043d\u044b\u0439 \u043a\u043b\u044e\u0447 \u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c</li> <li>\u0445\u043e\u0441\u0442/\u043f\u043e\u0440\u0442 \u0431\u0430\u0437\u044b, \u0438\u043c\u044f \u0431\u0430\u0437\u044b, \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0411\u0414</li> </ul> <p>\u0418\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f \u043f\u043e \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0435 DataGrip:</p> <ol> <li>\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 DataGrip: \u043e\u0444\u0438\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0439 \u0441\u0430\u0439\u0442.</li> <li>\u041e\u0442\u043a\u0440\u043e\u0439\u0442\u0435 <code>Data Sources and Drivers</code> \u2192 <code>+</code> \u2192 <code>PostgreSQL</code>.</li> <li>\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0431\u0430\u0437\u0435 (Host, Port, Database, User, Password).</li> <li>\u041f\u0435\u0440\u0435\u0439\u0434\u0438\u0442\u0435 \u0432\u043e \u0432\u043a\u043b\u0430\u0434\u043a\u0443 <code>SSH/SSL</code> \u0438 \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u0435 <code>Use SSH tunnel</code>.</li> <li>\u0423\u043a\u0430\u0436\u0438\u0442\u0435 SSH Host, Port, User.</li> <li>\u0412 \u0440\u0430\u0437\u0434\u0435\u043b\u0435 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 <code>Key pair</code> \u0438\u043b\u0438 <code>Password</code> \u0438 \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u043a\u043b\u044e\u0447/\u043f\u0430\u0440\u043e\u043b\u044c.</li> <li>\u041d\u0430\u0436\u043c\u0438\u0442\u0435 <code>Test Connection</code> \u0438 \u0443\u0431\u0435\u0434\u0438\u0442\u0435\u0441\u044c, \u0447\u0442\u043e \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e.</li> </ol> <p>\u0412\u0430\u0436\u043d\u043e: SSH\u2011\u0434\u0430\u043d\u043d\u044b\u0435 \u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u044b \u2014 \u043a\u043e\u043d\u0444\u0438\u0434\u0435\u043d\u0446\u0438\u0430\u043b\u044c\u043d\u044b, \u043d\u0435 \u043f\u0435\u0440\u0435\u0441\u044b\u043b\u0430\u0439\u0442\u0435 \u0438\u0445 \u0432 \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0435 \u043a\u0430\u043d\u0430\u043b\u044b.</p> <p>\u041f\u043e\u0441\u043b\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043e\u0437\u043d\u0430\u043a\u043e\u043c\u044c\u0442\u0435\u0441\u044c \u0441 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0430\u043c\u0438 \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0431\u0430\u0437\u043e\u0439 \u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u0430\u043c\u0438 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438.</p> <p>\u0421\u0441\u044b\u043b\u043a\u0430: \u0413\u0430\u0439\u0434 \u043f\u043e \u0440\u0430\u0431\u043e\u0442\u0435 \u0441 \u0431\u0430\u0437\u043e\u0439 \u0434\u0430\u043d\u043d\u044b\u0445</p>"},{"location":"onboarding/quick_start/#_7","title":"\u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u0438 \u0434\u0435\u043f\u043b\u043e\u0439","text":""},{"location":"onboarding/quick_start/#pytest","title":"\u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0442\u0435\u0441\u0442\u044b (Pytest)","text":"<p>\u041c\u044b \u0443\u0434\u0435\u043b\u044f\u0435\u043c \u0431\u043e\u043b\u044c\u0448\u043e\u0435 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0443 \u043a\u043e\u0434\u0430. \u041f\u0435\u0440\u0435\u0434 \u0442\u0435\u043c \u043a\u0430\u043a \u0432\u0430\u0448 Pull Request \u0431\u0443\u0434\u0435\u0442 \u0432\u043b\u0438\u0442 \u0432 \u043e\u0441\u043d\u043e\u0432\u043d\u0443\u044e \u0432\u0435\u0442\u043a\u0443, \u043e\u043d \u0434\u043e\u043b\u0436\u0435\u043d \u043f\u0440\u043e\u0439\u0442\u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u043c\u0438 \u0442\u0435\u0441\u0442\u0430\u043c\u0438. \u0412\u044b \u0442\u0430\u043a\u0436\u0435 \u043c\u043e\u0436\u0435\u0442\u0435 (\u0438 \u0434\u043e\u043b\u0436\u043d\u044b) \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c \u0442\u0435\u0441\u0442\u044b \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e.</p> <p>\ud83d\udc49 \u0413\u0430\u0439\u0434 \u043f\u043e \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044e</p>"},{"location":"onboarding/quick_start/#cicd","title":"CI/CD \u041f\u0430\u0439\u043f\u043b\u0430\u0439\u043d","text":"<p>\u0412 \u043f\u0440\u043e\u0435\u043a\u0442\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0434\u0435\u043f\u043b\u043e\u0439 \u0447\u0435\u0440\u0435\u0437 GitHub Actions. - \u041f\u0440\u0438 \u043a\u0430\u0436\u0434\u043e\u043c \u043f\u0443\u0448\u0435 \u0432 <code>develop</code> \u0438\u043b\u0438 <code>main</code> \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u044e\u0442\u0441\u044f \u0442\u0435\u0441\u0442\u044b \u0438 \u043b\u0438\u043d\u0442\u0435\u0440\u044b. - \u041f\u043e\u0441\u043b\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u044b\u0445 \u0442\u0435\u0441\u0442\u043e\u0432 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u0441\u0431\u043e\u0440\u043a\u0430 Docker-\u043e\u0431\u0440\u0430\u0437\u043e\u0432 \u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435.</p> <p>\ud83d\udc49 \u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435 \u043e \u0434\u0435\u043f\u043b\u043e\u0435 \u0438 CI/CD</p>"},{"location":"onboarding/quick_start/#_8","title":"\u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u0438 \u0410\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0430","text":"<p>\u0414\u043b\u044f \u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u043d\u0438\u044f \u0437\u0434\u043e\u0440\u043e\u0432\u044c\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0438 \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u043c\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u0441\u0442\u0435\u043a PostHog + Prometheus + Loki. \u0415\u0441\u043b\u0438 \u0432\u0430\u0448\u0430 \u0437\u0430\u0434\u0430\u0447\u0430 \u0441\u0432\u044f\u0437\u0430\u043d\u0430 \u0441 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435\u043c \u043d\u043e\u0432\u044b\u0445 \u043c\u0435\u0442\u0440\u0438\u043a \u0438\u043b\u0438 \u043b\u043e\u0433\u043e\u0432, \u043e\u0437\u043d\u0430\u043a\u043e\u043c\u044c\u0442\u0435\u0441\u044c \u0441 \u0433\u0430\u0439\u0434\u0430\u043c\u0438:</p> <p>\ud83d\udc49 \u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0438 \u0438 KPI</p>"},{"location":"onboarding/quick_start/#_9","title":"\u0427\u0442\u043e \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u0432 \u043f\u0435\u0440\u0432\u0443\u044e \u043e\u0447\u0435\u0440\u0435\u0434\u044c","text":"<ol> <li>\u041e\u0431\u0437\u043e\u0440 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u044b \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u2014 \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u043d\u044f\u0442\u044c, \u043a\u0430\u043a \u0443\u0441\u0442\u0440\u043e\u0435\u043d\u044b \u043a\u043b\u044e\u0447\u0435\u0432\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u0438 \u0438\u0445 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435.</li> </ol> <p>\ud83d\udc49 \u041e\u0431\u0437\u043e\u0440 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u044b</p> <ol> <li>\u0422\u0435\u043a\u0443\u0449\u0438\u0435 \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f, \u043c\u0430\u0439\u043b\u0441\u0442\u043e\u0443\u043d\u044b \u0438 \u0434\u0435\u0434\u043b\u0430\u0439\u043d\u044b \u2014 \u0447\u0442\u043e\u0431\u044b \u0432\u0438\u0434\u0435\u0442\u044c \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0435 \u0446\u0435\u043b\u0438 \u0438 \u0441\u0440\u043e\u043a\u0438.</li> </ol> <p>\ud83d\udc49 \u0422\u0435\u043a\u0443\u0449\u0438\u0435 \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0438 \u043c\u0430\u0439\u043b\u0441\u0442\u043e\u0443\u043d\u044b</p>"},{"location":"onboarding/quick_start/#-","title":"\u0415\u0441\u043b\u0438 \u0447\u0442\u043e-\u0442\u043e \u043d\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442","text":"<ul> <li>\u0421\u043d\u0430\u0447\u0430\u043b\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u044d\u0442\u043e\u0442 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442 \u0438 \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435 \u0433\u0430\u0439\u0434\u044b.</li> <li>\u0415\u0441\u043b\u0438 \u043e\u0442\u0432\u0435\u0442\u0430 \u043d\u0435\u0442 \u2014 \u043d\u0430\u043f\u0438\u0448\u0438\u0442\u0435 \u043c\u0435\u043d\u0442\u043e\u0440\u0443 \u0438 \u0443\u0442\u043e\u0447\u043d\u0438\u0442\u0435, \u0447\u0442\u043e \u0438\u043c\u0435\u043d\u043d\u043e \u043d\u0435 \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442\u0441\u044f \u0438 \u043d\u0430 \u043a\u0430\u043a\u043e\u043c \u0448\u0430\u0433\u0435.</li> </ul>"},{"location":"onboarding/roadmap/","title":"\u0422\u0435\u043a\u0443\u0449\u0438\u0435 \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0438 \u043c\u0430\u0439\u043b\u0441\u0442\u043e\u0443\u043d\u044b","text":"<p>\u042d\u0442\u043e\u0442 \u0440\u0430\u0437\u0434\u0435\u043b \u0444\u0438\u043a\u0441\u0438\u0440\u0443\u0435\u0442 \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u043a\u043e\u043c\u0430\u043d\u0434\u044b, \u043a\u043b\u044e\u0447\u0435\u0432\u044b\u0435 \u043c\u0430\u0439\u043b\u0441\u0442\u043e\u0443\u043d\u044b \u0438 \u0434\u0435\u0434\u043b\u0430\u0439\u043d\u044b \u043f\u043e \u043a\u0440\u0443\u043f\u043d\u044b\u043c \u0431\u043b\u043e\u043a\u0430\u043c. \u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043f\u0440\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0438 \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442\u043e\u0432 \u0438\u043b\u0438 \u043f\u043e\u044f\u0432\u043b\u0435\u043d\u0438\u0438 \u043d\u043e\u0432\u044b\u0445 \u0446\u0435\u043b\u0435\u0439.</p>"},{"location":"onboarding/roadmap/#_2","title":"\u0422\u0435\u043a\u0443\u0449\u0438\u0435 \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f","text":"\u041d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0426\u0435\u043b\u044c \u0412\u043b\u0430\u0434\u0435\u043b\u0435\u0446 \u0421\u0442\u0430\u0442\u0443\u0441 \u041f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u044f Core API \u0421\u0442\u0430\u0431\u0438\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0438 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0435 API TBD \u0412 \u0440\u0430\u0431\u043e\u0442\u0435 \u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u043e\u0432 \u0438 SLO Recommendation Engine \u0423\u043b\u0443\u0447\u0448\u0435\u043d\u0438\u0435 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0430 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439 TBD \u0412 \u0440\u0430\u0431\u043e\u0442\u0435 \u041c\u0435\u0442\u0440\u0438\u043a\u0438: CTR, \u043a\u043e\u043d\u0432\u0435\u0440\u0441\u0438\u044f, NDCG Parsing / Ingestion \u0420\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0435 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u043e\u0432 \u0438 \u043d\u0430\u0434\u0435\u0436\u043d\u043e\u0441\u0442\u0438 TBD \u041f\u043b\u0430\u043d\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u041e\u0447\u0435\u0440\u0435\u0434\u044c \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u043e\u0432 \u0432 Weeek Analytics \u0412\u0438\u0442\u0440\u0438\u043d\u044b \u0438 \u0434\u0430\u0448\u0431\u043e\u0440\u0434\u044b TBD \u041f\u043b\u0430\u043d\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u041e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430"},{"location":"onboarding/roadmap/#_3","title":"\u041c\u0430\u0439\u043b\u0441\u0442\u043e\u0443\u043d\u044b \u0438 \u0434\u0435\u0434\u043b\u0430\u0439\u043d\u044b","text":"\u0420\u0430\u0437\u0434\u0435\u043b \u041c\u0430\u0439\u043b\u0441\u0442\u043e\u0443\u043d \u0426\u0435\u043b\u0435\u0432\u0430\u044f \u0434\u0430\u0442\u0430 \u0421\u0442\u0430\u0442\u0443\u0441 \u0420\u0438\u0441\u043a\u0438 Core API \u0412\u0435\u0440\u0441\u0438\u044f vX.Y TBD \u041f\u043b\u0430\u043d\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0417\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u044c \u043e\u0442 \u0441\u0445\u0435\u043c\u044b \u0411\u0414 Recommendation Engine \u0420\u0435\u043b\u0438\u0437 \u043c\u043e\u0434\u0435\u043b\u0438 vN TBD \u041f\u043b\u0430\u043d\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u041d\u0443\u0436\u043d\u044b \u0434\u0430\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f Parsing / Ingestion \u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 N \u043d\u043e\u0432\u044b\u0445 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u043e\u0432 TBD \u041f\u043b\u0430\u043d\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u044f \u043f\u043e \u0430\u043d\u0442\u0438\u0431\u043e\u0442\u0430\u043c Analytics \u0417\u0430\u043f\u0443\u0441\u043a \u043d\u043e\u0432\u043e\u0433\u043e \u0434\u0430\u0448\u0431\u043e\u0440\u0434\u0430 TBD \u041f\u043b\u0430\u043d\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0423\u0442\u043e\u0447\u043d\u0438\u0442\u044c \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f"},{"location":"onboarding/roadmap/#_4","title":"\u041f\u0440\u0430\u0432\u0438\u043b\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b","text":"<ul> <li>\u041e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439 \u0437\u0430 \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442 \u0441\u0442\u0430\u0442\u0443\u0441 \u043c\u0438\u043d\u0438\u043c\u0443\u043c \u0440\u0430\u0437 \u0432 \u043d\u0435\u0434\u0435\u043b\u044e.</li> <li>\u0414\u0430\u0442\u044b \u0444\u0438\u043a\u0441\u0438\u0440\u0443\u044e\u0442\u0441\u044f \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 <code>YYYY-MM-DD</code>.</li> <li>\u0415\u0441\u043b\u0438 \u0434\u0435\u0434\u043b\u0430\u0439\u043d \u0441\u0434\u0432\u0438\u0433\u0430\u0435\u0442\u0441\u044f \u2014 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0439\u0442\u0435 \u043f\u0440\u0438\u0447\u0438\u043d\u0443 \u0432 \u043a\u043e\u043b\u043e\u043d\u043a\u0443 \u00ab\u0420\u0438\u0441\u043a\u0438\u00bb.</li> </ul>"},{"location":"onboarding/tech_stack/","title":"Tech Stack &amp; Concepts \ud83d\udee0\ufe0f","text":"<p>\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c \u0432 \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0441\u0435\u0440\u0434\u0446\u0435 Gifty.  \u041d\u0430 \u044d\u0442\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435 \u043c\u044b \u0441\u043e\u0431\u0440\u0430\u043b\u0438 \u043a\u043b\u044e\u0447\u0435\u0432\u044b\u0435 \u0442\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0438 \u0438 \u043a\u043e\u043d\u0446\u0435\u043f\u0446\u0438\u0438, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0441\u0442\u043e\u0438\u0442 \u043d\u0430\u0448 \u043f\u0440\u043e\u0435\u043a\u0442. \u042d\u0442\u043e \u0432\u0430\u0448\u0430 \u043a\u0430\u0440\u0442\u0430 \u043c\u0435\u0441\u0442\u043d\u043e\u0441\u0442\u0438: \u043d\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0437\u043d\u0430\u0442\u044c \u0432\u0441\u0435 \u0434\u0435\u0442\u0430\u043b\u0438 \u0441\u0440\u0430\u0437\u0443, \u043d\u043e \u0432\u0430\u0436\u043d\u043e \u043f\u043e\u043d\u0438\u043c\u0430\u0442\u044c, \u043f\u043e\u0447\u0435\u043c\u0443 \u043c\u044b \u0432\u044b\u0431\u0440\u0430\u043b\u0438 \u0438\u043c\u0435\u043d\u043d\u043e \u044d\u0442\u0438 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u044b \u0438 \u043a\u0430\u043a \u043e\u043d\u0438 \u0441\u0432\u044f\u0437\u0430\u043d\u044b \u0434\u0440\u0443\u0433 \u0441 \u0434\u0440\u0443\u0433\u043e\u043c.</p>"},{"location":"onboarding/tech_stack/#foundation","title":"\ud83c\udfd7 \u0418\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 (Foundation)","text":"<p>\u041d\u0430\u0448 \u0444\u0443\u043d\u0434\u0430\u043c\u0435\u043d\u0442 \u2014 \u044d\u0442\u043e \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0438\u0437\u0430\u0446\u0438\u044f \u0438 \u043d\u0430\u0434\u0435\u0436\u043d\u044b\u0435 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445.</p>"},{"location":"onboarding/tech_stack/#docker-docker-compose","title":"\ud83d\udc33 Docker &amp; Docker Compose","text":"<p>\u0417\u0430\u0447\u0435\u043c: \"It works on my machine\" \u2014 \u0431\u043e\u043b\u044c\u0448\u0435 \u043d\u0435 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442. \u041c\u044b \u0443\u043f\u0430\u043a\u043e\u0432\u044b\u0432\u0430\u0435\u043c \u0432\u0441\u0451 \u0432 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u044b. \u0412\u0435\u0441\u044c \u043f\u0440\u043e\u0435\u043a\u0442 (API, \u0411\u0414, \u041f\u0430\u0440\u0441\u0435\u0440\u044b, \u0411\u043e\u0442) \u043f\u043e\u0434\u043d\u0438\u043c\u0430\u0435\u0442\u0441\u044f \u043e\u0434\u043d\u043e\u0439 \u043a\u043e\u043c\u0430\u043d\u0434\u043e\u0439 <code>docker-compose up -d</code>. \u0415\u0441\u043b\u0438 \u0432\u044b \u0434\u043e\u0431\u0430\u0432\u0438\u043b\u0438 \u043d\u043e\u0432\u0443\u044e \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0443 \u0432 <code>requirements.txt</code>, \u043d\u0435 \u0437\u0430\u0431\u0443\u0434\u044c\u0442\u0435 \u043f\u0435\u0440\u0435\u0441\u043e\u0431\u0440\u0430\u0442\u044c \u043e\u0431\u0440\u0430\u0437 (<code>docker-compose build</code>).</p> <p>\ud83d\udc49 \u0413\u0430\u0439\u0434 \u043f\u043e \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u043c\u0443 \u0437\u0430\u043f\u0443\u0441\u043a\u0443</p>"},{"location":"onboarding/tech_stack/#postgresql-pgvector","title":"\ud83d\udc18 PostgreSQL + pgvector","text":"<p>\u0417\u0430\u0447\u0435\u043c: \u042d\u0442\u043e \u043d\u0435 \u043f\u0440\u043e\u0441\u0442\u043e \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0434\u0430\u043d\u043d\u044b\u0445, \u0430 \u043d\u0430\u0448 \u043f\u043e\u0438\u0441\u043a\u043e\u0432\u044b\u0439 \u0434\u0432\u0438\u0436\u043e\u043a. \u041c\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c PostgreSQL 16+ \u0441 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0435\u043c <code>pgvector</code>. \u042d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043d\u0430\u043c \u0445\u0440\u0430\u043d\u0438\u0442\u044c \u044d\u043c\u0431\u0435\u0434\u0434\u0438\u043d\u0433\u0438 (\u0432\u0435\u043a\u0442\u043e\u0440\u043d\u044b\u0435 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f) \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0438 \u0438\u0441\u043a\u0430\u0442\u044c \u043f\u043e\u0434\u0430\u0440\u043a\u0438 \u043f\u043e \u0441\u043c\u044b\u0441\u043b\u0443, \u0430 \u043d\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e \u043a\u043b\u044e\u0447\u0435\u0432\u044b\u043c \u0441\u043b\u043e\u0432\u0430\u043c.</p> <p>\u0412\u0430\u0436\u043d\u043e: \u0412\u0441\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043a \u0411\u0414 \u2014 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0435 (<code>asyncpg</code>).</p> <p>\ud83d\udc49 \u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u0431\u0430\u0437\u043e\u0439 \u0434\u0430\u043d\u043d\u044b\u0445</p>"},{"location":"onboarding/tech_stack/#rabbitmq","title":"\ud83d\udc30 RabbitMQ","text":"<p>\u0417\u0430\u0447\u0435\u043c: \u0410\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u0430\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0442\u044f\u0436\u0435\u043b\u044b\u0445 \u0437\u0430\u0434\u0430\u0447. \u041a\u043e\u0433\u0434\u0430 \u043d\u0443\u0436\u043d\u043e \u0441\u043f\u0430\u0440\u0441\u0438\u0442\u044c 1000 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0438\u043b\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c 500 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0439, \u043c\u044b \u043d\u0435 \u0437\u0430\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0436\u0434\u0430\u0442\u044c. \u041c\u044b \u043a\u0438\u0434\u0430\u0435\u043c \u0437\u0430\u0434\u0430\u0447\u0443 \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u044c (RabbitMQ), \u0430 \u0432\u043e\u0440\u043a\u0435\u0440\u044b (\u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b) \u0440\u0430\u0437\u0433\u0440\u0435\u0431\u0430\u044e\u0442 \u0435\u0451 \u0432 \u0444\u043e\u043d\u0435. \u042d\u0442\u043e \u0434\u0435\u043b\u0430\u0435\u0442 API \u0431\u044b\u0441\u0442\u0440\u044b\u043c \u0438 \u043e\u0442\u0437\u044b\u0432\u0447\u0438\u0432\u044b\u043c.</p> <p>\ud83d\udc49 \u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0430 \u0438 \u043e\u0447\u0435\u0440\u0435\u0434\u0435\u0439</p>"},{"location":"onboarding/tech_stack/#redis","title":"\ud83d\udd34 Redis","text":"<p>\u0417\u0430\u0447\u0435\u043c: \u041a\u044d\u0448\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0438 \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435. \u0417\u0434\u0435\u0441\u044c \u043c\u044b \u0445\u0440\u0430\u043d\u0438\u043c \u0441\u0435\u0441\u0441\u0438\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439, \u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u0434\u0435\u0440\u0433\u0430\u0442\u044c \u0411\u0414 \u043d\u0430 \u043a\u0430\u0436\u0434\u044b\u0439 \u0447\u0438\u0445, \u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043a\u0430\u043a \u0431\u0440\u043e\u043a\u0435\u0440 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439 \u0434\u043b\u044f Celery/TaskQueue \u0432 \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043c\u0435\u0441\u0442\u0430\u0445 (\u0438\u043b\u0438 \u043a\u0430\u043a \u0431\u044b\u0441\u0442\u0440\u044b\u0439 \u043a\u044d\u0448 \u0434\u043b\u044f \u0447\u0430\u0441\u0442\u043e \u0437\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0435\u043c\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445).</p>"},{"location":"onboarding/tech_stack/#core","title":"\ud83d\udc0d \u0411\u044d\u043a\u0435\u043d\u0434 (Core)","text":"<p>\u041d\u0430\u0448 \u043a\u043e\u0434 \u043d\u0430\u043f\u0438\u0441\u0430\u043d \u043d\u0430 Python 3.11+, \u0438 \u043c\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u0441\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0435 \u043f\u043e\u0434\u0445\u043e\u0434\u044b.</p>"},{"location":"onboarding/tech_stack/#fastapi","title":"\u26a1 FastAPI","text":"<p>\u0427\u0442\u043e \u044d\u0442\u043e: \u0421\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0439 \u0432\u0435\u0431-\u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a. \u041f\u043e\u0447\u0435\u043c\u0443: \u041e\u043d \u0431\u044b\u0441\u0442\u0440\u044b\u0439 (Starlette), \u0442\u0438\u043f\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 (Pydantic) \u0438 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0433\u0435\u043d\u0435\u0440\u0438\u0440\u0443\u0435\u0442 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044e (Swagger UI). \u041c\u044b \u043b\u044e\u0431\u0438\u043c \u0435\u0433\u043e \u0437\u0430 Dependency Injection (<code>Depends(...)</code>) \u2014 \u044d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043b\u0435\u0433\u043a\u043e \u043f\u043e\u0434\u043c\u0435\u043d\u044f\u0442\u044c \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0411\u0414) \u0432 \u0442\u0435\u0441\u0442\u0430\u0445.</p>"},{"location":"onboarding/tech_stack/#sqlalchemy-20-async","title":"\ud83d\uddc3 SQLAlchemy 2.0 (Async)","text":"<p>\u0427\u0442\u043e \u044d\u0442\u043e: ORM \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0431\u0430\u0437\u043e\u0439.</p> <p>\u0412\u0430\u0436\u043d\u043e: \u041c\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u0441\u0442\u0438\u043b\u044c 2.0.</p> <p>\u274c \u0421\u0442\u0430\u0440\u044b\u0439 \u0441\u0442\u0438\u043b\u044c (\u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c): <code>session.query(User).filter(...)</code></p> <p>\u2705 \u041d\u043e\u0432\u044b\u0439 \u0441\u0442\u0438\u043b\u044c (\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c): <code>await session.execute(select(User).where(...))</code></p> <p>\u042d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u0438\u0441\u0430\u0442\u044c \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0439 \u043a\u043e\u0434, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0435 \u0431\u043b\u043e\u043a\u0438\u0440\u0443\u0435\u0442 \u0441\u0435\u0440\u0432\u0435\u0440 \u043f\u043e\u043a\u0430 \u0431\u0430\u0437\u0430 \u0434\u0443\u043c\u0430\u0435\u0442.</p>"},{"location":"onboarding/tech_stack/#pydantic-v2","title":"\ud83d\udcdc Pydantic V2","text":"<p>\u0427\u0442\u043e \u044d\u0442\u043e: \u0412\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445. \u0412\u0441\u0435 \u0432\u0445\u043e\u0434\u043d\u044b\u0435 \u0438 \u0432\u044b\u0445\u043e\u0434\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u0441\u0445\u0435\u043c\u0430\u043c\u0438. \u042d\u0442\u043e \u0433\u0430\u0440\u0430\u043d\u0442\u0438\u0440\u0443\u0435\u0442, \u0447\u0442\u043e \u0435\u0441\u043b\u0438 \u0444\u0440\u043e\u043d\u0442\u0435\u043d\u0434 \u043f\u0440\u0438\u0441\u043b\u0430\u043b \u0441\u0442\u0440\u043e\u043a\u0443 \u0432\u043c\u0435\u0441\u0442\u043e \u0447\u0438\u0441\u043b\u0430, \u043c\u044b \u0443\u0437\u043d\u0430\u0435\u043c \u043e\u0431 \u044d\u0442\u043e\u043c \u0441\u0440\u0430\u0437\u0443 \u0438 \u0441 \u043f\u043e\u043d\u044f\u0442\u043d\u043e\u0439 \u043e\u0448\u0438\u0431\u043a\u043e\u0439. V2 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043d\u0430 Rust \u0438 \u043e\u0447\u0435\u043d\u044c \u0431\u044b\u0441\u0442\u0440.</p>"},{"location":"onboarding/tech_stack/#alembic","title":"\u2697\ufe0f Alembic","text":"<p>\u0427\u0442\u043e \u044d\u0442\u043e: \u041c\u0438\u0433\u0440\u0430\u0446\u0438\u0438 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445.</p> <p>\u041f\u0440\u0430\u0432\u0438\u043b\u043e \u043a\u0440\u043e\u0432\u0438: \u041d\u0438\u043a\u043e\u0433\u0434\u0430 \u043d\u0435 \u043c\u0435\u043d\u044f\u0439\u0442\u0435 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0443 \u0411\u0414 (\u0442\u0430\u0431\u043b\u0438\u0446\u044b, \u043a\u043e\u043b\u043e\u043d\u043a\u0438) \u0432\u0440\u0443\u0447\u043d\u0443\u044e \u0447\u0435\u0440\u0435\u0437 SQL. \u0412\u0441\u0435\u0433\u0434\u0430 \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0439\u0442\u0435 \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u044e: <code>alembic revision --autogenerate -m \"Added status column\"</code></p> <p>\ud83d\udc49 \u041a\u0430\u043a \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0442\u044c \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u0438</p>"},{"location":"onboarding/tech_stack/#ai","title":"\ud83e\udde0 \u041f\u0440\u0435\u0434\u043c\u0435\u0442\u043d\u0430\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u044c \u0438 AI","text":"<p>\u0422\u043e, \u0447\u0442\u043e \u0434\u0435\u043b\u0430\u0435\u0442 Gifty \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u043c.</p>"},{"location":"onboarding/tech_stack/#gutg-grand-unified-theory-of-gifting","title":"\ud83c\udf81 GUTG (Grand Unified Theory of Gifting)","text":"<p>\u042d\u0442\u043e \u043d\u0430\u0448\u0430 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u044f\u044f \u0444\u0438\u043b\u043e\u0441\u043e\u0444\u0438\u044f \u043f\u043e\u0434\u0431\u043e\u0440\u0430 \u043f\u043e\u0434\u0430\u0440\u043a\u043e\u0432. \u041c\u044b \u043e\u0446\u0435\u043d\u0438\u0432\u0430\u0435\u043c \u0442\u043e\u0432\u0430\u0440\u044b \u043d\u0435 \u043f\u0440\u043e\u0441\u0442\u043e \u043a\u0430\u043a \"\u041a\u0440\u0443\u0436\u043a\u0430\", \u0430 \u043f\u043e 10 \u043e\u0441\u044f\u043c: \u0420\u043e\u043c\u0430\u043d\u0442\u0438\u0447\u043d\u043e\u0441\u0442\u044c, \u041f\u0440\u0430\u043a\u0442\u0438\u0447\u043d\u043e\u0441\u0442\u044c, \u041a\u0440\u0438\u043d\u0436, \u042d\u0441\u0442\u0435\u0442\u0438\u043a\u0430 \u0438 \u0442.\u0434. \u042d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0434\u0430\u0432\u0430\u0442\u044c \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0438 \u0442\u0438\u043f\u0430 \"\u0425\u043e\u0447\u0443 \u0447\u0442\u043e-\u0442\u043e \u043c\u0438\u043b\u043e\u0435, \u043d\u043e \u043f\u043e\u043b\u0435\u0437\u043d\u043e\u0435\" (High Aesthetic + High Utility).</p> <p>\ud83d\udc49 \u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435 \u043e \u0444\u0438\u043b\u043e\u0441\u043e\u0444\u0438\u0438 GUTG</p>"},{"location":"onboarding/tech_stack/#scrapy-parsers","title":"\ud83d\udd77 Scrapy (Parsers)","text":"<p>\u0414\u043b\u044f \u0441\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u043c\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a Scrapy. \u0423 \u043d\u0430\u0441 \u0434\u0432\u0430 \u0440\u0435\u0436\u0438\u043c\u0430 \u0440\u0430\u0431\u043e\u0442\u044b \u043f\u0430\u0440\u0441\u0435\u0440\u043e\u0432:</p> <ol> <li>Discovery: \u0411\u044b\u0441\u0442\u0440\u043e \u043f\u0440\u043e\u0431\u0435\u0436\u0430\u0442\u044c\u0441\u044f \u043f\u043e \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0443 \u0438 \u043d\u0430\u0439\u0442\u0438 \u043d\u043e\u0432\u044b\u0435 \u0441\u0441\u044b\u043b\u043a\u0438 \u043d\u0430 \u0442\u043e\u0432\u0430\u0440\u044b.</li> <li>Deep: \u0417\u0430\u0439\u0442\u0438 \u0432 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u0442\u043e\u0432\u0430\u0440 \u0438 \u0441\u043a\u0430\u0447\u0430\u0442\u044c \u0432\u0441\u0451: \u0446\u0435\u043d\u0443, \u0444\u043e\u0442\u043e, \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435.</li> </ol> <p>\ud83d\udc49 \u041a\u0430\u043a \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u0441\u0435\u0440</p>"},{"location":"onboarding/tech_stack/#_1","title":"\ud83d\udee0 \u0418\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u044b \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0438 \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430","text":""},{"location":"onboarding/tech_stack/#weeek","title":"\ud83d\udcc5 Weeek","text":"<p>\u041d\u0430\u0448 \u0442\u0430\u0441\u043a-\u0442\u0440\u0435\u043a\u0435\u0440. \u0410\u043d\u0430\u043b\u043e\u0433 Jira/Trello. \u0412\u0441\u0435 \u0437\u0430\u0434\u0430\u0447\u0438, \u0431\u0430\u0433\u0438 \u0438 \u043f\u043b\u0430\u043d\u044b \u0436\u0438\u0432\u0443\u0442 \u0442\u0430\u043c. \u0423 \u043d\u0430\u0441 \u0435\u0441\u0442\u044c \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f: \u0431\u043e\u0442 \u043c\u043e\u0436\u0435\u0442 \u043f\u0440\u0438\u0441\u044b\u043b\u0430\u0442\u044c \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f \u043e \u043d\u043e\u0432\u044b\u0445 \u0437\u0430\u0434\u0430\u0447\u0430\u0445.</p> <p>\ud83d\udc49 \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 Weeek</p>"},{"location":"onboarding/tech_stack/#posthog","title":"\ud83e\udd94 PostHog","text":"<p>\u0410\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0430 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432. \u041c\u044b \u043d\u0435 \u0433\u0430\u0434\u0430\u0435\u043c, \u043c\u044b \u0441\u043c\u043e\u0442\u0440\u0438\u043c \u0434\u0430\u043d\u043d\u044b\u0435. \u041a\u0443\u0434\u0430 \u043a\u043b\u0438\u043a\u0430\u044e\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438? \u041d\u0430 \u043a\u0430\u043a\u043e\u043c \u0448\u0430\u0433\u0435 \u043e\u0442\u0432\u0430\u043b\u0438\u0432\u0430\u044e\u0442\u0441\u044f? PostHog \u0434\u0430\u0435\u0442 \u043e\u0442\u0432\u0435\u0442\u044b.</p> <p>\ud83d\udc49 \u041a\u0430\u043a \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0443</p>"},{"location":"onboarding/tech_stack/#observability-prometheus-grafana-loki","title":"\ud83d\udd2d Observability (Prometheus + Grafana + Loki)","text":"<ul> <li>Prometheus: \u0421\u043e\u0431\u0438\u0440\u0430\u0435\u0442 \u043c\u0435\u0442\u0440\u0438\u043a\u0438 (\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0443, \u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043e\u0448\u0438\u0431\u043e\u043a 500).</li> <li>Loki: \u0421\u043e\u0431\u0438\u0440\u0430\u0435\u0442 \u043b\u043e\u0433\u0438. \u0415\u0441\u043b\u0438 \u0447\u0442\u043e-\u0442\u043e \u0443\u043f\u0430\u043b\u043e, \u0438\u0434\u0435\u043c \u0432 Grafana \u0438\u0441\u043a\u0430\u0442\u044c \u0442\u0440\u0435\u0439\u0441\u0431\u044d\u043a.</li> <li>Sentry: \u041b\u043e\u0432\u0438\u0442 \u043e\u0448\u0438\u0431\u043a\u0438 \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0438 \u0448\u043b\u0435\u0442 \u0430\u043b\u0435\u0440\u0442\u044b \u0432 Telegram.</li> </ul> <p>\ud83d\udc49 \u0418\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0438 \u0441\u0435\u043a\u0440\u0435\u0442\u044b</p>"},{"location":"onboarding/testing/","title":"\u0422\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0432 Gifty \ud83e\uddea","text":"<p>\u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u043a\u043e\u0434\u0430 \u0438 \u043d\u0430\u0434\u0435\u0436\u043d\u043e\u0441\u0442\u044c \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u043e\u0432 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439 \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c <code>pytest</code>.</p>"},{"location":"onboarding/testing/#_1","title":"\ud83d\ude80 \u0417\u0430\u043f\u0443\u0441\u043a \u0442\u0435\u0441\u0442\u043e\u0432 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e","text":"<p>\u0414\u043b\u044f \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0442\u0435\u0441\u0442\u043e\u0432 \u0432\u0430\u043c \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 (\u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0435):</p> <pre><code>pip install pytest pytest-asyncio pytest-mock pyyaml\n</code></pre>"},{"location":"onboarding/testing/#_2","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u044b:","text":"<pre><code># \u0417\u0430\u043f\u0443\u0441\u043a \u0432\u0441\u0435\u0445 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0442\u0435\u0441\u0442\u043e\u0432\npytest\n\n# \u0417\u0430\u043f\u0443\u0441\u043a \u0442\u0435\u0441\u0442\u043e\u0432 \u0438\u0437 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430\npytest tests/test_recommendations.py\n\n# \u0417\u0430\u043f\u0443\u0441\u043a \u0441 \u0434\u0435\u0442\u0430\u043b\u044c\u043d\u044b\u043c \u0432\u044b\u0432\u043e\u0434\u043e\u043c (verbose)\npytest -v\n</code></pre>"},{"location":"onboarding/testing/#tests_configyaml","title":"\u2699\ufe0f \u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u043e\u0441\u0442\u0430\u0432\u043e\u043c \u0442\u0435\u0441\u0442\u043e\u0432 (<code>tests_config.yaml</code>)","text":"<p>\u0412 \u043a\u043e\u0440\u043d\u0435 \u043f\u0440\u043e\u0435\u043a\u0442\u0430 \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u0441\u044f \u0444\u0430\u0439\u043b <code>tests_config.yaml</code>. \u041e\u043d \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0433\u0438\u0431\u043a\u043e \u0432\u043a\u043b\u044e\u0447\u0430\u0442\u044c \u0438 \u043e\u0442\u043a\u043b\u044e\u0447\u0430\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u044b \u0442\u0435\u0441\u0442\u043e\u0432 \u0431\u0435\u0437 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u043a\u043e\u0434\u0430. \u042d\u0442\u043e \u043f\u043e\u043b\u0435\u0437\u043d\u043e \u0434\u043b\u044f \u0443\u0441\u043a\u043e\u0440\u0435\u043d\u0438\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0438\u043b\u0438 \u044d\u043a\u043e\u043d\u043e\u043c\u0438\u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u043f\u0440\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0438 \u043f\u043b\u0430\u0442\u043d\u044b\u0445 AI API).</p> <p>\u041f\u0440\u0438\u043c\u0435\u0440 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b: <pre><code>test_groups:\n  recommendations: true  # \u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u044b \u043f\u043e\u0434\u0431\u043e\u0440\u0430\n  routes: true           # API \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u044b\n  ai_intelligence: false # \u0422\u044f\u0436\u0435\u043b\u044b\u0435 \u0442\u0435\u0441\u0442\u044b AI (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0432\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u044b)\n</code></pre></p> <p>\u041f\u0440\u0435\u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u0430 \u0442\u0430\u043a\u043e\u0439 \u0441\u0445\u0435\u043c\u044b:</p> <ol> <li>\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c: \u0412 CI/CD \u043d\u0430 \u0432\u0435\u0442\u043a\u0435 <code>develop</code> \u043c\u043e\u0436\u043d\u043e \u043e\u0442\u043a\u043b\u044e\u0447\u0430\u0442\u044c \u0442\u044f\u0436\u0435\u043b\u044b\u0435 \u0442\u0435\u0441\u0442\u044b.</li> <li>\u042d\u043a\u043e\u043d\u043e\u043c\u0438\u044f: \u0422\u0435\u0441\u0442\u044b, \u0442\u0440\u0435\u0431\u0443\u044e\u0449\u0438\u0435 \u0432\u044b\u0437\u043e\u0432\u0430 \u0432\u043d\u0435\u0448\u043d\u0438\u0445 LLM, \u0432\u043a\u043b\u044e\u0447\u0430\u044e\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0432\u0440\u0443\u0447\u043d\u0443\u044e \u043f\u0435\u0440\u0435\u0434 \u0440\u0435\u043b\u0438\u0437\u043e\u043c.</li> <li>\u0414\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u043f\u0440\u043e\u043f\u0443\u0441\u043a: \u0415\u0441\u043b\u0438 \u0433\u0440\u0443\u043f\u043f\u0430 \u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u0430 \u0432 \u043a\u043e\u043d\u0444\u0438\u0433\u0435, <code>pytest</code> \u043f\u043e\u043c\u0435\u0442\u0438\u0442 \u0438\u0445 \u043a\u0430\u043a <code>SKIPPED</code>.</li> </ol>"},{"location":"onboarding/testing/#cicd","title":"\ud83d\udd04 \u0422\u0435\u0441\u0442\u044b \u0432 CI/CD","text":"<p>\u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0442\u0435\u0441\u0442\u044b \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u044e\u0442\u0441\u044f \u043f\u0440\u0438 \u043a\u0430\u0436\u0434\u043e\u043c Pull Request \u0432 \u0432\u0435\u0442\u043a\u0443 <code>develop</code> \u0438 <code>main</code>. </p> <p>IMPORTANT</p> <p>\u0412\u044b \u043d\u0435 \u0441\u043c\u043e\u0436\u0435\u0442\u0435 \u0432\u043b\u0438\u0442\u044c (merge) \u0441\u0432\u043e\u0439 \u043a\u043e\u0434, \u0435\u0441\u043b\u0438 \u0442\u0435\u0441\u0442\u044b \u043d\u0435 \u043f\u0440\u043e\u0448\u043b\u0438 (\u043f\u0430\u0439\u043f\u043b\u0430\u0439\u043d \u0431\u0443\u0434\u0435\u0442 \u043f\u043e\u043c\u0435\u0447\u0435\u043d \u043a\u0440\u0430\u0441\u043d\u044b\u043c).</p>"},{"location":"onboarding/testing/#ci","title":"\u0427\u0442\u043e \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442\u0441\u044f \u0432 CI:","text":"<ul> <li>\u041a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0441\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u044b API (\u0432\u0441\u0435 \u0440\u043e\u0443\u0442\u044b \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u044e\u0442 \u043e\u0436\u0438\u0434\u0430\u0435\u043c\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u0434\u0430\u043d\u043d\u044b\u0445).</li> <li>\u0426\u0435\u043b\u043e\u0441\u0442\u043d\u043e\u0441\u0442\u044c \u043c\u043e\u0434\u0435\u043b\u0435\u0439 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445.</li> <li>\u0411\u0430\u0437\u043e\u0432\u0430\u044f \u043b\u043e\u0433\u0438\u043a\u0430 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439.</li> </ul> <p>\u0415\u0441\u043b\u0438 \u0432\u0430\u0448\u0438 \u0442\u0435\u0441\u0442\u044b \u0443\u043f\u0430\u043b\u0438 \u0432 GitHub Actions, \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043b\u043e\u0433\u0438 \u0432\u043e \u0432\u043a\u043b\u0430\u0434\u043a\u0435 Actions \u0432 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438.</p>"},{"location":"overview/","title":"\u041e\u0431\u0437\u043e\u0440 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u044b","text":"<p>\u0421\u0438\u0441\u0442\u0435\u043c\u0430 Gifty \u0441\u043e\u0441\u0442\u043e\u0438\u0442 \u0438\u0437 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u043a\u043b\u044e\u0447\u0435\u0432\u044b\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432, \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445 \u0434\u0440\u0443\u0433 \u0441 \u0434\u0440\u0443\u0433\u043e\u043c:</p> graph TD     subgraph \"Client Layer\"         User[User Web App]         Admin[Telegram Admin Bot]         MiniApp[Parsing Dashboard]     end      subgraph \"Core API Layer\"         API[Core API / FastAPI]         Auth[OAuth &amp; Sessions]         Analytics[Internal Analytics]     end      subgraph \"Processing Layer\"         Scheduler[Cron Scheduler]         RabbitMQ[RabbitMQ Queue]         Workers[Scrapy Workers]         Intelligence[Intelligence API / LLM]     end      subgraph \"Data Layer\"         DB[(PostgreSQL + pgvector)]         Redis[Redis Cache]     end      %% User Flow     User --&gt;|1. Submit Quiz| API     API --&gt;|2. Vector Search| DB     API --&gt;|3. Filter by 10D Matrix| DB     API --&gt;|4. Return Recommendations| User      %% Admin Flow     Admin --&gt;|Manage Spiders| API     Admin --&gt;|View Health/Stats| API     MiniApp --&gt;|Edit Config| API      %% Parsing Flow     Scheduler --&gt;|Schedule Sync| RabbitMQ     RabbitMQ --&gt;|Task| Workers     Workers --&gt;|Extract Data| API     API --&gt;|Validation &amp; Normalization| API     API --&gt;|Request Scoring| Intelligence     Intelligence --&gt;|Score &amp; Tags| API     API --&gt;|Save Product| DB      %% Service Interaction     API &lt;--&gt;|Sessions / Cache| Redis"},{"location":"overview/#_2","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u0441\u043b\u043e\u0438","text":"<ol> <li>\u041f\u0430\u0440\u0441\u0438\u043d\u0433 \u0434\u0430\u043d\u043d\u044b\u0445: \u0421\u0431\u043e\u0440 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0442\u043e\u0432\u0430\u0440\u0430\u0445 \u0441 \u0441\u0430\u0439\u0442\u043e\u0432-\u0434\u043e\u043d\u043e\u0440\u043e\u0432.<ul> <li>\ud83d\udc49 \u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0430</li> <li>\ud83d\udc49 \u041a\u0430\u043a \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u0441\u0435\u0440</li> </ul> </li> <li>\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0438 \u043e\u0431\u043e\u0433\u0430\u0449\u0435\u043d\u0438\u0435: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 LLM \u0434\u043b\u044f \u043e\u0446\u0435\u043d\u043a\u0438 \"\u043f\u043e\u0434\u0430\u0440\u043e\u0447\u043d\u043e\u0441\u0442\u0438\" \u0442\u043e\u0432\u0430\u0440\u0430 \u0438 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u043f\u0440\u0438\u0432\u044f\u0437\u043a\u0438 \u043a \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f\u043c.<ul> <li>\ud83d\udc49 Gifty Intelligence API</li> </ul> </li> <li>\u0412\u0435\u043a\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f \u0438 \u0420\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0438: \u041f\u0440\u0435\u0432\u0440\u0430\u0449\u0435\u043d\u0438\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0439 \u0432 \u0432\u0435\u043a\u0442\u043e\u0440\u044b \u0438 \u043f\u043e\u0434\u0431\u043e\u0440 \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u0430\u043d\u043a\u0435\u0442\u044b.<ul> <li>\ud83d\udc49 \u0422\u0435\u043e\u0440\u0438\u044f GUTG</li> <li>\ud83d\udc49 \u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u044b \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439</li> </ul> </li> <li>\u0418\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u044b: <ul> <li>Web App: \u0424\u0440\u043e\u043d\u0442\u0435\u043d\u0434 \u0434\u043b\u044f \u043f\u043e\u0434\u0431\u043e\u0440\u0430 \u043f\u043e\u0434\u0430\u0440\u043a\u043e\u0432.</li> <li>Telegram Admin Bot: \u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0438 \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433. <ul> <li>\ud83d\udc49 \u0413\u0430\u0439\u0434 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f</li> <li>\ud83d\udc49 \u0412\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u0435 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e (Internals) (New!)</li> </ul> </li> </ul> </li> </ol>"},{"location":"overview/#_3","title":"\u0410\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0430 \u0438 \u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \ud83d\udcca","text":"<p>\u0412 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u0432\u043d\u0435\u0434\u0440\u0435\u043d\u0430 \u0441\u043a\u0432\u043e\u0437\u043d\u0430\u044f \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0430 \u0434\u043b\u044f \u0431\u0438\u0437\u043d\u0435\u0441-\u043c\u0435\u0442\u0440\u0438\u043a \u0438 \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430:</p> <ul> <li>PostHog: \u041f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432\u0430\u044f \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0430 (\u0441\u043e\u0431\u044b\u0442\u0438\u044f, \u0432\u043e\u0440\u043e\u043d\u043a\u0438, \u043a\u043e\u0433\u043e\u0440\u0442\u044b).</li> <li>Prometheus &amp; Grafana: \u0422\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432, \u0432\u0440\u0435\u043c\u044f \u043e\u0442\u0432\u0435\u0442\u0430 API, RAM/CPU.</li> <li>Loki: \u0426\u0435\u043d\u0442\u0440\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u0441\u0431\u043e\u0440 \u043b\u043e\u0433\u043e\u0432 \u0441\u043e \u0432\u0441\u0435\u0445 \u043c\u0438\u043a\u0440\u043e\u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432.</li> </ul> <p>\ud83d\udc49 \u0413\u0430\u0439\u0434 \u043f\u043e Analytics API</p>"},{"location":"overview/#cicd","title":"\u0418\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0438 CI/CD","text":"<p>\u041f\u0440\u043e\u0435\u043a\u0442 \u0440\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442 \u043d\u0430 \u0431\u0430\u0437\u0435 Docker Compose \u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0441\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0438 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0430\u0446\u0438\u0438:</p> <ul> <li>GitHub Actions: \u041f\u043e\u043b\u043d\u044b\u0439 \u0446\u0438\u043a\u043b CI (Continuous Integration) \u043f\u0440\u0438 \u043a\u0430\u0436\u0434\u043e\u043c \u043f\u0443\u0448\u0435. \u0421\u043d\u0430\u0447\u0430\u043b\u0430 \u043f\u0440\u043e\u0433\u043e\u043d\u044f\u044e\u0442\u0441\u044f \u0442\u0435\u0441\u0442\u044b, \u0437\u0430\u0442\u0435\u043c \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u0434\u0435\u043f\u043b\u043e\u0439.</li> <li>Blue-Green Deployment: \u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044f \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f \u0431\u0435\u0437 \u043f\u0440\u0435\u0440\u044b\u0432\u0430\u043d\u0438\u044f \u043e\u0431\u0441\u043b\u0443\u0436\u0438\u0432\u0430\u043d\u0438\u044f. \u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0430\u0435\u0442\u0441\u044f \u043c\u0435\u0436\u0434\u0443 \u0434\u0432\u0443\u043c\u044f \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430\u043c\u0438 \u043d\u0430 \u0440\u0430\u0437\u043d\u044b\u0445 \u043f\u043e\u0440\u0442\u0430\u0445 \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u0441\u043b\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0437\u0434\u043e\u0440\u043e\u0432\u044c\u044f (Health Check).</li> <li>Nginx Proxy: \u0412\u043d\u0435\u0448\u043d\u0438\u0439 \u043f\u0440\u043e\u043a\u0441\u0438 \u043d\u0430 \u0445\u043e\u0441\u0442\u0435, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 SSL \u0438 \u0431\u0435\u0441\u0448\u043e\u0432\u043d\u043e\u0435 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u0432\u0435\u0440\u0441\u0438\u0439 \u0447\u0435\u0440\u0435\u0437 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u043e\u0440\u0442\u0430 \u0432 upstream.</li> </ul>"},{"location":"overview/recipient_management/","title":"Recipient Management Refactoring","text":""},{"location":"overview/recipient_management/#overview","title":"Overview","text":"<p>This document describes the refactoring of the data models to separate the concepts of \"User\" (gift seeker) and \"Recipient\" (gift receiver), establishing a one-to-many relationship where a User can have multiple Recipients.</p>"},{"location":"overview/recipient_management/#changes-made","title":"Changes Made","text":""},{"location":"overview/recipient_management/#1-database-models-appmodelspy","title":"1. Database Models (<code>app/models.py</code>)","text":""},{"location":"overview/recipient_management/#new-recipient-model","title":"New <code>Recipient</code> Model","text":"<pre><code>class Recipient(TimestampMixin, Base):\n    __tablename__ = \"recipients\"\n\n    id: UUID (primary key)\n    user_id: UUID (foreign key to users.id)\n    name: Optional[str]\n    relation: Optional[str]  # friend, partner, etc.\n    gender: Optional[str]\n    age: Optional[int]\n    birth_date: Optional[datetime]\n    interests: List[str] (JSONB)\n</code></pre>"},{"location":"overview/recipient_management/#new-interaction-model","title":"New <code>Interaction</code> Model","text":"<pre><code>class Interaction(TimestampMixin, Base):\n    __tablename__ = \"interactions\"\n\n    id: UUID (primary key)\n    recipient_id: UUID (foreign key to recipients.id)\n    session_id: str\n    action_type: str  # like, dislike, view, purchase\n    target_type: str  # hypothesis, product\n    target_id: str\n    value: Optional[str]\n    metadata_json: Optional[dict] (JSONB)\n</code></pre>"},{"location":"overview/recipient_management/#2-pydantic-models-recommendationsmodelspy","title":"2. Pydantic Models (<code>recommendations/models.py</code>)","text":"<ul> <li>Renamed: <code>UserProfile</code> \u2192 <code>RecipientProfile</code></li> <li>Added fields:</li> <li><code>id</code>: Optional[str]</li> <li><code>owner_id</code>: Optional[str]</li> <li> <p><code>name</code>: Optional[str]</p> </li> <li> <p>Updated: <code>RecommendationSession.profile</code> \u2192 <code>RecommendationSession.recipient</code></p> </li> </ul>"},{"location":"overview/recipient_management/#3-services","title":"3. Services","text":""},{"location":"overview/recipient_management/#new-recipientservice-appservicesrecipient_servicepy","title":"New <code>RecipientService</code> (<code>app/services/recipient_service.py</code>)","text":"<p>Handles CRUD operations for recipients and their interactions: - <code>create_recipient(user_id, profile)</code> - Create a new recipient - <code>get_recipient(recipient_id)</code> - Get recipient by ID - <code>get_user_recipients(user_id)</code> - Get all recipients for a user - <code>update_recipient(recipient_id, ...)</code> - Update recipient info - <code>save_interaction(recipient_id, session_id, interaction)</code> - Save interaction - <code>get_recipient_interactions(recipient_id, limit)</code> - Get interaction history</p>"},{"location":"overview/recipient_management/#updated-dialoguemanager-appservicesdialogue_managerpy","title":"Updated <code>DialogueManager</code> (<code>app/services/dialogue_manager.py</code>)","text":"<ul> <li>Added <code>db: AsyncSession</code> parameter to constructor</li> <li>Added <code>user_id: Optional[UUID]</code> parameter to <code>init_session()</code></li> <li>Automatically creates <code>Recipient</code> in database when session is initialized</li> <li>All references to <code>session.profile</code> updated to <code>session.recipient</code></li> </ul>"},{"location":"overview/recipient_management/#4-api-endpoints","title":"4. API Endpoints","text":""},{"location":"overview/recipient_management/#new-recipients-router-routesrecipientspy","title":"New Recipients Router (<code>routes/recipients.py</code>)","text":"<ul> <li><code>GET /recipients/?user_id={uuid}</code> - List all recipients for a user</li> <li><code>GET /recipients/{recipient_id}</code> - Get specific recipient</li> <li><code>PUT /recipients/{recipient_id}</code> - Update recipient information</li> <li><code>GET /recipients/{recipient_id}/history</code> - Get interaction history</li> </ul>"},{"location":"overview/recipient_management/#updated-recommendations-router","title":"Updated Recommendations Router","text":"<ul> <li><code>POST /recommendations/init</code> now accepts optional <code>user_id</code> parameter</li> <li>When <code>user_id</code> is provided, a <code>Recipient</code> record is created in the database</li> </ul>"},{"location":"overview/recipient_management/#5-configuration-appconfigpy","title":"5. Configuration (<code>app/config.py</code>)","text":"<p>Added Docker-aware URL properties: - <code>db_url</code> - Automatically uses <code>postgres</code> host when running in Docker - <code>redis_connection_url</code> - Automatically uses <code>redis</code> host when running in Docker - <code>rabbitmq_connection_url</code> - Automatically uses <code>rabbitmq</code> host when running in Docker</p> <p>This allows the same <code>.env</code> file to work both locally and in Docker containers.</p>"},{"location":"overview/recipient_management/#database-migration","title":"Database Migration","text":"<p>Migration file: <code>alembic/versions/345ee831ac2a_add_recipients_and_interactions.py</code></p> <p>To apply: <pre><code>alembic upgrade head\n</code></pre></p>"},{"location":"overview/recipient_management/#usage-example","title":"Usage Example","text":""},{"location":"overview/recipient_management/#creating-a-session-with-recipient-persistence","title":"Creating a Session with Recipient Persistence","text":"<pre><code># POST /recommendations/init\n{\n    \"user_id\": \"123e4567-e89b-12d3-a456-426614174000\",\n    \"quiz\": {\n        \"recipient_age\": 30,\n        \"interests\": [\"coffee\", \"books\"],\n        \"budget\": 5000,\n        \"language\": \"ru\"\n    }\n}\n</code></pre> <p>This will: 1. Create a <code>RecipientProfile</code> in the session (Redis) 2. Create a <code>Recipient</code> record in PostgreSQL 3. Link the recipient to the user 4. Return a session with the recipient profile</p>"},{"location":"overview/recipient_management/#viewing-recipient-history","title":"Viewing Recipient History","text":"<pre><code># GET /recipients/{recipient_id}/history?limit=50\n</code></pre> <p>Returns all interactions for this recipient across all sessions.</p>"},{"location":"overview/recipient_management/#benefits","title":"Benefits","text":"<ol> <li>Persistent Recipient Profiles: Recipients are now stored in the database, allowing for long-term tracking</li> <li>Multi-Recipient Support: Users can manage multiple gift recipients</li> <li>Interaction History: All user interactions are logged per recipient for better personalization</li> <li>Future Wishlist: Foundation for implementing recipient-specific wishlists</li> <li>Better Analytics: Can track gift-giving patterns per recipient type/relationship</li> </ol>"},{"location":"overview/recipient_management/#next-steps","title":"Next Steps","text":"<ol> <li>Implement wishlist functionality per recipient</li> <li>Add recipient-specific recommendation tuning</li> <li>Implement recipient search/filtering</li> <li>Add recipient photo upload</li> <li>Create recipient management UI in frontend</li> </ol>"},{"location":"parsing/architecture/","title":"\u041f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u0430\u044f \u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 \u041f\u0430\u0440\u0441\u0438\u043d\u0433\u0430 v2.1","text":"<p>\u0412 \u044d\u0442\u043e\u043c \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0435 \u0434\u0435\u0442\u0430\u043b\u044c\u043d\u043e \u043e\u043f\u0438\u0441\u0430\u043d\u0430 \u0446\u0435\u043b\u0435\u0432\u0430\u044f \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0441\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 (Scraping System) \u0434\u043b\u044f \u043f\u0440\u043e\u0435\u043a\u0442\u0430 Gifty. \u041c\u044b \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0438\u043c \u043e\u0442 \u043c\u043e\u043d\u043e\u043b\u0438\u0442\u043d\u043e\u0433\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u043f\u0430\u0440\u0441\u0435\u0440\u043e\u0432 \u043a \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0439 \u043c\u0438\u043a\u0440\u043e\u0441\u0435\u0440\u0432\u0438\u0441\u043d\u043e\u0439 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0435.</p>"},{"location":"parsing/architecture/#1-the-big-picture","title":"1. \u041e\u0431\u0449\u0430\u044f \u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 (The Big Picture)","text":"<p>\u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0440\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0430 \u043d\u0430 \u0442\u0440\u0438 \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0441\u043b\u043e\u044f:</p> <ol> <li>Orchestration (\u041c\u043e\u0437\u0433): \u041f\u043b\u0430\u043d\u0438\u0440\u0443\u0435\u0442, \u0447\u0442\u043e \u0438 \u043a\u043e\u0433\u0434\u0430 \u043f\u0430\u0440\u0441\u0438\u0442\u044c, \u0438\u0441\u0445\u043e\u0434\u044f \u0438\u0437 \u0442\u0438\u043f\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u0438 \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442\u043e\u0432.</li> <li>Execution (\u041c\u044b\u0448\u0446\u044b): \u0418\u0437\u043e\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0432\u043e\u0440\u043a\u0435\u0440\u044b \u043d\u0430 \u0431\u0430\u0437\u0435 Scrapy.</li> <li>Storage &amp; Processing (\u041f\u0430\u043c\u044f\u0442\u044c): \u041f\u0440\u0438\u0435\u043c\u043a\u0430, \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044f \u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445.</li> </ol> sequenceDiagram     participant S as Scheduler     participant Q as RabbitMQ     participant W as Scrapy Worker     participant T as Target Site     participant A as Ingestion API     participant DB as Postgres      S-&gt;&gt;S: Scan Due Sources     S-&gt;&gt;Q: Hub/List Task     Q-&gt;&gt;W: Pick Up     W-&gt;&gt;T: Fetch Content     T--&gt;&gt;W: HTML     W-&gt;&gt;W: Extract Links/Items     W-&gt;&gt;A: Batch Ingest     A-&gt;&gt;A: Validate/Clean     A-&gt;&gt;DB: Upsert Products     A-&gt;&gt;DB: Update Source Stats"},{"location":"parsing/architecture/#2-scheduler","title":"2. \u0421\u043b\u043e\u0439 \u041e\u0440\u043a\u0435\u0441\u0442\u0440\u0430\u0446\u0438\u0438 (Scheduler)","text":""},{"location":"parsing/architecture/#21-source-types","title":"2.1 \u041a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u0418\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u043e\u0432 (Source Types)","text":"<p>\u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0440\u0430\u0437\u043b\u0438\u0447\u0430\u0435\u0442 \u0442\u0438\u043f\u044b \u0441\u0442\u0440\u0430\u043d\u0438\u0446, \u0442\u0430\u043a \u043a\u0430\u043a \u043e\u043d\u0438 \u0442\u0440\u0435\u0431\u0443\u044e\u0442 \u0440\u0430\u0437\u043d\u044b\u0445 \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0439 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438. \u0412 \u0411\u0414 \u0432\u0432\u043e\u0434\u0438\u0442\u0441\u044f \u043f\u043e\u043b\u0435 <code>type</code>:</p> <ol> <li> <p>Hub / Category List (<code>hub</code>):</p> <ul> <li>\u041f\u0440\u0438\u043c\u0435\u0440: <code>groupprice.ru/catalog/gifts</code> (\u043f\u043b\u0438\u0442\u043a\u0430 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \"\u041c\u0430\u043c\u0435\", \"\u041f\u0430\u043f\u0435\").</li> <li>\u0417\u0430\u0434\u0430\u0447\u0430: Discovery. \u041d\u0430\u0439\u0442\u0438 \u0441\u0441\u044b\u043b\u043a\u0438 \u043d\u0430 \u043d\u043e\u0432\u044b\u0435 \u043f\u043e\u0434\u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u0438 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0438\u0445 \u0432 \u0411\u0414. \u041d\u0435 \u043f\u0430\u0440\u0441\u0438\u0442 \u0442\u043e\u0432\u0430\u0440\u044b.</li> <li>\u0427\u0430\u0441\u0442\u043e\u0442\u0430: \u0420\u0435\u0434\u043a\u043e (\u0440\u0430\u0437 \u0432 \u043d\u0435\u0434\u0435\u043b\u044e/\u043c\u0435\u0441\u044f\u0446). \u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0441\u0430\u0439\u0442\u043e\u0432 \u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f \u043d\u0435\u0447\u0430\u0441\u0442\u043e.</li> </ul> </li> <li> <p>Product List (<code>list</code>) \u2014 \u041e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0442\u0438\u043f:</p> <ul> <li>\u041f\u0440\u0438\u043c\u0435\u0440: <code>mrgeek.ru/category/vse-tovary/</code>.</li> <li>\u0417\u0430\u0434\u0430\u0447\u0430: Extraction. \u041f\u0440\u043e\u0439\u0442\u0438\u0441\u044c \u043f\u043e \u043f\u0430\u0433\u0438\u043d\u0430\u0446\u0438\u0438, \u0441\u043e\u0431\u0440\u0430\u0442\u044c \u043a\u0440\u0430\u0442\u043a\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 (\u0426\u0435\u043d\u0430, \u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435, \u041a\u0430\u0440\u0442\u0438\u043d\u043a\u0430) \u0438 \u0441\u0441\u044b\u043b\u043a\u0438 \u043d\u0430 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438.</li> <li>\u0427\u0430\u0441\u0442\u043e\u0442\u0430: \u0415\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u043e (\u0440\u0430\u0437 \u0432 12-24\u0447).</li> <li>\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044f: \u041c\u044b \u0445\u0440\u0430\u043d\u0438\u043c \u0432 \u0411\u0414 \u0438\u043c\u0435\u043d\u043d\u043e \"\u043b\u0438\u0441\u0442\u043e\u0432\u044b\u0435\" \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 (\u043a\u043e\u043d\u0435\u0447\u043d\u044b\u0435). \u042d\u0442\u043e \u043d\u0430\u0434\u0435\u0436\u043d\u0435\u0435, \u0447\u0435\u043c \u043a\u0430\u0436\u0434\u044b\u0439 \u0440\u0430\u0437 \u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0425\u0430\u0431.</li> </ul> </li> <li> <p>Single Product (<code>product</code>):</p> <ul> <li>\u041f\u0440\u0438\u043c\u0435\u0440: <code>ozon.ru/product/iphone-15</code>.</li> <li>\u0417\u0430\u0434\u0430\u0447\u0430: Deep Dive. \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043f\u043e\u043b\u043d\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435, \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438, \u043e\u0442\u0437\u044b\u0432\u044b.</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0442\u043e\u0447\u0435\u0447\u043d\u043e, \u043a\u043e\u0433\u0434\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438\u0437 \u0441\u043f\u0438\u0441\u043a\u0430 \u043d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0438\u043b\u0438 \u043d\u0443\u0436\u043d\u043e \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u0442\u044c \u0446\u0435\u043d\u0443 VIP-\u0442\u043e\u0432\u0430\u0440\u0430 \u043a\u0430\u0436\u0434\u044b\u0439 \u0447\u0430\u0441.</li> </ul> </li> <li> <p>Sitemap XML (<code>sitemap</code>):</p> <ul> <li>\u041f\u0440\u0438\u043c\u0435\u0440: <code>site.com/sitemap.xml</code>.</li> <li>\u0417\u0430\u0434\u0430\u0447\u0430: Bulk Discovery. \"\u0417\u043e\u043b\u043e\u0442\u043e\u0439 \u0413\u0440\u0430\u0430\u043b\u044c\" \u2014 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c 100% \u0441\u0441\u044b\u043b\u043e\u043a \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0430 \u0431\u0435\u0437 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0430 HTML.</li> <li>\u0421\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u044c: \u041d\u0438\u0437\u043a\u0430\u044f, \u044d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f.</li> </ul> </li> </ol>"},{"location":"parsing/architecture/#22-strategies","title":"2.2 \u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0438 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 (Strategies)","text":"<p>\u041f\u043e\u043b\u0435 <code>strategy</code> \u0443\u0442\u043e\u0447\u043d\u044f\u0435\u0442 \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u0432\u043e\u0440\u043a\u0435\u0440\u0430 \u0432 \u0440\u0430\u043c\u043a\u0430\u0445 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u0442\u0438\u043f\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b:</p> <ul> <li><code>deep</code> (\u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f): \u041f\u043e\u043b\u043d\u0430\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f. \u0418\u0434\u0435\u043c \u043f\u043e \u0432\u0441\u0435\u043c \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430\u043c. \u041e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u043c \u0432\u0441\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043d\u044b\u0435 \u0442\u043e\u0432\u0430\u0440\u044b.</li> <li><code>discovery</code> (\u041f\u043e\u0438\u0441\u043a): \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f <code>type: hub</code>. \u0418\u0449\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u0441\u0441\u044b\u043b\u043a\u0438, \u0442\u043e\u0432\u0430\u0440\u044b \u043d\u0435 \u0441\u043e\u0431\u0438\u0440\u0430\u0435\u043c.</li> </ul>"},{"location":"parsing/architecture/#23-parsingsource","title":"2.3 \u041c\u043e\u0434\u0435\u043b\u044c \u0434\u0430\u043d\u043d\u044b\u0445 <code>ParsingSource</code>","text":"<p>\u0422\u0430\u0431\u043b\u0438\u0446\u0430-\u0440\u0435\u0435\u0441\u0442\u0440 \u0432 PostgreSQL:</p> \u041f\u043e\u043b\u0435 \u0422\u0438\u043f \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 <code>url</code> String \u0422\u043e\u0447\u043a\u0430 \u0432\u0445\u043e\u0434\u0430. <code>type</code> Enum <code>hub</code>, <code>list</code>, <code>product</code>, <code>sitemap</code>. <code>site_key</code> String <code>mrgeek</code>, <code>ozon</code>. \u041e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u043a\u043b\u0430\u0441\u0441 Spider'\u0430. <code>priority</code> Int 1-100. \u0412\u043b\u0438\u044f\u0435\u0442 \u043d\u0430 \u043e\u0447\u0435\u0440\u0435\u0434\u043d\u043e\u0441\u0442\u044c \u0432 RabbitMQ. <code>refresh_interval</code> Int \u0411\u0430\u0437\u043e\u0432\u0430\u044f \u0447\u0430\u0441\u0442\u043e\u0442\u0430 (\u0447\u0430\u0441\u044b). <code>next_sync_at</code> DateTime \u0412\u0440\u0435\u043c\u044f \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0433\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430 (\u0438\u043d\u0434\u0435\u043a\u0441). <code>config</code> JSON \u0421\u043f\u0435\u0446\u0438\u0444\u0438\u0447\u043d\u044b\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 (Cookie, Geo, Proxy settings)."},{"location":"parsing/architecture/#24-the-loop","title":"2.4 \u041b\u043e\u0433\u0438\u043a\u0430 \u041f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0449\u0438\u043a\u0430 (The Loop)","text":"<p>\u0417\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u043f\u043e Cron (\u0440\u0430\u0437 \u0432 5 \u043c\u0438\u043d\u0443\u0442):</p> <ol> <li>Select: \u0412\u044b\u0431\u0438\u0440\u0430\u0435\u0442 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0438, \u0433\u0434\u0435 <code>next_sync_at &lt;= NOW()</code>.</li> <li>Lock: \u041e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442 <code>next_sync_at</code> \u043d\u0430 \u0431\u0443\u0434\u0443\u0449\u0435\u0435 (\"\u0431\u0440\u043e\u043d\u0438\u0440\u0443\u0435\u0442\").</li> <li>Publish: \u041e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0443 \u0432 RabbitMQ \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u0438\u0435\u043c <code>page_type</code>.<ul> <li>\u0415\u0441\u043b\u0438 \u0432\u043e\u0440\u043a\u0435\u0440 \u0443\u0432\u0438\u0434\u0438\u0442 <code>type='hub'</code>, \u043e\u043d \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442 \u043b\u043e\u0433\u0438\u043a\u0443 \u043f\u043e\u0438\u0441\u043a\u0430 \u0441\u0441\u044b\u043b\u043e\u043a.</li> <li>\u0415\u0441\u043b\u0438 <code>type='list'</code>, \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442 \u043b\u043e\u0433\u0438\u043a\u0443 \u0441\u0431\u043e\u0440\u0430 \u0442\u043e\u0432\u0430\u0440\u043e\u0432.</li> </ul> </li> </ol>"},{"location":"parsing/architecture/#25-smart-scheduling","title":"2.5 Smart Scheduling (\u0423\u043c\u043d\u043e\u0435 \u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435)","text":"<p>\u0412\u043c\u0435\u0441\u0442\u043e \u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b\u043e\u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0430\u0434\u0430\u043f\u0442\u0438\u0432\u043d\u0443\u044e \u043b\u043e\u0433\u0438\u043a\u0443, \u043e\u0441\u043d\u043e\u0432\u0430\u043d\u043d\u0443\u044e \u043d\u0430 \u043e\u0431\u0440\u0430\u0442\u043d\u043e\u0439 \u0441\u0432\u044f\u0437\u0438 \u043e\u0442 Ingestion API:</p> <ol> <li>\u0410\u0434\u0430\u043f\u0442\u0438\u0432\u043d\u044b\u0439 \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b (Stale Decay):<ul> <li>\u0415\u0441\u043b\u0438 \u0437\u0430\u043f\u0443\u0441\u043a \u043d\u0435 \u0432\u044b\u044f\u0432\u0438\u043b \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439 (<code>items_updated == 0</code>), \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b \u043c\u0435\u0436\u0434\u0443 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430\u043c\u0438 \u043f\u043e\u0441\u0442\u0435\u043f\u0435\u043d\u043d\u043e \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0432\u0430\u0435\u0442\u0441\u044f (Step: x1.5).</li> <li>\u0415\u0441\u043b\u0438 \u043e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u0430 \u0432\u044b\u0441\u043e\u043a\u0430\u044f \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c (\u043c\u043d\u043e\u0433\u043e \u043d\u043e\u0432\u0438\u043d\u043e\u043a \u0438\u043b\u0438 \u0441\u043c\u0435\u043d \u0446\u0435\u043d), \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b \u0441\u043e\u043a\u0440\u0430\u0449\u0430\u0435\u0442\u0441\u044f \u0434\u043e \u043c\u0438\u043d\u0438\u043c\u0443\u043c\u0430 \u0434\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0430.</li> </ul> </li> <li>Exponential Backoff (\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043e\u043a):<ul> <li>\u041f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u043e\u0448\u0438\u0431\u043e\u043a \u0441\u0435\u0442\u0438 \u0438\u043b\u0438 \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043e\u043a (403, 503), \u0432\u0440\u0435\u043c\u044f \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0433\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u043e\u0442\u043e\u0434\u0432\u0438\u0433\u0430\u0435\u0442\u0441\u044f \u043f\u043e \u044d\u043a\u0441\u043f\u043e\u043d\u0435\u043d\u0442\u0435: 1\u0447 -&gt; 4\u0447 -&gt; 24\u0447.</li> </ul> </li> <li>\u041f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0437\u0430\u0446\u0438\u044f:<ul> <li>\u0417\u0430\u0434\u0430\u0447\u0438 \u0432 RabbitMQ \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u0441 \u0440\u0430\u0437\u043d\u044b\u043c <code>priority</code> (\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f RabbitMQ Priority Queues). \u041f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u0438 \u0441\u0430\u0439\u0442\u044b \u0441 \u0432\u044b\u0441\u043e\u043a\u0438\u043c <code>Base_Priority</code> \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u0432\u043e\u0440\u043a\u0435\u0440\u0430\u043c\u0438 \u0432 \u043f\u0435\u0440\u0432\u0443\u044e \u043e\u0447\u0435\u0440\u0435\u0434\u044c.</li> </ul> </li> <li>\u041e\u043a\u043d\u043e \u043e\u0431\u0441\u043b\u0443\u0436\u0438\u0432\u0430\u043d\u0438\u044f:<ul> <li>\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0442\u044c \u043f\u0430\u0440\u0441\u0438\u043d\u0433 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0445 \u0441\u0430\u0439\u0442\u043e\u0432 \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u043e\u0447\u043d\u044b\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0435\u043c, \u0447\u0442\u043e\u0431\u044b \u0441\u043d\u0438\u0437\u0438\u0442\u044c \u0440\u0438\u0441\u043a \u043e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u0438\u044f \u0438 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0443 \u043d\u0430 \u0441\u0430\u0439\u0442-\u0434\u043e\u043d\u043e\u0440.</li> </ul> </li> </ol>"},{"location":"parsing/architecture/#_1","title":"\u0421\u0442\u0430\u0442\u0443\u0441 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438","text":""},{"location":"parsing/architecture/#3-scraping-workers","title":"3. \u0421\u043b\u043e\u0439 \u0418\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f (Scraping Workers)","text":"<p>\u041c\u0438\u043a\u0440\u043e\u0441\u0435\u0440\u0432\u0438\u0441 \u043d\u0430 \u0431\u0430\u0437\u0435 Scrapy. \u041e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0438 \u0438\u0437 \u043e\u0447\u0435\u0440\u0435\u0434\u0438.</p>"},{"location":"parsing/architecture/#workflow","title":"Workflow \u0412\u043e\u0440\u043a\u0435\u0440\u0430","text":"<ol> <li>Consume: \u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 JSON \u0437\u0430\u0434\u0430\u0447\u0443.     <pre><code>{ \"url\": \"...\", \"type\": \"list\", \"site_key\": \"mrgeek\" }\n</code></pre></li> <li>Select Spider: \u0417\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u043d\u0443\u0436\u043d\u044b\u0439 Java/Python \u043a\u043b\u0430\u0441\u0441.</li> <li>Crawl:<ul> <li>Proxy Rotation: Middleware \u043c\u0435\u043d\u044f\u0435\u0442 IP \u043f\u0440\u0438 \u0431\u0430\u043d\u0435 (403/Capt\u0441ha).</li> <li>User-Agent: \u0420\u043e\u0442\u0430\u0446\u0438\u044f \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u043e\u0432.</li> <li>Throttling: \u0410\u0432\u0442\u043e-\u0441\u043d\u0438\u0436\u0435\u043d\u0438\u0435 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438, \u0435\u0441\u043b\u0438 \u0441\u0430\u0439\u0442 \u0442\u043e\u0440\u043c\u043e\u0437\u0438\u0442.</li> </ul> </li> <li>Output:<ul> <li>\u0415\u0441\u043b\u0438 <code>list</code>: \u041e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043f\u0430\u0447\u043a\u0443 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 (Batch) \u0432 API.</li> <li>\u0415\u0441\u043b\u0438 <code>hub</code>: \u041e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u0430\u0439\u0434\u0435\u043d\u043d\u044b\u0435 URL \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u0432 API \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043d\u043e\u0432\u044b\u0445 <code>ParsingSource</code>.</li> </ul> </li> </ol>"},{"location":"parsing/architecture/#_2","title":"\u0421\u0442\u0430\u0442\u0443\u0441 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438","text":""},{"location":"parsing/architecture/#4-ingestion-api","title":"4. \u0421\u043b\u043e\u0439 \u0414\u0430\u043d\u043d\u044b\u0445 (Ingestion API)","text":"<p>\u041f\u0430\u0440\u0441\u0435\u0440\u044b \u043d\u0435 \u043f\u0438\u0448\u0443\u0442 \u0432 \u0411\u0414 \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e. API (<code>POST /internal/ingest</code>) \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442 \u0440\u043e\u043b\u044c \u0441\u0442\u0440\u0430\u0436\u0430:</p> <ol> <li>Validation: \u041e\u0442\u0441\u0435\u0438\u0432\u0430\u0435\u0442 \u0431\u0438\u0442\u044b\u0435 \u0442\u043e\u0432\u0430\u0440\u044b (\u043d\u0435\u0442 \u0446\u0435\u043d\u044b/\u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438).</li> <li>Normalization: \u0412\u0430\u043b\u044e\u0442\u044b -&gt; RUB, \u043e\u0447\u0438\u0441\u0442\u043a\u0430 HTML \u0442\u0435\u0433\u043e\u0432.</li> <li>Upsert: \u041e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0439 \u0442\u043e\u0432\u0430\u0440 \u0438\u043b\u0438 \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u043d\u043e\u0432\u044b\u0439.</li> <li>Feedback: \u0417\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443 (items_found, duration), \u0447\u0442\u043e\u0431\u044b \u041f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0449\u0438\u043a \u043c\u043e\u0433 \u0430\u0434\u0430\u043f\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0447\u0430\u0441\u0442\u043e\u0442\u0443.</li> </ol>"},{"location":"parsing/architecture/#41-ai-category-mapping","title":"4.1 AI Category Mapping (\u041c\u0430\u043f\u043f\u0438\u043d\u0433 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439)","text":"<p>\u0427\u0442\u043e\u0431\u044b \u043f\u0440\u0438\u0432\u0435\u0441\u0442\u0438 \u0442\u044b\u0441\u044f\u0447\u0438 \u0432\u043d\u0435\u0448\u043d\u0438\u0445 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 (\"\u041f\u0440\u0438\u043a\u043e\u043b\u044c\u043d\u044b\u0435 \u043a\u0440\u0443\u0436\u043a\u0438\", \"\u0427\u0430\u0448\u043a\u0438 \u0434\u043b\u044f \u0447\u0430\u044f\") \u043a \u0435\u0434\u0438\u043d\u043e\u043c\u0443 \u0432\u0438\u0434\u0443 Gifty:</p> <ol> <li>Table <code>CategoryMap</code>: \u0425\u0440\u0430\u043d\u0438\u0442 \u0441\u0432\u044f\u0437\u043a\u0443 <code>external_name</code> -&gt; <code>internal_category_id</code>.</li> <li>Runtime: \u0415\u0441\u043b\u0438 Ingestion API \u0432\u0441\u0442\u0440\u0435\u0447\u0430\u0435\u0442 \u043d\u043e\u0432\u043e\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438, \u043e\u043d \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442 \u0435\u0433\u043e \u0432 <code>CategoryMap</code> \u0441 <code>internal_id=NULL</code> \u0438 \u043f\u043e\u043c\u0435\u0447\u0430\u0435\u0442 \u0442\u043e\u0432\u0430\u0440 \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439 \u043c\u0435\u0442\u043a\u043e\u0439.</li> <li>Background Job (AI Classifier): \u0420\u0430\u0437 \u0432 \u0447\u0430\u0441 \u0431\u0435\u0440\u0435\u0442 \u043d\u0435\u0440\u0430\u0437\u043c\u0435\u0447\u0435\u043d\u043d\u044b\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 LLM (Gemini/GPT) \u0432\u043c\u0435\u0441\u0442\u0435 \u0441\u043e \u0441\u043f\u0438\u0441\u043a\u043e\u043c \u043d\u0430\u0448\u0438\u0445 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0445 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439.<ul> <li>Prompt: \"\u0421\u043e\u043f\u043e\u0441\u0442\u0430\u0432\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0410 \u0441\u043e \u0441\u043f\u0438\u0441\u043a\u043e\u043c \u0411\".</li> <li>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442\u0441\u044f \u0432 \u0411\u0414, \u0438 \u0442\u043e\u0432\u0430\u0440\u044b \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u044e\u0442\u0441\u044f.</li> </ul> </li> </ol>"},{"location":"parsing/architecture/#_3","title":"\u0421\u0442\u0430\u0442\u0443\u0441 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438","text":""},{"location":"parsing/architecture/#5-cicd","title":"5. \u0422\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0438 \u0414\u0435\u043f\u043b\u043e\u0439 (CI/CD)","text":"<p>\u0420\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u043f\u0430\u0440\u0441\u0435\u0440\u043e\u0432 \u0442\u0440\u0435\u0431\u0443\u0435\u0442 \u0441\u043f\u0435\u0446\u0438\u0444\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u043f\u043e\u0434\u0445\u043e\u0434\u0430 \u043a \u0442\u0435\u0441\u0442\u0430\u043c, \u0442\u0430\u043a \u043a\u0430\u043a \u0441\u0430\u0439\u0442\u044b \u043f\u043e\u0441\u0442\u043e\u044f\u043d\u043d\u043e \u043c\u0435\u043d\u044f\u044e\u0442\u0441\u044f.</p>"},{"location":"parsing/architecture/#51-fixture-tests","title":"5.1 \u041b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0435 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 (Fixture Tests)","text":"<p>\u041c\u044b \u043d\u0435 \u0442\u0435\u0441\u0442\u0438\u0440\u0443\u0435\u043c \u043d\u0430 \u0436\u0438\u0432\u044b\u0445 \u0441\u0430\u0439\u0442\u0430\u0445 \u0432 CI (\u044d\u0442\u043e \u043d\u0435\u043d\u0430\u0434\u0435\u0436\u043d\u043e). 1.  \u0420\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442 HTML-\u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0432 \u0444\u0430\u0439\u043b: <code>tests/fixtures/mrgeek.html</code>. 2.  \u041f\u0438\u0448\u0435\u0442 \u0442\u0435\u0441\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0430\u0442\u0440\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442 Spider \u043d\u0430 \u044d\u0442\u043e\u0442 \u0444\u0430\u0439\u043b. 3.  \u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442, \u0447\u0442\u043e \u0438\u0437\u0432\u043b\u0435\u043a\u043b\u043e\u0441\u044c \u0440\u043e\u0432\u043d\u043e 36 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0438 \u043f\u043e\u043b\u044f (\u0426\u0435\u043d\u0430, \u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435) \u043d\u0435 \u043f\u0443\u0441\u0442\u044b\u0435. *   \u041f\u043b\u044e\u0441: \u0422\u0435\u0441\u0442\u044b \u043f\u0440\u043e\u043b\u0435\u0442\u0430\u044e\u0442 \u0437\u0430 \u0441\u0435\u043a\u0443\u043d\u0434\u0443 \u0438 \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0442 \u0431\u0435\u0437 \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442\u0430.</p>"},{"location":"parsing/architecture/#52","title":"5.2 \u041f\u0440\u043e\u0446\u0435\u0441\u0441 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f","text":"<p>Scraper Service \u2014 \u044d\u0442\u043e Stateless \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440. 1.  \u041f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u043a\u043e\u0434\u0430 \u0441\u043e\u0431\u0438\u0440\u0430\u0435\u0442\u0441\u044f \u043d\u043e\u0432\u044b\u0439 Docker image. 2.  \u0412\u043e\u0440\u043a\u0435\u0440\u044b \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u0430\u044e\u0442\u0441\u044f \u043f\u043e\u044d\u0442\u0430\u043f\u043d\u043e (Rolling Update). 3.  \u0417\u0430\u0434\u0430\u0447\u0438 \u0432 RabbitMQ \u043d\u0435 \u0442\u0435\u0440\u044f\u044e\u0442\u0441\u044f: \u0435\u0441\u043b\u0438 \u0432\u043e\u0440\u043a\u0435\u0440 \u0443\u043c\u0435\u0440 \u0432\u043e \u0432\u0440\u0435\u043c\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438, \u0437\u0430\u0434\u0430\u0447\u0430 \u043f\u0440\u043e\u0441\u0442\u043e \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442\u0441\u044f \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u0434\u043b\u044f \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u0432\u043e\u0440\u043a\u0435\u0440\u0430.</p>"},{"location":"parsing/architecture/#6","title":"6. \u0411\u044b\u0441\u0442\u0440\u044b\u0439 \u0441\u0442\u0430\u0440\u0442 \u0434\u043b\u044f \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430 \u043f\u0430\u0440\u0441\u0435\u0440\u043e\u0432","text":"<p>\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0430\u044f \u043f\u043e\u0448\u0430\u0433\u043e\u0432\u0430\u044f \u0438\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f \u043f\u043e \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044e, \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044e \u0438 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u043d\u043e\u0432\u044b\u0445 \u043f\u0430\u0443\u043a\u043e\u0432 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u0432\u044b\u043d\u0435\u0441\u0435\u043d\u0430 \u0432 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e\u0435 \u0440\u0443\u043a\u043e\u0432\u043e\u0434\u0441\u0442\u0432\u043e:</p> <p>\ud83d\udc49 \u0413\u0430\u0439\u0434 \u043f\u043e \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044e \u043f\u0430\u0440\u0441\u0435\u0440\u043e\u0432</p>"},{"location":"parsing/guide/","title":"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u043e\u0432\u044b\u0445 \u043f\u0430\u0440\u0441\u0435\u0440\u043e\u0432 \ud83d\udd77\ufe0f","text":"<p>\u0412 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 Gifty \u0441\u0431\u043e\u0440 \u0434\u0430\u043d\u043d\u044b\u0445 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e Scrapy. \u042d\u0442\u0430 \u0441\u0442\u0430\u043d\u0438\u0446\u0430 \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442, \u043a\u0430\u043a \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0442\u044c, \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0438 \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0430\u0443\u043a\u043e\u0432.</p>"},{"location":"parsing/guide/#_2","title":"\ud83d\ude80 \u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043a\u043e\u043d\u0446\u0435\u043f\u0446\u0438\u0438","text":""},{"location":"parsing/guide/#1-yield","title":"1. \u041a\u0430\u043a \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u041f\u0430\u0443\u043a (Yield \u0438 \u0413\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440\u044b)","text":"<p>\u0412 Scrapy \u043c\u0435\u0442\u043e\u0434\u044b \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0430 \u2014 \u044d\u0442\u043e \u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440\u044b. \u0412\u043c\u0435\u0441\u0442\u043e \u0442\u043e\u0433\u043e \u0447\u0442\u043e\u0431\u044b \u0441\u043e\u0431\u0438\u0440\u0430\u0442\u044c \u0432\u0441\u0435 \u0442\u043e\u0432\u0430\u0440\u044b \u0432 \u043e\u0433\u0440\u043e\u043c\u043d\u044b\u0439 \u0441\u043f\u0438\u0441\u043e\u043a \u0438 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0442\u044c \u0435\u0433\u043e \u0432 \u043a\u043e\u043d\u0446\u0435 (<code>return list</code>), \u043c\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043a\u043b\u044e\u0447\u0435\u0432\u043e\u0435 \u0441\u043b\u043e\u0432\u043e <code>yield</code>.</p> <p>\u041f\u043e\u0447\u0435\u043c\u0443 \u044d\u0442\u043e \u0432\u0430\u0436\u043d\u043e?</p> <ul> <li>\u042d\u043a\u043e\u043d\u043e\u043c\u0438\u044f \u043f\u0430\u043c\u044f\u0442\u0438: Scrapy \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u043e\u0431\u044a\u0435\u043a\u0442\u044b \u043f\u043e \u043e\u0434\u043d\u043e\u043c\u0443, \u043a\u0430\u043a \u0442\u043e\u043b\u044c\u043a\u043e \u043e\u043d\u0438 \"\u0432\u044b\u043b\u0435\u0442\u0430\u044e\u0442\" \u0438\u0437 \u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440\u0430. \u042d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u0430\u0440\u0441\u0438\u0442\u044c \u043c\u0438\u043b\u043b\u0438\u043e\u043d\u044b \u0442\u043e\u0432\u0430\u0440\u043e\u0432, \u043d\u0435 \u0437\u0430\u0431\u0438\u0432\u0430\u044f RAM \u0432\u043e\u0440\u043a\u0435\u0440\u0430.</li> <li>\u041f\u043e\u0442\u043e\u043a\u043e\u0432\u043e\u0441\u0442\u044c: Pipeline (\u0446\u0435\u043f\u043e\u0447\u043a\u0430 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438) \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442 \u0432\u0430\u043b\u0438\u0434\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u043f\u0435\u0440\u0432\u044b\u0439 \u0442\u043e\u0432\u0430\u0440, \u043f\u043e\u043a\u0430 \u043f\u0430\u0443\u043a \u0435\u0449\u0435 \u043f\u0430\u0440\u0441\u0438\u0442 \u0432\u0442\u043e\u0440\u043e\u0439.</li> </ul> <pre><code>def parse_catalog(self, response):\n    for card in response.css('.card'):\n        # \u041c\u044b \"\u0432\u044b\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u0435\u043c\" \u0442\u043e\u0432\u0430\u0440 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u0441\u0440\u0430\u0437\u0443\n        yield self.create_product(...)\n</code></pre>"},{"location":"parsing/guide/#2-discovery-vs-deep","title":"2. \u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0438: Discovery vs Deep","text":"<p>\u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0440\u0430\u0437\u043b\u0438\u0447\u0430\u0435\u0442 \u0434\u0432\u0435 \u0444\u0430\u0437\u044b \u0436\u0438\u0437\u043d\u0438 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0430:</p> <ul> <li>Discovery (<code>strategy=\"discovery\"</code>): \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0425\u0430\u0431\u043e\u0432 (\u0433\u043b\u0430\u0432\u043d\u044b\u0445 \u0441\u0442\u0440\u0430\u043d\u0438\u0446 \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432). \u041f\u0430\u0443\u043a \u0438\u0449\u0435\u0442 \u0441\u0441\u044b\u043b\u043a\u0438 \u043d\u0430 \u043a\u043e\u043d\u0435\u0447\u043d\u044b\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438. \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u2014 \u043e\u0431\u044a\u0435\u043a\u0442\u044b <code>CategoryItem</code>.</li> <li>Deep (<code>strategy=\"deep\"</code>): \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0421\u043f\u0438\u0441\u043a\u043e\u0432 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 (\u041b\u0438\u0441\u0442\u0438\u043d\u0433\u043e\u0432). \u041f\u0430\u0443\u043a \u0441\u043e\u0431\u0438\u0440\u0430\u0435\u0442 \u0442\u043e\u0432\u0430\u0440\u044b \u0438 \u0438\u0434\u0435\u0442 \u043f\u043e \u043f\u0430\u0433\u0438\u043d\u0430\u0446\u0438\u0438. \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u2014 \u043e\u0431\u044a\u0435\u043a\u0442\u044b <code>ProductItem</code>.</li> </ul>"},{"location":"parsing/guide/#_3","title":"\ud83d\udee0\ufe0f \u0420\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u041f\u0430\u0443\u043a\u0430","text":"<p>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 <code>GiftyBaseSpider</code> \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u043e\u0441\u043d\u043e\u0432\u044b. \u041e\u043d \u0431\u0435\u0440\u0435\u0442 \u043d\u0430 \u0441\u0435\u0431\u044f \u0440\u0443\u0442\u0438\u043d\u0443: \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044e URL, \u043f\u0440\u043e\u0431\u0440\u043e\u0441 <code>source_id</code> \u0438 \u0432\u044b\u0431\u043e\u0440 \u043d\u0443\u0436\u043d\u043e\u0433\u043e \u043c\u0435\u0442\u043e\u0434\u0430 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0430 \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0438.</p>"},{"location":"parsing/guide/#_4","title":"\u041f\u0440\u0438\u043c\u0435\u0440 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438","text":"<pre><code>from gifty_scraper.base_spider import GiftyBaseSpider\nfrom gifty_scraper.items import CategoryItem\n\nclass MyShopSpider(GiftyBaseSpider):\n    name = \"myshop\"\n    site_key = \"myshop\"\n\n    def parse_discovery(self, response):\n        \"\"\"\u0424\u0430\u0437\u0430 1: \u0421\u043e\u0431\u0438\u0440\u0430\u0435\u043c \u0441\u0441\u044b\u043b\u043a\u0438 \u043d\u0430 \u043f\u043e\u0434\u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438\"\"\"\n        for link in response.css('a.category-link'):\n            yield CategoryItem(\n                name=link.css('::text').get().strip(),\n                url=response.urljoin(link.attrib['href']),\n                site_key=self.site_key\n            )\n\n    def parse_catalog(self, response):\n        \"\"\"\u0424\u0430\u0437\u0430 2: \u0421\u043e\u0431\u0438\u0440\u0430\u0435\u043c \u0442\u043e\u0432\u0430\u0440\u044b \u0438\u0437 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0439 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438\"\"\"\n        for card in response.css('.product-card'):\n            yield self.create_product(\n                title=card.css('.name::text').get(),\n                price=card.css('.price::text').re_first(r'\\d+'),\n                product_url=response.urljoin(card.css('a::attr(href)').get()),\n                image_url=response.urljoin(card.css('img::attr(src)').get()),\n                merchant=\"My Shop\"\n            )\n\n        # \u041f\u0430\u0433\u0438\u043d\u0430\u0446\u0438\u044f\n        if self.strategy == \"deep\":\n            next_page = response.css('a.next::attr(href)').get()\n            if next_page:\n                yield response.follow(next_page, self.parse_catalog)\n</code></pre>"},{"location":"parsing/guide/#_5","title":"\ud83c\udfd7\ufe0f \u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0441\u043b\u043e\u0436\u043d\u044b\u0445 \u0441\u043b\u0443\u0447\u0430\u0435\u0432","text":""},{"location":"parsing/guide/#_6","title":"\u0421\u043b\u0443\u0447\u0430\u0439: \u0420\u0430\u0437\u043d\u0430\u044f \u0432\u0435\u0440\u0441\u0442\u043a\u0430 \u0434\u043b\u044f \u0440\u0430\u0437\u043d\u044b\u0445 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439","text":"<p>\u0418\u043d\u043e\u0433\u0434\u0430 \u0432\u043d\u0443\u0442\u0440\u0438 \u043e\u0434\u043d\u043e\u0433\u043e \u0441\u0430\u0439\u0442\u0430 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \"\u041e\u0434\u0435\u0436\u0434\u0430\" \u0438 \"\u042d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u0438\u043a\u0430\" \u0438\u043c\u0435\u044e\u0442 \u0430\u0431\u0441\u043e\u043b\u044e\u0442\u043d\u043e \u0440\u0430\u0437\u043d\u044b\u0435 \u0441\u0435\u043b\u0435\u043a\u0442\u043e\u0440\u044b.</p> <p>\u0412\u0430\u0440\u0438\u0430\u043d\u0442 \u0410: \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0447\u0435\u0440\u0435\u0437 URL (\u0432 \u043a\u043e\u0434\u0435) <pre><code>def parse_catalog(self, response):\n    if \"/electronics/\" in response.url:\n        return self.parse_electronics(response)\n    return self.parse_generic(response)\n</code></pre></p> <p>\u0412\u0430\u0440\u0438\u0430\u043d\u0442 \u0411: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 Config (\u0447\u0435\u0440\u0435\u0437 \u0431\u0430\u0437\u0443) \u0415\u0441\u043b\u0438 \u0432\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u043c\u0435\u043d\u044f\u0442\u044c \u043b\u043e\u0433\u0438\u043a\u0443 \u0431\u0435\u0437 \u043f\u0435\u0440\u0435\u0441\u0431\u043e\u0440\u043a\u0438 \u043a\u043e\u0434\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043f\u043e\u043b\u0435 <code>config</code> \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 <code>parsing_sources</code>. \u0412\u0441\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u043d\u0435\u0433\u043e \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u043f\u0430\u0443\u043a\u0443 \u0432 <code>self.config</code>. <pre><code>def parse_catalog(self, response):\n    title_css = self.config.get('custom_title_css', '.default-title')\n    yield self.create_product(\n        title=response.css(title_css).get(),\n        # ...\n    )\n</code></pre></p>"},{"location":"parsing/guide/#_7","title":"\ud83d\udee0\ufe0f \u0422\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0438 \u043e\u0442\u043b\u0430\u0434\u043a\u0430","text":"<p>\u0414\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u043b\u043e\u0433\u0438\u043a\u0438 \u0431\u0435\u0437 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0432\u0441\u0435\u0439 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b (Docker/API) \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0439 \u0441\u043a\u0440\u0438\u043f\u0442:</p> <pre><code>python3 scripts/test_spider.py myshop \"https://myshop.ru/catalog\" --limit 10\n</code></pre> <ul> <li><code>--limit</code>: \u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0442 \u0441\u0431\u043e\u0440 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u043f\u0435\u0440\u0432\u044b\u0435 10 \u0442\u043e\u0432\u0430\u0440\u043e\u0432).</li> <li><code>--output</code>: \u0418\u043c\u044f \u0444\u0430\u0439\u043b\u0430 \u0441 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430\u043c\u0438 (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e <code>test_results.json</code>).</li> <li><code>--strategy</code>: discovery \u0438\u043b\u0438 deep (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e deep).</li> </ul>"},{"location":"parsing/guide/#_8","title":"\u26d3\ufe0f \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435","text":"<p>\u0412 \u043d\u043e\u0432\u043e\u0439 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0435 Gifty \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u0430\u0443\u043a\u043e\u0432 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438. \u0412\u0430\u043c \u043d\u0435 \u043d\u0443\u0436\u043d\u043e \u0432\u0440\u0443\u0447\u043d\u0443\u044e \u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0431\u0430\u0437\u0443 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438\u043b\u0438 \u0441\u043b\u043e\u0432\u0430\u0440\u0438 \u0432 \u043a\u043e\u0434\u0435.</p>"},{"location":"parsing/guide/#1","title":"1. \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u0430\u0443\u043a\u0430","text":"<p>\u041f\u0440\u043e\u0441\u0442\u043e \u0441\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u043d\u043e\u0432\u044b\u0439 \u0444\u0430\u0439\u043b \u043f\u0430\u0443\u043a\u0430 \u0432 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 <code>services/gifty_scraper/spiders/</code>. \u0423\u0431\u0435\u0434\u0438\u0442\u0435\u0441\u044c, \u0447\u0442\u043e \u0443 \u043f\u0430\u0443\u043a\u0430 \u0437\u0430\u0434\u0430\u043d\u043e \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u043e\u0435 \u0438\u043c\u044f (<code>name</code> \u0438 <code>site_key</code>).</p>"},{"location":"parsing/guide/#2","title":"2. \u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u043e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u0438\u0435","text":"<p>\u041a\u0430\u043a \u0442\u043e\u043b\u044c\u043a\u043e \u0432\u044b \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u0435 \u0444\u0430\u0439\u043b \u0438 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0435 \u0441\u0435\u0440\u0432\u0438\u0441 <code>scraper</code>, \u0432\u043e\u0440\u043a\u0435\u0440 \u043f\u0440\u0438 \u0441\u0442\u0430\u0440\u0442\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442 \u043a\u043e\u043c\u0430\u043d\u0434\u0443 <code>scrapy list</code> \u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u043f\u0430\u0443\u043a\u043e\u0432 \u0432 Core API.</p>"},{"location":"parsing/guide/#3-dashboard","title":"3. \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u0447\u0435\u0440\u0435\u0437 Dashboard","text":"<p>\u041f\u043e\u0441\u043b\u0435 \u043e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u0438\u044f \u043d\u043e\u0432\u044b\u0439 \u043f\u0430\u0443\u043a \u043f\u043e\u044f\u0432\u0438\u0442\u0441\u044f \u0432 Dashboard (\u0432 Telegram \u0431\u043e\u0442\u0435) \u0441\u043e \u0441\u0442\u0430\u0442\u0443\u0441\u043e\u043c <code>disabled</code>. \u0427\u0442\u043e\u0431\u044b \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0435\u0433\u043e:</p> <ol> <li>\u041e\u0442\u043a\u0440\u043e\u0439\u0442\u0435 Dashboard \u0447\u0435\u0440\u0435\u0437 \u0431\u043e\u0442\u0430.</li> <li>\u041d\u0430\u0439\u0434\u0438\u0442\u0435 \u0432\u0430\u0448\u0435\u0433\u043e \u043d\u043e\u0432\u043e\u0433\u043e \u043f\u0430\u0443\u043a\u0430 \u0432 \u0441\u043f\u0438\u0441\u043a\u0435.</li> <li>\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u043a\u043d\u043e\u043f\u043a\u0443 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0438 \u0443\u043a\u0430\u0436\u0438\u0442\u0435:<ul> <li>URL: \u0412\u0445\u043e\u0434\u043d\u0430\u044f \u0442\u043e\u0447\u043a\u0430 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0441\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 Sitemap \u0438\u043b\u0438 Hub-\u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443).</li> <li>Type: \u0422\u0438\u043f \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0430 (<code>hub</code>, <code>list</code>, <code>sitemap</code>).</li> <li>Strategy: \u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044f (<code>discovery</code> \u0438\u043b\u0438 <code>deep</code>).</li> <li>Interval: \u0416\u0435\u043b\u0430\u0435\u043c\u044b\u0439 \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f.</li> </ul> </li> <li>\u041f\u0435\u0440\u0435\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0430\u0442\u0435\u043b\u044c \u0432 \u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435 Active.</li> </ol> <p>\u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0441\u0430\u043c\u0430 \u0434\u043e\u0431\u0430\u0432\u0438\u0442 \u0437\u0430\u0434\u0430\u0447\u0443 \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u043f\u0440\u0438 \u043d\u0430\u0441\u0442\u0443\u043f\u043b\u0435\u043d\u0438\u0438 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0439 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438.</p>"},{"location":"parsing/guide/#dashboard","title":"\ud83d\udea6 \u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 (Dashboard)","text":"<p>\u0414\u043b\u044f \u043e\u043f\u0435\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0433\u043e \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u043e\u0439 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f Gifty Scraping Dashboard, \u0438\u043d\u0442\u0435\u0433\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u043f\u0440\u044f\u043c\u043e \u0432 Telegram \u0411\u043e\u0442\u0430 (Mini App).</p>"},{"location":"parsing/guide/#_9","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0434\u0430\u0448\u0431\u043e\u0440\u0434\u0430:","text":"<ol> <li>Spider List: \u0421\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u043e\u0432, \u0438\u0445 \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u0441\u0442\u0430\u0442\u0443\u0441 (<code>waiting</code>, <code>running</code>, <code>error</code>, <code>broken</code>) \u0438 \u0432\u0440\u0435\u043c\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430.</li> <li>Health Check: \u0412\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0432\u043e\u0440\u043a\u0435\u0440\u043e\u0432 \u0438 \u0438\u0445 \"\u043f\u0443\u043b\u044c\u0441\u0430\" (heartbeat) \u0438\u0437 Redis.</li> <li>Config Editor: \u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a \u043f\u0430\u0443\u043a\u0430 (URL, \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b, \u0433\u043b\u0443\u0431\u0438\u043d\u0430 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0430) \u0431\u0435\u0437 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u043a\u043e\u0434\u0430.</li> <li>Stats: \u0410\u0433\u0440\u0435\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u0430\u044f \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u043f\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0443 \u0441\u043f\u0430\u0440\u0448\u0435\u043d\u043d\u044b\u0445 \u0438 \u043d\u043e\u0432\u044b\u0445 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0437\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435 24 \u0447\u0430\u0441\u0430.</li> </ol>"},{"location":"parsing/guide/#_10","title":"\u041a\u0430\u043a \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u0434\u0430\u0448\u0431\u043e\u0440\u0434:","text":"<p>\u0412 \u0433\u043b\u0430\u0432\u043d\u043e\u043c \u043c\u0435\u043d\u044e Telegram \u0431\u043e\u0442\u0430 \u043d\u0430\u0436\u043c\u0438\u0442\u0435 \u043a\u043d\u043e\u043f\u043a\u0443 \"\ud83d\udd77 \u041f\u0430\u0440\u0441\u0438\u043d\u0433\". </p> <p>Tip</p> <p>\u0415\u0441\u043b\u0438 \u0434\u0430\u0448\u0431\u043e\u0440\u0434 \u043d\u0435 \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u0442\u0441\u044f (\u0431\u0435\u043b\u044b\u0439 \u044d\u043a\u0440\u0430\u043d), \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435, \u0437\u0430\u043f\u0443\u0449\u0435\u043d \u043b\u0438 \u0441\u0435\u0440\u0432\u0438\u0441 <code>dashboard</code> \u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u043b\u0438 \u043e\u043d \u043f\u043e HTTPS (\u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u0435 Telegram).</p>"},{"location":"parsing/guide/#_11","title":"\ud83d\udca1 \u0420\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0438","text":"<ol> <li>Throttling: \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0441\u0442\u043e\u0438\u0442 \u0437\u0430\u0434\u0435\u0440\u0436\u043a\u0430 1\u0441 \u043c\u0435\u0436\u0434\u0443 \u0437\u0430\u043f\u0440\u043e\u0441\u0430\u043c\u0438. \u0415\u0441\u043b\u0438 \u0441\u0430\u0439\u0442 \u0431\u043b\u043e\u043a\u0438\u0440\u0443\u0435\u0442 \u2014 \u0443\u0432\u0435\u043b\u0438\u0447\u044c\u0442\u0435 <code>DOWNLOAD_DELAY</code> \u0432 <code>settings.py</code>.</li> <li>CSS vs XPath: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 CSS \u0441\u0435\u043b\u0435\u043a\u0442\u043e\u0440\u044b \u0432\u0435\u0437\u0434\u0435, \u0433\u0434\u0435 \u044d\u0442\u043e \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u2014 \u043e\u043d\u0438 \u043f\u0440\u043e\u0449\u0435 \u0447\u0438\u0442\u0430\u044e\u0442\u0441\u044f.</li> <li>Images: \u0412\u0441\u0435\u0433\u0434\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0439\u0442\u0435, \u0447\u0442\u043e <code>image_url</code> \u2014 \u044d\u0442\u043e \u043f\u043e\u043b\u043d\u0430\u044f \u0441\u0441\u044b\u043b\u043a\u0430 (\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 <code>response.urljoin</code>).</li> <li>Batching: \u041d\u0430\u0448 Pipeline \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0433\u0440\u0443\u043f\u043f\u0438\u0440\u0443\u0435\u0442 \u0442\u043e\u0432\u0430\u0440\u044b \u0432 \u043f\u0430\u0447\u043a\u0438 \u043f\u0435\u0440\u0435\u0434 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u043e\u0439 \u0432 API \u0434\u043b\u044f \u044d\u043a\u043e\u043d\u043e\u043c\u0438\u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432.</li> </ol>"},{"location":"recommendation/discovery_algorithm/","title":"\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c \u0418\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u043d\u0438\u044f \u0438 \u0414\u0438\u0430\u043b\u043e\u0433\u0430 (Discovery via Dialogue)","text":"<p>\u0424\u0438\u043b\u043e\u0441\u043e\u0444\u0438\u044f: \u041c\u044b \u043d\u0435 \u0433\u0430\u0434\u0430\u0435\u043c, \u043a\u0430\u043a\u043e\u0439 \u043f\u043e\u0434\u0430\u0440\u043e\u043a \u043d\u0443\u0436\u0435\u043d \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e. \u041c\u044b \u0432\u0435\u0434\u0435\u043c \u043e\u0441\u043e\u0437\u043d\u0430\u043d\u043d\u044b\u0439 \u0434\u0438\u0430\u043b\u043e\u0433, \u0447\u0442\u043e\u0431\u044b \u0432\u043c\u0435\u0441\u0442\u0435 \u0441 \u043d\u0438\u043c \u00ab\u0434\u043e\u0441\u0442\u0440\u043e\u0438\u0442\u044c\u00bb \u043e\u0431\u0440\u0430\u0437 \u0438\u0434\u0435\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u043e\u0434\u0430\u0440\u043a\u0430, \u0434\u0438\u0430\u0433\u043d\u043e\u0441\u0442\u0438\u0440\u0443\u044f \u0436\u0438\u0437\u043d\u0435\u043d\u043d\u044b\u0435 \u0434\u0435\u0444\u0438\u0446\u0438\u0442\u044b \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u044f.</p>"},{"location":"recommendation/discovery_algorithm/#1","title":"1. \u041e\u0431\u0449\u0430\u044f \u0441\u0445\u0435\u043c\u0430 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430","text":"<p>\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0441\u043e\u0431\u043e\u0439 \u0446\u0438\u043a\u043b \u043e\u0431\u0440\u0430\u0442\u043d\u043e\u0439 \u0441\u0432\u044f\u0437\u0438, \u0433\u0434\u0435 \u043a\u0430\u0436\u0434\u043e\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043b\u0438\u0431\u043e \u0441\u0443\u0436\u0430\u0435\u0442 \u0442\u0435\u043a\u0443\u0449\u0443\u044e \u0442\u0435\u043c\u0443, \u043b\u0438\u0431\u043e \u0437\u0430\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u0441\u043e\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u00ab\u043f\u0440\u044b\u0436\u043e\u043a\u00bb \u0432 \u043d\u043e\u0432\u0443\u044e \u043e\u0431\u043b\u0430\u0441\u0442\u044c.</p> graph TD     Start[\"\u041a\u0432\u0438\u0437 (Cold Start)\"] --&gt; Topics[\"\u0418\u0437\u0432\u043b\u0435\u0447\u0435\u043d\u0438\u0435 Topics (\u0421\u0435\u043c\u0435\u043d\u0430)\"]      subgraph \"\u0410\u043d\u0430\u043b\u0438\u0437 \u0438 \u0412\u0435\u0442\u0432\u043b\u0435\u043d\u0438\u0435\"         Topics --&gt; Wide{\u0422\u043e\u043f\u0438\u043a \u0448\u0438\u0440\u043e\u043a\u0438\u0439?}         Wide -- \u0414\u0430 --&gt; Probe1[\"\u0417\u043e\u043d\u0434-\u0443\u0442\u043e\u0447\u043d\u0438\u0442\u0435\u043b\u044c (\u0412\u0435\u0442\u0432\u043b\u0435\u043d\u0438\u0435)\"]         Probe1 --&gt; Topics         Wide -- \u041d\u0435\u0442 --&gt; Hypothesis[\"\u0413\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u0413\u0438\u043f\u043e\u0442\u0435\u0437 (GUTG Mix)\"]     end      subgraph \"\u0418\u043d\u0442\u0435\u0440\u0430\u043a\u0442\u0438\u0432\u043d\u0430\u044f \u041b\u0435\u043d\u0442\u0430\"         Hypothesis --&gt; Cards[\"\u041a\u0430\u0440\u0442\u043e\u0447\u043a\u0438 \u0418\u0434\u0435\u0439 + \u041f\u0440\u0438\u043c\u0435\u0440\u044b \u0442\u043e\u0432\u0430\u0440\u043e\u0432\"]         Cards --&gt; Feedback{\u0424\u0438\u0434\u0431\u044d\u043a?}         Feedback -- \"Like / Click\" --&gt; DeepDive[\"Deep Dive: \u041d\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0442\u043e\u0432\u0430\u0440\u0430\u043c\u0438 \u0442\u0435\u043c\u044b\"]         Feedback -- \"Dislike\" --&gt; Hypothesis         Feedback -- \"\u041c\u0435\u0440\u0442\u0432\u0430\u044f \u0437\u043e\u043d\u0430 (\u0422\u0443\u043f\u0438\u043a)\" --&gt; Pivot[\"\u0421\u043f\u0430\u0441-\u043a\u0430\u0440\u0442\u0430 (Pivot Probe)\"]     end      Pivot --&gt; |\"\u041d\u043e\u0432\u044b\u0439 \u0438\u043d\u0442\u0435\u0440\u0435\u0441\"| Topics     Pivot --&gt; |\"GUTG \u0413\u044d\u043f\"| Hypothesis     DeepDive --&gt; Shortlist[\"\u0428\u043e\u0440\u0442\u043b\u0438\u0441\u0442 \u0438 \u041f\u043e\u043a\u0443\u043f\u043a\u0430\"]"},{"location":"recommendation/discovery_algorithm/#2-1-branching","title":"2. \u042d\u0442\u0430\u043f 1: \u0410\u043d\u0430\u043b\u0438\u0437 \u0422\u043e\u043f\u0438\u043a\u043e\u0432 (Branching)","text":"<p>\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0447\u0430\u0441\u0442\u043e \u0432\u0432\u043e\u0434\u0438\u0442 \u043e\u0431\u0449\u0438\u0435 \u043f\u043e\u043d\u044f\u0442\u0438\u044f (\u00ab\u0418\u0433\u0440\u044b\u00bb, \u00ab\u041a\u0443\u0445\u043d\u044f\u00bb). \u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0434\u043e\u043b\u0436\u043d\u0430 \u00ab\u043a\u043e\u043b\u043b\u0430\u043f\u0441\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u00bb \u044d\u0442\u0438 \u043f\u043e\u043d\u044f\u0442\u0438\u044f \u0434\u043e \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u0438\u043a\u0438.</p> <ul> <li>\u041b\u043e\u0433\u0438\u043a\u0430: LLM \u0430\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u0442 \u0442\u043e\u043f\u0438\u043a. \u0415\u0441\u043b\u0438 \u043e\u043d \u043f\u043e\u043a\u0440\u044b\u0432\u0430\u0435\u0442 \u0431\u043e\u043b\u0435\u0435 3-\u0445 \u043d\u0435\u043f\u0435\u0440\u0435\u0441\u0435\u043a\u0430\u044e\u0449\u0438\u0445\u0441\u044f \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u2014 \u043e\u043d \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f \u0448\u0438\u0440\u043e\u043a\u0438\u043c.</li> <li>\u0418\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442: \u0417\u043e\u043d\u0434-\u0441\u043f\u0435\u0446\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440.</li> <li>\u041f\u0440\u0438\u043c\u0435\u0440: \u00ab\u0421\u043f\u043e\u0440\u0442\u00bb.<ul> <li>\u0417\u043e\u043d\u0434: \u00ab\u042d\u0442\u043e \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0439 \u0441\u043f\u043e\u0440\u0442 (\u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u044c), \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 \u0444\u043e\u0440\u043c\u044b (\u0433\u0430\u0434\u0436\u0435\u0442\u044b) \u0438\u043b\u0438 \u0444\u0430\u043d\u0430\u0442\u0441\u0442\u0432\u043e (\u043c\u0435\u0440\u0447)?\u00bb</li> </ul> </li> </ul>"},{"location":"recommendation/discovery_algorithm/#3-2-gutg-","title":"3. \u042d\u0442\u0430\u043f 2: \u0413\u0438\u043f\u043e\u0442\u0435\u0437\u044b \u0438 GUTG-\u0433\u044d\u043f\u044b","text":"<p>GUTG \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043d\u0430\u043c\u0438 \u043d\u0435 \u0434\u043b\u044f \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0430, \u0430 \u0434\u043b\u044f \u043f\u043e\u043a\u0440\u044b\u0442\u0438\u044f \u0432\u0441\u0435\u0445 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u044b\u0445 \u00ab\u043f\u0440\u043e\u0431\u043e\u0438\u043d\u00bb \u0432 \u0435\u0433\u043e \u0436\u0438\u0437\u043d\u0438 \u0432 \u0440\u0430\u043c\u043a\u0430\u0445 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u0442\u043e\u043f\u0438\u043a\u0430.</p> <p>\u0414\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0442\u043e\u043f\u0438\u043a\u0430 \u043c\u044b \u0433\u0435\u043d\u0435\u0440\u0438\u0440\u0443\u0435\u043c 3\u20134 \u0433\u0438\u043f\u043e\u0442\u0435\u0437\u044b \u0438\u0437 \u0440\u0430\u0437\u043d\u044b\u0445 \u0441\u0444\u0435\u0440 GUTG: 1.  Optimizer Idea: \u041a\u0430\u043a \u044d\u0442\u043e\u0442 \u0442\u043e\u043f\u0438\u043a \u043c\u043e\u0436\u0435\u0442 \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u0435\u0433\u043e \u0436\u0438\u0437\u043d\u044c \u0443\u0434\u043e\u0431\u043d\u0435\u0435? 2.  Catalyst Idea: \u041a\u0430\u043a \u044d\u0442\u043e\u0442 \u0442\u043e\u043f\u0438\u043a \u043c\u043e\u0436\u0435\u0442 \u043f\u043e\u043c\u043e\u0447\u044c \u0435\u043c\u0443 \u0432\u044b\u0440\u0430\u0441\u0442\u0438? 3.  Permission Idea: \u041a\u0430\u043a \u044d\u0442\u043e\u0442 \u0442\u043e\u043f\u0438\u043a \u043c\u043e\u0436\u0435\u0442 \u043f\u043e\u043c\u043e\u0447\u044c \u0435\u043c\u0443 \u0440\u0430\u0441\u0441\u043b\u0430\u0431\u0438\u0442\u044c\u0441\u044f/\u043f\u043e\u0437\u0432\u043e\u043b\u0438\u0442\u044c \u0441\u0435\u0431\u0435 \u043b\u0438\u0448\u043d\u0435\u0435?</p>"},{"location":"recommendation/discovery_algorithm/#the-preview","title":"\u041d\u0430\u0433\u043b\u044f\u0434\u043d\u043e\u0441\u0442\u044c (The Preview)","text":"<p>\u0413\u0438\u043f\u043e\u0442\u0435\u0437\u0430 \u043d\u0438\u043a\u043e\u0433\u0434\u0430 \u043d\u0435 \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0433\u043e\u043b\u043e\u0439. \u041e\u043d\u0430 \u0432\u0441\u0435\u0433\u0434\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 2\u20133 \u0440\u0435\u0430\u043b\u044c\u043d\u044b\u0445 \u0442\u043e\u0432\u0430\u0440\u0430 \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u043f\u0440\u0438\u043c\u0435\u0440\u0430. \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0433\u043e\u043b\u043e\u0441\u0443\u0435\u0442 \u0437\u0430 \u00ab\u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0432\u043e\u043f\u043b\u043e\u0449\u0435\u043d\u0438\u0435\u00bb \u0438\u0434\u0435\u0438.</p>"},{"location":"recommendation/discovery_algorithm/#4-3-dead-end-detection","title":"4. \u042d\u0442\u0430\u043f 3: \u0414\u0435\u0442\u0435\u043a\u0446\u0438\u044f \u0422\u0443\u043f\u0438\u043a\u0430 (Dead-End Detection)","text":"<p>\u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0434\u043e\u043b\u0436\u043d\u0430 \u0432\u043e\u0432\u0440\u0435\u043c\u044f \u043f\u043e\u043d\u044f\u0442\u044c, \u0447\u0442\u043e \u043e\u043d\u0430 \u00ab\u043a\u0440\u0443\u0442\u0438\u0442\u0441\u044f \u043d\u0435 \u0442\u0430\u043c\u00bb \u0438 \u0440\u0430\u0437\u0434\u0440\u0430\u0436\u0430\u0435\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f.</p> <p>\u041a\u0440\u0438\u0442\u0435\u0440\u0438\u0438 \u0422\u0443\u043f\u0438\u043a\u0430: *   Cold Scroll: \u041f\u0440\u043e\u043b\u0438\u0441\u0442\u0430\u043d\u043e &gt; 3 \u0433\u0438\u043f\u043e\u0442\u0435\u0437 \u0438\u043b\u0438 &gt; 15 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0431\u0435\u0437 \u043a\u043b\u0438\u043a\u043e\u0432/\u043b\u0430\u0439\u043a\u043e\u0432. *   Decision Paralysis: \u0412\u0440\u0435\u043c\u044f \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438 \u0432 2 \u0440\u0430\u0437\u0430 \u0432\u044b\u0448\u0435 \u0441\u0440\u0435\u0434\u043d\u0435\u0433\u043e, \u043d\u043e \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 \u043d\u0435\u0442. *   Low Relevancy: \u0421\u0443\u043c\u043c\u0430\u0440\u043d\u044b\u0439 \u0432\u0435\u043a\u0442\u043e\u0440\u0442\u043d\u044b\u0439 \u0441\u043a\u043e\u0440 \u0432\u044b\u0434\u0430\u0447\u0438 \u043f\u0430\u0434\u0430\u0435\u0442 (\u043c\u044b \u043d\u0430\u0447\u0430\u043b\u0438 \u043f\u0440\u0435\u0434\u043b\u0430\u0433\u0430\u0442\u044c \u00ab\u043c\u0443\u0441\u043e\u0440\u00bb).</p>"},{"location":"recommendation/discovery_algorithm/#5-4-the-pivot","title":"5. \u042d\u0442\u0430\u043f 4: \u0412\u044b\u0445\u043e\u0434 \u0438\u0437 \u0442\u0443\u043f\u0438\u043a\u0430 (The Pivot)","text":"<p>\u041a\u043e\u0433\u0434\u0430 \u0442\u0443\u043f\u0438\u043a \u0437\u0430\u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d, \u043b\u0435\u043d\u0442\u0430 \u043f\u0440\u0435\u0440\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0421\u043f\u0430\u0441-\u043a\u0430\u0440\u0442\u043e\u0439. \u041c\u044b \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0430\u0435\u043c \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u043d\u0430 \u0438\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u043c\u044b\u0441\u043b\u043e\u0432.</p>"},{"location":"recommendation/discovery_algorithm/#topic-pivot","title":"\u0422\u0438\u043f \u0410: \u041f\u043e\u0438\u0441\u043a \u041d\u043e\u0432\u043e\u0433\u043e \u0421\u0435\u043c\u0435\u043d\u0438 (Topic Pivot)","text":"<p>\u0415\u0441\u043b\u0438 \u0442\u0435\u043c\u0430 \u00ab\u0421\u043f\u043e\u0440\u0442\u00bb \u043d\u0435 \u0437\u0430\u0448\u043b\u0430, \u043c\u044b \u0438\u0449\u0435\u043c \u0441\u043e\u0432\u0435\u0440\u0448\u0435\u043d\u043d\u043e \u0434\u0440\u0443\u0433\u043e\u0439 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442. *   \u0417\u043e\u043d\u0434: \u00ab\u0412\u0438\u0436\u0443, \u0441\u043e \u0441\u043f\u043e\u0440\u0442\u043e\u043c \u043d\u0435 \u0438\u0434\u0435\u0442. \u0414\u0430\u0432\u0430\u0439 \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0435\u043c \u0438\u043d\u0430\u0447\u0435: \u0427\u0442\u043e \u043e\u043d(\u0430) \u043d\u0435\u043d\u0430\u0432\u0438\u0434\u0438\u0442 \u0434\u0435\u043b\u0430\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 \u0432\u0441\u0435\u0433\u043e?\u00bb (\u041f\u043e\u0438\u0441\u043a \u0431\u043e\u043b\u0438 \u0432\u043d\u0435 \u0445\u043e\u0431\u0431\u0438).</p>"},{"location":"recommendation/discovery_algorithm/#gutg-pivot","title":"\u0422\u0438\u043f \u0411: \u041f\u043e\u0438\u0441\u043a \u041d\u0443\u0436\u0434\u044b (GUTG Pivot)","text":"<p>\u0415\u0441\u043b\u0438 \u043c\u044b \u043d\u0435 \u043f\u043e\u043d\u0438\u043c\u0430\u0435\u043c \u0437\u0430\u0447\u0435\u043c \u0434\u0430\u0440\u0438\u0442\u044c, \u043c\u044b \u0441\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0435\u043c \u043e\u0431 \u044d\u043c\u043e\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u043e\u043c \u0434\u0435\u0444\u0438\u0446\u0438\u0442\u0435. *   \u0417\u043e\u043d\u0434: \u00ab\u0417\u0430\u0431\u0443\u0434\u0435\u043c \u043f\u0440\u043e \u0432\u0435\u0449\u0438. \u0427\u0442\u043e \u0435\u043c\u0443 \u0441\u0435\u0439\u0447\u0430\u0441 \u043d\u0443\u0436\u043d\u0435\u0435: \u0432\u0437\u0431\u043e\u0434\u0440\u0438\u0442\u044c\u0441\u044f \u0438 \u043d\u0430\u0447\u0430\u0442\u044c \u0447\u0442\u043e-\u0442\u043e \u043d\u043e\u0432\u043e\u0435 \u0438\u043b\u0438 \u0447\u0442\u043e\u0431\u044b \u0435\u0433\u043e \u043f\u0440\u043e\u0441\u0442\u043e \u043e\u0441\u0442\u0430\u0432\u0438\u043b\u0438 \u0432 \u043f\u043e\u043a\u043e\u0435 \u0438 \u0434\u0430\u043b\u0438 \u043e\u0442\u0434\u043e\u0445\u043d\u0443\u0442\u044c?\u00bb     *   \u0412\u0437\u0431\u043e\u0434\u0440\u0438\u0442\u044c\u0441\u044f -&gt; \u0411\u0443\u0441\u0442\u0438\u043c Catalyst \u0432\u043e \u0432\u0441\u0435\u0445 \u0442\u0435\u043c\u0430\u0445.     *   \u041e\u0442\u0434\u043e\u0445\u043d\u0443\u0442\u044c -&gt; \u0411\u0443\u0441\u0442\u0438\u043c Permission/Optimizer.</p>"},{"location":"recommendation/discovery_algorithm/#6","title":"6. \u041c\u0435\u0445\u0430\u043d\u0438\u043a\u0430 \u0424\u0438\u0434\u0431\u044d\u043a\u0430","text":"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0421\u0438\u0433\u043d\u0430\u043b \u0434\u043b\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0422\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0441\u043b\u0435\u0434\u0441\u0442\u0432\u0438\u0435 \u041a\u043b\u0438\u043a \u043d\u0430 \u0418\u0434\u0435\u044e \u00ab\u0412\u0435\u043a\u0442\u043e\u0440 \u0432\u0435\u0440\u043d\u044b\u0439\u00bb \u0421\u043a\u0440\u044b\u0432\u0430\u0435\u043c \u0434\u0440\u0443\u0433\u0438\u0435 \u0433\u0438\u043f\u043e\u0442\u0435\u0437\u044b, \u043d\u0430\u043f\u043e\u043b\u043d\u044f\u0435\u043c \u043b\u0435\u043d\u0442\u0443 \u0442\u043e\u0432\u0430\u0440\u0430\u043c\u0438 \u044d\u0442\u043e\u0439 \u0432\u0435\u0442\u043a\u0438. \u041b\u0430\u0439\u043a \u0442\u043e\u0432\u0430\u0440\u0430 \u00ab\u0421\u0442\u0438\u043b\u044c/\u0421\u043f\u0435\u0446\u0438\u0444\u0438\u043a\u0430 \u0432\u0435\u0440\u043d\u0430\u044f\u00bb \u041a\u043e\u0440\u0440\u0435\u043a\u0442\u0438\u0440\u0443\u0435\u043c \u0432\u0438\u0437\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u0444\u0438\u043b\u044c\u0442\u0440 (\u0446\u0435\u043d\u0442\u0440\u043e\u0438\u0434 \u044d\u043c\u0431\u0435\u0434\u0434\u0438\u043d\u0433\u043e\u0432). \u0414\u0438\u0437\u043b\u0430\u0439\u043a \u043a\u043e\u043d\u0446\u0435\u043f\u0442\u0430 \u00ab\u042d\u0442\u0430 \u0434\u044b\u0440\u0430 \u043d\u0435 \u0431\u043e\u043b\u0438\u0442\u00bb \u041f\u043e\u043d\u0438\u0436\u0430\u0435\u043c \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442 \u0434\u0430\u043d\u043d\u043e\u0439 \u043e\u0441\u0438 GUTG \u0434\u043b\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0442\u043e\u043f\u0438\u043a\u0430. \u041e\u0442\u0432\u0435\u0442 \u043d\u0430 \u0417\u043e\u043d\u0434 \u00ab\u0423\u0442\u043e\u0447\u043d\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430\u00bb \u041c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u0430\u044f \u043f\u0435\u0440\u0435\u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u043f\u043e\u0438\u0441\u043a\u043e\u0432\u044b\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0432 \u0444\u043e\u043d\u0435."},{"location":"recommendation/discovery_algorithm/#7","title":"7. \u0424\u0438\u043d\u0430\u043b: \u0421\u0438\u043d\u0442\u0435\u0437 \u0432 \u0428\u043e\u0440\u0442\u043b\u0438\u0441\u0442","text":"<p>\u041a\u043e\u0433\u0434\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0430\u0445\u043e\u0434\u0438\u0442 \u00ab\u0441\u0432\u043e\u0451\u00bb, \u043e\u043d \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u044d\u0442\u043e \u0432 \u0428\u043e\u0440\u0442\u043b\u0438\u0441\u0442. \u0428\u043e\u0440\u0442\u043b\u0438\u0441\u0442 \u2014 \u044d\u0442\u043e \u0444\u0438\u043d\u0430\u043b\u044c\u043d\u0430\u044f \u0442\u043e\u0447\u043a\u0430 \u0438\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u043d\u0438\u044f, \u0433\u0434\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u043c\u043e\u0436\u0435\u0442 \u0434\u0430\u0442\u044c \u00ab\u041e\u0431\u043e\u0441\u043d\u043e\u0432\u0430\u043d\u0438\u0435\u00bb:  \u00ab\u041c\u044b \u0432\u044b\u0431\u0440\u0430\u043b\u0438 \u044d\u0442\u043e\u0442 \u043f\u043e\u0434\u0430\u0440\u043e\u043a, \u043f\u043e\u0442\u043e\u043c\u0443 \u0447\u0442\u043e \u043e\u043d \u0437\u0430\u043a\u0440\u044b\u0432\u0430\u0435\u0442 \u0435\u0433\u043e \u043f\u043e\u0442\u0440\u0435\u0431\u043d\u043e\u0441\u0442\u044c \u0432 [GUTG-\u0433\u044d\u043f], \u0432\u044b\u044f\u0432\u043b\u0435\u043d\u043d\u0443\u044e \u0432 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435 \u043d\u0430\u0448\u0435\u0433\u043e \u0434\u0438\u0430\u043b\u043e\u0433\u0430\u00bb.</p>"},{"location":"recommendation/discovery_v2_deep_dive/","title":"Discovery &amp; Recommendation Engine (v2)","text":"<p>This document provides a technical overview of the \"Dialogue-driven Discovery\" system, which powers the Gifty recommendation engine.</p>"},{"location":"recommendation/discovery_v2_deep_dive/#1-high-level-architecture","title":"1. High-Level Architecture","text":"<p>The system transitions from a static \"quiz-to-list\" model to an interactive \"discovery dialogue.\"</p> graph TD     User([User]) --&gt;|Quiz Snippet| API[FastAPI /recommendations/init]     API --&gt; DM[DialogueManager]      subgraph Discovery Loop     DM --&gt;|Raw Quiz Data| AS[AnthropicService]     AS --&gt;|Psychological Diagnostic| Claude(Claude 3 Haiku)     Claude --&gt;|Gift Hypotheses| DM      DM --&gt;|Search Queries| RS[RecommendationService]     RS --&gt;|Vector Search| DB[(PostgreSQL + pgvector)]     DB --&gt;|Candidates| RS     RS --&gt;|Preview Products| DM     end      DM --&gt;|Discovery Session| User      User --&gt;|Interaction/Reaction| InteractAPI[FastAPI /recommendations/interact]     InteractAPI --&gt; DM     DM --&gt;|Persistence| RecS[RecipientService]     RecS --&gt;|Store Hypotheses| DB"},{"location":"recommendation/discovery_v2_deep_dive/#2-core-components","title":"2. Core Components","text":""},{"location":"recommendation/discovery_v2_deep_dive/#dialoguemanager-the-orchestrator","title":"<code>DialogueManager</code> (The Orchestrator)","text":"<p>The central brain of the discovery flow. It manages:</p> <ul> <li>Session Lifecycle: <code>init_session</code> creates the state and triggers initial analysis.</li> <li>State Management: Orchestrates transitions between <code>QUIZ</code>, <code>OVERVIEW</code>, <code>DEEP_DIVE</code>, and <code>COMPILATION</code>.</li> <li>Parallelism: Runs multiple \"Topic Tracks\" in parallel to provide diverse gift directions.</li> </ul>"},{"location":"recommendation/discovery_v2_deep_dive/#anthropicservice-the-intelligence","title":"<code>AnthropicService</code> (The Intelligence)","text":"<p>The bridge between our business logic and LLM capabilities.</p> <ul> <li>AI-Native Diagnostic: Instead of hardcoded rules, it passes raw Quiz Data to Claude.</li> <li>Hypothesis Generation: Uses the Psychological Gifting Model to craft specific psychological \"Gaps\" (Mirror, Anchor, Optimizer, etc.).</li> <li>Search Query Synthesis: Generates 3-5 specific keywords for the vector search engine.</li> </ul>"},{"location":"recommendation/discovery_v2_deep_dive/#recommendationservice-the-retriever","title":"<code>RecommendationService</code> (The Retriever)","text":"<p>Interacts with the product catalog using semantic search.</p> <ul> <li>Vector Retrieval: Uses <code>pgvector</code> to find products matching the AI-generated queries.</li> <li>Reranking: (In Deep Dive) Uses cross-encoders to ensure the closest possible match to the hypothesis description.</li> <li>Lazy Loading: Supports fetching products on-demand when a user expands a specific hypothesis.</li> </ul>"},{"location":"recommendation/discovery_v2_deep_dive/#recipientservice-the-persistence","title":"<code>RecipientService</code> (The Persistence)","text":"<p>Handles long-term storage and analytical data.</p> <ul> <li>Profile Management: Stores recipient data (age, gender, relationships).</li> <li>Hypothesis Analytics: Saves every generated hypothesis and user reactions (likes/dislikes) for future model fine-tuning.</li> </ul>"},{"location":"recommendation/discovery_v2_deep_dive/#3-the-discovery-loop-flow","title":"3. The Discovery Loop Flow","text":"<ol> <li>Initialization: User submits a quiz. <code>DialogueManager</code> creates a <code>RecipientProfile</code> and <code>RecommendationSession</code>.</li> <li>Analysis: <code>AnthropicService</code> analyzes raw data and picks 3 main interest topics.</li> <li>Drafting (Bulk): Claude generates 2-3 hypotheses for each topic in a single bulk call.</li> <li>Retrieval: <code>RecommendationService</code> fetches 3 preview products for each hypothesis.</li> <li>Presentation: User sees \"Topic Tracks\" with catchy titles and ideas.</li> <li>Deep Dive: When a user \"likes\" an idea, the system fetches 15+ highly relevant products for that specific hypothesis.</li> </ol>"},{"location":"recommendation/discovery_v2_deep_dive/#4-why-this-matters","title":"4. Why This Matters","text":"<ul> <li>Psychological Depth: We don't just match keywords; we fulfill needs (e.g., \"Permission to indulge\").</li> <li>Low Latency: Bulk LLM calls and parallel retrieval keep the experience snappy.</li> <li>Scalability: New gifting gaps or logic changes are implemented via prompt engineering, not complex code refactors.</li> <li>Learning: Database persistence of user reactions allows us to build a dataset for training custom rankers.</li> </ul>"},{"location":"recommendation/engine/","title":"Gifty Recommendation Engine: The Semantic Bridge (\u0421\u0435\u043c\u0430\u043d\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u041c\u043e\u0441\u0442)","text":"<p>\u0424\u0438\u043b\u043e\u0441\u043e\u0444\u0441\u043a\u043e\u0435 \u044f\u0434\u0440\u043e: \u041c\u044b \u043d\u0435 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u043c \u0442\u043e\u0432\u0430\u0440\u044b. \u041c\u044b \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u043c \u0441\u043c\u044b\u0441\u043b\u044b, \u0443\u043f\u0430\u043a\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0432 \u0442\u043e\u0432\u0430\u0440\u044b.</p> <p>\u042d\u0442\u043e\u0442 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442 \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0443 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439 Gifty. \u0412 \u043e\u0442\u043b\u0438\u0447\u0438\u0435 \u043e\u0442 \u0442\u0440\u0430\u0434\u0438\u0446\u0438\u043e\u043d\u043d\u044b\u0445 \u0441\u0438\u0441\u0442\u0435\u043c \u043a\u043e\u043b\u043b\u0430\u0431\u043e\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 (\u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0441\u043e\u043f\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u044e\u0442 User-to-Item), Gifty \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0443 \u0421\u0435\u043c\u0430\u043d\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u041c\u043e\u0441\u0442\u0430 (User -&gt; Psychology -&gt; Concept -&gt; Item).</p>"},{"location":"recommendation/engine/#1","title":"1. \u0412\u044b\u0441\u043e\u043a\u043e\u0443\u0440\u043e\u0432\u043d\u0435\u0432\u0430\u044f \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430","text":"<p>\u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0441\u043e\u0441\u0442\u043e\u0438\u0442 \u0438\u0437 \u0442\u0440\u0435\u0445 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0445 \u0441\u043b\u043e\u0435\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u044e\u0442 \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u043e\u0435 \u043d\u0430\u043c\u0435\u0440\u0435\u043d\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0432 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0435 \u0442\u043e\u0432\u0430\u0440\u044b, \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0434\u043b\u044f \u043f\u043e\u043a\u0443\u043f\u043a\u0438.</p> graph TD     User[\"\u0412\u0432\u043e\u0434 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\"] --&gt;|\u041a\u0432\u0438\u0437 + \u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442| Profiler      subgraph \"\u0421\u043b\u043e\u0439 1: \u041f\u0440\u043e\u0444\u0430\u0439\u043b\u0435\u0440 (The Profiler)\"         Profiler[\"\u041f\u0441\u0438\u0445\u043e\u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u041f\u0440\u043e\u0444\u0430\u0439\u043b\u0435\u0440\"] --&gt;|\u0412\u0435\u043a\u0442\u043e\u0440\u044b GUTG| ProfileState[\"\u0421\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u041f\u0440\u043e\u0444\u0438\u043b\u044f\"]         Meta[\"\u041c\u0435\u0442\u0430-\u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\"] --&gt;|\"\u0424\u0438\u043b\u044c\u0442\u0440\u044b: \u0423\u0441\u0438\u043b\u0438\u044f, \u0412\u0440\u0435\u043c\u044f, \u0426\u0435\u043b\u044c\"| ProfileState     end      subgraph \"\u0421\u043b\u043e\u0439 2: \u0414\u0432\u0438\u0436\u043e\u043a \u041a\u043e\u043d\u0446\u0435\u043f\u0442\u043e\u0432 (The Concept Engine)\"         ProfileState --&gt;|\u0422\u043e\u043f Gaps| DHG[\"\u0414\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0413\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440 \u0413\u0438\u043f\u043e\u0442\u0435\u0437 (LLM)\"]         DHG --&gt;|\u0413\u0435\u043d\u0435\u0440\u0438\u0440\u0443\u0435\u0442| Cloud[\"\u041e\u0431\u043b\u0430\u043a\u0430 \u0413\u0438\u043f\u043e\u0442\u0435\u0437\"]         Cloud --&gt;|\u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f| Portfolio[\"\u041f\u043e\u0440\u0442\u0444\u0435\u043b\u044c\u043d\u044b\u0439 \u041c\u0435\u043d\u0435\u0434\u0436\u0435\u0440\"]     end      subgraph \"\u0421\u043b\u043e\u0439 3: \u0417\u0430\u043a\u0443\u043f\u0449\u0438\u043a (The Procurer)\"         Portfolio --&gt;|\u041f\u043e\u0438\u0441\u043a\u043e\u0432\u044b\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b| VectorDB[(\"PgVector Product DB\")]         VectorDB --&gt;|\u041d\u0430\u0445\u043e\u0434\u0438\u0442| Candidates         Candidates --&gt;|\u0420\u0430\u043d\u0436\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435| Scorer     end      Scorer --&gt;|\u0412\u044b\u0434\u0430\u0447\u0430| Feed[\"Smart Feed UI\"]     Feed --&gt;|\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f| ActiveLearning[\"Active Learning Loop\"]     ActiveLearning --&gt;|\u041e\u0431\u0440\u0430\u0442\u043d\u0430\u044f \u0441\u0432\u044f\u0437\u044c| Profiler"},{"location":"recommendation/engine/#2-1","title":"2. \u0421\u043b\u043e\u0439 1: \u041f\u0440\u043e\u0444\u0430\u0439\u043b\u0435\u0440 (\u0410\u043d\u0430\u043b\u0438\u0437 \u0432\u0432\u043e\u0434\u0430)","text":"<p>\u0426\u0435\u043b\u044c: \u041f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u0442\u044c \u0441\u044b\u0440\u043e\u0439 \u0432\u0432\u043e\u0434 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0432 \u0412\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u043d\u044b\u0439 \u041f\u0440\u043e\u0444\u0438\u043b\u044c.</p> <p>\u041f\u0440\u043e\u0444\u0430\u0439\u043b\u0435\u0440 \u043d\u0435 \u0438\u0449\u0435\u0442 \u043a\u043b\u044e\u0447\u0435\u0432\u044b\u0435 \u0441\u043b\u043e\u0432\u0430 \u0432\u0440\u043e\u0434\u0435 \"\u0433\u0438\u0442\u0430\u0440\u0430\". \u041e\u043d \u0438\u0449\u0435\u0442 \u043f\u0441\u0438\u0445\u043e\u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0432\u0435\u043a\u0442\u043e\u0440\u044b.</p>"},{"location":"recommendation/engine/#21-gutg","title":"2.1. \u0412\u0435\u043a\u0442\u043e\u0440 GUTG","text":"<p>\u041d\u0430\u043c\u0435\u0440\u0435\u043d\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043c\u0430\u043f\u0438\u0442\u0441\u044f \u043d\u0430 5 \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u0439 \"Grand Unified Theory of Gifting\". *   \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442: \u0420\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u0435\u0439, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 <code>{Mirror: 0.6, Optimizer: 0.3, Catalyst: 0.1, Anchor: 0.0, Permission: 0.0}</code>.</p>"},{"location":"recommendation/engine/#22-","title":"2.2. \u041c\u0435\u0442\u0430-\u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442","text":"<p>\u0412\u043e\u043f\u0440\u043e\u0441\u044b \u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435 \u0434\u0430\u0440\u0435\u043d\u0438\u044f, \u0430 \u043d\u0435 \u043e \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u0435. \u041e\u043d\u0438 \u0434\u0435\u0439\u0441\u0442\u0432\u0443\u044e\u0442 \u043a\u0430\u043a \u0416\u0435\u0441\u0442\u043a\u0438\u0435 \u0424\u0438\u043b\u044c\u0442\u0440\u044b \u0438 \u041c\u043d\u043e\u0436\u0438\u0442\u0435\u043b\u0438 \u0420\u0430\u043d\u0436\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f.</p> \u041f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0430\u044f \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430 \u041e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0412\u043b\u0438\u044f\u043d\u0438\u0435 \u043d\u0430 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0443 Relationship (\u041e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f) \u041a\u0442\u043e \u044d\u0442\u043e? (\u041f\u0430\u0440\u0442\u043d\u0435\u0440, \u0411\u043e\u0441\u0441) \u0412\u0435\u0441\u0430: \"\u0411\u043e\u0441\u0441\" \u0443\u0431\u0438\u0432\u0430\u0435\u0442 Anchor (\u0441\u043b\u0438\u0448\u043a\u043e\u043c \u0438\u043d\u0442\u0438\u043c\u043d\u043e), \u0431\u0443\u0441\u0442\u0438\u0442 Optimizer. Effort Level (\u0423\u0440\u043e\u0432\u0435\u043d\u044c \u0443\u0441\u0438\u043b\u0438\u0439) \u0421\u0432\u043e\u0438\u043c\u0438 \u0440\u0443\u043a\u0430\u043c\u0438 vs \"\u041a\u0443\u043f\u0438\u0442\u044c \u0441\u0435\u0439\u0447\u0430\u0441\" \u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f: \"\u041d\u0438\u0437\u043a\u0438\u0435 \u0443\u0441\u0438\u043b\u0438\u044f\" \u0441\u043a\u0440\u044b\u0432\u0430\u044e\u0442 \u0441\u043b\u043e\u0436\u043d\u044b\u0435 DIY \u043d\u0430\u0431\u043e\u0440\u044b \u0438\u0437 Catalyst. Gifting Goal (\u0426\u0435\u043b\u044c \u043f\u043e\u0434\u0430\u0440\u043a\u0430) \u0412\u043f\u0435\u0447\u0430\u0442\u043b\u0438\u0442\u044c vs \u0417\u0430\u0431\u043e\u0442\u0430 vs \u041f\u0440\u043e\u0442\u043e\u043a\u043e\u043b \u0411\u0443\u0441\u0442\u0438\u043d\u0433: \"\u0412\u043f\u0435\u0447\u0430\u0442\u043b\u0438\u0442\u044c\" \u0431\u0443\u0441\u0442\u0438\u0442 Mirror/Permission. \"\u0417\u0430\u0431\u043e\u0442\u0430\" \u0431\u0443\u0441\u0442\u0438\u0442 Optimizer. Session Mode (\u0420\u0435\u0436\u0438\u043c \u0441\u0435\u0441\u0441\u0438\u0438) \u0411\u044b\u0441\u0442\u0440\u043e\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u0435 vs \u0413\u043b\u0443\u0431\u043e\u043a\u0438\u0439 \u043f\u043e\u0438\u0441\u043a \u041f\u0440\u043e\u0446\u0435\u0441\u0441: \"\u0411\u044b\u0441\u0442\u0440\u043e\" \u043f\u0440\u043e\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u0433\u043b\u0443\u0431\u043e\u043a\u0438\u0435 \u0443\u0442\u043e\u0447\u043d\u0435\u043d\u0438\u044f, \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u043d\u0430\u0434\u0435\u0436\u043d\u044b\u0435 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b (Safe Bets). Timeline (\u0421\u0440\u043e\u043a\u0438) \u0417\u0430\u0432\u0442\u0440\u0430 vs \u041c\u0435\u0441\u044f\u0446 \u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f: \"\u0417\u0430\u0432\u0442\u0440\u0430\" \u0441\u043a\u0440\u044b\u0432\u0430\u0435\u0442 \u0442\u043e\u0432\u0430\u0440\u044b \u0441 \u0434\u043e\u043b\u0433\u043e\u0439 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u043e\u0439/\u043a\u0430\u0441\u0442\u043e\u043c\u0438\u0437\u0430\u0446\u0438\u0435\u0439."},{"location":"recommendation/engine/#3-2","title":"3. \u0421\u043b\u043e\u0439 2: \u0414\u0432\u0438\u0436\u043e\u043a \u041a\u043e\u043d\u0446\u0435\u043f\u0442\u043e\u0432 (\u041c\u043e\u0437\u0433 \u0441\u0438\u0441\u0442\u0435\u043c\u044b)","text":"<p>\u0426\u0435\u043b\u044c: \u0413\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \"\u041e\u0431\u043b\u0430\u043a\u0430 \u0413\u0438\u043f\u043e\u0442\u0435\u0437\" \u2014 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u044b \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0445 \u0438\u0434\u0435\u0439, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0441\u043b\u0443\u0436\u0430\u0442 \u043c\u043e\u0441\u0442\u043e\u043c \u043c\u0435\u0436\u0434\u0443 \u043f\u0441\u0438\u0445\u043e\u043b\u043e\u0433\u0438\u0435\u0439 \u0438 \u0442\u043e\u0432\u0430\u0440\u0430\u043c\u0438.</p>"},{"location":"recommendation/engine/#31-dhg","title":"3.1. \u0414\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0413\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u0413\u0438\u043f\u043e\u0442\u0435\u0437 (DHG)","text":"<p>\u041c\u044b \u043d\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c \u0441\u0442\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0434\u0435\u0440\u0435\u0432\u043e \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439. \u041c\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c LLM \u0438\u043b\u0438 \u043a\u044d\u0448\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u044b \u0434\u043b\u044f \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 \u0433\u0438\u043f\u043e\u0442\u0435\u0437 \u043d\u0430 \u043b\u0435\u0442\u0443.</p> <p>\u041f\u0440\u0438\u043c\u0435\u0440 \u043f\u043e\u0442\u043e\u043a\u0430:</p> <ol> <li>\u0412\u0432\u043e\u0434: \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0433\u043e\u0432\u043e\u0440\u0438\u0442 \"\u041b\u044e\u0431\u0438\u0442 \u0413\u0438\u0442\u0430\u0440\u0443\".</li> <li>\u042d\u043a\u0441\u043f\u0430\u043d\u0441\u0438\u044f DHG: \u0414\u0432\u0438\u0436\u043e\u043a \u043d\u0435 \u043f\u0440\u043e\u0441\u0442\u043e \u0438\u0449\u0435\u0442 \"\u0433\u0438\u0442\u0430\u0440\u0430\". \u041e\u043d \u0440\u0430\u0441\u0449\u0435\u043f\u043b\u044f\u0435\u0442 \u043a\u043e\u043d\u0446\u0435\u043f\u0442 \u043f\u043e \u043e\u0441\u044f\u043c GUTG:<ul> <li>\u0413\u0438\u043f\u043e\u0442\u0435\u0437\u0430 A (Catalyst): \"\u041d\u0430\u0447\u0438\u043d\u0430\u044e\u0449\u0430\u044f \u0440\u043e\u043a-\u0437\u0432\u0435\u0437\u0434\u0430\" (\u041d\u0443\u0436\u043d\u043e: \u041e\u0431\u0443\u0447\u0430\u044e\u0449\u0438\u0435 \u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u044b, \u0441\u0442\u0430\u0440\u0442\u043e\u0432\u044b\u0435 \u043d\u0430\u0431\u043e\u0440\u044b).</li> <li>\u0413\u0438\u043f\u043e\u0442\u0435\u0437\u0430 B (Optimizer): \"\u0413\u0438\u043a \u0437\u0432\u0443\u043a\u0430\" (\u041d\u0443\u0436\u043d\u043e: \u0414\u043e\u0440\u043e\u0433\u0438\u0435 \u0441\u0442\u0440\u0443\u043d\u044b, \u0443\u0445\u043e\u0434 \u0437\u0430 \u043f\u0435\u0434\u0430\u043b\u0431\u043e\u0440\u0434\u043e\u043c, \u043d\u0430\u0431\u043e\u0440\u044b \u0434\u043b\u044f \u0447\u0438\u0441\u0442\u043a\u0438).</li> <li>\u0413\u0438\u043f\u043e\u0442\u0435\u0437\u0430 C (Mirror): \"\u0424\u0430\u043d\u0430\u0442\" (\u041d\u0443\u0436\u043d\u043e: \u0411\u0438\u043e\u0433\u0440\u0430\u0444\u0438\u0438, \u0432\u0438\u043d\u0438\u043b, \u043c\u0435\u0440\u0447 \u0433\u0440\u0443\u043f\u043f).</li> </ul> </li> <li>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442: \u0422\u0435\u043f\u0435\u0440\u044c \u0443 \u043d\u0430\u0441 \u0435\u0441\u0442\u044c 3 \u043e\u0442\u043b\u0438\u0447\u043d\u044b\u0445 \"\u041e\u0431\u043b\u0430\u043a\u0430\" \u043f\u043e\u0438\u0441\u043a\u043e\u0432\u044b\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432.</li> </ol>"},{"location":"recommendation/engine/#32","title":"3.2. \u041f\u043e\u0440\u0442\u0444\u0435\u043b\u044c \u0413\u0438\u043f\u043e\u0442\u0435\u0437 (\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044f \u0421\u043b\u043e\u0442\u0442\u0438\u043d\u0433\u0430)","text":"<p>\u041c\u044b \u043d\u0438\u043a\u043e\u0433\u0434\u0430 \u043d\u0435 \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u043c \u043e\u0434\u043d\u043e\u0440\u043e\u0434\u043d\u0443\u044e \u043b\u0435\u043d\u0442\u0443. \u041c\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u041f\u043e\u0440\u0442\u0444\u0435\u043b\u044c\u043d\u0443\u044e \u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044e \u0434\u043b\u044f \u0431\u0430\u043b\u0430\u043d\u0441\u0430 \u043c\u0435\u0436\u0434\u0443 \u0418\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u043d\u0438\u0435\u043c (Exploration) \u0438 \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c (Exploitation). \u041b\u0435\u043d\u0442\u0430 \u0441\u0442\u0440\u043e\u0438\u0442\u0441\u044f \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u0421\u043b\u043e\u0442\u043e\u0432.</p> <p>\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c \u0421\u043b\u043e\u0442\u0442\u0438\u043d\u0433\u0430:</p> <ul> <li>\u0421\u043b\u043e\u0442 1: \u041d\u0430\u0434\u0435\u0436\u043d\u0430\u044f \u0441\u0442\u0430\u0432\u043a\u0430 (High Confidence). \u041f\u0440\u044f\u043c\u043e\u0435 \u043f\u043e\u043f\u0430\u0434\u0430\u043d\u0438\u0435 \u0438\u0437 \u041f\u0440\u043e\u0444\u0430\u0439\u043b\u0435\u0440\u0430. (\u043d\u0430\u043f\u0440., Mirror: \u0424\u0430\u043d\u0430\u0442 \u0413\u0438\u0442\u0430\u0440\u044b).</li> <li>\u0421\u043b\u043e\u0442 2: \u042d\u043c\u043e\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u041f\u0438\u0432\u043e\u0442. \u0414\u0440\u0443\u0433\u043e\u0439 \u043f\u0441\u0438\u0445\u043e\u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0443\u0433\u043e\u043b. (\u043d\u0430\u043f\u0440., Anchor: \"\u0417\u0430\u0444\u0440\u0435\u0439\u043c\u0438\u0442\u044c \u0432\u0430\u0448\u0435 \u043b\u0443\u0447\u0448\u0435\u0435 \u0441\u043e\u0432\u043c\u0435\u0441\u0442\u043d\u043e\u0435 \u0444\u043e\u0442\u043e\").</li> <li>\u0421\u043b\u043e\u0442 3: \u041f\u0440\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u0435. \u0427\u0438\u0441\u0442\u0430\u044f \u043f\u043e\u043b\u044c\u0437\u0430. (\u043d\u0430\u043f\u0440., Optimizer: \"\u0410\u043f\u0433\u0440\u0435\u0439\u0434 \u0435\u0433\u043e \u0443\u0442\u0440\u0435\u043d\u043d\u0435\u0433\u043e \u043a\u043e\u0444\u0435\").</li> <li>\u0421\u043b\u043e\u0442 4: \u0414\u0436\u043e\u043a\u0435\u0440 (Wildcard). \u0421\u043b\u0443\u0447\u0430\u0439\u043d\u0430\u044f \u0434\u043e\u0433\u0430\u0434\u043a\u0430 \u0441 \u0432\u044b\u0441\u043e\u043a\u043e\u0439 \u044d\u043d\u0442\u0440\u043e\u043f\u0438\u0435\u0439 \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u043d\u043e\u0432\u043e\u0433\u043e \u0432\u0435\u043a\u0442\u043e\u0440\u0430. (\u043d\u0430\u043f\u0440., Permission: \"\u041c\u0430\u0441\u0441\u0430\u0436\u043d\u044b\u0439 \u043f\u0438\u0441\u0442\u043e\u043b\u0435\u0442\").</li> </ul>"},{"location":"recommendation/engine/#4-3","title":"4. \u0421\u043b\u043e\u0439 3: \u0417\u0430\u043a\u0443\u043f\u0449\u0438\u043a (\u0418\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435)","text":"<p>\u0426\u0435\u043b\u044c: \u041d\u0430\u0439\u0442\u0438 \u043b\u0443\u0447\u0448\u0435\u0435 \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0434\u043e\u043a\u0430\u0437\u0430\u0442\u0435\u043b\u044c\u0441\u0442\u0432\u043e (\u0422\u043e\u0432\u0430\u0440) \u0434\u043b\u044f \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u043e\u0439 \u0418\u0434\u0435\u0438.</p> <ol> <li>\u0412\u0432\u043e\u0434: \u041a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u0430\u044f \u0418\u0434\u0435\u044f \u041f\u043e\u0434\u0430\u0440\u043a\u0430 (\u043d\u0430\u043f\u0440., \"\u041d\u0430\u0431\u043e\u0440 \u0434\u043b\u044f \u0443\u0445\u043e\u0434\u0430 \u0437\u0430 \u0433\u0438\u0442\u0430\u0440\u043e\u0439\").</li> <li>\u041f\u043e\u0438\u0441\u043a\u043e\u0432\u044b\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b: <code>[\"guitar cleaning kit\", \"string winder\", \"fretboard oil\"]</code>.</li> <li>\u0412\u0435\u043a\u0442\u043e\u0440\u043d\u044b\u0439 \u041f\u043e\u0438\u0441\u043a: \u0417\u0430\u043f\u0440\u043e\u0441 \u0432 \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u043e \u044d\u043c\u0431\u0435\u0434\u0434\u0438\u043d\u0433\u043e\u0432 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 <code>pgvector</code>.</li> <li>\u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f: \u041f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0411\u044e\u0434\u0436\u0435\u0442\u0430, \u041c\u0435\u0442\u0430-\u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430 (\u0423\u0441\u0438\u043b\u0438\u044f) \u0438 \u041d\u0435\u0433\u0430\u0442\u0438\u0432\u043d\u044b\u0445 \u041a\u043b\u044e\u0447\u0435\u0432\u044b\u0445 \u0441\u043b\u043e\u0432.</li> <li>\u0412\u044b\u0431\u043e\u0440: \u0412\u044b\u0431\u043e\u0440 \"\u0422\u043e\u0432\u0430\u0440\u0430-\u0413\u0435\u0440\u043e\u044f\" + 2 \u0410\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u044b.</li> </ol>"},{"location":"recommendation/engine/#5-active-learning","title":"5. \u041f\u0440\u043e\u0442\u043e\u043a\u043e\u043b \u0418\u0437\u0432\u043b\u0435\u0447\u0435\u043d\u0438\u044f (Active Learning)","text":"<p>\u042d\u0442\u043e \"\u041c\u0435\u0442\u043e\u0434 \u0421\u043e\u043a\u0440\u0430\u0442\u0430\" \u0434\u0432\u0438\u0436\u043a\u0430. \u041e\u043d \u043f\u0440\u0435\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u0438\u0437 \u043f\u043e\u0438\u0441\u043a\u043e\u0432\u0438\u043a\u0430 \u0432 \u0438\u043d\u0442\u0435\u0440\u0432\u044c\u044e\u0435\u0440\u0430.</p>"},{"location":"recommendation/engine/#51-probes","title":"5.1. \u0421\u0438\u0441\u0442\u0435\u043c\u0430 \"\u0417\u043e\u043d\u0434\u043e\u0432\" (Probes)","text":"<p>\u0417\u043e\u043d\u0434 (Probe) \u2014 \u044d\u0442\u043e \u0432\u043e\u043f\u0440\u043e\u0441 \u0438\u043b\u0438 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435, \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u043d\u043e\u0435 \u0434\u043b\u044f \u043a\u043e\u043b\u043b\u0430\u043f\u0441\u0430 \u0432\u043e\u043b\u043d\u043e\u0432\u043e\u0439 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u043d\u0430\u043c\u0435\u0440\u0435\u043d\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f.</p> <p>\u0422\u0438\u043f\u044b \u0417\u043e\u043d\u0434\u043e\u0432:</p> <ol> <li>\u0411\u0438\u043d\u0430\u0440\u043d\u0430\u044f \u0420\u0430\u0437\u0432\u0438\u043b\u043a\u0430 (\u0412 \u043b\u0435\u043d\u0442\u0435):<ul> <li>\u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442: \u0423 \u043d\u0430\u0441 \u0435\u0441\u0442\u044c \"\u0413\u0438\u0442\u0430\u0440\u0430\", \u043d\u043e \u043c\u044b \u043d\u0435 \u0437\u043d\u0430\u0435\u043c \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u043d\u0430\u0432\u044b\u043a\u0430.</li> <li>\u0417\u043e\u043d\u0434: \"\u041e\u043d \u043d\u043e\u0432\u0438\u0447\u043e\u043a, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0443\u0447\u0438\u0442\u0441\u044f \u0438\u0433\u0440\u0430\u0442\u044c, \u0438\u043b\u0438 \u043f\u0440\u043e\u0444\u0438 \u0441 \u043a\u0443\u0447\u0435\u0439 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f?\"</li> <li>\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435: [\u041d\u043e\u0432\u0438\u0447\u043e\u043a] -&gt; \u0411\u0443\u0441\u0442 Catalyst. [\u041f\u0440\u043e\u0444\u0438] -&gt; \u0411\u0443\u0441\u0442 Optimizer.</li> </ul> </li> <li>\u041f\u0440\u043e\u0440\u044b\u0432\u0430\u0442\u0435\u043b\u044c \u0422\u0443\u043f\u0438\u043a\u0430 (Dead-End Breaker):<ul> <li>\u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442: \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043f\u0440\u043e\u043b\u0438\u0441\u0442\u0430\u043b 10 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0431\u0435\u0437 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f.</li> <li>\u0417\u043e\u043d\u0434: \"\u0414\u0430\u0432\u0430\u0439 \u0441\u043c\u0435\u043d\u0438\u043c \u0442\u0435\u043c\u0443. \u0427\u0442\u043e \u043e\u043d \u043d\u0435\u043d\u0430\u0432\u0438\u0434\u0438\u0442 \u0434\u0435\u043b\u0430\u0442\u044c? (\u0423\u0431\u043e\u0440\u043a\u0430, \u0413\u043e\u0442\u043e\u0432\u043a\u0430, \u0414\u043e\u0440\u043e\u0433\u0430?)\"</li> <li>\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435: \u0418\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u0438\u0441\u043a \u0434\u043b\u044f \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0439 \u0431\u043e\u043b\u0438.</li> </ul> </li> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0426\u0435\u043d\u043d\u043e\u0441\u0442\u0435\u0439:<ul> <li>\u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442: \u0412\u044b\u0431\u043e\u0440 \u043c\u0435\u0436\u0434\u0443 \u043f\u0440\u0430\u043a\u0442\u0438\u0447\u043d\u044b\u043c \u0438 \u0432\u0435\u0441\u0435\u043b\u044b\u043c \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u043e\u043c.</li> <li>\u0417\u043e\u043d\u0434: \"\u0422\u044b \u0445\u043e\u0447\u0435\u0448\u044c \u0431\u044b\u0442\u044c \u043f\u043e\u043b\u0435\u0437\u043d\u044b\u043c \u0438\u043b\u0438 \u0437\u0430\u043f\u043e\u043c\u0438\u043d\u0430\u044e\u0449\u0438\u043c\u0441\u044f?\"</li> </ul> </li> </ol>"},{"location":"recommendation/engine/#52","title":"5.2. \u041f\u0435\u0442\u043b\u044f \u041e\u0431\u0440\u0430\u0442\u043d\u043e\u0439 \u0421\u0432\u044f\u0437\u0438 (\u042f\u0432\u043d\u043e\u0435 \u0432\u0430\u0436\u043d\u0435\u0435 \u041d\u0435\u044f\u0432\u043d\u043e\u0433\u043e)","text":"<p>\u0414\u043e\u0432\u0435\u0440\u044f\u0442\u044c \"\u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438\" (dwell time) \u0441\u043b\u0438\u0448\u043a\u043e\u043c \u0440\u0438\u0441\u043a\u043e\u0432\u0430\u043d\u043d\u043e \u0434\u043b\u044f \u043f\u043e\u0434\u0430\u0440\u043a\u043e\u0432. \u041d\u0430\u043c \u043d\u0443\u0436\u043d\u0430 \u042f\u0432\u043d\u0430\u044f \u041e\u0431\u0440\u0430\u0442\u043d\u0430\u044f \u0421\u0432\u044f\u0437\u044c \u0434\u043b\u044f \u0442\u043e\u0447\u043d\u043e\u0439 \u043a\u0430\u043b\u0438\u0431\u0440\u043e\u0432\u043a\u0438 \u0434\u0432\u0438\u0436\u043a\u0430.</p> <p>\u041c\u043e\u0434\u0435\u043b\u044c \u0412\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f: 1.  \u2764\ufe0f \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u0428\u043e\u0440\u0442-\u043b\u0438\u0441\u0442 (\u0421\u0438\u043b\u044c\u043d\u044b\u0439 \u041f\u043e\u0437\u0438\u0442\u0438\u0432):     *   \u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435: \"\u042d\u0442\u043e \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0432\u0435\u0440\u043d\u043e\u0435\".     *   \u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435: \u0417\u043d\u0430\u0447\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043f\u043e\u0432\u044b\u0441\u0438\u0442\u044c \u0432\u0435\u0441\u0430 \u044d\u0442\u043e\u0439 \u043e\u0441\u0438 GUTG. \u0413\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 \u0433\u0438\u043f\u043e\u0442\u0435\u0437 \u0432 \u044d\u0442\u043e\u043c \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435. 2.  \u274c \u0414\u0438\u0437\u043b\u0430\u0439\u043a/\u0421\u043a\u0440\u044b\u0442\u044c (\u0421\u0438\u043b\u044c\u043d\u044b\u0439 \u041d\u0435\u0433\u0430\u0442\u0438\u0432):     *   \u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435: \"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043f\u0443\u0442\u044c\".     *   \u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435: \u0417\u0430\u0431\u0430\u043d\u0438\u0442\u044c \u044d\u0442\u0443 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u0443\u044e \u0433\u0438\u043f\u043e\u0442\u0435\u0437\u0443.     *   \u0423\u0442\u043e\u0447\u043d\u0435\u043d\u0438\u0435: \"\u041f\u0440\u043e\u0442\u043e\u043a\u043e\u043b '\u041f\u043e\u0447\u0435\u043c\u0443?'\". \u0418\u043d\u043e\u0433\u0434\u0430 \u0441\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0442\u044c \u043f\u043e\u0447\u0435\u043c\u0443 \u044d\u0442\u043e \u0431\u044b\u043b\u043e \u043e\u0442\u0432\u0435\u0440\u0433\u043d\u0443\u0442\u043e:         *   \u0412\u0430\u0440\u0438\u0430\u043d\u0442: \"\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u0434\u043e\u0440\u043e\u0433\u043e\" -&gt; \u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u0431\u044e\u0434\u0436\u0435\u0442\u0430.         *   \u0412\u0430\u0440\u0438\u0430\u043d\u0442: \"\u0421\u043a\u0443\u0447\u043d\u043e\" -&gt; \u041f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u0441 Optimizer \u043d\u0430 Catalyst/Mirror.         *   \u0412\u0430\u0440\u0438\u0430\u043d\u0442: \"\u041d\u0435 \u0438\u0445 \u0441\u0442\u0438\u043b\u044c\" -&gt; \u0418\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0442\u0435\u043a\u0443\u0449\u0438\u0435 \u0442\u0435\u0433\u0438 Aesthetic. 3.  \ud83e\udd14 \u041d\u0435 \u0443\u0432\u0435\u0440\u0435\u043d (\u0422\u0440\u0438\u0433\u0433\u0435\u0440 \u0417\u043e\u043d\u0434\u0430):     *   \u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435: \"\u041d\u0435\u043e\u0434\u043d\u043e\u0437\u043d\u0430\u0447\u043d\u043e\".     *   \u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435: \u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u0412\u043e\u043f\u0440\u043e\u0441-\u0417\u043e\u043d\u0434 (\u043d\u0430\u043f\u0440., \"\u042d\u0442\u043e \u043f\u0440\u0438\u043a\u043e\u043b\u044c\u043d\u043e, \u043d\u043e \u0431\u0435\u0441\u043f\u043e\u043b\u0435\u0437\u043d\u043e?\").</p> <p>\u042d\u0444\u0444\u0435\u043a\u0442 \u0428\u043e\u0440\u0442-\u043b\u0438\u0441\u0442\u0430: \u041f\u043e \u043c\u0435\u0440\u0435 \u0442\u043e\u0433\u043e \u043a\u0430\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0441\u043e\u0431\u0438\u0440\u0430\u0435\u0442 \u0448\u043e\u0440\u0442-\u043b\u0438\u0441\u0442, \u041f\u0440\u043e\u0444\u0438\u043b\u044c \u0434\u0435\u0439\u0441\u0442\u0432\u0443\u0435\u0442 \u043a\u0430\u043a \"\u0426\u0435\u043d\u0442\u0440 \u041c\u0430\u0441\u0441\" \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u043e\u0432. \u041c\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u0448\u043e\u0440\u0442-\u043b\u0438\u0441\u0442 \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0440\u0430\u043d\u0436\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043e\u0441\u0442\u0430\u0432\u0448\u0435\u0439\u0441\u044f \u043b\u0435\u043d\u0442\u044b \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438.</p>"},{"location":"recommendation/engine/#6","title":"6. \u041f\u0440\u0438\u043c\u0435\u0440 \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0439 \u0421\u0435\u0441\u0441\u0438\u0438 (\u041f\u043e\u0442\u043e\u043a)","text":"<p>\u0428\u0430\u0433 1: \u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 (\u041a\u0432\u0438\u0437)</p> <ul> <li>\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c: \"\u041f\u0430\u0440\u0435\u043d\u044c, 30, IT \u0421\u043f\u0435\u0446\u0438\u0430\u043b\u0438\u0441\u0442. \u041b\u044e\u0431\u0438\u0442 \u0413\u043e\u0442\u043e\u0432\u0438\u0442\u044c.\"</li> <li>\u041f\u0440\u043e\u0444\u0430\u0439\u043b\u0435\u0440: <ul> <li>\u0411\u0430\u0437\u0430: <code>Optimizer: 0.3</code>, <code>Mirror: 0.3</code>.</li> <li>\u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442: <code>\u041e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f: \u041f\u0430\u0440\u0442\u043d\u0435\u0440</code> -&gt; \u0411\u0443\u0441\u0442 <code>Anchor</code>.</li> </ul> </li> </ul> <p>\u0428\u0430\u0433 2: DHG (\u0413\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u0413\u0438\u043f\u043e\u0442\u0435\u0437)</p> <ul> <li>\u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0435\u0442 \"\u0413\u043e\u0442\u043e\u0432\u043a\u0430\" + \"IT\":<ul> <li>H1 (Optimizer/Tech): \"\u041f\u0440\u0435\u0446\u0438\u0437\u0438\u043e\u043d\u043d\u0430\u044f \u041a\u0443\u043b\u0438\u043d\u0430\u0440\u0438\u044f\" (\u0421\u0443-\u0432\u0438\u0434, \u0443\u043c\u043d\u044b\u0435 \u0442\u0435\u0440\u043c\u043e\u043c\u0435\u0442\u0440\u044b).</li> <li>H2 (Permission/Taste): \"\u0420\u0435\u0434\u043a\u0438\u0435 \u0418\u043d\u0433\u0440\u0435\u0434\u0438\u0435\u043d\u0442\u044b\" (\u0422\u0440\u044e\u0444\u0435\u043b\u044c\u043d\u043e\u0435 \u043c\u0430\u0441\u043b\u043e, \u0432\u044b\u0434\u0435\u0440\u0436\u0430\u043d\u043d\u044b\u0439 \u0431\u0430\u043b\u044c\u0437\u0430\u043c\u0438\u043a).</li> <li>H3 (Catalyst/Skill): \"\u041c\u0430\u0441\u0442\u0435\u0440\u0441\u0442\u0432\u043e\" (\u0422\u043e\u0447\u0438\u043b\u044c\u043d\u044b\u0435 \u043a\u0430\u043c\u043d\u0438, \u043d\u0430\u0431\u043e\u0440 \u043c\u043e\u043b\u0435\u043a\u0443\u043b\u044f\u0440\u043d\u043e\u0439 \u043a\u0443\u0445\u043d\u0438).</li> </ul> </li> </ul> <p>\u0428\u0430\u0433 3: \u041f\u043e\u0440\u0442\u0444\u0435\u043b\u044c\u043d\u0430\u044f \u041b\u0435\u043d\u0442\u0430 (\u041f\u0435\u0440\u0432\u044b\u0435 4 \u041a\u0430\u0440\u0442\u043e\u0447\u043a\u0438)</p> <ol> <li>\u041a\u0430\u0440\u0442\u043e\u0447\u043a\u0430 1 (Optimizer): \"\u0410\u043f\u0433\u0440\u0435\u0439\u0434 \u0435\u0433\u043e \u043a\u0443\u0445\u043e\u043d\u043d\u044b\u0445 \u0433\u0430\u0434\u0436\u0435\u0442\u043e\u0432\" (\u0423\u043c\u043d\u044b\u0439 \u0442\u0435\u0440\u043c\u043e\u043c\u0435\u0442\u0440 \u0434\u043b\u044f \u043c\u044f\u0441\u0430).</li> <li>\u041a\u0430\u0440\u0442\u043e\u0447\u043a\u0430 2 (Anchor): \"\u0421\u0432\u0438\u0434\u0430\u043d\u0438\u0435 \u0441 \u0433\u043e\u0442\u043e\u0432\u043a\u043e\u0439\" (\u041d\u0430\u0431\u043e\u0440 \u0434\u043b\u044f \u043f\u0430\u0441\u0442\u044b \u043d\u0430 \u0434\u0432\u043e\u0438\u0445).</li> <li>\u041a\u0430\u0440\u0442\u043e\u0447\u043a\u0430 3 (Permission): \"\u0423\u043d\u0438\u0444\u043e\u0440\u043c\u0430 \u0428\u0435\u0444\u0430\" (\u041a\u0430\u0441\u0442\u043e\u043c\u043d\u044b\u0439 \u0444\u0430\u0440\u0442\u0443\u043a).</li> <li>\u041a\u0430\u0440\u0442\u043e\u0447\u043a\u0430 4 (Wildcard): \"\u0420\u0430\u0441\u0441\u043b\u0430\u0431\u043b\u0435\u043d\u0438\u0435 \u043f\u043e\u0441\u043b\u0435 \u0440\u0430\u0431\u043e\u0442\u044b\" (\u041c\u0430\u0441\u0441\u0430\u0436\u0435\u0440).</li> </ol> <p>\u0428\u0430\u0433 4: \u0412\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 (\u0417\u043e\u043d\u0434)</p> <ul> <li>\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0437\u0430\u0432\u0438\u0441 \u043d\u0430 \u041a\u0430\u0440\u0442\u043e\u0447\u043a\u0435 1 (\u0422\u0435\u0440\u043c\u043e\u043c\u0435\u0442\u0440), \u043d\u043e \u043d\u0435 \u043a\u043b\u0438\u043a\u0430\u0435\u0442.</li> <li>\u0421\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0439 \u0417\u043e\u043d\u0434: \"\u041e\u043d \u043b\u044e\u0431\u0438\u0442 \u0433\u0430\u0434\u0436\u0435\u0442\u044b \u0438\u043b\u0438 \u043f\u0440\u0435\u0434\u043f\u043e\u0447\u0438\u0442\u0430\u0435\u0442 \u043e\u043b\u0434\u0441\u043a\u0443\u043b\u044c\u043d\u044b\u0435 \u0440\u0443\u0447\u043d\u044b\u0435 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u044b?\"</li> <li>\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c: \"\u0413\u0430\u0434\u0436\u0435\u0442\u044b.\"</li> </ul> <p>\u0428\u0430\u0433 5: \u0423\u0442\u043e\u0447\u043d\u0435\u043d\u0438\u0435</p> <ul> <li>\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u041f\u0440\u043e\u0444\u0430\u0439\u043b\u0435\u0440\u0430: <code>Optimizer</code> ++, <code>Tech</code> ++. <code>Old-school</code> --.</li> <li>\u041d\u043e\u0432\u0430\u044f \u041b\u0435\u043d\u0442\u0430: \u0421\u0443-\u0432\u0438\u0434, \u0412\u0430\u043a\u0443\u0443\u043c\u0430\u0442\u043e\u0440, Bluetooth \u0449\u0443\u043f \u0434\u043b\u044f \u0431\u0430\u0440\u0431\u0435\u043a\u044e. (\u0418\u0434\u0435\u044f \"Anchor\" \u0441\u0434\u0432\u0438\u0433\u0430\u0435\u0442\u0441\u044f \u0432\u043d\u0438\u0437).</li> </ul>"},{"location":"recommendation/engine/#7","title":"7. \u041c\u043e\u0434\u0435\u043b\u0438 \u0414\u0430\u043d\u043d\u044b\u0445","text":""},{"location":"recommendation/engine/#the-hypothesis","title":"\u0413\u0438\u043f\u043e\u0442\u0435\u0437\u0430 (The Hypothesis)","text":"<p>\u041f\u0440\u043e\u043c\u0435\u0436\u0443\u0442\u043e\u0447\u043d\u0430\u044f \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u043c\u0435\u0436\u0434\u0443 \u041d\u0430\u043c\u0435\u0440\u0435\u043d\u0438\u0435\u043c \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438 \u0422\u043e\u0432\u0430\u0440\u043e\u043c.</p> <pre><code>{\n  \"id\": \"cooking_precision_tech\",\n  \"title\": \"Precision Cooking Lab\",\n  \"gutg_axis\": \"Optimizer\",\n  \"gutg_subtype\": \"Upgrade\",\n  \"reasoning\": \"\u041e\u043d \u0432 IT, \u043f\u043e\u044d\u0442\u043e\u043c\u0443, \u0441\u043a\u043e\u0440\u0435\u0435 \u0432\u0441\u0435\u0433\u043e, \u0446\u0435\u043d\u0438\u0442 \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c \u0438 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c.\",\n  \"search_queries\": [\"sous vide\", \"smart thermometer\", \"precision scale\"],\n  \"validation_question\": \"Does he treat cooking as an art or a science?\"\n}\n</code></pre>"},{"location":"recommendation/engine/#the-user-state","title":"\u0421\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (The User State)","text":"<pre><code>{\n  \"session_id\": \"xyz\",\n  \"gutg_weights\": {\n    \"mirror\": 0.2,\n    \"optimizer\": 0.6,\n    \"permission\": 0.2\n  },\n  \"meta_context\": {\n    \"effort\": \"low\",\n    \"goal\": \"impress\"\n  },\n  \"active_hypotheses\": [\"cooking_precision_tech\", \"smart_home\"],\n  \"rejected_hypotheses\": [\"cooking_aprons\"]\n}\n</code></pre>"},{"location":"recommendation/intelligence_api/","title":"Hybrid Intelligence Architecture","text":"<p>\u042d\u0442\u043e\u0442 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442 \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0443 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0445 \u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u0439 Gifty \u0434\u043b\u044f \u0437\u0430\u0434\u0430\u0447 \u043c\u0430\u0448\u0438\u043d\u043d\u043e\u0433\u043e \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f (embeddings, reranking, classification).</p>"},{"location":"recommendation/intelligence_api/#_1","title":"\u041e\u0431\u0437\u043e\u0440","text":"<p>Gifty \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0433\u0438\u0431\u0440\u0438\u0434\u043d\u044b\u0439 \u043f\u043e\u0434\u0445\u043e\u0434 \u043a \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0435 ML-\u0437\u0430\u0434\u0430\u0447, \u0440\u0430\u0437\u0434\u0435\u043b\u044f\u044f \u0438\u0445 \u043f\u043e \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442\u0443 \u0438 \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f. \u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0438\u0440\u0443\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0438 \u043c\u0435\u0436\u0434\u0443 \u0432\u043d\u0435\u0448\u043d\u0438\u043c\u0438 API, GPU-\u0444\u0435\u0440\u043c\u0430\u043c\u0438 (RunPod) \u0438 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u043c\u0438 \u0432\u043e\u0440\u043a\u0435\u0440\u0430\u043c\u0438.</p> graph TD     A[Backend Service] --&gt;|priority: high| B[Real-time Execution]     A --&gt;|priority: low| C[Batch Processing Queue]      B --&gt; D{Provider Router}     D --&gt;|Intelligence API| E[api.giftyai.ru]     D --&gt;|RunPod| F[Serverless GPU Cluster]     D --&gt;|Together AI| G[Cloud GPU Providers]      C --&gt; H[compute_tasks Database]     H --&gt; I[External Workers]     I --&gt;|Poll tasks| H     I --&gt;|Submit results| H     H --&gt;|Callback/Poll| A"},{"location":"recommendation/intelligence_api/#1","title":"1. \u0420\u0435\u0436\u0438\u043c\u044b \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f","text":""},{"location":"recommendation/intelligence_api/#online-real-time","title":"Online (Real-time)","text":"<ul> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f: \u043e\u0442\u0432\u0435\u0442\u043e\u0432 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e \u0432 \u0447\u0430\u0442\u0435, \u0431\u044b\u0441\u0442\u0440\u043e\u0433\u043e \u043f\u043e\u0438\u0441\u043a\u0430, \u043f\u0440\u0435\u0432\u044c\u044e \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439.</li> <li>\u041f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442: <code>high</code>.</li> <li>\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c: &lt; 1-2 \u0441\u0435\u043a.</li> <li>\u041f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u044b: RunPod (\u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439), Intelligence API (fallback), Together AI.</li> </ul>"},{"location":"recommendation/intelligence_api/#offline-batchqueue","title":"Offline (Batch/Queue)","text":"<ul> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f: \u0444\u043e\u043d\u043e\u0432\u043e\u0433\u043e \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0430 \u0442\u043e\u0432\u0430\u0440\u043e\u0432, \u043f\u0435\u0440\u0435\u0441\u0447\u0435\u0442\u0430 \u044d\u043c\u0431\u0435\u0434\u0434\u0438\u043d\u0433\u043e\u0432 \u0432\u0441\u0435\u0433\u043e \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430, \u0442\u044f\u0436\u0435\u043b\u043e\u0433\u043e \u0441\u043a\u043e\u0440\u0438\u043d\u0433\u0430.</li> <li>\u041f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442: <code>low</code>.</li> <li>\u041c\u0435\u0445\u0430\u043d\u0438\u0437\u043c: \u0417\u0430\u0434\u0430\u0447\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u044e\u0442\u0441\u044f \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0443 <code>compute_tasks</code>.</li> <li>\u0412\u043e\u0440\u043a\u0435\u0440\u044b: \u0421\u043a\u0440\u0438\u043f\u0442\u044b \u043d\u0430 Kaggle, \u0434\u043e\u043c\u0430\u0448\u043d\u0438\u0435 GPU-\u043a\u043b\u0430\u0441\u0442\u0435\u0440\u044b \u0438\u043b\u0438 \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u044b\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u044b.</li> </ul>"},{"location":"recommendation/intelligence_api/#2-provider-routing","title":"2. \u041c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0446\u0438\u044f (Provider Routing)","text":"<p>\u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f ML-\u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438 (<code>IntelligenceAPIClient</code>) \u043d\u0430\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 <code>configs/logic.yaml</code>.</p>"},{"location":"recommendation/intelligence_api/#embeddings","title":"\u042d\u043c\u0431\u0435\u0434\u0434\u0438\u043d\u0433\u0438 (Embeddings)","text":"<p>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c\u044b\u0435 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u044b: 1.  <code>intelligence_api</code>: \u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0439 API Gifty. 2.  <code>runpod</code>: \u041e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u0432\u044b\u0441\u043e\u043a\u043e\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438. 3.  <code>together</code>: \u0428\u0438\u0440\u043e\u043a\u0438\u0439 \u0432\u044b\u0431\u043e\u0440 open-source \u043c\u043e\u0434\u0435\u043b\u0435\u0439.</p>"},{"location":"recommendation/intelligence_api/#llm-ai-reasoning","title":"LLM (AI Reasoning)","text":"<p>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c\u044b\u0435 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u044b: - Anthropic (Claude) - Google (Gemini) - Groq (Llama 3 / Mixtral) - OpenRouter (\u0410\u0433\u0440\u0435\u0433\u0430\u0442\u043e\u0440) - Together AI</p>"},{"location":"recommendation/intelligence_api/#3-task-queue","title":"3. \u0422\u0430\u0431\u043b\u0438\u0446\u0430 \u0437\u0430\u0434\u0430\u0447 (Task Queue)","text":"<p>\u0414\u043b\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 <code>low-priority</code> \u0437\u0430\u0434\u0430\u0447 \u0432\u043e\u0440\u043a\u0435\u0440\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0439 API:</p> <ol> <li>\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447: <code>GET /internal/workers/tasks</code> \u2014 \u0432\u044b\u0434\u0430\u0435\u0442 \u043f\u0430\u0447\u043a\u0443 \u0437\u0430\u0434\u0430\u0447 \u0438 \u043f\u043e\u043c\u0435\u0447\u0430\u0435\u0442 \u0438\u0445 \u043a\u0430\u043a <code>processing</code>.</li> <li>\u041e\u0442\u043f\u0440\u0430\u0432\u043a\u0430 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430: <code>POST /internal/workers/tasks/{id}/result</code> \u2014 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0438 \u043f\u043e\u043c\u0435\u0447\u0430\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0443 \u043a\u0430\u043a <code>completed</code>.</li> </ol>"},{"location":"recommendation/intelligence_api/#4","title":"4. \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f","text":"<p>\u0412\u0441\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043c\u043e\u0434\u0435\u043b\u0435\u0439 \u0438 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u043e\u0432 \u0432\u044b\u043d\u0435\u0441\u0435\u043d\u044b \u0432 YAML-\u043a\u043e\u043d\u0444\u0438\u0433 \u0434\u043b\u044f \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0433\u043e\u0440\u044f\u0447\u0435\u0439 \u0437\u0430\u043c\u0435\u043d\u044b \u0431\u0435\u0437 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u043a\u043e\u0434\u0430.</p> <p>\u041f\u0440\u0438\u043c\u0435\u0440 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0432 <code>configs/logic.yaml</code>: <pre><code>llm:\n  default_provider: \"anthropic\"\n  embedding_provider: \"runpod\"\n  model_embedding: \"bge-m3\"\n</code></pre></p>"},{"location":"recommendation/multi_track/","title":"Multi-Track Discovery Architecture","text":"<p>This document details the architecture of the Multi-Track Discovery System, introduced to allow parallel exploration of multiple user interests simultaneously, replacing the previous sequential topic processing.</p>"},{"location":"recommendation/multi_track/#core-concept","title":"Core Concept","text":"<p>Instead of processing one topic at a time (e.g., \"Lego\" -&gt; Hypotheses -&gt; Next Topic), the system now parallelizes the discovery process:</p> <ol> <li>Normalizes the user's input (e.g., \"Lego and coffee\") into distinct topics ([\"Lego\", \"Coffee\"]).</li> <li>Generates hypotheses for all normalized topics in a single bulk LLM call.</li> <li>Fetches product previews for all generated hypotheses in parallel.</li> <li>Presents all tracks to the user simultaneously (e.g., as tabs or cards).</li> </ol>"},{"location":"recommendation/multi_track/#system-flow","title":"System Flow","text":"sequenceDiagram     participant U as User (Frontend)     participant DM as DialogueManager     participant A as AnthropicService (LLM)     participant RS as RecommendationService (DB/Vector)      U-&gt;&gt;DM: POST /recommendations/init (Quiz Answers)      rect rgb(200, 220, 240)         Note over DM, A: Step 1: Topic Normalization         DM-&gt;&gt;A: normalize_topics(\"Lego &amp; Coffee, Fishing\")         A--&gt;&gt;DM: [\"Lego\", \"Coffee\", \"Fishing\"]     end      rect rgb(220, 240, 200)         Note over DM, A: Step 2: Bulk Hypothesis Generation         DM-&gt;&gt;A: generate_hypotheses_bulk([\"Lego\", \"Coffee\", \"Fishing\"], Context)         A--&gt;&gt;DM: { \"Lego\": [Hyp1, Hyp2], \"Coffee\": [Hyp3, Hyp4], ... }     end      rect rgb(240, 220, 220)         Note over DM, RS: Step 3: Parallel Product Previews         par For Each Hypothesis             DM-&gt;&gt;RS: find_preview_products(Hypothesis Search Queries)             RS--&gt;&gt;DM: [ProductDTO, ProductDTO, ...]         end     end      Note over DM: Construct TopicTrack objects      DM--&gt;&gt;U: Session with tracks[] and state=\"overview\"      Note over U: User sees tabs: [Lego] [Coffee] [Fishing]      U-&gt;&gt;DM: POST /interact (action=\"select_track\", value=\"Lego\")     DM-&gt;&gt;DM: Set selected_topic=\"Lego\", state=\"showing_hypotheses\"     DM--&gt;&gt;U: Return active track hypotheses"},{"location":"recommendation/multi_track/#detailed-components","title":"detailed Components","text":""},{"location":"recommendation/multi_track/#1-topic-normalizer-anthropicservicenormalize_topics","title":"1. Topic Normalizer (<code>AnthropicService.normalize_topics</code>)","text":"<p>Crucial for handling mixed inputs like \"Lego and coffee\".</p> <ul> <li>Input: <code>[\"Lego and coffee\", \"Travel\"]</code></li> <li>LLM Task: Split compound topics, remove noise, translate to session language.</li> <li>Output: <code>[\"Lego\", \"Coffee\", \"Travel\"]</code></li> </ul>"},{"location":"recommendation/multi_track/#2-bulk-generator-anthropicservicegenerate_hypotheses_bulk","title":"2. Bulk Generator (<code>AnthropicService.generate_hypotheses_bulk</code>)","text":"<p>Optimized for performance and Rate Limits. Instead of $N$ calls for $N$ topics, we make 1 call with a JSON prompt asking for hypotheses for all topics at once. This reduces latency from ~2-3 minutes (sequential) to ~10-15 seconds.</p>"},{"location":"recommendation/multi_track/#3-track-structure-recommendationsmodelstopictrack","title":"3. Track Structure (<code>recommendations.models.TopicTrack</code>)","text":"<p>The session now holds a list of tracks, not just a single active topic.</p> <pre><code>class TopicTrack(BaseModel):\n    topic_id: str\n    topic_name: str         # e.g. \"Lego\"\n    title: str              # User-facing title\n    preview_text: str       # Short description\n    hypotheses: List[Hypothesis]\n</code></pre>"},{"location":"recommendation/multi_track/#4-state-machine-updates","title":"4. State Machine Updates","text":"<ul> <li>New State: <code>DiscoveryState.OVERVIEW</code> \u2014 The initial state after <code>init</code>, where multiple tracks are available but none is \"active\" yet.</li> <li>New Action: <code>select_track</code> \u2014 Transitions from <code>OVERVIEW</code> to <code>SHOWING_HYPOTHESES</code> for a specific topic.</li> </ul>"},{"location":"recommendation/multi_track/#performance-considerations","title":"Performance Considerations","text":"<ul> <li>Latency: The bulk generation step dominates latency (~10s).</li> <li>Rate Limits: By using a single bulk call, we stay well within Anthropic Tier 1 limits (unlike parallel requests which trigger 429 errors).</li> <li>Fallback: If bulk generation fails, the system falls back to processing just the first topic sequentially.</li> </ul>"},{"location":"recommendation/overview/","title":"Gifty Recommendation System Architecture","text":"<p>This document describes the State-of-the-Art (SOTA) recommendation engine powered by Vision-Language Models (VLM) and Vector Search.</p>"},{"location":"recommendation/overview/#1-system-overview","title":"1. System Overview","text":"<p>The Gifty recommendation system transforms raw product data into high-quality gift suggestions by combining semantic search with a multi-dimensional psychological evaluation.</p>"},{"location":"recommendation/overview/#2-core-components","title":"2. Core Components","text":""},{"location":"recommendation/overview/#a-data-ingestion-catalog-sync","title":"A. Data Ingestion (Catalog Sync)","text":"<ul> <li>Source: TakProdam API.</li> <li>Process: Fetches products, cleans metadata, and persists them into a PostgreSQL database.</li> <li>Deduplication: Uses <code>content_hash</code> to avoid redundant processing of the same product data.</li> </ul>"},{"location":"recommendation/overview/#b-vector-embeddings-stage-3","title":"B. Vector Embeddings (Stage 3)","text":"<ul> <li>Model: <code>BAAI/bge-m3</code> (Multi-lingual, High-dimensional).</li> <li>Function: Converts product titles and descriptions into 1024-dimensional vectors.</li> <li>Storage: <code>product_embeddings</code> table with <code>pgvector</code> HNSW indices for ultra-fast cosine similarity search.</li> </ul>"},{"location":"recommendation/overview/#c-gifty-10-dimensions-matrix-the-gifty-dna","title":"C. Gifty 10-Dimensions Matrix (The Gifty DNA)","text":"<p>Instead of a binary \"gift / not gift\" flag, every product is evaluated by a Qwen2-VL model across 10 psychological axes (stored in <code>llm_gift_vector</code> JSONB): 1.  Wow-Factor: Surprise and delight level. 2.  Warmth: Emotional temperature (Handcrafted vs. Tech). 3.  Romance: Suitability for intimate relationships. 4.  Practicality: Utility value vs. purely aesthetic. 5.  Usage Frequency: Daily driver vs. seasonal/niche. 6.  Occasion Versatility: How universal is the gift (Birthday vs. Wedding). 7.  Aesthetics: Visual perception of quality and premium feel. 8.  Social Risk: Danger of missing the mark or awkwardness. 9.  Age Suitability: Multi-segment distribution. 10. Gender Bias: Masculine, Feminine, or Unisex.</p>"},{"location":"recommendation/overview/#3-the-recommendation-pipeline","title":"3. The Recommendation Pipeline","text":""},{"location":"recommendation/overview/#step-1-user-profile-quiz","title":"Step 1: User Profile (Quiz)","text":"<p>The user answers a quiz determining the recipient's age, interests, vibes, and relationship type.</p>"},{"location":"recommendation/overview/#step-2-semantic-retrieval","title":"Step 2: Semantic Retrieval","text":"<p>The system generates a query vector from the quiz answers and performs a vector search against the product catalog to find items that are semantically relevant.</p>"},{"location":"recommendation/overview/#step-3-psychological-filtering","title":"Step 3: Psychological Filtering","text":"<p>Items are filtered and scored based on the 10-D Matrix. For example: - If the relationship is \"Professional\", products with high Romance are penalized. - If the vibe is \"Practical\", products with high Practicality are prioritized.</p>"},{"location":"recommendation/overview/#step-4-reranking-diversity","title":"Step 4: Reranking &amp; Diversity","text":"<p>The final list is reranked to ensure a diverse mix of categories and price points, preventing a \"unanimous\" list (e.g., only showing 10 different types of socks).</p>"},{"location":"recommendation/overview/#4-technical-stack","title":"4. Technical Stack","text":"<ul> <li>Backend: FastAPI (Python 3.11+).</li> <li>Database: PostgreSQL + <code>pgvector</code>.</li> <li>Cache/Queue: Redis.</li> <li>VLM Workers: <code>Qwen2-VL-7B</code> running on GPU environments (Kaggle/Colab or dedicated GPU servers).</li> <li>Deployment: Dockerized, non-root user for security, Gunicorn + Uvicorn workers.</li> </ul> <p>Last Updated: January 2026</p>"},{"location":"recommendation/query_rules/","title":"Gift Query &amp; Feedback Strategy","text":"<p>\"100% \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c \u043d\u0435\u0434\u043e\u0441\u0442\u0438\u0436\u0438\u043c\u0430. \u041d\u0430\u0448\u0430 \u0446\u0435\u043b\u044c \u2014 \u043c\u0430\u043a\u0441\u0438\u043c\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u044c \u0438 \u044f\u0432\u043d\u043e \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0443\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0441\u0442\u044c.\"</p> <p>\u042d\u0442\u043e\u0442 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442 \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u043f\u043e\u043b\u043d\u0443\u044e \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0443 \u0441\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u043f\u043e\u0441\u0442\u0440\u043e\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0444\u0438\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 Grand Unified Theory of Gifting.</p>"},{"location":"recommendation/query_rules/#1-3","title":"1. \u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 \u0441\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 (3 \u0441\u043b\u043e\u044f)","text":""},{"location":"recommendation/query_rules/#1-core-quiz","title":"\u0421\u043b\u043e\u0439 1 \u2014 \u0418\u043d\u0442\u0435\u0440\u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0439 \u041e\u043f\u0440\u043e\u0441 (Core Quiz)","text":"<ul> <li>\u0412\u0435\u0442\u0432\u044f\u0449\u0430\u044f\u0441\u044f \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430: 12\u201318 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u0432\u043e\u043f\u0440\u043e\u0441\u043e\u0432 + 10\u201325 \u0441\u0438\u0442\u0443\u0430\u0442\u0438\u0432\u043d\u044b\u0445.</li> <li>\u041a\u0430\u0436\u0434\u044b\u0439 \u043a\u043b\u044e\u0447\u0435\u0432\u043e\u0439 \u043e\u0442\u0432\u0435\u0442 \u0438\u043c\u0435\u0435\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 Confidence (\u0417\u043d\u0430\u044e \u0442\u043e\u0447\u043d\u043e / \u041a\u0430\u0436\u0435\u0442\u0441\u044f / \u041d\u0435 \u0437\u043d\u0430\u044e).</li> <li>\u0426\u0435\u043b\u044c: \u041f\u043e\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0431\u0430\u0437\u043e\u0432\u044b\u0439 \u0432\u0435\u043a\u0442\u043e\u0440 \u0432\u0435\u0441\u043e\u0432 \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u0439.</li> </ul>"},{"location":"recommendation/query_rules/#2-active-learning-scroll-loop","title":"\u0421\u043b\u043e\u0439 2 \u2014 Active Learning (Scroll Loop)","text":"<ul> <li>1 Micro-Question \u043f\u043e\u0441\u043b\u0435 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f (Like/Dislike).</li> <li>Pairwise Choice \u043a\u0430\u0436\u0434\u044b\u0435 6\u20138 \u043a\u0430\u0440\u0442\u043e\u0447\u0435\u043a (A \u0438\u043b\u0438 B?).</li> <li>\u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0432\u044b\u0431\u0438\u0440\u0430\u0435\u0442 \u0432\u043e\u043f\u0440\u043e\u0441, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u0441\u043d\u0438\u0436\u0430\u0435\u0442 \u044d\u043d\u0442\u0440\u043e\u043f\u0438\u044e \u043f\u0440\u043e\u0444\u0438\u043b\u044f.</li> </ul>"},{"location":"recommendation/query_rules/#3-external-verification-optional","title":"\u0421\u043b\u043e\u0439 3 \u2014 External Verification (Optional)","text":"<ul> <li>\u0410\u043d\u0430\u043b\u0438\u0437 \u0441\u043e\u0446\u0441\u0435\u0442\u0435\u0439/\u0432\u0438\u0448\u043b\u0438\u0441\u0442\u043e\u0432/\u0441\u043a\u0440\u0438\u043d\u0448\u043e\u0442\u043e\u0432 (\u0441 \u044f\u0432\u043d\u043e\u0433\u043e \u0441\u043e\u0433\u043b\u0430\u0441\u0438\u044f).</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0432\u0435\u0440\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 Mirror (\u0444\u0430\u043d\u0434\u043e\u043c\u044b, \u044d\u0441\u0442\u0435\u0442\u0438\u043a\u0430) \u0438 Catalyst (\u043c\u0435\u0447\u0442\u044b).</li> </ul>"},{"location":"recommendation/query_rules/#2-system-entities","title":"2. \u041c\u043e\u0434\u0435\u043b\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044f (System Entities)","text":"<p>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u043c \u0440\u0430\u0431\u043e\u0442\u044b \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u043e\u0442\u0447\u0435\u0442:</p> <ol> <li>5 Dimensions (Weights 0-100 + Confidence 0-1):<ul> <li>Mirror, Optimizer, Catalyst, Anchor, Permission.</li> </ul> </li> <li>Subtypes (Weights 0-100):<ul> <li>\u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440: Mirror: Aesthetic (80%), Optimizer: Automation (65%).</li> </ul> </li> <li>Constraints &amp; Risks:<ul> <li>Hard Limits (\u0430\u043b\u043b\u0435\u0440\u0433\u0438\u0438, \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \"\u043d\u0435\u0442\").</li> <li>Soft Limits (\u043c\u0438\u043d\u0438\u043c\u0430\u043b\u0438\u0437\u043c, \"\u0431\u0435\u0437 \u0445\u043b\u0430\u043c\u0430\").</li> <li>Context (\u0441\u043e\u0432\u043c\u0435\u0441\u0442\u0438\u043c\u043e\u0441\u0442\u044c iOS/Android, \u0440\u0430\u0437\u043c\u0435\u0440\u044b).</li> </ul> </li> <li>Signal Evidence List:<ul> <li>\u041a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0435 \u0431\u0440\u0435\u043d\u0434\u044b, \u0446\u0438\u0442\u0430\u0442\u044b, \u0431\u043e\u043b\u0438, \u043c\u0435\u0447\u0442\u044b.</li> </ul> </li> </ol>"},{"location":"recommendation/query_rules/#3-quiz-logic","title":"3. \u0414\u0435\u0442\u0430\u043b\u044c\u043d\u0430\u044f \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u041e\u043f\u0440\u043e\u0441\u0430 (Quiz Logic)","text":""},{"location":"recommendation/query_rules/#0","title":"\u0411\u043b\u043e\u043a 0. \u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 (\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439)","text":"<ol> <li>\u041a\u0442\u043e \u0432\u044b \u0435\u043c\u0443? (\u041a\u043e\u043b\u043b\u0435\u0433\u0430 / \u041f\u0440\u0438\u044f\u0442\u0435\u043b\u044c / \u0414\u0440\u0443\u0433 / \u0411\u043b\u0438\u0437\u043a\u0438\u0439 \u0434\u0440\u0443\u0433 / \u041f\u0430\u0440\u0442\u043d\u0451\u0440 / \u0420\u043e\u0434\u0441\u0442\u0432\u0435\u043d\u043d\u0438\u043a / \u0420\u043e\u0434\u0438\u0442\u0435\u043b\u044c).<ul> <li>Logic: \u0415\u0441\u043b\u0438 \u0431\u043b\u0438\u0437\u043e\u0441\u0442\u044c \u2264 2 \u2192 Anchor limit, Catalyst \u0442\u043e\u043b\u044c\u043a\u043e \"Starter\".</li> </ul> </li> <li>\u041f\u043e\u0432\u043e\u0434: (\u0414\u0420 / \u041f\u0440\u0430\u0437\u0434\u043d\u0438\u043a / \u0421\u043f\u0430\u0441\u0438\u0431\u043e / \u0418\u0437\u0432\u0438\u043d\u0435\u043d\u0438\u0435 / \"\u041f\u0440\u043e\u0441\u0442\u043e \u0442\u0430\u043a\" / \u0421\u043e\u0431\u044b\u0442\u0438\u0435).</li> <li>\u0411\u043b\u0438\u0437\u043e\u0441\u0442\u044c (1\u20135): \u041e\u0446\u0435\u043d\u043a\u0430 \u0443\u0440\u043e\u0432\u043d\u044f \u0438\u043d\u0442\u0438\u043c\u043d\u043e\u0441\u0442\u0438.</li> <li>\u0411\u044e\u0434\u0436\u0435\u0442: \u0414\u0438\u0430\u043f\u0430\u0437\u043e\u043d + \u0447\u0435\u043a\u0431\u043e\u043a\u0441 \"\u0422\u043e\u043b\u044c\u043a\u043e exact price\" \u0438\u043b\u0438 \"\u041c\u043e\u0436\u043d\u043e +30% \u0437\u0430 \u043c\u044d\u0442\u0447\".</li> <li>\u0421\u0440\u043e\u043a: \u0414\u0430\u0442\u0430 + \u0424\u043e\u0440\u043c\u0430\u0442 (\u041b\u0438\u0447\u043d\u043e / \u0414\u043e\u0441\u0442\u0430\u0432\u043a\u0430 / \u0426\u0438\u0444\u0440\u043e\u0432\u043e\u0439).</li> <li>\u0412\u043e\u0437\u0440\u0430\u0441\u0442\u043d\u043e\u0439 \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d: (15\u201318 / 18\u201325 / 25\u201335 / ...).</li> <li>\u041f\u043e\u043b / \u0413\u0435\u043d\u0434\u0435\u0440: (\u041e\u043f\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u043e, \u0434\u043b\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u043e\u0434\u0435\u0436\u0434\u044b/\u043f\u0430\u0440\u0444\u044e\u043c\u0430).</li> </ol>"},{"location":"recommendation/query_rules/#1-safety-first","title":"\u0411\u043b\u043e\u043a 1. \u0416\u0435\u0441\u0442\u043a\u0438\u0435 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u044f (Safety First)","text":"<ol> <li>\u0422\u043e\u0447\u043d\u043e \u041d\u0415 \u0434\u0430\u0440\u0438\u0442\u044c (\u041c\u0443\u043b\u044c\u0442\u0438\u0432\u044b\u0431\u043e\u0440):<ul> <li>\u041e\u0434\u0435\u0436\u0434\u0430/\u041e\u0431\u0443\u0432\u044c, \u041f\u0430\u0440\u0444\u044e\u043c/\u041a\u043e\u0441\u043c\u0435\u0442\u0438\u043a\u0430, \u0415\u0434\u0430/\u0410\u043b\u043a\u043e\u0433\u043e\u043b\u044c, \u0421\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u044b, \u0414\u0435\u043a\u043e\u0440/\u0421\u0443\u0432\u0435\u043d\u0438\u0440\u044b, \u0428\u0443\u0442\u043a\u0438, \u041b\u0438\u0447\u043d\u043e\u0435/\u0418\u043d\u0442\u0438\u043c\u043d\u043e\u0435, \u0413\u0430\u0434\u0436\u0435\u0442\u044b.</li> </ul> </li> <li>\u0417\u0434\u043e\u0440\u043e\u0432\u044c\u0435/\u042d\u0442\u0438\u043a\u0430: \u0410\u043b\u043b\u0435\u0440\u0433\u0438\u0438, \u0414\u0438\u0435\u0442\u044b, \u0412\u0435\u0433\u0430\u043d\u0441\u0442\u0432\u043e, \u042d\u043a\u043e-\u043f\u0440\u0438\u043d\u0446\u0438\u043f\u044b.</li> <li>\u041e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0435 \u043a \u0432\u0435\u0449\u0430\u043c:<ul> <li>\u041b\u044e\u0431\u0438\u0442 \u0432\u0435\u0449\u0438 / \u041d\u0435\u0439\u0442\u0440\u0430\u043b\u044c\u043d\u043e / \u041c\u0438\u043d\u0438\u043c\u0430\u043b\u0438\u0437\u043c / \u041d\u0435\u043d\u0430\u0432\u0438\u0434\u0438\u0442 \u0445\u043b\u0430\u043c.</li> </ul> </li> <li>\u041f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u043e: \u041c\u0430\u043b\u043e \u043c\u0435\u0441\u0442\u0430 / \u041d\u043e\u0440\u043c / \u041c\u043d\u043e\u0433\u043e \u043c\u0435\u0441\u0442\u0430 (\u0434\u043b\u044f \u0433\u0430\u0431\u0430\u0440\u0438\u0442\u043d\u044b\u0445 \u043f\u043e\u0434\u0430\u0440\u043a\u043e\u0432).</li> <li>\u0422\u0435\u0445\u043d\u0438\u043a\u0430: \u042d\u043a\u043e\u0441\u0438\u0441\u0442\u0435\u043c\u0430 (iOS/Android) + \"\u0415\u0441\u0442\u044c \u043b\u0438 AirTag-\u0430\u043d\u0430\u043b\u043e\u0433?\".</li> <li>\u042d\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0444\u0438\u043b\u044c\u0442\u0440\u044b: \u0411\u0435\u0437 \u043a\u043e\u0436\u0438, \u041b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u0431\u0440\u0435\u043d\u0434\u044b, Zero Waste.</li> </ol>"},{"location":"recommendation/query_rules/#2-mirror-identity-map","title":"\u0411\u043b\u043e\u043a 2. Mirror (Identity Map)","text":"<p>\u041c\u044b \u0441\u043e\u0431\u0438\u0440\u0430\u0435\u043c \u043d\u0430\u0431\u043b\u044e\u0434\u0430\u0435\u043c\u044b\u0435 \u0441\u0438\u0433\u043d\u0430\u043b\u044b, \u0430 \u043d\u0435 \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0446\u0438\u0438.</p> <ol> <li>\u0422\u043e\u043f-3 \u0420\u043e\u043b\u0438/\u0422\u0435\u0433\u0430 (\u0412\u044b\u0431\u043e\u0440 + \u0421\u0432\u043e\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442):<ul> <li>\u042d\u0441\u0442\u0435\u0442, \u0422\u0435\u0445\u043d\u0430\u0440\u044c, \u0413\u0443\u0440\u043c\u0430\u043d, \u0421\u043f\u043e\u0440\u0442\u0441\u043c\u0435\u043d, \u0413\u0435\u0439\u043c\u0435\u0440, \u041c\u0435\u043b\u043e\u043c\u0430\u043d, \u0427\u0438\u0442\u0430\u0442\u0435\u043b\u044c, \u041f\u0443\u0442\u0435\u0448\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u0438\u043a, \u0414\u043e\u043c\u043e\u0441\u0435\u0434, \u0422\u0443\u0441\u043e\u0432\u0449\u0438\u043a, \u0427\u0435\u043b\u043e\u0432\u0435\u043a-\u0441\u0438\u0441\u0442\u0435\u043c\u0430, \u0422\u0432\u043e\u0440\u0435\u0446, \u041a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u043e\u043d\u0435\u0440, \u041a\u0430\u0440\u044c\u0435\u0440\u0438\u0441\u0442.</li> <li>Confidence: \u0417\u043d\u0430\u044e \u0442\u043e\u0447\u043d\u043e / \u041a\u0430\u0436\u0435\u0442\u0441\u044f / \u041d\u0435 \u0443\u0432\u0435\u0440\u0435\u043d.</li> </ul> </li> <li>\u0422\u043e\u043f-3 \u0422\u0435\u043c\u044b \u0440\u0430\u0437\u0433\u043e\u0432\u043e\u0440\u043e\u0432: \u041e \u0447\u0435\u043c \u043c\u043e\u0436\u0435\u0442 \u0433\u043e\u0432\u043e\u0440\u0438\u0442\u044c \u0447\u0430\u0441\u0430\u043c\u0438?<ul> <li>\u0423\u0442\u043e\u0447\u043d\u0435\u043d\u0438\u0435: \u042d\u0442\u043e \u0434\u0430\u0432\u043d\u043e \u0438\u043b\u0438 \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0435 \u0443\u0432\u043b\u0435\u0447\u0435\u043d\u0438\u0435?</li> </ul> </li> </ol>"},{"location":"recommendation/query_rules/#3-fanatic-obsessions","title":"\u0411\u043b\u043e\u043a 3. Fanatic (Obsessions)","text":"<ol> <li>\u0415\u0441\u0442\u044c \u043b\u0438 1\u20132 \u043e\u0431\u0441\u0435\u0441\u0441\u0438\u0438? (\u0414\u0430/\u041d\u0435\u0442).<ul> <li>\u0415\u0441\u043b\u0438 \u0434\u0430: \u0427\u0442\u043e \u0438\u043c\u0435\u043d\u043d\u043e? (\u0424\u0430\u043d\u0434\u043e\u043c / \u0418\u0433\u0440\u0430 / \u0410\u0440\u0442\u0438\u0441\u0442 / \u0411\u0440\u0435\u043d\u0434).</li> <li>Level: Casual / \u0424\u0430\u043d\u0430\u0442 / \u041a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u043e\u043d\u0435\u0440.</li> <li>Negative Filter: \u0427\u0442\u043e \u0442\u043e\u0447\u043d\u043e \u041d\u0415 \u043b\u044e\u0431\u0438\u0442 \u0432\u043d\u0443\u0442\u0440\u0438 \u0442\u0435\u043c\u044b? (\u041d\u0435 \u044d\u0442\u043e\u0442 \u0441\u0435\u0437\u043e\u043d / \u041d\u0435 \u044d\u0442\u043e\u0442 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436).</li> <li>Check: \"\u0423 \u043d\u0435\u0433\u043e \u0443\u0436\u0435 \u0435\u0441\u0442\u044c \u043c\u0435\u0440\u0447? \u041a\u0430\u043a\u043e\u0439?\" (\u0420\u0435\u0434\u043a\u043e\u0435 vs \u041c\u0430\u0441\u0441\u043e\u0432\u043e\u0435).</li> </ul> </li> </ol>"},{"location":"recommendation/query_rules/#4-aesthetic-visual-language","title":"\u0411\u043b\u043e\u043a 4. Aesthetic (Visual Language)","text":"<ol> <li>\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 2 \u044d\u0441\u0442\u0435\u0442\u0438\u043a\u0438:<ul> <li>\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u0438\u0437\u043c, \u0423\u044e\u0442 (Cozy), \u0412\u0438\u043d\u0442\u0430\u0436, Techwear, \u0410\u0440\u0442, \u0421\u043f\u043e\u0440\u0442, \"\u0414\u043e\u0440\u043e\u0433\u043e-\u0442\u0438\u0445\u043e\", \u042f\u0440\u043a\u043e-\u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u0438\u0437\u043c, \u041a\u0430\u0432\u0430\u0439/Cute, \u0418\u043d\u0434\u0430\u0441\u0442\u0440\u0438\u0430\u043b, \u041d\u0430\u0442\u0443\u0440\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u044c.</li> </ul> </li> <li>\u041f\u0430\u043b\u0438\u0442\u0440\u0430: \u0421\u0432\u0435\u0442\u043b\u043e\u0435 / \u0422\u0451\u043c\u043d\u043e\u0435 / \u041d\u0435\u0439\u0442\u0440\u0430\u043b\u044c\u043d\u043e\u0435 / \u042f\u0440\u043a\u043e\u0435.</li> <li>\u041c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u044b: \u041c\u0435\u0442\u0430\u043b\u043b / \u0414\u0435\u0440\u0435\u0432\u043e / \u041a\u0435\u0440\u0430\u043c\u0438\u043a\u0430 / \u0422\u043a\u0430\u043d\u044c / \u041a\u043e\u0436\u0430 / \u041f\u043b\u0430\u0441\u0442\u0438\u043a.</li> <li>\u041b\u043e\u0433\u043e\u0442\u0438\u043f\u044b: \u041b\u044e\u0431\u0438\u0442 \u0431\u0440\u0435\u043d\u0434\u0438\u043d\u0433 / \u0422\u043e\u043b\u044c\u043a\u043e no-name.</li> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430: \u0415\u043c\u0443 \u0432\u0430\u0436\u043d\u0435\u0435 \u043a\u0430\u043a \u0432\u044b\u0433\u043b\u044f\u0434\u0438\u0442 \u0438\u043b\u0438 \u043a\u0430\u043a \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442? (Slider 0-10).</li> </ol>"},{"location":"recommendation/query_rules/#5-taste-token-micro-preferences","title":"\u0411\u043b\u043e\u043a 5. Taste Token (Micro-Preferences)","text":"<ol> <li>Daily Drivers (\u0427\u0442\u043e \u043f\u043e\u0442\u0440\u0435\u0431\u043b\u044f\u0435\u0442 \u0435\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u043e?):<ul> <li>\u041a\u043e\u0444\u0435, \u0427\u0430\u0439, \u0412\u043e\u0434\u0430, \u0421\u043d\u0435\u043a\u0438, \u0423\u0445\u043e\u0434, \u041c\u0443\u0437\u044b\u043a\u0430, \u041a\u0430\u043d\u0446\u0435\u043b\u044f\u0440\u0438\u044f.</li> </ul> </li> <li>\u0422\u043e\u0447\u043d\u044b\u0435 \"\u041b\u044e\u0431\u043b\u044e/\u041d\u0435 \u043b\u044e\u0431\u043b\u044e\":<ul> <li>\u0412\u043a\u0443\u0441\u044b (\u0421\u043b\u0430\u0434\u043a\u043e\u0435/\u0413\u043e\u0440\u044c\u043a\u043e\u0435), \u0417\u0430\u043f\u0430\u0445\u0438 (\u0426\u0438\u0442\u0440\u0443\u0441/\u0412\u0430\u043d\u0438\u043b\u044c), \u0422\u0435\u043a\u0441\u0442\u0443\u0440\u044b.</li> </ul> </li> <li>\u0421\u043f\u0435\u0446\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f: \u041f\u043e\u0434\u0430\u0440\u043e\u043a \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \"\u0442\u043e\u0447\u043d\u044b\u043c \u043f\u043e \u043c\u043e\u0434\u0435\u043b\u0438\" \u0438\u043b\u0438 \"\u0441\u044e\u0440\u043f\u0440\u0438\u0437 \u043e\u043a\"?</li> </ol>"},{"location":"recommendation/query_rules/#6-values-signal-principles","title":"\u0411\u043b\u043e\u043a 6. Values Signal (Principles)","text":"<ol> <li>\u041f\u0440\u043e\u044f\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u0446\u0435\u043d\u043d\u043e\u0441\u0442\u0438 (\u0434\u043e 3):<ul> <li>\u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e/\u0414\u043e\u043b\u0433\u043e\u0432\u0435\u0447\u043d\u043e\u0441\u0442\u044c, \u041f\u0440\u0430\u043a\u0442\u0438\u0447\u043d\u043e\u0441\u0442\u044c, \u0421\u0442\u0430\u0442\u0443\u0441, \u042d\u043c\u043e\u0446\u0438\u0438, \u0417\u0434\u043e\u0440\u043e\u0432\u044c\u0435, \u0422\u0432\u043e\u0440\u0447\u0435\u0441\u0442\u0432\u043e, \u0422\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0438, \u042d\u043a\u043e\u043b\u043e\u0433\u0438\u044f.</li> </ul> </li> <li>\u041f\u0440\u0438\u043d\u0446\u0438\u043f\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \"\u041d\u0415\u0422\": \u0418\u0437-\u0437\u0430 \u0447\u0435\u0433\u043e \u043e\u043d \u043d\u0435 \u043a\u0443\u043f\u0438\u0442 \u0432\u0435\u0449\u044c?</li> </ol>"},{"location":"recommendation/query_rules/#7-tribe-badge","title":"\u0411\u043b\u043e\u043a 7. Tribe (Badge)","text":"<ol> <li>\u0413\u0434\u0435 \u043e\u043d \"\u0441\u0432\u043e\u0439\"?<ul> <li>\u0411\u0435\u0433/\u0417\u0430\u043b, \u041d\u0430\u0441\u0442\u043e\u043b\u043a\u0438, \u041a\u0438\u0431\u0435\u0440\u0441\u043f\u043e\u0440\u0442, \u0421\u0442\u0430\u0440\u0442\u0430\u043f, \u041a\u0438\u043d\u043e/\u0410\u0440\u0442, \u0424\u043e\u0442\u043e, \u041c\u0443\u0437\u044b\u043a\u0430, \u0410\u0432\u0442\u043e.</li> </ul> </li> <li>Level: \u0413\u0438\u043a \u043f\u043e \u0434\u0435\u0442\u0430\u043b\u044f\u043c vs \u041b\u044e\u0431\u0438\u0442\u0435\u043b\u044c.</li> </ol>"},{"location":"recommendation/query_rules/#8-personal-myth-archetype","title":"\u0411\u043b\u043e\u043a 8. Personal Myth (Archetype)","text":"<ol> <li>\u0410\u0440\u0445\u0435\u0442\u0438\u043f: \u0418\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c, \u0421\u043e\u0437\u0434\u0430\u0442\u0435\u043b\u044c, \u041a\u0443\u0440\u0430\u0442\u043e\u0440, \u041f\u0435\u0440\u0444\u0435\u043a\u0446\u0438\u043e\u043d\u0438\u0441\u0442, \u0417\u0430\u0449\u0438\u0442\u043d\u0438\u043a, \u041a\u043e\u043c\u0438\u043a.</li> <li>Self-Worth: \u0427\u0442\u043e \u043e\u043d \u0432 \u0441\u0435\u0431\u0435 \u0446\u0435\u043d\u0438\u0442? (\u0412\u0432\u043e\u0434 1-2 \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u044f).</li> </ol>"},{"location":"recommendation/query_rules/#9-optimizer-friction","title":"\u0411\u043b\u043e\u043a 9. Optimizer (Friction)","text":"<ol> <li>\u0422\u043e\u043f-3 \u0440\u0430\u0437\u0434\u0440\u0430\u0436\u0438\u0442\u0435\u043b\u044f \u0432 \u0431\u044b\u0442\u0443: (\u0412\u0432\u043e\u0434).</li> <li>\u0421\u0442\u0438\u043b\u044c: \u0422\u0435\u0440\u043f\u0438\u0442 \u043d\u0435\u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 vs \u041e\u043f\u0442\u0438\u043c\u0438\u0437\u0438\u0440\u0443\u0435\u0442 \u0432\u0441\u0451.</li> <li>\u0417\u043e\u043d\u044b \u0431\u043e\u043b\u0438:<ul> <li>\u0417\u0430\u0440\u044f\u0434\u043a\u0430/\u041f\u0440\u043e\u0432\u043e\u0434\u0430, \u041a\u043b\u044e\u0447\u0438, \u0421\u043e\u043d/\u0421\u0442\u0440\u0435\u0441\u0441, \u0420\u0430\u0431\u043e\u0447\u0435\u0435 \u043c\u0435\u0441\u0442\u043e, \u0423\u0431\u043e\u0440\u043a\u0430, \u0417\u0434\u043e\u0440\u043e\u0432\u044c\u0435/\u0421\u043f\u0438\u043d\u0430.</li> </ul> </li> <li>Risk Check: \u0415\u0441\u0442\u044c \u043b\u0438 \u0442\u0435\u043c\u044b, \u0433\u0434\u0435 \u0444\u0438\u043a\u0441 \u0432\u044b\u0433\u043b\u044f\u0434\u0438\u0442 \u043a\u0430\u043a \u0443\u043f\u0440\u0451\u043a? (\u0412\u0435\u0441, \u0413\u0438\u0433\u0438\u0435\u043d\u0430, \u041f\u043e\u0440\u044f\u0434\u043e\u043a).</li> </ol>"},{"location":"recommendation/query_rules/#10-catalyst-potential","title":"\u0411\u043b\u043e\u043a 10. Catalyst (Potential)","text":"<ol> <li>\u041c\u0435\u0447\u0442\u044b (\"\u0425\u043e\u0447\u0443 \u043d\u0430\u0447\u0430\u0442\u044c\"): 1\u20133 \u043f\u0443\u043d\u043a\u0442\u0430 (\u042f\u0437\u044b\u043a, \u0421\u043f\u043e\u0440\u0442, \u0425\u043e\u0431\u0431\u0438).</li> <li>Reality Check: \"\u0413\u043e\u0432\u043e\u0440\u0438\u0442 \u0438 \u0434\u0435\u043b\u0430\u0435\u0442\" vs \"\u0413\u043e\u0432\u043e\u0440\u0438\u0442 \u0438 \u043e\u0442\u043a\u043b\u0430\u0434\u044b\u0432\u0430\u0435\u0442\".</li> <li>Learning Style: \u041a\u0443\u0440\u0441\u044b / \u041f\u0440\u0430\u043a\u0442\u0438\u043a\u0430 / \u041a\u043e\u043c\u044c\u044e\u043d\u0438\u0442\u0438 / \u0421\u0430\u043c\u043e\u0443\u0447\u043a\u0430.</li> <li>\u0412\u0440\u0435\u043c\u044f \u043d\u0430 \u0445\u043e\u0431\u0431\u0438: \u041c\u0430\u043b\u043e / \u0421\u0440\u0435\u0434\u043d\u0435 / \u041c\u043d\u043e\u0433\u043e.</li> </ol>"},{"location":"recommendation/query_rules/#11-anchor-bond","title":"\u0411\u043b\u043e\u043a 11. Anchor (Bond)","text":"<p>(\u0422\u043e\u043b\u044c\u043a\u043e \u0435\u0441\u043b\u0438 \u0411\u043b\u0438\u0437\u043e\u0441\u0442\u044c \u2265 3)</p> <ol> <li>Shared Context: \u0415\u0441\u0442\u044c \u043b\u0438 \u043e\u0431\u0449\u0438\u0439 \u0441\u0438\u043c\u0432\u043e\u043b/\u0438\u0441\u0442\u043e\u0440\u0438\u044f?</li> <li>Sentimentality: \u041b\u044e\u0431\u0438\u0442 \u0441\u0435\u043d\u0442\u0438\u043c\u0435\u043d\u0442\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u044c vs \"\u041d\u0435 \u043d\u0430\u0434\u043e \u0441\u043e\u043f\u043b\u0435\u0439\".</li> <li>Intimacy: \u041f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442 \u043b\u0438 \u043e\u0447\u0435\u043d\u044c \u043b\u0438\u0447\u043d\u044b\u0435 \u043f\u043e\u0434\u0430\u0440\u043a\u0438?</li> </ol>"},{"location":"recommendation/query_rules/#12-permission-guilt-free","title":"\u0411\u043b\u043e\u043a 12. Permission (Guilt-Free)","text":"<ol> <li>Self-Spending: \u041e\u0442\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u0441\u0435\u0431\u0435? (\u0427\u0430\u0441\u0442\u043e / \u0418\u043d\u043e\u0433\u0434\u0430 / \u041d\u0438\u043a\u043e\u0433\u0434\u0430).</li> <li>Guilty Pleasures:<ul> <li>\u0412\u043a\u0443\u0441\u043d\u043e\u0435, \u0417\u0430\u043f\u0430\u0445\u0438, \u0412\u0430\u043d\u043d\u0430/\u0423\u0445\u043e\u0434, \u0422\u043a\u0430\u043d\u0438/\u041f\u0438\u0436\u0430\u043c\u0430, \u0414\u0435\u043a\u043e\u0440, \u041f\u0440\u0435\u043c\u0438\u0443\u043c-\u0430\u043a\u0441\u0435\u0441\u0441\u0443\u0430\u0440\u044b.</li> </ul> </li> <li>Preference: \"\u0422\u0438\u0445\u043e-\u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u043e\" vs \"\u0412\u0430\u0443-\u044d\u0444\u0444\u0435\u043a\u0442\".</li> </ol>"},{"location":"recommendation/query_rules/#4-active-learning","title":"4. \u0414\u0438\u043d\u0430\u043c\u0438\u043a\u0430 \u0432\u043e \u0432\u0440\u0435\u043c\u044f \u0441\u043a\u0440\u043e\u043b\u043b\u0430 (Active Learning)","text":""},{"location":"recommendation/query_rules/#event-a-like-1-tap","title":"Event A: Like (\ud83d\udc4d) \u2014 \"\u0427\u0442\u043e \u0437\u0430\u0446\u0435\u043f\u0438\u043b\u043e?\" (1 tap)","text":"<ul> <li>\u0421\u0442\u0438\u043b\u044c/\u041a\u0440\u0430\u0441\u0438\u0432\u043e \u2192 <code>Mirror: Aesthetic</code> boost.</li> <li>\u041f\u0440\u044f\u043c\u043e \"\u043f\u0440\u043e \u043d\u0435\u0433\u043e\" \u2192 <code>Mirror: Identity</code> boost.</li> <li>\u041f\u043e\u043b\u0435\u0437\u043d\u043e\u0441\u0442\u044c \u2192 <code>Optimizer</code> boost.</li> <li>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 \u043c\u0435\u0447\u0442\u044b \u2192 <code>Catalyst</code> boost.</li> <li>\u0422\u0435\u043f\u043b\u043e/\u041b\u0438\u0447\u043d\u043e \u2192 <code>Anchor</code> boost.</li> <li>\u0421\u0430\u043c \u0431\u044b \u043d\u0435 \u043a\u0443\u043f\u0438\u043b \u2192 <code>Permission</code> boost.</li> <li>Smart Fork: \u0415\u0441\u043b\u0438 \u0432\u044b\u0431\u0440\u0430\u043d Optimizer \u2192 \"\u0415\u043c\u0443 \u0432\u0430\u0436\u043d\u0435\u0435 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e (Upgrade) \u0438\u043b\u0438 \u0447\u0442\u043e\u0431\u044b \u0441\u0430\u043c\u043e \u0440\u0430\u0431\u043e\u0442\u0430\u043b\u043e (Automation)?\"</li> </ul>"},{"location":"recommendation/query_rules/#event-b-dislike","title":"Event B: Dislike (\ud83d\udc4e) \u2014 \"\u041f\u043e\u0447\u0435\u043c\u0443 \u043d\u0435\u0442?\"","text":"<ul> <li>\u041d\u0435 \u0435\u0433\u043e \u0441\u0442\u0438\u043b\u044c \u2192 \u0421\u043c\u0435\u043d\u0438\u0442\u044c <code>Aesthetic</code>.</li> <li>\u0411\u0435\u0441\u043f\u043e\u043b\u0435\u0437\u043d\u043e \u2192 <code>Permission</code> down / <code>Optimizer</code> up.</li> <li>\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u0441\u043b\u043e\u0436\u043d\u043e \u2192 <code>Catalyst</code> risk.</li> <li>\u0423\u0436\u0435 \u0435\u0441\u0442\u044c \u2192 \u041f\u0440\u0435\u0434\u043b\u043e\u0436\u0438\u0442\u044c <code>Upgrade</code>.</li> <li>\u0425\u043b\u0430\u043c \u2192 <code>Minimalism</code> filter.</li> <li>\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u043b\u0438\u0447\u043d\u043e \u2192 <code>Anchor</code> limit.</li> </ul>"},{"location":"recommendation/query_rules/#event-c-pairwise-a-vs-b","title":"Event C: Pairwise (A vs B)","text":"<p>\u041a\u0430\u0436\u0434\u044b\u0435 8 \u043a\u0430\u0440\u0442\u043e\u0447\u0435\u043a: *   \u041f\u0440\u0430\u043a\u0442\u0438\u0447\u043d\u043e vs \u042d\u0441\u0442\u0435\u0442\u0438\u0447\u043d\u043e? *   \u0412\u0435\u0449\u044c vs \u041e\u043f\u044b\u0442? *   \u041b\u0438\u0447\u043d\u043e\u0435 vs \u041d\u0435\u0439\u0442\u0440\u0430\u043b\u044c\u043d\u043e\u0435?</p> <p>Stop Rule: \u041e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0432\u043e\u043f\u0440\u043e\u0441\u043e\u0432, \u043a\u043e\u0433\u0434\u0430 \u0432\u0435\u0441\u0430 \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u0439 \u0441\u0442\u0430\u0431\u0438\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c (Delta &lt; X).</p>"},{"location":"recommendation/query_rules/#5","title":"5. \u041c\u0435\u0445\u0430\u043d\u0438\u043a\u0430 \"\u0422\u043e\u0447\u043d\u043e\u0441\u0442\u0438\"","text":"<ol> <li>Confidence Weights:<ul> <li>\u0421\u0438\u043b\u044c\u043d\u044b\u0435 \u0441\u0438\u0433\u043d\u0430\u043b\u044b (Explicit \"\u0417\u043d\u0430\u044e \u0442\u043e\u0447\u043d\u043e\", \u041a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0435 \u0431\u0440\u0435\u043d\u0434\u044b) = x2..x4 \u0432\u0435\u0441.</li> <li>\u0421\u043b\u0430\u0431\u044b\u0435 \u0441\u0438\u0433\u043d\u0430\u043b\u044b (Implicit, \"\u041a\u0430\u0436\u0435\u0442\u0441\u044f\") = x1 \u0432\u0435\u0441.</li> </ul> </li> <li>Consistency Check:<ul> <li>\u041a\u043e\u043d\u0444\u043b\u0438\u043a\u0442 \"\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u0438\u0437\u043c\" + \"\u041b\u044e\u0431\u0438\u0442 \u0441\u0443\u0432\u0435\u043d\u0438\u0440\u044b\" \u2192 \u0417\u0430\u0434\u0430\u0442\u044c \u0443\u0442\u043e\u0447\u043d\u044f\u044e\u0449\u0438\u0439 \u0432\u043e\u043f\u0440\u043e\u0441.</li> <li>\u041a\u043e\u043d\u0444\u043b\u0438\u043a\u0442 \"\u041d\u0435 \u043b\u044e\u0431\u0438\u0442 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u044b\" + \"\u0425\u043e\u0447\u0435\u0442 \u043e\u043f\u044b\u0442\" \u2192 \u0423\u0442\u043e\u0447\u043d\u0438\u0442\u044c \u0444\u043e\u0440\u043c\u0430\u0442 (\"\u0411\u0438\u043b\u0435\u0442 &gt; \u0412\u0430\u0443\u0447\u0435\u0440\").</li> </ul> </li> <li>Negative Filtering:<ul> <li>\u0422\u0440\u0438\u0433\u0433\u0435\u0440\u044b \u043e\u0442\u0442\u043e\u0440\u0436\u0435\u043d\u0438\u044f \u0438\u043c\u0435\u044e\u0442 \u043d\u0430\u0438\u0432\u044b\u0441\u0448\u0438\u0439 \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442 (Vetoe Power).</li> </ul> </li> </ol>"},{"location":"recommendation/query_rules/#6-output-concept","title":"6. \u0424\u0438\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u041e\u0442\u0447\u0451\u0442 (Output Concept)","text":"<p>User Portrait: *   Dominant: Mirror (78%), Optimizer (64%). *   Subtypes: Aesthetic (Minimalism), TasteToken (Coffee), Optimizer (System). *   Red Flags: NO clutter, NO logos, iOS only. *   Evidence: [\u041b\u044e\u0431\u0438\u0442 \u043a\u043e\u0444\u0435 \u0441\u043f\u0435\u0448\u0438\u0430\u043b\u0442\u0438, \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0438\u0437 \u0434\u043e\u043c\u0430, \u0436\u0430\u043b\u0443\u0435\u0442\u0441\u044f \u043d\u0430 \u0431\u0430\u0440\u0434\u0430\u043a \u043d\u0430 \u0441\u0442\u043e\u043b\u0435].</p> <p>Strategy Recommendations: 1.  Strategy 1 (The Upgrade): \u041f\u0440\u0435\u043c\u0438\u0443\u043c-\u0430\u043a\u0441\u0435\u0441\u0441\u0443\u0430\u0440 \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0447\u0435\u0433\u043e \u0441\u0442\u043e\u043b\u0430 (Mirror + Optimizer). 2.  Strategy 2 (The Ritual): \u041d\u0430\u0431\u043e\u0440 \u0434\u043b\u044f \u0430\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u043d\u043e\u0433\u043e \u0437\u0430\u0432\u0430\u0440\u0438\u0432\u0430\u043d\u0438\u044f (Mirror + Permission). 3.  Strategy 3 (The Fix): \u041e\u0440\u0433\u0430\u043d\u0430\u0439\u0437\u0435\u0440 \u043a\u0430\u0431\u0435\u043b\u0435\u0439 (Optimizer + Aesthetic).</p> <p>Framing: \"\u042f \u0437\u0430\u043c\u0435\u0442\u0438\u043b, \u043a\u0430\u043a \u0442\u044b \u0446\u0435\u043d\u0438\u0448\u044c \u043f\u043e\u0440\u044f\u0434\u043e\u043a \u043d\u0430 \u0441\u0442\u043e\u043b\u0435, \u043f\u043e\u044d\u0442\u043e\u043c\u0443...\"</p>"},{"location":"recommendation/quiz_system/","title":"\u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0418\u043d\u0442\u0435\u043b\u043b\u0435\u043a\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u041a\u0432\u0438\u0437\u0430 (Gifty Quiz System)","text":"<p>\u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u0430\u044f \u0426\u0435\u043b\u044c: \u0421\u0443\u0437\u0438\u0442\u044c \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u043e \u043f\u043e\u0438\u0441\u043a\u0430 \u0438\u0437 \u043c\u0438\u043b\u043b\u0438\u043e\u043d\u043e\u0432 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0434\u043e ~50 \u0440\u0435\u043b\u0435\u0432\u0430\u043d\u0442\u043d\u044b\u0445 \u043a\u0430\u043d\u0434\u0438\u0434\u0430\u0442\u043e\u0432 \u0438 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044e \u0440\u0430\u043d\u0436\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f.</p> <p>\u041a\u0432\u0438\u0437 \u2014 \u044d\u0442\u043e \u043d\u0435 \u043f\u0440\u043e\u0441\u0442\u043e \u0430\u043d\u043a\u0435\u0442\u0430. \u041a\u0430\u0436\u0434\u044b\u0439 \u0431\u043b\u043e\u043a \u0432\u043e\u043f\u0440\u043e\u0441\u043e\u0432 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u0443\u044e \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u0443\u044e \u0444\u0443\u043d\u043a\u0446\u0438\u044e: \u043b\u0438\u0431\u043e \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442 \u0416\u0435\u0441\u0442\u043a\u0438\u0435 \u0424\u0438\u043b\u044c\u0442\u0440\u044b (Hard Filters), \u043b\u0438\u0431\u043e \u0437\u0430\u0434\u0430\u0435\u0442 \u0412\u0435\u043a\u0442\u043e\u0440\u044b \u0420\u0430\u043d\u0436\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f (Ranking Vectors).</p>"},{"location":"recommendation/quiz_system/#1-the-givers-constraints","title":"\u0411\u043b\u043e\u043a 1: \u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u0414\u0430\u0440\u0438\u0442\u0435\u043b\u044f (The Giver's Constraints)","text":"<p>\u0426\u0435\u043b\u044c: \u0423\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \"\u041f\u0440\u0430\u0432\u0438\u043b\u0430 \u0418\u0433\u0440\u044b\". \u042d\u0442\u043e \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0438 \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u044f, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0430\u043a\u043b\u0430\u0434\u044b\u0432\u0430\u0435\u0442 \u0441\u0430\u043c \u0434\u0430\u0440\u0438\u0442\u0435\u043b\u044c.</p>"},{"location":"recommendation/quiz_system/#11-relationship","title":"1.1. \u0421\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u0430\u044f \u0414\u0438\u0441\u0442\u0430\u043d\u0446\u0438\u044f (Relationship)","text":"<ul> <li>\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u0430\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u044f: \u0424\u0438\u043b\u044c\u0442\u0440 \u0434\u043e\u043f\u0443\u0441\u0442\u0438\u043c\u043e\u0439 \u0438\u043d\u0442\u0438\u043c\u043d\u043e\u0441\u0442\u0438 (Intimacy Filter).</li> <li>\u0417\u0430\u0447\u0435\u043c: \u041e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442, \u043a\u0430\u043a\u0438\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u043f\u043e\u0434\u0430\u0440\u043a\u043e\u0432 \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u043e \u043f\u0440\u0438\u0435\u043c\u043b\u0435\u043c\u044b.</li> <li>\u041b\u043e\u0433\u0438\u043a\u0430:<ul> <li>Partner/Best Friend: \u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u044b \u043b\u0438\u0447\u043d\u044b\u0435, \u0441\u0435\u043d\u0442\u0438\u043c\u0435\u043d\u0442\u0430\u043b\u044c\u043d\u044b\u0435 (Anchor), \u0442\u0430\u043a\u0442\u0438\u043b\u044c\u043d\u044b\u0435 \u0442\u043e\u0432\u0430\u0440\u044b.</li> <li>Colleague/Boss: \u0416\u0435\u0441\u0442\u043a\u0438\u0439 \u0431\u043b\u043e\u043a \u043d\u0430 \u0438\u043d\u0442\u0438\u043c\u043d\u044b\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 (\u0431\u0435\u043b\u044c\u0435, \u0433\u0438\u0433\u0438\u0435\u043d\u0430, \u0440\u043e\u043c\u0430\u043d\u0442\u0438\u043a\u0430). \u041f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442 \u0441\u0442\u0430\u0442\u0443\u0441\u043d\u044b\u0445 (Permission) \u0438 \u043f\u043e\u043b\u0435\u0437\u043d\u044b\u0445 (Optimizer) \u0432\u0435\u0449\u0435\u0439.</li> <li>Relative: \u0410\u043a\u0446\u0435\u043d\u0442 \u043d\u0430 \u0437\u0430\u0431\u043e\u0442\u0443 (Optimizer) \u0438 \u0442\u0440\u0430\u0434\u0438\u0446\u0438\u0438 (Anchor).</li> </ul> </li> </ul>"},{"location":"recommendation/quiz_system/#12-effort-time","title":"1.2. \u0420\u0435\u0441\u0443\u0440\u0441 \u0414\u0430\u0440\u0438\u0442\u0435\u043b\u044f (Effort &amp; Time)","text":"<ul> <li>\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u0430\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u044f: \u0424\u0438\u043b\u044c\u0442\u0440 \u0441\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0438\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f (Execution Complexity Filter).</li> <li>\u0417\u0430\u0447\u0435\u043c: \u041e\u0442\u0441\u0435\u043a\u0430\u0435\u0442 \u0438\u0434\u0435\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0434\u0430\u0440\u0438\u0442\u0435\u043b\u044c \u043d\u0435 \u0433\u043e\u0442\u043e\u0432 \u0438\u043b\u0438 \u043d\u0435 \u0443\u0441\u043f\u0435\u0435\u0442 \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c.</li> <li>\u041b\u043e\u0433\u0438\u043a\u0430:<ul> <li>Low Effort / Last Minute: \u0421\u043a\u0440\u044b\u0432\u0430\u0435\u043c DIY-\u043d\u0430\u0431\u043e\u0440\u044b, \u0441\u043b\u043e\u0436\u043d\u044b\u0435 \u043a\u0432\u0435\u0441\u0442\u044b, \u0442\u043e\u0432\u0430\u0440\u044b \u0441 \u0434\u043e\u043b\u0433\u043e\u0439 \u043a\u0430\u0441\u0442\u043e\u043c\u0438\u0437\u0430\u0446\u0438\u0435\u0439. \u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u043c \u0433\u043e\u0442\u043e\u0432\u044b\u0435 \u0431\u043e\u043a\u0441\u044b \u0438 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u044b.</li> <li>High Effort: \u0420\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u0443\u0435\u043c \u0441\u043b\u043e\u0436\u043d\u044b\u0435 \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0438 \"Catalyst\" (\u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u0432\u043f\u0435\u0447\u0430\u0442\u043b\u0435\u043d\u0438\u044f) \u0438 \"Anchor\" (\u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0444\u043e\u0442\u043e\u0430\u043b\u044c\u0431\u043e\u043c\u0430).</li> </ul> </li> </ul>"},{"location":"recommendation/quiz_system/#13-goal","title":"1.3. \u0418\u043d\u0442\u0435\u043d\u0446\u0438\u044f (Goal)","text":"<ul> <li>\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u0430\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u044f: \u0413\u043b\u0430\u0432\u043d\u044b\u0439 \u0432\u0435\u043a\u0442\u043e\u0440 \u0440\u0430\u043d\u0436\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f (Primary Ranking Vector).</li> <li>\u0417\u0430\u0447\u0435\u043c: \u041e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u044d\u043c\u043e\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u0443\u044e \u0446\u0435\u043b\u044c \u043f\u043e\u0434\u0430\u0440\u043a\u0430. \u041e\u0434\u0438\u043d \u0438 \u0442\u043e\u0442 \u0436\u0435 \u0438\u043d\u0442\u0435\u0440\u0435\u0441 (\u043d\u0430\u043f\u0440., \"\u041a\u043e\u0444\u0435\") \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u043e\u0434\u0430\u043d \u043f\u043e-\u0440\u0430\u0437\u043d\u043e\u043c\u0443.</li> <li>\u041b\u043e\u0433\u0438\u043a\u0430:<ul> <li>Impress (\u0412\u0430\u0443-\u044d\u0444\u0444\u0435\u043a\u0442): \u0418\u0449\u0435\u043c \u0440\u0435\u0434\u043a\u043e\u0435, \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u043e\u0435, \u0442\u0440\u0435\u043d\u0434\u043e\u0432\u043e\u0435. (Mirror/Catalyst).</li> <li>Care (\u0417\u0430\u0431\u043e\u0442\u0430): \u0418\u0449\u0435\u043c \u043f\u043e\u043b\u0435\u0437\u043d\u043e\u0435, \u0443\u043f\u0440\u043e\u0449\u0430\u044e\u0449\u0435\u0435 \u0436\u0438\u0437\u043d\u044c, \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0435. (Optimizer).</li> <li>Formal (\u041f\u0440\u043e\u0442\u043e\u043a\u043e\u043b): \u0418\u0449\u0435\u043c \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0435, \u043f\u0440\u0435\u043c\u0438\u0430\u043b\u044c\u043d\u043e\u0435, \u043e\u0431\u0449\u0435\u043f\u0440\u0438\u0437\u043d\u0430\u043d\u043d\u043e\u0435. (Permission).</li> </ul> </li> </ul>"},{"location":"recommendation/quiz_system/#2-the-recipients-semantic-field","title":"\u0411\u043b\u043e\u043a 2: \u0424\u0430\u043a\u0442\u0443\u0440\u0430 \u041b\u0438\u0447\u043d\u043e\u0441\u0442\u0438 (The Recipient's Semantic Field)","text":"<p>\u0426\u0435\u043b\u044c: \u0421\u043e\u0431\u0440\u0430\u0442\u044c \"\u0421\u0435\u043c\u0430\u043d\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u041e\u0431\u043b\u0430\u043a\u043e\" (Semantic Seeds). \u042d\u0442\u043e \u0441\u044b\u0440\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 \u0433\u0438\u043f\u043e\u0442\u0435\u0437.</p>"},{"location":"recommendation/quiz_system/#21-demographics","title":"2.1. \u0414\u0435\u043c\u043e\u0433\u0440\u0430\u0444\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0411\u0430\u0437\u0438\u0441 (Demographics)","text":"<ul> <li>\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u0430\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u044f: \u041a\u0430\u043b\u0438\u0431\u0440\u043e\u0432\u043a\u0430 \u0431\u0430\u0437\u043e\u0432\u043e\u0439 \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u0438 (Baseline Calibration).</li> <li>\u0417\u0430\u0447\u0435\u043c: \u0420\u0435\u0448\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b \u0445\u043e\u043b\u043e\u0434\u043d\u043e\u0433\u043e \u0441\u0442\u0430\u0440\u0442\u0430 (Cold Start) \u0438 \u043e\u0442\u0441\u0435\u0447\u0435\u043d\u0438\u0435 \u0432\u043e\u0437\u0440\u0430\u0441\u0442\u043d\u044b\u0445 \u043d\u0435\u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0439.</li> <li>\u041b\u043e\u0433\u0438\u043a\u0430:<ul> <li>\u041f\u043e\u043b \u0438 \u0432\u043e\u0437\u0440\u0430\u0441\u0442 \u0434\u0430\u044e\u0442 \u043d\u0430\u0447\u0430\u043b\u044c\u043d\u044b\u0435 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0432\u0435\u0441\u0430 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f\u043c \u0442\u043e\u0432\u0430\u0440\u043e\u0432.</li> <li>\u041f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0433\u0440\u0443\u0431\u044b\u0435 \u043e\u0448\u0438\u0431\u043a\u0438 (\u043d\u0430\u043f\u0440., \u0434\u0435\u0442\u0441\u043a\u0438\u0435 \u0438\u0433\u0440\u0443\u0448\u043a\u0438 \u0434\u043b\u044f \u0432\u0437\u0440\u043e\u0441\u043b\u043e\u0433\u043e, \u0435\u0441\u043b\u0438 \u044d\u0442\u043e \u043d\u0435 \u043a\u0438\u0434\u0430\u043b\u0442\u044b).</li> </ul> </li> </ul>"},{"location":"recommendation/quiz_system/#22-topic-analysis","title":"2.2. \u041e\u0431\u043b\u0430\u0441\u0442\u0438 \u0418\u043d\u0442\u0435\u0440\u0435\u0441\u0430 (Topic Analysis)","text":"<ul> <li>\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u0430\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u044f: \u0422\u043e\u043f\u043b\u0438\u0432\u043e \u0434\u043b\u044f \u0413\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440\u0430 \u0413\u0438\u043f\u043e\u0442\u0435\u0437 (DHG Fuel).</li> <li>\u0417\u0430\u0447\u0435\u043c: \u041e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u0442\u0435\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u044b, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043c\u044b \u0431\u0443\u0434\u0435\u043c \u0438\u0441\u043a\u0430\u0442\u044c \u0440\u0435\u0448\u0435\u043d\u0438\u044f.</li> <li>\u041b\u043e\u0433\u0438\u043a\u0430:<ul> <li>\u041c\u044b \u043d\u0435 \u043f\u0440\u043e\u0441\u0438\u043c \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0442\u043e\u0432\u0430\u0440\u044b. \u041c\u044b \u043f\u0440\u043e\u0441\u0438\u043c \u043d\u0430\u0437\u0432\u0430\u0442\u044c \u0422\u0435\u043c\u044b (\u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u044b), \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0436\u0438\u0432\u0435\u0442 \u0447\u0435\u043b\u043e\u0432\u0435\u043a.</li> <li>\u0412\u0432\u043e\u0434: \u0421\u043b\u043e\u0432\u0430-\u0442\u0435\u0433\u0438 (\u043d\u0430\u043f\u0440., \"\u0420\u044b\u0431\u0430\u043b\u043a\u0430\", \"Python\", \"\u0419\u043e\u0433\u0430\").</li> <li>\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430: LLM \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0435\u0442 \u044d\u0442\u0438 \u0442\u0435\u0433\u0438 \u0432 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0435 \u043f\u043e\u0438\u0441\u043a\u043e\u0432\u044b\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b, \u0430\u0434\u0430\u043f\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u0434 \u0418\u043d\u0442\u0435\u043d\u0446\u0438\u044e \u0438\u0437 \u0411\u043b\u043e\u043a\u0430 1. (\u0420\u044b\u0431\u0430\u043b\u043a\u0430 + Care = \"\u0423\u0434\u043e\u0431\u043d\u043e\u0435 \u043a\u0440\u0435\u0441\u043b\u043e\", \u0420\u044b\u0431\u0430\u043b\u043a\u0430 + Impress = \"\u042d\u0445\u043e\u043b\u043e\u0442\").</li> </ul> </li> </ul>"},{"location":"recommendation/quiz_system/#3-gutg-mapping","title":"\u0411\u043b\u043e\u043a 3: \u041f\u0441\u0438\u0445\u043e\u043c\u0435\u0442\u0440\u0438\u044f (GUTG Mapping)","text":"<p>(\u041d\u0430 \u0441\u0442\u0430\u0434\u0438\u0438 \u043f\u0440\u043e\u0435\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. \u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0432\u043e\u043f\u0440\u043e\u0441\u044b, \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u044e\u0449\u0438\u0435 \u0433\u043b\u0443\u0431\u0438\u043d\u043d\u044b\u0435 \u0434\u0440\u0430\u0439\u0432\u0435\u0440\u044b \u043f\u043e\u0442\u0440\u0435\u0431\u043b\u0435\u043d\u0438\u044f: \u0414\u0435\u0444\u0438\u0446\u0438\u0442, \u042d\u043d\u0435\u0440\u0433\u0438\u044e \u0438 \u0410\u0440\u0445\u0435\u0442\u0438\u043f).</p>"},{"location":"recommendation/quiz_system/#data-flow","title":"\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f: Data Flow","text":"<pre><code>{\n  \"constraints\": {\n    \"relationship\": \"colleague\", // Intimacy Filter: Low\n    \"effort\": \"low\",             // Complexity Filter: Low\n    \"goal\": \"protocol\"           // Ranking: Safe Bets &gt; Unique\n  },\n  \"recipient_profile\": {\n    \"age\": 35,\n    \"gender\": \"male\",\n    \"topics\": [\"coffee\", \"startups\"] // Semantic Seeds\n  },\n  \"gutg_weights\": {\n    // \u0411\u0443\u0434\u0435\u0442 \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u043f\u043e\u0441\u043b\u0435 \u043f\u0440\u043e\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0411\u043b\u043e\u043a\u0430 3\n  }\n}\n</code></pre>"},{"location":"recommendation/theory/","title":"Grand Unified Theory of Gifting (GUTG) \ud83c\udf81","text":"<p>\"A gift is 50% item, 50% framing.\"</p> <p>\u0412 \u043e\u0441\u043d\u043e\u0432\u0435 Gifty \u043b\u0435\u0436\u0438\u0442 \u0433\u043b\u0443\u0431\u043e\u043a\u0430\u044f \u043f\u0441\u0438\u0445\u043e\u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c. \u0425\u043e\u0440\u043e\u0448\u0438\u0439 \u043f\u043e\u0434\u0430\u0440\u043e\u043a \u2014 \u044d\u0442\u043e \u043e\u0431\u044a\u0435\u043a\u0442 \u0438\u043b\u0438 \u043e\u043f\u044b\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0437\u0430\u043a\u0440\u044b\u0432\u0430\u0435\u0442 \u043e\u0434\u0438\u043d \u0438\u0437 \u043f\u044f\u0442\u0438 \u043f\u0441\u0438\u0445\u043e\u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0420\u0430\u0437\u0440\u044b\u0432\u043e\u0432 (Gaps) \u043c\u0435\u0436\u0434\u0443 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u044c\u044e \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u044f \u0438 \u0435\u0433\u043e \u0436\u0435\u043b\u0430\u0435\u043c\u043e\u0439 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u044c\u044e.</p>"},{"location":"recommendation/theory/#5-dimensions-of-gifting","title":"5 Dimensions of Gifting","text":""},{"location":"recommendation/theory/#1-the-mirror-the-recognition-gap","title":"1. The Mirror (The Recognition Gap)","text":"<p>Gap: \"\u0412\u0438\u0434\u0438\u0442 \u043b\u0438 \u043a\u0442\u043e-\u0442\u043e, \u043a\u0442\u043e \u044f \u0435\u0441\u0442\u044c \u043d\u0430 \u0441\u0430\u043c\u043e\u043c \u0434\u0435\u043b\u0435?\" Slogan: \"I see who you are.\"</p> <p>Human Explanation: \u041b\u044e\u0434\u0438 \u0445\u043e\u0442\u044f\u0442 \u0431\u044b\u0442\u044c \u043f\u043e\u043d\u044f\u0442\u044b\u043c\u0438. \u0411\u043e\u043b\u044c\u0448\u0438\u043d\u0441\u0442\u0432\u043e \u043f\u043e\u0434\u0430\u0440\u043a\u043e\u0432 \u2014 \"\u0434\u0435\u0436\u0443\u0440\u043d\u044b\u0435\" (\u0433\u0435\u043b\u044c \u0434\u043b\u044f \u0434\u0443\u0448\u0430, \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442), \u043e\u043d\u0438 \u0433\u043e\u0432\u043e\u0440\u044f\u0442: \"\u042f \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u043b \u0447\u0442\u043e-\u0442\u043e \u043f\u043e\u0434\u0430\u0440\u0438\u0442\u044c\". \u041f\u043e\u0434\u0430\u0440\u043e\u043a-\u0417\u0435\u0440\u043a\u0430\u043b\u043e \u0433\u043e\u0432\u043e\u0440\u0438\u0442: \"\u042f \u0437\u043d\u0430\u044e \u0442\u0435\u0431\u044f \u043d\u0430\u0441\u0442\u043e\u044f\u0449\u0435\u0433\u043e. \u042f \u0437\u043d\u0430\u044e \u0442\u0432\u043e\u0438 \u0441\u0442\u0440\u0430\u043d\u043d\u043e\u0441\u0442\u0438, \u0442\u0432\u043e\u0439 \u0432\u043a\u0443\u0441 \u0438 \u0442\u0432\u043e\u044e \u0431\u0430\u043d\u0434\u0443\". \u042d\u0442\u043e \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044f \u043b\u0438\u0447\u043d\u043e\u0441\u0442\u0438.</p>"},{"location":"recommendation/theory/#the-fanatic-obessesion-fuel","title":"The Fanatic (Obessesion Fuel): \"\u042f \u0437\u043d\u0430\u044e, \u043e\u0442 \u0447\u0435\u0433\u043e \u0443 \u0442\u0435\u0431\u044f \u0433\u043e\u0440\u044f\u0442 \u0433\u043b\u0430\u0437\u0430\"","text":"<p>\u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u044c, \u0447\u0442\u043e \u0443 \u0442\u0432\u043e\u0435\u0433\u043e \u0434\u0440\u0443\u0433\u0430 \u0435\u0441\u0442\u044c \"\u043f\u0443\u043d\u043a\u0442\u0438\u043a\". \u0422\u0435\u043c\u0430, \u043f\u0440\u043e \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u043e\u043d \u043c\u043e\u0436\u0435\u0442 \u0433\u043e\u0432\u043e\u0440\u0438\u0442\u044c \u0447\u0430\u0441\u0430\u043c\u0438, \u043f\u043e\u043a\u0430 \u0442\u044b \u043d\u0435 \u043d\u0430\u0447\u043d\u0435\u0448\u044c \u0437\u0435\u0432\u0430\u0442\u044c. \u042d\u0442\u043e \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0441\u0435\u0440\u0438\u0430\u043b \"\u041e\u0444\u0438\u0441\", \u0433\u0440\u0443\u043f\u043f\u0430 BTS, \u043c\u0430\u0440\u043a\u0430 BMW, \u0432\u0438\u0434\u0435\u043e\u0438\u0433\u0440\u0430 Dota 2 \u0438\u043b\u0438 \u0434\u0430\u0436\u0435 \u043f\u0440\u043e\u0441\u0442\u043e \"\u0434\u0438\u0437\u0430\u0439\u043d \u0441\u0442\u0443\u043b\u044c\u0435\u0432 20 \u0432\u0435\u043a\u0430\".</p> <p>\u041a\u043e\u0433\u0434\u0430 \u0442\u044b \u0434\u0430\u0440\u0438\u0448\u044c \u043f\u043e\u0434\u0430\u0440\u043e\u043a \u0442\u0438\u043f\u0430 Fanatic, \u0442\u044b \u0433\u043e\u0432\u043e\u0440\u0438\u0448\u044c:</p> <p>\"\u042f \u043d\u0435 \u0441\u0447\u0438\u0442\u0430\u044e \u0442\u0432\u043e\u0435 \u0443\u0432\u043b\u0435\u0447\u0435\u043d\u0438\u0435 \u0441\u0442\u0440\u0430\u043d\u043d\u044b\u043c. \u041d\u0430\u043e\u0431\u043e\u0440\u043e\u0442, \u044f \u0437\u0430\u043f\u043e\u043c\u043d\u0438\u043b, \u0447\u0442\u043e \u0442\u044b \u044d\u0442\u043e \u043b\u044e\u0431\u0438\u0448\u044c, \u0438 \u043d\u0430\u0448\u0435\u043b \u0447\u0442\u043e-\u0442\u043e \u043a\u0440\u0443\u0442\u043e\u0435 \u0438\u043c\u0435\u043d\u043d\u043e \u0438\u0437 \u044d\u0442\u043e\u0433\u043e \u043c\u0438\u0440\u0430.\"</p> <p>\u042d\u0442\u043e \u043f\u043e\u0434\u0430\u0440\u043e\u043a-\u0432\u0430\u043b\u0438\u0434\u0430\u0442\u043e\u0440. \u041e\u043d \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442, \u0447\u0442\u043e \u0442\u044b \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0448\u044c \u0435\u0433\u043e \u0441\u0442\u0440\u0430\u0441\u0442\u044c.</p> <p>\u0413\u043b\u0430\u0432\u043d\u044b\u0439 \u0441\u0435\u043a\u0440\u0435\u0442: \u041f\u043e\u0434\u0430\u0440\u043e\u043a \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \"\u0434\u043b\u044f \u0441\u0432\u043e\u0438\u0445\".</p> <ul> <li>\u274c \u041f\u043b\u043e\u0445\u043e: \u041a\u0443\u043f\u0438\u0442\u044c \u0444\u0430\u043d\u0430\u0442\u0443 \"\u0413\u0430\u0440\u0440\u0438 \u041f\u043e\u0442\u0442\u0435\u0440\u0430\" \u043e\u0431\u044b\u0447\u043d\u0443\u044e \u043a\u0440\u0443\u0436\u043a\u0443 \u0441 \u0433\u0435\u0440\u0431\u043e\u043c \u0413\u0440\u0438\u0444\u0444\u0438\u043d\u0434\u043e\u0440\u0430, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0435\u0441\u0442\u044c \u0432 \u043a\u0430\u0436\u0434\u043e\u043c \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0435. \u042d\u0442\u043e \u043f\u043e\u043f\u0441\u0430.</li> <li>\u2705 \u0425\u043e\u0440\u043e\u0448\u043e: \u041d\u0430\u0439\u0442\u0438 \u0440\u0435\u043f\u043b\u0438\u043a\u0443 \u043f\u0430\u043b\u043e\u0447\u043a\u0438 \u0440\u0435\u0434\u043a\u043e\u0433\u043e \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430 \u0438\u043b\u0438 \u0430\u0440\u0442\u0431\u0443\u043a \u0441 \u043a\u043e\u043d\u0446\u0435\u043f\u0442\u0430\u043c\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0435 \u043f\u043e\u0448\u043b\u0438 \u0432 \u0444\u0438\u043b\u044c\u043c. \u042d\u0442\u043e \u0443\u0432\u0430\u0436\u0435\u043d\u0438\u0435.</li> </ul> <p>\u041f\u043e\u0447\u0435\u043c\u0443 \u044d\u0442\u043e \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442: \u0412 \u043c\u0438\u0440\u0435, \u0433\u0434\u0435 \u0432\u0441\u0435 \u0441\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u044e\u0442 \"\u043d\u0443 \u043a\u0430\u043a \u0440\u0430\u0431\u043e\u0442\u0430?\", \u0442\u044b \u0434\u0430\u0440\u0438\u0448\u044c \u0435\u043c\u0443 \u043a\u0443\u0441\u043e\u0447\u0435\u043a \u0442\u043e\u0433\u043e \u043c\u0438\u0440\u0430, \u0433\u0434\u0435 \u043e\u043d \u0441\u0447\u0430\u0441\u0442\u043b\u0438\u0432.</p>"},{"location":"recommendation/theory/#the-aesthetic-style-language-match","title":"The Aesthetic (Style Language Match): \"\u042f \u0437\u043d\u0430\u044e \u0442\u0432\u043e\u0439 \u0432\u0438\u0437\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u044f\u0437\u044b\u043a\"","text":"<p>\u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u044c, \u0447\u0442\u043e \u0436\u0438\u0437\u043d\u044c \u0442\u0432\u043e\u0435\u0433\u043e \u0434\u0440\u0443\u0433\u0430 \u2014 \u044d\u0442\u043e \u0444\u0438\u043b\u044c\u043c \u0441\u043e \u0441\u0432\u043e\u0438\u043c \u0441\u0442\u0438\u043b\u0435\u043c.</p> <ul> <li>\u041c\u043e\u0436\u0435\u0442, \u044d\u0442\u043e \u0442\u0443\u043c\u0430\u043d\u043d\u044b\u0439 \u043a\u0438\u0431\u0435\u0440\u043f\u0430\u043d\u043a (\u043d\u0435\u043e\u043d, \u0442\u0435\u0445\u043d\u0438\u043a\u0430, \u0442\u0435\u043c\u043d\u043e\u0442\u0430).</li> <li>\u0418\u043b\u0438 \u0441\u043e\u043b\u043d\u0435\u0447\u043d\u044b\u0439 \"Call Me by Your Name\" (\u0432\u0438\u043b\u043b\u0430, \u043b\u0435\u043d, \u043f\u0435\u0440\u0441\u0438\u043a\u0438).</li> <li>\u0418\u043b\u0438 \u0437\u0430\u0433\u0430\u0434\u043e\u0447\u043d\u0430\u044f Dark Academia (\u0442\u0432\u0438\u0434, \u0441\u0442\u0430\u0440\u044b\u0435 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438, \u043a\u043e\u0436\u0430\u043d\u044b\u0435 \u043f\u0435\u0440\u0435\u043f\u043b\u0435\u0442\u044b).</li> </ul> <p>\u041a\u043e\u0433\u0434\u0430 \u0442\u044b \u0434\u0430\u0440\u0438\u0448\u044c \u043f\u043e\u0434\u0430\u0440\u043e\u043a \u0442\u0438\u043f\u0430 Aesthetic, \u0442\u044b \u043f\u0440\u0438\u043d\u043e\u0441\u0438\u0448\u044c \u0440\u0435\u043a\u0432\u0438\u0437\u0438\u0442 \u0434\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u0444\u0438\u043b\u044c\u043c\u0430. \u0422\u044b \u0433\u043e\u0432\u043e\u0440\u0438\u0448\u044c:</p> <p>\"\u042f \u0432\u0438\u0436\u0443 \u0430\u0442\u043c\u043e\u0441\u0444\u0435\u0440\u0443, \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u0442\u044b \u0432\u043e\u043a\u0440\u0443\u0433 \u0441\u0435\u0431\u044f \u0441\u0442\u0440\u043e\u0438\u0448\u044c. \u042f \u043d\u0435 \u043f\u0440\u0438\u043d\u0435\u0441\u0443 \u0442\u0435\u0431\u0435 \u0447\u0443\u0436\u0435\u0440\u043e\u0434\u043d\u044b\u0439 \u043f\u0440\u0435\u0434\u043c\u0435\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0435\u0451 \u0440\u0430\u0437\u0440\u0443\u0448\u0438\u0442\".</p> <p>\u0413\u043b\u0430\u0432\u043d\u044b\u0439 \u0441\u0435\u043a\u0440\u0435\u0442: \u042d\u0441\u0442\u0435\u0442\u0438\u043a\u0430 \u0438\u043c\u0435\u0435\u0442 \u0434\u0432\u043e\u0439\u043d\u0443\u044e \u043f\u0440\u0438\u0440\u043e\u0434\u0443.</p> <ol> <li>\u041a\u0430\u043a \u0414\u0440\u0430\u0439\u0432\u0435\u0440 (\u0426\u0435\u043b\u044c): \u041a\u043e\u0433\u0434\u0430 \u043a\u0440\u0430\u0441\u043e\u0442\u0430 \u2014 \u044d\u0442\u043e \u0433\u043b\u0430\u0432\u043d\u0430\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u044f. \u0412\u0430\u0437\u0430 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043d\u0435\u0443\u0434\u043e\u0431\u043d\u043e\u0439, \u043d\u043e \u0435\u0441\u043b\u0438 \u044d\u0442\u043e \u0438\u0434\u0435\u0430\u043b\u044c\u043d\u044b\u0439 \"Scandi\" \u2014 \u044d\u0442\u043e \u043f\u043e\u0431\u0435\u0434\u0430.</li> <li>\u041a\u0430\u043a \u0424\u0438\u043b\u044c\u0442\u0440 (\u0423\u0441\u043b\u043e\u0432\u0438\u0435): \u041a\u043e\u0433\u0434\u0430 \u043c\u044b \u0434\u0430\u0440\u0438\u043c \u043f\u043e\u043b\u0435\u0437\u043d\u0443\u044e \u0432\u0435\u0449\u044c (\u043f\u044b\u043b\u0435\u0441\u043e\u0441, \u043d\u043e\u0436), \u043e\u043d\u0430 \u043e\u0431\u044f\u0437\u0430\u043d\u0430 \u043f\u043e\u043f\u0430\u0434\u0430\u0442\u044c \u0432 \u0441\u0442\u0438\u043b\u044c. \u041c\u0438\u043d\u0438\u043c\u0430\u043b\u0438\u0441\u0442\u0443 \u043d\u0435\u043b\u044c\u0437\u044f \u0434\u0430\u0440\u0438\u0442\u044c \u043f\u0435\u0441\u0442\u0440\u044b\u0439 \u043c\u0443\u043b\u044c\u0442\u0438\u0442\u0443\u043b \u2014 \u0434\u043b\u044f \u043d\u0435\u0433\u043e \u044d\u0442\u043e \u0432\u0438\u0437\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u0448\u0443\u043c.</li> </ol> <p>\u041f\u043e\u0447\u0435\u043c\u0443 \u044d\u0442\u043e \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442: \u041b\u044e\u0434\u0438 \u0442\u0440\u0430\u0442\u044f\u0442 \u0433\u043e\u0434\u044b, \u0447\u0442\u043e\u0431\u044b \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0432\u043e\u043a\u0440\u0443\u0433 \u0441\u0435\u0431\u044f \"\u0441\u0432\u043e\u0439 \u043c\u0438\u0440\". \u0422\u0432\u043e\u0439 \u043f\u043e\u0434\u0430\u0440\u043e\u043a \u043b\u0438\u0431\u043e \u0434\u043e\u043f\u043e\u043b\u043d\u044f\u0435\u0442 \u044d\u0442\u043e\u0442 \u043c\u0438\u0440, \u043b\u0438\u0431\u043e \u043c\u0443\u0441\u043e\u0440\u0438\u0442 \u0432 \u043d\u0435\u043c.</p>"},{"location":"recommendation/theory/#the-taste-token-micro-preference-hit","title":"The Taste Token (Micro-Preference Hit)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u042f \u0437\u0430\u043c\u0435\u0442\u0438\u043b \u044d\u0442\u0443 \u043c\u0430\u043b\u0435\u043d\u044c\u043a\u0443\u044e \u0434\u0435\u0442\u0430\u043b\u044c\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u0421\u043d\u0430\u0439\u043f\u0435\u0440\u0441\u043a\u0438\u0439 \u0432\u044b\u0441\u0442\u0440\u0435\u043b \u0432 \u0441\u043f\u0435\u0446\u0438\u0444\u0438\u0447\u043d\u044b\u0439 \u0432\u043a\u0443\u0441. \u041e\u043d \u043f\u044c\u0435\u0442 \u043a\u043e\u0444\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u0438\u0437 \u042d\u0444\u0438\u043e\u043f\u0438\u0438? \u041e\u043d\u0430 \u043f\u0438\u0448\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u0440\u0443\u0447\u043a\u0430\u043c\u0438 0.38\u043c\u043c? \u041f\u043e\u0434\u0430\u0440\u0438\u0442\u0435 \u0438\u043c\u0435\u043d\u043d\u043e \u044d\u0442\u043e. \u042d\u0442\u043e \u0433\u043e\u0432\u043e\u0440\u0438\u0442 \u043e \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0438 \u0433\u0440\u043e\u043c\u0447\u0435, \u0447\u0435\u043c \u043c\u0430\u0448\u0438\u043d\u0430.\n*   *AI Cue*: \"only drinks\", \"hates when\", \"specific brand\".\n</code></pre>"},{"location":"recommendation/theory/#the-values-signal-beliefs-principles","title":"The Values Signal (Beliefs &amp; Principles)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u042f \u0443\u0432\u0430\u0436\u0430\u044e \u0442\u0432\u043e\u0438 \u043f\u0440\u0438\u043d\u0446\u0438\u043f\u044b\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u041f\u043e\u0434\u0430\u0440\u043e\u043a, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0430\u0435\u0442 \u0435\u0433\u043e \u044d\u0442\u0438\u043a\u0443. \u0412\u0435\u0433\u0430\u043d\u0443 \u2014 \u0432\u0435\u0433\u0430\u043d\u0441\u043a\u0443\u044e \u043a\u043e\u0436\u0443. \u042d\u043a\u043e\u043b\u043e\u0433\u0443 \u2014 \u043c\u043d\u043e\u0433\u043e\u0440\u0430\u0437\u043e\u0432\u0443\u044e \u0441\u0442\u0438\u043b\u044c\u043d\u0443\u044e \u0431\u0443\u0442\u044b\u043b\u043a\u0443. \u0412\u044b \u0433\u043e\u0432\u043e\u0440\u0438\u0442\u0435: \"\u0422\u0432\u043e\u0438 \u0446\u0435\u043d\u043d\u043e\u0441\u0442\u0438 \u0432\u0430\u0436\u043d\u044b\".\n*   *AI Cue*: \"cares about\", \"volunteers\", \"eco-friendly\".\n</code></pre>"},{"location":"recommendation/theory/#the-tribe-badge-belonging","title":"The Tribe Badge (Belonging)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u0422\u044b \u2014 \u0447\u0430\u0441\u0442\u044c \u0441\u0432\u043e\u0435\u0439 \u0441\u0442\u0430\u0438\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u041f\u043e\u0434\u0430\u0440\u043e\u043a, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u043e\u043d\u044f\u0442\u0435\u043d \u0442\u043e\u043b\u044c\u043a\u043e \"\u0441\u0432\u043e\u0438\u043c\". \u041a\u0435\u0439\u043a\u0430\u043f\u044b \u0434\u043b\u044f \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0438\u0441\u0442\u0430, \u043c\u0430\u0433\u043d\u0435\u0437\u0438\u044f \u0434\u043b\u044f \u0441\u043a\u0430\u043b\u043e\u043b\u0430\u0437\u0430. \u042d\u0442\u043e \u0443\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u0435\u043d\u0438\u0435 \u0447\u043b\u0435\u043d\u0441\u0442\u0432\u0430 \u0432 \u043a\u043b\u0443\u0431\u0435.\n*   *AI Cue*: \"community\", \"meetups\", \"discord\".\n</code></pre>"},{"location":"recommendation/theory/#the-personal-myth-symbols-narratives","title":"The Personal Myth (Symbols &amp; Narratives)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u042f \u0432\u0435\u0440\u044e \u0432 \u0442\u0432\u043e\u044e \u043b\u0435\u0433\u0435\u043d\u0434\u0443\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u0423 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0435\u0441\u0442\u044c \u0438\u0441\u0442\u043e\u0440\u0438\u044f \u043f\u0440\u043e \u0441\u0435\u0431\u044f: \"\u042f \u2014 \u041f\u0443\u0442\u0435\u0448\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u0438\u043a\", \"\u042f \u2014 \u0422\u0432\u043e\u0440\u0435\u0446\". \u041f\u043e\u0434\u0430\u0440\u043e\u043a \u2014 \u044d\u0442\u043e \u0430\u0440\u0442\u0435\u0444\u0430\u043a\u0442 \u0434\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u0433\u0435\u0440\u043e\u044f. \u041a\u043e\u043c\u043f\u0430\u0441 \u0434\u043b\u044f \u043f\u0443\u0442\u0435\u0448\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u0438\u043a\u0430 (\u0434\u0430\u0436\u0435 \u0435\u0441\u043b\u0438 \u0443 \u043d\u0435\u0433\u043e \u0435\u0441\u0442\u044c GPS).\n*   *AI Cue*: \"I'm the kind of person who...\", \"always building\".\n</code></pre>"},{"location":"recommendation/theory/#2-the-optimizer-the-friction-gap","title":"2. The Optimizer (The Friction Gap)","text":"<p>Gap: \"\u041f\u043e\u0447\u0435\u043c\u0443 \u0436\u0438\u0437\u043d\u044c \u0442\u0430\u043a\u0430\u044f \u0441\u043b\u043e\u0436\u043d\u0430\u044f?\" Slogan: \"I make your life smoother.\"</p> <p>Human Explanation: \u0416\u0438\u0437\u043d\u044c \u043f\u043e\u043b\u043d\u0430 \u043c\u0435\u043b\u043a\u043e\u0433\u043e \"\u043f\u0435\u0441\u043a\u0430\" \u2014 \u0442\u0443\u043f\u044b\u0435 \u043d\u043e\u0436\u0438, \u0432\u0435\u0447\u043d\u043e \u0440\u0430\u0437\u0440\u044f\u0436\u0435\u043d\u043d\u044b\u0439 \u0442\u0435\u043b\u0435\u0444\u043e\u043d, \u0445\u0430\u043e\u0441 \u0432 \u043f\u0440\u043e\u0432\u043e\u0434\u0430\u0445. \u041c\u044b \u0442\u0435\u0440\u043f\u0438\u043c \u044d\u0442\u043e, \u043f\u043e\u0442\u043e\u043c\u0443 \u0447\u0442\u043e \u0436\u0430\u043b\u043a\u043e \u0434\u0435\u043d\u0435\u0433 \u0438\u043b\u0438 \"\u0440\u0443\u043a\u0438 \u043d\u0435 \u0434\u043e\u0445\u043e\u0434\u044f\u0442\". \u041f\u043e\u0434\u0430\u0440\u043e\u043a-\u041e\u043f\u0442\u0438\u043c\u0430\u0439\u0437\u0435\u0440 \u2014 \u044d\u0442\u043e \"\u0436\u0438\u0437\u043d\u0435\u043d\u043d\u044b\u0439 \u043f\u0430\u0442\u0447\". \u0412\u044b \u0443\u0431\u0438\u0440\u0430\u0435\u0442\u0435 \u0440\u0430\u0437\u0434\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0438 \u0434\u0430\u0440\u0438\u0442\u0435 \u0441\u0430\u043c\u043e\u0435 \u0446\u0435\u043d\u043d\u043e\u0435 \u2014 \u043f\u043e\u043a\u043e\u0439 \u0438 \u0432\u0440\u0435\u043c\u044f.</p>"},{"location":"recommendation/theory/#the-upgrade-quality-lift","title":"The Upgrade (Quality Lift)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \u0422\u043e \u0436\u0435 \u0441\u0430\u043c\u043e\u0435, \u0442\u043e\u043b\u044c\u043a\u043e *\u043d\u043e\u0440\u043c\u0430\u043b\u044c\u043d\u043e\u0435*.\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u0417\u0430\u043c\u0435\u043d\u0438\u0442\u0435 \u0435\u0433\u043e \u0434\u0435\u0448\u0435\u0432\u044b\u0439 \u0444\u0435\u043d \u043d\u0430 Dyson. \u0417\u0430\u043c\u0435\u043d\u0438\u0442\u0435 \u0435\u0433\u043e \u0441\u0442\u0430\u0440\u0443\u044e \u043c\u044b\u0448\u043a\u0443 \u043d\u0430 \u0441\u0443\u043f\u0435\u0440-\u0443\u0434\u043e\u0431\u043d\u0443\u044e. \u0421\u0446\u0435\u043d\u0430\u0440\u0438\u0439 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u043d\u0435 \u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f, \u043d\u043e \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u0436\u0438\u0437\u043d\u0438 \u0440\u0430\u0441\u0442\u0435\u0442.\n*   *AI Cue*: \"uses every day\", \"basic version\".\n</code></pre>"},{"location":"recommendation/theory/#the-fix-remove-bottleneck","title":"The Fix (Remove Bottleneck)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u042f \u0443\u0431\u0440\u0430\u043b \u044d\u0442\u043e\u0442 \u043a\u0430\u043c\u0435\u043d\u044c \u0438\u0437 \u0442\u0432\u043e\u0435\u0433\u043e \u0431\u043e\u0442\u0438\u043d\u043a\u0430\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u0420\u0435\u0448\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0439 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b. \u0412\u0435\u0447\u043d\u043e \u0442\u0435\u0440\u044f\u0435\u0442 \u043a\u043b\u044e\u0447\u0438? AirTag. \u0425\u043e\u043b\u043e\u0434\u043d\u043e \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c? \u0422\u0435\u043f\u043b\u044b\u0439 \u043a\u043e\u0432\u0440\u0438\u043a \u0434\u043b\u044f \u043d\u043e\u0433.\n*   *AI Cue*: \"hates when\", \"always forgets\", \"annoying\".\n</code></pre>"},{"location":"recommendation/theory/#the-system-organization","title":"The System (Organization)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u041f\u043e\u0431\u0435\u0434\u0430 \u043d\u0430\u0434 \u0445\u0430\u043e\u0441\u043e\u043c\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u0414\u043b\u044f \u0442\u0435\u0445, \u0443 \u043a\u043e\u0433\u043e \u0431\u0430\u0440\u0434\u0430\u043a (\u0432 \u0432\u0435\u0449\u0430\u0445 \u0438\u043b\u0438 \u0433\u043e\u043b\u043e\u0432\u0435). \u041e\u0440\u0433\u0430\u043d\u0430\u0439\u0437\u0435\u0440\u044b, \u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0449\u0438\u043a\u0438, \u0434\u043e\u043a-\u0441\u0442\u0430\u043d\u0446\u0438\u0438. \u042d\u0442\u043e \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0447\u0443\u0432\u0441\u0442\u0432\u043e \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044f.\n*   *AI Cue*: \"messy\", \"can't find\", \"clutter\".\n</code></pre>"},{"location":"recommendation/theory/#the-automation-autopilot","title":"The Automation (Autopilot)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u041f\u0443\u0441\u0442\u044c \u0440\u043e\u0431\u043e\u0442\u044b \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0442\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u0421\u043d\u044f\u0442\u0438\u0435 \u0440\u0443\u0442\u0438\u043d\u044b. \u0420\u043e\u0431\u043e\u0442-\u043f\u044b\u043b\u0435\u0441\u043e\u0441, \u0430\u0432\u0442\u043e\u043f\u043e\u0438\u043b\u043a\u0430 \u0434\u043b\u044f \u043a\u043e\u0442\u0430. \u0412\u044b \u0434\u0430\u0440\u0438\u0442\u0435 \u0441\u0432\u043e\u0431\u043e\u0434\u0443 \u043e\u0442 \u0441\u043a\u0443\u0447\u043d\u044b\u0445 \u0434\u0435\u043b.\n*   *AI Cue*: \"chore\", \"no time\", \"wish it just worked\".\n</code></pre>"},{"location":"recommendation/theory/#the-buffer-preparedness","title":"The Buffer (Preparedness)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u0422\u044b \u0433\u043e\u0442\u043e\u0432 \u043a\u043e \u0432\u0441\u0435\u043c\u0443\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u0421\u043d\u044f\u0442\u0438\u0435 \u0442\u0440\u0435\u0432\u043e\u0433\u0438 \"\u0430 \u0447\u0442\u043e \u0435\u0441\u043b\u0438...\". \u041c\u043e\u0449\u043d\u044b\u0439 \u043f\u0430\u0443\u044d\u0440\u0431\u0430\u043d\u043a, \u0434\u043e\u0440\u043e\u0436\u043d\u0430\u044f \u0430\u043f\u0442\u0435\u0447\u043a\u0430, \u043c\u0443\u043b\u044c\u0442\u0438\u0442\u0443\u043b. \u0427\u0443\u0432\u0441\u0442\u0432\u043e \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u0432 \u043a\u0430\u0440\u043c\u0430\u043d\u0435.\n*   *AI Cue*: \"unprepared\", \"disaster\", \"worries about\".\n</code></pre>"},{"location":"recommendation/theory/#the-comfort-regulator-load-reduction","title":"The Comfort Regulator (Load Reduction)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u0422\u0432\u043e\u0435\u043c\u0443 \u0442\u0435\u043b\u0443 \u0441\u0442\u0430\u043d\u0435\u0442 \u043b\u0435\u0433\u0447\u0435\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u0424\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0437\u0430\u0431\u043e\u0442\u0430. \u0423\u0442\u044f\u0436\u0435\u043b\u0435\u043d\u043d\u043e\u0435 \u043e\u0434\u0435\u044f\u043b\u043e (\u0441\u043d\u0438\u0436\u0430\u0435\u0442 \u0442\u0440\u0435\u0432\u043e\u0433\u0443), \u043c\u0430\u0441\u0441\u0430\u0436\u0435\u0440 \u0434\u043b\u044f \u0448\u0435\u0438, \u0448\u0442\u043e\u0440\u044b \u0431\u043b\u044d\u043a\u0430\u0443\u0442.\n*   *AI Cue*: \"tired\", \"stressed\", \"can't sleep\".\n</code></pre>"},{"location":"recommendation/theory/#3-the-catalyst-the-potential-gap","title":"3. The Catalyst (The Potential Gap)","text":"<p>Gap: \"\u041a\u0435\u043c \u0431\u044b \u044f \u043c\u043e\u0433 \u0441\u0442\u0430\u0442\u044c?\" Slogan: \"I support who you\u2019re becoming.\"</p> <p>Human Explanation: \u0423 \u0432\u0441\u0435\u0445 \u043d\u0430\u0441 \u0435\u0441\u0442\u044c \"\u042f \u0432 \u0431\u0443\u0434\u0443\u0449\u0435\u043c\": \u0445\u0443\u0434\u043e\u0436\u043d\u0438\u043a, \u0431\u0435\u0433\u0443\u043d, \u0448\u0435\u0444-\u043f\u043e\u0432\u0430\u0440. \u041d\u043e \u043d\u0430\u0447\u0430\u0442\u044c \u0441\u0442\u0440\u0430\u0448\u043d\u043e. \"\u0412\u0434\u0440\u0443\u0433 \u043d\u0435 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u0441\u044f?\", \"\u041d\u0435 \u0437\u043d\u0430\u044e, \u0447\u0442\u043e \u043a\u0443\u043f\u0438\u0442\u044c\". Catalyst \u2014 \u044d\u0442\u043e \u043c\u044f\u0433\u043a\u0438\u0439 \u0442\u043e\u043b\u0447\u043e\u043a \u0432 \u0441\u043f\u0438\u043d\u0443. \u0412\u044b \u0433\u043e\u0432\u043e\u0440\u0438\u0442\u0435: \"\u0423 \u0442\u0435\u0431\u044f \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u0441\u044f, \u0432\u043e\u0442 \u0442\u0435\u0431\u0435 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u044b\".</p>"},{"location":"recommendation/theory/#the-starter-low-barrier","title":"The Starter (Low Barrier)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u041f\u0440\u043e\u0441\u0442\u043e \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439, \u044d\u0442\u043e \u043b\u0435\u0433\u043a\u043e\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u0423\u0431\u0438\u0440\u0430\u0435\u0442 \u0441\u0442\u0440\u0430\u0445 \u0447\u0438\u0441\u0442\u043e\u0433\u043e \u043b\u0438\u0441\u0442\u0430. \u041d\u0430\u0431\u043e\u0440 \u0434\u043b\u044f \u0432\u044b\u0440\u0430\u0449\u0438\u0432\u0430\u043d\u0438\u044f \u043c\u0438\u043a\u0440\u043e\u0437\u0435\u043b\u0435\u043d\u0438 (\u0430 \u043d\u0435 \u0446\u0435\u043b\u0430\u044f \u0442\u0435\u043f\u043b\u0438\u0446\u0430). \u0423\u043a\u0443\u043b\u0435\u043b\u0435 (\u0430 \u043d\u0435 \u0441\u043b\u043e\u0436\u043d\u0430\u044f \u0433\u0438\u0442\u0430\u0440\u0430).\n*   *AI Cue*: \"want to try\", \"curious about\".\n</code></pre>"},{"location":"recommendation/theory/#the-commitment-consistency","title":"The Commitment (Consistency)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u0427\u0442\u043e\u0431\u044b \u0442\u044b \u043d\u0435 \u0431\u0440\u043e\u0441\u0438\u043b\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u041f\u043e\u043c\u043e\u0433\u0430\u0435\u0442 \u043f\u0440\u0435\u0432\u0440\u0430\u0442\u0438\u0442\u044c \u0438\u0441\u043a\u0440\u0443 \u0432 \u043f\u0440\u0438\u0432\u044b\u0447\u043a\u0443. \u041a\u0440\u0430\u0441\u0438\u0432\u044b\u0439 \u043a\u043e\u0432\u0440\u0438\u043a \u0434\u043b\u044f \u0439\u043e\u0433\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 *\u0445\u043e\u0447\u0435\u0442\u0441\u044f* \u0440\u0430\u0441\u0441\u0442\u0435\u043b\u0438\u0442\u044c. \u041f\u043e\u0434\u043f\u0438\u0441\u043a\u0430 \u043d\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435.\n*   *AI Cue*: \"started but stopped\", \"hard to stick to\".\n</code></pre>"},{"location":"recommendation/theory/#the-accelerator-level-up","title":"The Accelerator (Level Up)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u0422\u044b \u043f\u0440\u043e\u0444\u0438, \u0442\u0435\u0431\u0435 \u043d\u0443\u0436\u0435\u043d \u043f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u0414\u043b\u044f \u0442\u0435\u0445, \u043a\u0442\u043e *\u0443\u0436\u0435* \u0448\u044c\u0435\u0442, \u0431\u0435\u0433\u0430\u0435\u0442 \u0438\u043b\u0438 \u0441\u043d\u0438\u043c\u0430\u0435\u0442. \u0414\u0430\u0440\u0438\u043c \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u043e\u043d \u0437\u0430\u0436\u0430\u043b \u043a\u0443\u043f\u0438\u0442\u044c. \u041e\u0431\u044a\u0435\u043a\u0442\u0438\u0432 L-\u0441\u0435\u0440\u0438\u0438, \u043a\u0440\u043e\u0441\u0441\u043e\u0432\u043a\u0438 Carbon.\n*   *AI Cue*: \"doing it for years\", \"serious about\".\n</code></pre>"},{"location":"recommendation/theory/#the-horizon-expander-exposure","title":"The Horizon Expander (Exposure)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438, \u043a\u0430\u043a \u0431\u044b\u0432\u0430\u0435\u0442\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u0412\u0434\u043e\u0445\u043d\u043e\u0432\u0435\u043d\u0438\u0435. \u0411\u0438\u043b\u0435\u0442 \u043d\u0430 \u043d\u0435\u043e\u0431\u044b\u0447\u043d\u0443\u044e \u0432\u044b\u0441\u0442\u0430\u0432\u043a\u0443, \u043a\u043d\u0438\u0433\u0430 \u043f\u043e \u0442\u0435\u043c\u0435, \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u043e\u043d \u043d\u0435 \u0437\u043d\u0430\u043b. \u0420\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0435 \u043a\u0440\u0443\u0433\u043e\u0437\u043e\u0440\u0430.\n*   *AI Cue*: \"bored\", \"stuck\", \"needs inspiration\".\n</code></pre>"},{"location":"recommendation/theory/#the-confidence-builder-safe-failure","title":"The Confidence Builder (Safe Failure)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u0417\u0434\u0435\u0441\u044c \u043d\u0435 \u0441\u0442\u0440\u0430\u0448\u043d\u043e \u043e\u0448\u0438\u0431\u0430\u0442\u044c\u0441\u044f\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u0430\u044f \u043f\u0435\u0441\u043e\u0447\u043d\u0438\u0446\u0430. \u041a\u0443\u0440\u0441 \"\u0440\u0438\u0441\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u043b\u044f \u0442\u0435\u0445, \u043a\u0442\u043e \u043d\u0435 \u0443\u043c\u0435\u0435\u0442\". \u041f\u0440\u0438\u0432\u0430\u0442\u043d\u044b\u0439 \u0443\u0440\u043e\u043a, \u0433\u0434\u0435 \u043d\u0438\u043a\u0442\u043e \u043d\u0435 \u0441\u043c\u043e\u0442\u0440\u0438\u0442.\n*   *AI Cue*: \"scared to\", \"bad at\", \"shy\".\n</code></pre>"},{"location":"recommendation/theory/#the-identity-claim-symbolic","title":"The Identity Claim (Symbolic)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u0422\u044b \u0443\u0436\u0435 \u043d\u0430\u0441\u0442\u043e\u044f\u0449\u0438\u0439 [\u041f\u0438\u0441\u0430\u0442\u0435\u043b\u044c/\u0428\u0435\u0444]\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u0421\u0438\u043c\u0432\u043e\u043b \u0441\u0442\u0430\u0442\u0443\u0441\u0430. \u0418\u043c\u0435\u043d\u043d\u043e\u0439 \u0444\u0430\u0440\u0442\u0443\u043a. \u0412\u0438\u0437\u0438\u0442\u043a\u0438. \u0412\u044b \u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0435\u0441\u044c \u043a \u0435\u0433\u043e \u0445\u043e\u0431\u0431\u0438 \u043a\u0430\u043a \u043a \u043f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u0438.\n*   *AI Cue*: \"trying to become\", \"new role\".\n</code></pre>"},{"location":"recommendation/theory/#4-the-anchor-the-distance-gap","title":"4. The Anchor (The Distance Gap)","text":"<p>Gap: \"\u0412\u0430\u0436\u0435\u043d \u043b\u0438 \u044f? \u0412\u0430\u0436\u043d\u043e \u043b\u0438 \u043d\u0430\u0448\u0435 \u043f\u0440\u043e\u0448\u043b\u043e\u0435?\" Slogan: \"Our bond is real, specific, and safe.\"</p> <p>Human Explanation: \u042d\u0442\u043e \u043f\u043e\u0434\u0430\u0440\u043a\u0438 \u043f\u0440\u043e \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f. \u0412\u0435\u0449\u044c \u0437\u0434\u0435\u0441\u044c \u043d\u0435 \u0432\u0430\u0436\u043d\u0430, \u0432\u0430\u0436\u0435\u043d \u0441\u043c\u044b\u0441\u043b. \u042d\u0442\u043e \u0430\u0440\u0442\u0435\u0444\u0430\u043a\u0442\u044b \u0432\u0430\u0448\u0435\u0439 \u0434\u0440\u0443\u0436\u0431\u044b \u0438\u043b\u0438 \u043b\u044e\u0431\u0432\u0438. \u0413\u043b\u0430\u0432\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u2014 \u0434\u0430\u0440\u0438\u0442\u044c \u0442\u0430\u043a\u043e\u0435, \u043a\u043e\u0433\u0434\u0430 \u0432\u044b \u0435\u0434\u0432\u0430 \u0437\u043d\u0430\u043a\u043e\u043c\u044b (\u043a\u0440\u0438\u043d\u0436), \u0438\u043b\u0438 \u043d\u0435 \u0434\u0430\u0440\u0438\u0442\u044c, \u043a\u043e\u0433\u0434\u0430 \u0432\u044b \u0432\u043c\u0435\u0441\u0442\u0435 10 \u043b\u0435\u0442 (\u0445\u043e\u043b\u043e\u0434).</p>"},{"location":"recommendation/theory/#the-time-capsule-shared-history","title":"The Time Capsule (Shared History)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u041f\u043e\u043c\u043d\u0438\u0448\u044c, \u043a\u0430\u043a \u043d\u0430\u043c \u0431\u044b\u043b\u043e \u043a\u0440\u0443\u0442\u043e?\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u041a\u043e\u043d\u0441\u0435\u0440\u0432\u0430\u0446\u0438\u044f \u0432\u043e\u0441\u043f\u043e\u043c\u0438\u043d\u0430\u043d\u0438\u0439. \u0424\u043e\u0442\u043e\u043a\u043d\u0438\u0433\u0430, \u043f\u043e\u0441\u0442\u0435\u0440 \u0441 \u0434\u0430\u0442\u043e\u0439 \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0441\u0432\u0438\u0434\u0430\u043d\u0438\u044f.\n*   *AI Cue*: \"remember when\", \"anniversary\".\n</code></pre>"},{"location":"recommendation/theory/#the-inside-language-private-code","title":"The Inside Language (Private Code)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u0428\u0443\u0442\u043a\u0430, \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u043f\u043e\u0439\u043c\u0435\u043c \u0442\u043e\u043b\u044c\u043a\u043e \u043c\u044b\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u041c\u0435\u043c, \u0440\u0430\u0441\u043f\u0435\u0447\u0430\u0442\u0430\u043d\u043d\u044b\u0439 \u043d\u0430 \u043a\u0440\u0443\u0436\u043a\u0435. \u041e\u0442\u0441\u044b\u043b\u043a\u0430 \u043a \u0433\u043b\u0443\u043f\u043e\u0439 \u0441\u0438\u0442\u0443\u0430\u0446\u0438\u0438 \u0432 \u043e\u0442\u043f\u0443\u0441\u043a\u0435. \u0421\u043e\u0437\u0434\u0430\u0435\u0442 \u0447\u0443\u0432\u0441\u0442\u0432\u043e \"\u0437\u0430\u0433\u043e\u0432\u043e\u0440\u0430\".\n*   *AI Cue*: \"our joke\", \"we always say\".\n</code></pre>"},{"location":"recommendation/theory/#the-gratitude-mirror-validation","title":"The Gratitude Mirror (Validation)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u0421\u043f\u0430\u0441\u0438\u0431\u043e, \u0447\u0442\u043e \u0442\u044b \u0435\u0441\u0442\u044c\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u041f\u0440\u044f\u043c\u0430\u044f \u0431\u043b\u0430\u0433\u043e\u0434\u0430\u0440\u043d\u043e\u0441\u0442\u044c. \u041f\u0438\u0441\u044c\u043c\u043e, \u043d\u0430\u0433\u0440\u0430\u0434\u0430 \"\u041b\u0443\u0447\u0448\u0438\u0439 \u043d\u0430\u0441\u0442\u0430\u0432\u043d\u0438\u043a\". \u0412\u0430\u0436\u043d\u043e, \u0447\u0442\u043e\u0431\u044b \u044d\u0442\u043e \u0431\u044b\u043b\u043e \u0438\u0441\u043a\u0440\u0435\u043d\u043d\u0435.\n*   *AI Cue*: \"helped me\", \"grateful\".\n</code></pre>"},{"location":"recommendation/theory/#the-ritual-builder-future-loop","title":"The Ritual Builder (Future Loop)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u0414\u0430\u0432\u0430\u0439 \u0434\u0435\u043b\u0430\u0442\u044c \u044d\u0442\u043e \u0432\u043c\u0435\u0441\u0442\u0435 \u0447\u0430\u0449\u0435\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u041f\u043e\u0434\u0430\u0440\u043e\u043a, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0442\u0440\u0430\u0434\u0438\u0446\u0438\u044e. \u041d\u0430\u0431\u043e\u0440 \u0434\u043b\u044f \u0435\u0436\u0435\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u043e\u0439 \u043f\u0438\u0446\u0446\u044b. \u0418\u0433\u0440\u0430 \u0434\u043b\u044f \u0434\u0432\u043e\u0438\u0445 \u043d\u0430 \u0432\u0435\u0447\u0435\u0440 \u043f\u044f\u0442\u043d\u0438\u0446\u044b.\n*   *AI Cue*: \"miss you\", \"need more time together\".\n</code></pre>"},{"location":"recommendation/theory/#the-presence-token-bridge","title":"The Presence Token (Bridge)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u042f \u0440\u044f\u0434\u043e\u043c, \u0434\u0430\u0436\u0435 \u043a\u043e\u0433\u0434\u0430 \u0434\u0430\u043b\u0435\u043a\u043e\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u0414\u043b\u044f \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439 \u043d\u0430 \u0440\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0438. \u041b\u0430\u043c\u043f\u0430 \u0434\u0440\u0443\u0436\u0431\u044b, \u0445\u0443\u0434\u0438, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u043f\u0430\u0445\u043d\u0435\u0442 \u0442\u0432\u043e\u0438\u043c\u0438 \u0434\u0443\u0445\u0430\u043c\u0438.\n*   *AI Cue*: \"long distance\", \"moving away\".\n</code></pre>"},{"location":"recommendation/theory/#the-protection-signal-care","title":"The Protection Signal (Care)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u042f \u0445\u043e\u0447\u0443, \u0447\u0442\u043e\u0431\u044b \u0442\u044b \u0431\u044b\u043b \u0432 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u0417\u0430\u0431\u043e\u0442\u0430 \u043a\u0430\u043a \u044f\u0437\u044b\u043a \u043b\u044e\u0431\u0432\u0438. \u041f\u0435\u0440\u0446\u043e\u0432\u044b\u0439 \u0431\u0430\u043b\u043b\u043e\u043d\u0447\u0438\u043a (\u0441 \u043b\u044e\u0431\u043e\u0432\u044c\u044e), \u0442\u0435\u043f\u043b\u044b\u0439 \u0448\u0430\u0440\u0444, \u0441\u0442\u0440\u0430\u0445\u043e\u0432\u043a\u0430.\n*   *AI Cue*: \"worry about\", \"keep safe\".\n</code></pre>"},{"location":"recommendation/theory/#5-the-permission-the-guilt-gap","title":"5. The Permission (The Guilt Gap)","text":"<p>Gap: \"\u042f \u0445\u043e\u0447\u0443 \u044d\u0442\u043e, \u043d\u043e \u043d\u0435 \u043c\u043e\u0433\u0443 \u043e\u043f\u0440\u0430\u0432\u0434\u0430\u0442\u044c.\" Slogan: \"You\u2019re allowed to enjoy.\"</p> <p>Human Explanation: \u0423 \u0432\u0441\u0435\u0445 \u0435\u0441\u0442\u044c \"\u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0439 \u0431\u0443\u0445\u0433\u0430\u043b\u0442\u0435\u0440\", \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0437\u0430\u043f\u0440\u0435\u0449\u0430\u0435\u0442 \u0442\u0440\u0430\u0442\u0438\u0442\u044c \u0434\u0435\u043d\u044c\u0433\u0438 \u043d\u0430 \u0435\u0440\u0443\u043d\u0434\u0443. \"\u0417\u0430\u0447\u0435\u043c \u043c\u043d\u0435 \u0431\u043e\u043c\u0431\u043e\u0447\u043a\u0430 \u0434\u043b\u044f \u0432\u0430\u043d\u043d\u044b \u0437\u0430 1000\u0440, \u044f \u043b\u0443\u0447\u0448\u0435 \u043a\u0443\u043f\u043b\u044e \u0435\u0434\u044b\". \u041f\u043e\u0434\u0430\u0440\u043e\u043a-Permission \u0432\u0437\u043b\u0430\u043c\u044b\u0432\u0430\u0435\u0442 \u044d\u0442\u0443 \u0437\u0430\u0449\u0438\u0442\u0443. \u0412\u044b \u0434\u0430\u0435\u0442\u0435 \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0443 \u043b\u0435\u0433\u0430\u043b\u044c\u043d\u043e\u0435 \u043f\u0440\u0430\u0432\u043e \u043d\u0430 \u0443\u0434\u043e\u0432\u043e\u043b\u044c\u0441\u0442\u0432\u0438\u0435. \"\u042d\u0442\u043e \u043f\u043e\u0434\u0430\u0440\u043e\u043a, \u0442\u044b \u043e\u0431\u044f\u0437\u0430\u043d \u044d\u0442\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c!\".</p>"},{"location":"recommendation/theory/#the-quiet-premium-quality-upgrade","title":"The Quiet Premium (Quality Upgrade)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u0425\u043e\u0440\u043e\u0448\u0435\u0435 \u0432\u043c\u0435\u0441\u0442\u043e \u043d\u043e\u0440\u043c\u0430\u043b\u044c\u043d\u043e\u0433\u043e\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u0412\u0435\u0449\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \"\u0436\u0430\u0431\u0430 \u0434\u0443\u0448\u0438\u0442\" \u043a\u0443\u043f\u0438\u0442\u044c. \u0414\u043e\u0440\u043e\u0433\u0438\u0435 \u043d\u043e\u0441\u043a\u0438 (\u0437\u0430 2000\u0440), \u043a\u0440\u0430\u0444\u0442\u043e\u0432\u044b\u0439 \u0448\u043e\u043a\u043e\u043b\u0430\u0434, \u043f\u0440\u0435\u043c\u0438\u0443\u043c \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0430 YouTube.\n*   *AI Cue*: \"too expensive\", \"don't need it\".\n</code></pre>"},{"location":"recommendation/theory/#the-sensory-treat-pure-pleasure","title":"The Sensory Treat (Pure Pleasure)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u0423\u0434\u043e\u0432\u043e\u043b\u044c\u0441\u0442\u0432\u0438\u0435 \u0434\u043b\u044f \u0442\u0435\u043b\u0430\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u0427\u0438\u0441\u0442\u044b\u0439 \u0433\u0435\u0434\u043e\u043d\u0438\u0437\u043c. \u0421\u0432\u0435\u0447\u0438, \u0441\u043e\u043b\u044c \u0434\u043b\u044f \u0432\u0430\u043d\u043d, \u0434\u0435\u043b\u0438\u043a\u0430\u0442\u0435\u0441\u044b, \u043c\u044f\u0433\u043a\u0438\u0439 \u0445\u0430\u043b\u0430\u0442. \u041b\u043e\u0433\u0438\u043a\u0430 \u0442\u0443\u0442 \u043d\u0435 \u043d\u0443\u0436\u043d\u0430, \u0442\u043e\u043b\u044c\u043a\u043e \u043a\u0430\u0439\u0444.\n*   *AI Cue*: \"loves cozy\", \"foodie\".\n</code></pre>"},{"location":"recommendation/theory/#the-rest-license-pause-button","title":"The Rest License (Pause Button)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u0422\u0435\u0431\u0435 \u043e\u0444\u0438\u0446\u0438\u0430\u043b\u044c\u043d\u043e \u043c\u043e\u0436\u043d\u043e \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u0434\u0435\u043b\u0430\u0442\u044c\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u043d\u0430 \u043e\u0442\u0434\u044b\u0445. \u0421\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u0432 \u0421\u041f\u0410, \u0434\u0435\u043d\u044c \u0431\u0435\u0437 \u0434\u0435\u0442\u0435\u0439, \u043c\u0430\u0441\u043a\u0430 \u0434\u043b\u044f \u0441\u043d\u0430.\n*   *AI Cue*: \"burned out\", \"always working\".\n</code></pre>"},{"location":"recommendation/theory/#the-play-pass-inner-child","title":"The Play Pass (Inner Child)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u0412\u0437\u0440\u043e\u0441\u043b\u044b\u043c \u0442\u043e\u0436\u0435 \u043c\u043e\u0436\u043d\u043e \u0438\u0433\u0440\u0430\u0442\u044c\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u0412\u0435\u0449\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043a\u0430\u0436\u0443\u0442\u0441\u044f \"\u043d\u0435\u0441\u0435\u0440\u044c\u0435\u0437\u043d\u044b\u043c\u0438\", \u043d\u043e \u043f\u0440\u0438\u043d\u043e\u0441\u044f\u0442 \u0440\u0430\u0434\u043e\u0441\u0442\u044c. Lego, \u0440\u0430\u0441\u043a\u0440\u0430\u0441\u043a\u0430 \u043f\u043e \u043d\u043e\u043c\u0435\u0440\u0430\u043c, \u0440\u0430\u0434\u0438\u043e\u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c\u044b\u0439 \u0432\u0435\u0440\u0442\u043e\u043b\u0435\u0442.\n*   *AI Cue*: \"too serious\", \"misses fun\".\n</code></pre>"},{"location":"recommendation/theory/#the-beauty-token-aesthetic","title":"The Beauty Token (Aesthetic)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u0411\u0435\u0441\u043f\u043e\u043b\u0435\u0437\u043d\u043e, \u043d\u043e \u043a\u0440\u0430\u0441\u0438\u0432\u043e\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u0412\u0435\u0449\u0438, \u0443 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043d\u0435\u0442 \u0444\u0443\u043d\u043a\u0446\u0438\u0438, \u043a\u0440\u043e\u043c\u0435 \u043a\u0440\u0430\u0441\u043e\u0442\u044b. \u0416\u0438\u0432\u044b\u0435 \u0446\u0432\u0435\u0442\u044b \u0431\u0435\u0437 \u043f\u043e\u0432\u043e\u0434\u0430. \u0410\u0440\u0442-\u0430\u043b\u044c\u0431\u043e\u043c. \u0421\u0442\u0430\u0442\u0443\u044d\u0442\u043a\u0430.\n*   *AI Cue*: \"loves design\", \"admire\".\n</code></pre>"},{"location":"recommendation/theory/#the-status-quiet-reward-pride","title":"The Status-Quiet Reward (Pride)","text":"<pre><code>*   **\u0421\u0443\u0442\u044c:** \"\u0422\u044b \u044d\u0442\u043e \u0437\u0430\u0441\u043b\u0443\u0436\u0438\u043b\".\n*   **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:** \u041f\u0440\u0438\u0437\u043d\u0430\u043d\u0438\u0435 \u0437\u0430\u0441\u043b\u0443\u0433. \u0411\u0440\u0435\u043d\u0434\u043e\u0432\u0430\u044f \u0440\u0443\u0447\u043a\u0430, \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u0436\u0430\u043d\u044b\u0439 \u043a\u043e\u0448\u0435\u043b\u0435\u043a. \u0422\u0438\u0445\u0438\u0439 \u0441\u0438\u043c\u0432\u043e\u043b \u0443\u0441\u043f\u0435\u0445\u0430.\n*   *AI Cue*: \"worked hard\", \"deserves it\".\n</code></pre>"},{"location":"en/","title":"Welcome to Gifty Engineering Docs \ud83c\udf81","text":"<p>This portal contains all technical documentation for the Gifty project \u2014 a smart gift recommendation platform. We aggregate product data from popular platforms, analyze it using AI, and provide a user-friendly interface for discovery.</p>"},{"location":"en/#fast-navigation","title":"\ud83e\udded Fast Navigation","text":"Section Description Link Onboarding Step-by-step plan for new members: access, chats, first tasks. Open \u2192 Local Setup Boot up the entire system (Docker, API, Bot) in 5 minutes. Open \u2192 Architecture High-level overview of how data turns into recommendations. Open \u2192 Data &amp; DB Data domains, PostgreSQL schemas, and migration rules. Open \u2192"},{"location":"en/#core-systems","title":"\ud83c\udfd7 Core Systems","text":""},{"location":"en/#recommendation-engine","title":"\ud83e\udde0 Recommendation Engine","text":"<p>Our SOTA engine based on Qwen2-VL and Vector Search. We don't just search for products; we analyze them across 10 psychological axes (GUTG). \ud83d\udc49 Read more about RecSys \u2192</p>"},{"location":"en/#parsing-system","title":"\ud83d\udd77 Parsing System","text":"<p>Scalable data collection system using Scrapy and RabbitMQ. Features automatic category mapping and AI validation. \ud83d\udc49 How parsers work \u2192</p>"},{"location":"en/#telegram-admin-bot","title":"\ud83e\udd16 Telegram Admin Bot","text":"<p>Mission control center. Health monitoring, manual parsing control, and access management. \ud83d\udc49 Bot guide \u2192</p>"},{"location":"en/#quality-monitoring","title":"\ud83e\uddea Quality &amp; Monitoring","text":"<p>We believe in TDD and Observability:</p> <ul> <li>Testing: Every feature is covered by <code>pytest</code>. Testing Guide \u2192</li> <li>Analytics: We track business success via PostHog. Why do we need analytics? \u2192</li> <li>CI/CD: Automatic deployment on every push. Deployment process \u2192</li> </ul> <p>Any questions?</p> <p>Reach out in Slack <code>#gifty-dev</code> or message your mentor. We are always happy to help!</p> <p>Contributing</p> <p>If you find an error in the documentation or want to add a new section, feel free to create a Pull Request!</p>"},{"location":"en/api/","title":"API Reference Overview \ud83d\ude80","text":"<p>Welcome to the Gifty Technical API Reference. Our system is built using a layered architecture, where each component has a clear area of responsibility.</p>"},{"location":"en/api/#interaction-architecture","title":"Interaction Architecture","text":"graph TD     UI[Frontend / Dashboard] --&gt; API[API Layer]     Bot[Telegram Bot] --&gt; API     Workers[Scrapy Workers] --&gt; InternalAPI[Internal API]      subgraph \"Backend Core\"         API --&gt; Services[Services Layer]         InternalAPI --&gt; Services         Services --&gt; Repositories[Repositories Layer]         Repositories --&gt; DB[(PostgreSQL + pgvector)]         Models[Data Models] -.-&gt; API         Models -.-&gt; Services     end      subgraph \"External Systems\"         Services --&gt; Weeek[Weeek CRM]         API --&gt; PostHog[PostHog Analytics]     end"},{"location":"en/api/#documentation-sections","title":"Documentation Sections","text":""},{"location":"en/api/#api-playground","title":"\ud83d\udd79 API Playground","text":"<p>Interactive Swagger UI console for testing endpoints in the browser (Localhost / Production).</p>"},{"location":"en/api/#data-models","title":"\ud83d\udce6 Data Models","text":"<p>Description of Pydantic schemas and SQLAlchemy models. This section defines the data structures transferred between frontend and backend, as well as how they are stored in the database.</p>"},{"location":"en/api/#services","title":"\u2699\ufe0f Services","text":"<p>The system's business logic. Services coordinate the work of repositories and external integrations to solve high-level tasks (e.g., product ingestion flow or recommendation logic).</p>"},{"location":"en/api/#repositories","title":"\ud83d\uddc4 Repositories","text":"<p>The data access layer. Direct interaction with the database via SQLAlchemy. Repositories encapsulate complex SQL queries and vector searches.</p>"},{"location":"en/api/#public-api","title":"\ud83c\udf10 Public API","text":"<p>Interfaces for the external frontend: feedback forms (leads), team lists, and recommendation generation.</p>"},{"location":"en/api/#integrations-weeek","title":"\ud83d\udd0c Integrations &amp; Weeek","text":"<p>Integration with Weeek for task management: internal endpoints for the bot and public proxies for documentation.</p>"},{"location":"en/api/#auth-api","title":"\ud83d\udee1\ufe0f Auth API","text":"<p>Session management and login via OAuth 2.0 (Google, Yandex, VK).</p>"},{"location":"en/api/#analytics-api","title":"\ud83d\udcca Analytics API","text":"<p>A secure proxy layer for retrieving product metrics from PostHog and technical data from Prometheus/Loki.</p>"},{"location":"en/api/#internal-api","title":"\ud83d\udd10 Internal API","text":"<p>Interfaces for internal needs: worker management, manual parser execution, product batch ingestion, and AI scoring tasks.</p> <p>Auto-generation</p> <p>Most of this section is automatically generated from Python docstrings using <code>mkdocstrings</code>.</p>"},{"location":"en/api/auth/","title":"Auth API Reference \ud83d\udd10","text":"<p>Gifty's authentication system is built on OAuth 2.0 with PKCE. We support login via Google, Yandex, and VK. Sessions are stored in Redis and delivered to the client via HttpOnly Secure cookies.</p>"},{"location":"en/api/auth/#authentication-flow","title":"\ud83d\ude80 Authentication Flow","text":"<p>For frontend developers, the login process works as follows: 1. Redirect the user to <code>/auth/{provider}/start</code>. 2. The backend redirects the user to the provider's login page. 3. After a successful login, the provider returns the user to our Callback URL. 4. The backend sets the <code>gifty_session</code> cookie and redirects the user back to the frontend.</p>"},{"location":"en/api/auth/#endpoints","title":"\ud83d\udd11 Endpoints","text":""},{"location":"en/api/auth/#1-start-authorization-providerstart","title":"1. Start Authorization (<code>/{provider}/start</code>)","text":"<p>Initiates the login process.</p> <ul> <li>URL: <code>/api/v1/auth/{provider}/start</code></li> <li>Method: <code>GET</code></li> <li>Parameters:<ul> <li><code>provider</code>: <code>google</code>, <code>yandex</code>, or <code>vk</code>.</li> <li><code>return_to</code> (query, optional): The URL on the frontend to return the user to after login (default is <code>/</code>).</li> </ul> </li> <li>Result: 302 Redirect.</li> </ul>"},{"location":"en/api/auth/#2-current-user-info-me","title":"2. Current User Info (<code>/me</code>)","text":"<p>Checks the current user's status.</p> <ul> <li>URL: <code>/api/v1/auth/me</code></li> <li>Method: <code>GET</code></li> <li>Response: <code>UserDTO</code></li> <li>Errors:<ul> <li><code>401 Unauthorized</code>: If the session is invalid or missing.</li> </ul> </li> </ul>"},{"location":"en/api/auth/#3-logout-logout","title":"3. Logout (<code>/logout</code>)","text":"<p>Ends the session.</p> <ul> <li>URL: <code>/api/v1/auth/logout</code></li> <li>Method: <code>POST</code></li> <li>Result: Deletes the cookie and clears data in Redis.</li> </ul>"},{"location":"en/api/auth/#security","title":"\ud83d\udee1 Security","text":"<ul> <li>Cookies: The <code>gifty_session</code> cookie is set with <code>HttpOnly</code>, <code>Secure</code>, <code>SameSite=Lax</code> flags.</li> <li>PKCE: Used to protect against authorization code interception.</li> <li>State: Protection against CSRF attacks via state verification.</li> </ul>"},{"location":"en/api/internal/","title":"Internal API Reference \ud83d\udd10","text":"<p>The Internal API is designed for interaction between the core components of the Gifty system: the Admin Dashboard, parsing workers, and the Intelligence scoring system.</p> <p>These endpoints require high privilege levels and are not intended to be called from the public frontend.</p>"},{"location":"en/api/internal/#authentication","title":"Authentication","text":"<p>All requests to the Internal API must include the access token in the <code>X-Internal-Token</code> header.</p> Header Description <code>X-Internal-Token</code> Secret token defined in settings (<code>INTERNAL_API_TOKEN</code>)."},{"location":"en/api/internal/#parsing-management-sources","title":"\ud83d\udd77 Parsing Management (Sources)","text":""},{"location":"en/api/internal/#1-list-sources-sources","title":"1. List Sources (<code>/sources</code>)","text":"<p>Returns all registered sites and categories for data collection.</p> <ul> <li>URL: <code>/internal/sources</code></li> <li>Method: <code>GET</code></li> <li>Response: <code>List[ParsingSourceSchema]</code></li> </ul>"},{"location":"en/api/internal/#2-detailed-info-sourcessource_id","title":"2. Detailed Info (<code>/sources/{source_id}</code>)","text":"<p>Returns full run history, current configuration, and statistics for a specific parser.</p> <ul> <li>URL: <code>/internal/sources/{source_id}</code></li> <li>Method: <code>GET</code></li> <li>Response: <code>ParsingSourceSchema</code> (including <code>history</code> array and <code>total_items</code>).</li> </ul>"},{"location":"en/api/internal/#3-discovery-backlog-sourcesbacklog","title":"3. Discovery Backlog (<code>/sources/backlog</code>)","text":"<p>List of new sites or categories automatically found by the system but not yet processed.</p> <ul> <li>URL: <code>/internal/sources/backlog</code></li> <li>Method: <code>GET</code></li> <li>Response: <code>List[ParsingSourceSchema]</code> (objects with <code>discovered</code> status).</li> </ul>"},{"location":"en/api/internal/#4-backlog-activation-sourcesbacklogactivate","title":"4. Backlog Activation (<code>/sources/backlog/activate</code>)","text":"<p>Mass activation of sources from the backlog.</p> <ul> <li>URL: <code>/internal/sources/backlog/activate</code></li> <li>Method: <code>POST</code></li> <li>Body: <code>{ \"source_ids\": [1, 2, 3] }</code></li> </ul>"},{"location":"en/api/internal/#5-force-run-idforce-run","title":"5. Force Run (<code>/{id}/force-run</code>)","text":"<p>Immediately dispatches a parsing task to RabbitMQ, bypassing the schedule.</p> <ul> <li>URL: <code>/internal/sources/{source_id}/force-run</code></li> <li>Method: <code>POST</code></li> <li> <ul> <li><code>strategy</code> (optional): Strategy override (<code>discovery</code> or <code>deep</code>).</li> </ul> </li> </ul>"},{"location":"en/api/internal/#6-enabledisable-idtoggle","title":"6. Enable/Disable (<code>/{id}/toggle</code>)","text":"<p>Activates or deactivates the automatic scheduled execution of a parser.</p> <ul> <li>URL: <code>/internal/sources/{source_id}/toggle</code></li> <li>Method: <code>POST</code></li> <li>Body: <code>{ \"is_active\": bool }</code></li> </ul>"},{"location":"en/api/internal/#data-ingestion-processing","title":"\ud83d\udce6 Data Ingestion &amp; Processing","text":""},{"location":"en/api/internal/#1-ingest-batch-ingest-batch","title":"1. Ingest Batch (<code>/ingest-batch</code>)","text":"<p>The primary endpoint for Scrapy workers to transmit collected products and categories to the main database.</p> <ul> <li>URL: <code>/internal/ingest-batch</code></li> <li>Method: <code>POST</code></li> <li>Body: <code>IngestBatchRequest</code> (list of items and discovered categories).</li> </ul>"},{"location":"en/api/internal/#2-worker-stats-workers","title":"2. Worker Stats (<code>/workers</code>)","text":"<p>Returns a list of currently running Scrapy containers and their current load.</p> <ul> <li>URL: <code>/internal/workers</code></li> <li>Method: <code>GET</code></li> </ul>"},{"location":"en/api/internal/#intelligence-categorization","title":"\ud83e\udde0 Intelligence &amp; Categorization","text":""},{"location":"en/api/internal/#1-scoring-tasks-scoringtasks","title":"1. Scoring Tasks (<code>/scoring/tasks</code>)","text":"<p>Used by external LLM workers (e.g., in Kaggle/Colab) to fetch products that haven't been scored across the 10 GUTG axes.</p> <ul> <li>URL: <code>/internal/scoring/tasks</code></li> <li>Method: <code>GET</code></li> <li>Parameters: <code>limit</code> (default: 50).</li> </ul>"},{"location":"en/api/internal/#2-category-mapping-tasks-categoriestasks","title":"2. Category Mapping Tasks (<code>/categories/tasks</code>)","text":"<p>List of \"raw\" categories discovered by parsers that need to be mapped to Gifty's internal category tree using AI.</p> <ul> <li>URL: <code>/internal/categories/tasks</code></li> <li>Method: <code>GET</code></li> </ul>"},{"location":"en/api/internal/#access-telegram","title":"\ud83d\udee1 Access &amp; Telegram","text":""},{"location":"en/api/internal/#1-subscriber-management-telegramsubscribers","title":"1. Subscriber Management (<code>/telegram/subscribers</code>)","text":"<p>Manage access permissions for Telegram bot users and the Dashboard (roles: <code>admin</code>, <code>superadmin</code>).</p>"},{"location":"en/api/internal/#2-webapp-auth-webappauth","title":"2. WebApp Auth (<code>/webapp/auth</code>)","text":"<p>Verifies <code>initData</code> from the Telegram Mini App for Dashboard login.</p> <ul> <li>URL: <code>/internal/webapp/auth</code></li> <li>Method: <code>POST</code></li> <li>Body: <code>{ \"init_data\": \"...\" }</code></li> </ul>"},{"location":"en/api/models/","title":"\u041c\u043e\u0434\u0435\u043b\u0438 (Models)","text":"<p>\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0435\u0439 SQLAlchemy, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0445 \u0432 \u043f\u0440\u043e\u0435\u043a\u0442\u0435.</p>"},{"location":"en/api/models/#app.models.Product","title":"<code>app.models.Product</code>","text":"<p>               Bases: <code>TimestampMixin</code>, <code>Base</code></p> <p>\u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c \u0442\u043e\u0432\u0430\u0440\u0430 \u0432 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0435. \u0421\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u0442\u043e\u0432\u0430\u0440\u0430, \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043c\u0435\u0440\u0447\u0430\u043d\u0442\u0435 \u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043e\u0446\u0435\u043d\u043a\u0438 LLM.</p> Source code in <code>app/models.py</code> <pre><code>class Product(TimestampMixin, Base):\n    \"\"\"\n    \u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c \u0442\u043e\u0432\u0430\u0440\u0430 \u0432 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0435.\n    \u0421\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u0442\u043e\u0432\u0430\u0440\u0430, \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043c\u0435\u0440\u0447\u0430\u043d\u0442\u0435 \u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043e\u0446\u0435\u043d\u043a\u0438 LLM.\n    \"\"\"\n    __tablename__ = \"products\"\n\n    gift_id: Mapped[str] = mapped_column(Text, primary_key=True)\n    title: Mapped[str] = mapped_column(Text, nullable=False)\n    description: Mapped[Optional[str]] = mapped_column(Text, nullable=True)\n    price: Mapped[Optional[float]] = mapped_column(sa.Numeric, nullable=True)\n    currency: Mapped[Optional[str]] = mapped_column(Text, nullable=True)\n    image_url: Mapped[Optional[str]] = mapped_column(Text, nullable=True)\n    product_url: Mapped[str] = mapped_column(Text, nullable=False)\n    merchant: Mapped[Optional[str]] = mapped_column(Text, nullable=True, index=True)\n    category: Mapped[Optional[str]] = mapped_column(Text, nullable=True, index=True)\n    raw: Mapped[Optional[dict]] = mapped_column(JSONB, nullable=True)\n    is_active: Mapped[bool] = mapped_column(sa.Boolean, server_default=\"true\", default=True, index=True)\n    content_text: Mapped[Optional[str]] = mapped_column(Text, nullable=True)\n    content_hash: Mapped[Optional[str]] = mapped_column(Text, nullable=True)\n\n    # LLM Scoring\n    llm_gift_score: Mapped[Optional[float]] = mapped_column(sa.Float, nullable=True, index=True)\n    llm_gift_reasoning: Mapped[Optional[str]] = mapped_column(Text, nullable=True)\n    llm_gift_vector: Mapped[Optional[dict]] = mapped_column(JSONB, nullable=True)\n    llm_scoring_model: Mapped[Optional[str]] = mapped_column(Text, nullable=True)\n    llm_scoring_version: Mapped[Optional[str]] = mapped_column(Text, nullable=True)\n    llm_scored_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True), nullable=True)\n</code></pre>"},{"location":"en/api/models/#app.models.Product-attributes","title":"Attributes","text":""},{"location":"en/api/models/#app.models.Product.gift_id","title":"<code>gift_id = mapped_column(Text, primary_key=True)</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"en/api/models/#app.models.Product.title","title":"<code>title = mapped_column(Text, nullable=False)</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"en/api/models/#app.models.Product.description","title":"<code>description = mapped_column(Text, nullable=True)</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"en/api/models/#app.models.Product.price","title":"<code>price = mapped_column(sa.Numeric, nullable=True)</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"en/api/models/#app.models.ParsingSource","title":"<code>app.models.ParsingSource</code>","text":"<p>               Bases: <code>TimestampMixin</code>, <code>Base</code></p> <p>\u0420\u0435\u0435\u0441\u0442\u0440 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u043e\u0432 \u0434\u043b\u044f \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0430 (\u043c\u0430\u0433\u0430\u0437\u0438\u043d\u043e\u0432 \u0438 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439). \u0423\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435\u043c \u0438 \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0435\u0439 \u0441\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445.</p> Source code in <code>app/models.py</code> <pre><code>class ParsingSource(TimestampMixin, Base):\n    \"\"\"\n    \u0420\u0435\u0435\u0441\u0442\u0440 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u043e\u0432 \u0434\u043b\u044f \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0430 (\u043c\u0430\u0433\u0430\u0437\u0438\u043d\u043e\u0432 \u0438 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439).\n    \u0423\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435\u043c \u0438 \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0435\u0439 \u0441\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445.\n    \"\"\"\n    __tablename__ = \"parsing_sources\"\n\n    id: Mapped[int] = mapped_column(sa.Integer, primary_key=True, autoincrement=True)\n    url: Mapped[str] = mapped_column(Text, nullable=False, unique=True)\n    type: Mapped[str] = mapped_column(String, nullable=False)  # hub, list, product, sitemap\n    site_key: Mapped[str] = mapped_column(String, nullable=False, index=True)  # mrgeek, ozon, etc.\n    strategy: Mapped[str] = mapped_column(String, server_default=\"deep\")  # deep, discovery\n    priority: Mapped[int] = mapped_column(sa.Integer, server_default=\"50\", index=True)\n    refresh_interval_hours: Mapped[int] = mapped_column(sa.Integer, server_default=\"24\")\n    last_synced_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True), nullable=True)\n    next_sync_at: Mapped[datetime] = mapped_column(DateTime(timezone=True), server_default=func.now(), index=True)\n    is_active: Mapped[bool] = mapped_column(sa.Boolean, server_default=\"true\", default=True, index=True)\n    status: Mapped[str] = mapped_column(String, server_default=\"waiting\", index=True) # waiting, running, error, broken\n    config: Mapped[Optional[dict]] = mapped_column(JSONB, nullable=True)\n</code></pre>"},{"location":"en/api/models/#app.models.CategoryMap","title":"<code>app.models.CategoryMap</code>","text":"<p>               Bases: <code>TimestampMixin</code>, <code>Base</code></p> <p>\u041c\u0430\u043f\u043f\u0438\u043d\u0433 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u0432\u043d\u0435\u0448\u043d\u0438\u0445 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u043e\u0432 \u0432\u043e \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 Gifty. \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430.</p> Source code in <code>app/models.py</code> <pre><code>class CategoryMap(TimestampMixin, Base):\n    \"\"\"\n    \u041c\u0430\u043f\u043f\u0438\u043d\u0433 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u0432\u043d\u0435\u0448\u043d\u0438\u0445 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u043e\u0432 \u0432\u043e \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 Gifty.\n    \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430.\n    \"\"\"\n    __tablename__ = \"category_maps\"\n\n    id: Mapped[int] = mapped_column(sa.Integer, primary_key=True, autoincrement=True)\n    external_name: Mapped[str] = mapped_column(String, nullable=False, unique=True)\n    internal_category_id: Mapped[Optional[int]] = mapped_column(sa.Integer, nullable=True)\n    is_verified: Mapped[bool] = mapped_column(sa.Boolean, server_default=\"false\")\n</code></pre>"},{"location":"en/api/public/","title":"Public API Reference \ud83c\udf10","text":"<p>Gifty's Public API is designed for use by the external frontend (landing page). These endpoints are open and do not require authorization, but are protected from spam and abuse (Rate Limiting, Honeypot).</p>"},{"location":"en/api/public/#team","title":"\ud83d\udc65 Team","text":""},{"location":"en/api/public/#1-get-team-list-team","title":"1. Get Team List (<code>/team</code>)","text":"<p>Returns a list of active Gifty team members to display on the landing page.</p> <ul> <li>URL: <code>/api/v1/public/team</code></li> <li>Method: <code>GET</code></li> <li>Response: <code>List[TeamMemberSchema]</code></li> </ul>"},{"location":"en/api/public/#leads-and-feedback-contacts","title":"\ud83d\udce9 Leads and Feedback (Contacts)","text":"<p>All endpoints in this section support Honeypot protection. If the <code>hp</code> field is filled, the request is considered spam and ignored (success is returned, but data is not saved).</p>"},{"location":"en/api/public/#1-investor-lead-investor-contact","title":"1. Investor Lead (<code>/investor-contact</code>)","text":"<p>Triggers a Telegram notification on the <code>investors</code> topic. Saves the contact to the database.</p> <ul> <li>URL: <code>/api/v1/public/investor-contact</code></li> <li>Method: <code>POST</code></li> <li>Body (<code>InvestorContactCreate</code>):<ul> <li><code>name</code> (string, min 2): Investor's name.</li> <li><code>company</code> (string, optional): Fund or company name.</li> <li><code>email</code> (EmailStr): Contact email.</li> <li><code>linkedin</code> (HttpUrl, optional): Profile link.</li> <li><code>hp</code> (string, optional): Honeypot (leave empty).</li> </ul> </li> </ul>"},{"location":"en/api/public/#2-partner-lead-partner-contact","title":"2. Partner Lead (<code>/partner-contact</code>)","text":"<p>Triggers a Telegram notification on the <code>partners</code> topic. Currently only notifies the team without saving to the DB.</p> <ul> <li>URL: <code>/api/v1/public/partner-contact</code></li> <li>Method: <code>POST</code></li> <li>Body (<code>PartnerContactCreate</code>):<ul> <li><code>name</code> (string): Representative's name.</li> <li><code>email</code> (EmailStr): Email.</li> <li><code>message</code> (string, min 10): Proposal content.</li> <li><code>website</code> (HttpUrl, optional): Company website.</li> </ul> </li> </ul>"},{"location":"en/api/public/#3-newsletter-subscription-newsletter-subscribe","title":"3. Newsletter Subscription (<code>/newsletter-subscribe</code>)","text":"<p>Triggers a Telegram notification on the <code>newsletter</code> topic.</p> <ul> <li>URL: <code>/api/v1/public/newsletter-subscribe</code></li> <li>Method: <code>POST</code></li> <li>Body (<code>NewsletterSubscribe</code>):<ul> <li><code>email</code> (EmailStr): Email for subscription.</li> </ul> </li> </ul>"},{"location":"en/api/public/#recommendations","title":"\ud83c\udf81 Recommendations","text":""},{"location":"en/api/public/#1-generate-recommendations-generate","title":"1. Generate Recommendations (<code>/generate</code>)","text":"<p>The main endpoint for the quiz.</p> <ul> <li>URL: <code>/api/v1/recommendations/generate</code></li> <li>Method: <code>POST</code></li> <li>Headers: <code>X-Anon-Id</code> (UUID for anonymous session tracking).</li> <li>Body: <code>RecommendationRequest</code> (quiz answers).</li> <li>Response: <code>RecommendationResponse</code> (Hero gift and list of alternatives).</li> </ul> <p>\ud83d\udc49 For details on engine logic, see the Recommendation Engine section.</p>"},{"location":"en/api/services/","title":"Services (Services)","text":"<p>This section provides documentation for the application's key service layers.</p>"},{"location":"en/api/weeek/","title":"Weeek Integration API \ud83d\udd0c","text":"<p>The Weeek integration is used for two purposes: 1.  Internal API: For deep interaction between the Telegram bot and team tasks. 2.  Integrations API: Proxy endpoints for displaying task status directly within this documentation.</p>"},{"location":"en/api/weeek/#internal-weeek-api-telegram-bot","title":"\ud83d\udee0 Internal Weeek API (Telegram Bot)","text":"<p>These endpoints require the <code>X-Internal-Token</code> header and are used by the bot to manage the workflow.</p>"},{"location":"en/api/weeek/#1-connect-account-connect","title":"1. Connect Account (<code>/connect</code>)","text":"<p>Binds a Telegram Chat ID to a Weeek API token.</p> <ul> <li>URL: <code>/internal/weeek/connect</code></li> <li>Method: <code>POST</code></li> <li>Body:     <pre><code>{\n  \"telegram_chat_id\": 12345678,\n  \"weeek_api_token\": \"your_token_here\"\n}\n</code></pre></li> </ul>"},{"location":"en/api/weeek/#2-task-list-tasks","title":"2. Task List (<code>/tasks</code>)","text":"<p>Retrieves tasks assigned to the user.</p> <ul> <li>URL: <code>/internal/weeek/tasks</code></li> <li>Method: <code>GET</code></li> <li>Parameters:<ul> <li><code>telegram_chat_id</code>: Telegram Chat ID.</li> <li><code>type</code>: <code>all</code>, <code>today</code>, <code>tomorrow</code>, <code>overdue</code>.</li> </ul> </li> </ul>"},{"location":"en/api/weeek/#integrations-api-public-proxy","title":"\ud83c\udf10 Integrations API (Public Proxy)","text":"<p>Used by the documentation frontend to embed widgets with live task status.</p>"},{"location":"en/api/weeek/#1-task-proxy-weeektasks","title":"1. Task Proxy (<code>/weeek/tasks</code>)","text":"<p>Allows fetching a task list without exposing the API key to the frontend.</p> <ul> <li>URL: <code>/api/v1/integrations/weeek/tasks</code></li> <li>Method: <code>GET</code></li> <li>Parameters: <code>projectId</code>, <code>boardId</code>, <code>tagNames</code>.</li> </ul>"},{"location":"en/api/analytics/coverage/","title":"Catalog Coverage \ud83d\udce6","text":"<p>Analysis of how well catalog products match AI-generated search queries.</p>"},{"location":"en/api/analytics/coverage/#coverage-overview-catalogcoverage","title":"Coverage Overview (<code>catalogCoverage</code>)","text":"<p>Provides data on Hit Rate (percentage of successful searches) and identifies catalog \"gaps.\"</p> <p>Query: <pre><code>query GetCoverage($days: Int!) {\n  catalogCoverage(days: $days) {\n    totalSearches\n    hitRate\n    avgResultsPerSearch\n    topCatalogGaps {\n      query\n      misses\n    }\n  }\n}\n</code></pre></p> <p>Fields Description: - <code>hitRate</code>: Percentage of searches that returned at least one result. - <code>topCatalogGaps</code>: List of queries that most frequently returned 0 results (a signal to add new scraping sources).</p>"},{"location":"en/api/analytics/kpi/","title":"Business Metrics and KPI \ud83d\udcca","text":"<p>All primary metrics are now available via a single GraphQL query.</p>"},{"location":"en/api/analytics/kpi/#core-kpi-stats","title":"Core KPI (<code>stats</code>)","text":"<p>Returns DAU, quiz completion rate, and gift CTR.</p> <p>Query: <pre><code>query {\n  stats {\n    dau\n    quizCompletionRate\n    giftCtr\n    totalSessions\n    lastUpdated\n  }\n}\n</code></pre></p>"},{"location":"en/api/analytics/kpi/#trends-and-charts-trends","title":"Trends and Charts (<code>trends</code>)","text":"<p>Returns time series for building linear charts.</p> <p>Query: <pre><code>query GetTrends($days: Int!) {\n  trends(days: $days) {\n    dates\n    dauTrend\n    quizStarts\n    lastUpdated\n  }\n}\n</code></pre></p>"},{"location":"en/api/analytics/kpi/#conversion-funnel-funnel","title":"Conversion Funnel (<code>funnel</code>)","text":"<p>User progression through major product stages over the last 30 days.</p> <p>Query: <pre><code>query {\n  funnel {\n    name\n    count\n    conversionRate\n  }\n}\n</code></pre></p>"},{"location":"en/api/analytics/monitoring/","title":"Monitoring and Health \ud83d\udee0\ufe0f","text":"<p>Technical metrics and spider status.</p>"},{"location":"en/api/analytics/monitoring/#technical-health-technical","title":"Technical Health (<code>technical</code>)","text":"<p>Metrics from Prometheus and error logs from Loki.</p> <p>Query: <pre><code>query {\n  technical {\n    apiHealth\n    requestsPerMinute\n    errorRate5xx\n    lastErrors\n    lastUpdated\n  }\n}\n</code></pre></p>"},{"location":"en/api/analytics/monitoring/#scraper-status-scraping","title":"Scraper Status (<code>scraping</code>)","text":"<p>Monitoring the data collection process.</p> <p>Query: <pre><code>query {\n  scraping {\n    activeSources\n    unmappedCategories\n    totalScrapedItems\n    ingestionErrors\n    spiders\n  }\n}\n</code></pre></p> <p>Description: - <code>unmappedCategories</code>: Number of external site categories not yet mapped to Gifty's internal structure. - <code>spiders</code>: Detailed statistics for each active Scrapy spider.</p>"},{"location":"en/api/analytics/overview/","title":"Analytics API Overview \ud83d\udcc8","text":"<p>The entire Gifty analytics section has been migrated to GraphQL. This allows the frontend to request exactly the data needed for a specific dashboard, minimizing server load.</p> <p>The API acts as a secure proxy between the internal dashboard and data collection systems (PostHog, Prometheus, PostgreSQL).</p>"},{"location":"en/api/analytics/overview/#authentication","title":"Authentication","text":"<p>All requests to the Analytics GraphQL API require an access token in the <code>X-Analytics-Token</code> header.</p> Header Description <code>X-Analytics-Token</code> Secret token set in settings (<code>ANALYTICS_API_TOKEN</code>)."},{"location":"en/api/analytics/overview/#endpoint","title":"Endpoint","text":"<p>All requests are directed to a single endpoint: - URL: <code>/api/v1/analytics/graphql</code> - Method: <code>POST</code> (or <code>GET</code> for GraphiQL browser access)</p>"},{"location":"en/api/analytics/overview/#caching","title":"Caching","text":"<p>Redis is used to reduce the load on external services:</p> <ul> <li>Behavioral data (PostHog): 5-10 minutes.</li> <li>Technical metrics (Prometheus): 1 minute.</li> <li>System Health (PostgreSQL): 5 minutes.</li> </ul>"},{"location":"en/api/analytics/recommendations/","title":"AI Hypotheses and Recommendations \u2728","text":"<p>Analysis of recommendation engine performance.</p>"},{"location":"en/api/analytics/recommendations/#system-health-systemhealth","title":"System Health (<code>systemHealth</code>)","text":"<p>Composite score (Health Score) reflecting catalog coverage and user reactions.</p> <p>Query: <pre><code>query {\n  systemHealth {\n    healthScore\n    status\n    catalogCoverage {\n      score\n      hitRate\n    }\n    recommendationRelevance {\n      score\n      likeRate\n    }\n    searchLatency {\n      avgMs\n    }\n  }\n}\n</code></pre></p>"},{"location":"en/api/analytics/recommendations/#hypothesis-details-hypothesisdetails","title":"Hypothesis Details (<code>hypothesisDetails</code>)","text":"<p>Granular analysis of a specific gift idea: search queries used by AI, results found, and products shown.</p> <p>Query: <pre><code>query GetHypothesis($id: UUID!) {\n  hypothesisDetails(id: $id) {\n    id\n    title\n    reaction\n    searchQueries\n    totalResultsFound\n    products\n  }\n}\n</code></pre></p>"},{"location":"en/engineering/deployment/","title":"Deployment Guide (CI/CD)","text":"<p>Gifty uses a modern automated deployment pipeline that ensures Zero-Downtime and guarantees code quality through mandatory testing.</p>"},{"location":"en/engineering/deployment/#deployment-architecture","title":"Deployment Architecture","text":"<p>We use a Blue-Green Deployment strategy using host-based Nginx and Docker Compose for containerization.</p>"},{"location":"en/engineering/deployment/#how-it-works","title":"How it works:","text":"<ol> <li>Two Slots: Two ports are reserved on the server: <code>8000</code> and <code>8001</code>.</li> <li>Health Checks: The new version of the application starts in the free \"slot\". Docker and our deployment script check the <code>/health</code> endpoint.</li> <li>Seamless Switch: Nginx switches traffic to the new port only after the application has confirmed its readiness.</li> <li>Safe Rollback: If the new version fails to start, the old one continues to run without service interruption.</li> </ol>"},{"location":"en/engineering/deployment/#github-actions-pipeline","title":"GitHub Actions Pipeline","text":"<p>The deployment process is described in the <code>.github/workflows/deploy-prod.yml</code> file. It consists of two main stages:</p>"},{"location":"en/engineering/deployment/#1-testing-stage-test","title":"1. Testing Stage (<code>test</code>)","text":"<p>Runs on every push to <code>main</code>. </p> <ul> <li>Sets up the environment (Python 3.11).</li> <li>Installs dependencies.</li> <li>Runs <code>pytest</code> according to settings in <code>tests_config.yaml</code>.</li> <li>If tests fail, deployment will not proceed.</li> </ul>"},{"location":"en/engineering/deployment/#2-deployment-stage-deploy","title":"2. Deployment Stage (<code>deploy</code>)","text":"<p>Runs via SSH on the target server:</p> <ul> <li>SCP: Copies the latest code to the <code>/app/gifty-backend</code> folder.</li> <li>Build: Builds a new Docker image.</li> <li>Switch: Executes the <code>scripts/deploy.sh</code> script to switch ports and update the Nginx config.</li> </ul>"},{"location":"en/engineering/deployment/#server-configuration","title":"Server Configuration","text":"<p>For the deployment to work, the following conditions must be met on the server:</p>"},{"location":"en/engineering/deployment/#1-nginx-configuration","title":"1. Nginx Configuration","text":"<p>Nginx must use a dynamic <code>upstream</code> file.  In the site config (<code>/etc/nginx/sites-enabled/gifty</code>): <pre><code>include /etc/nginx/conf.d/gifty_upstream.conf;\n\nserver {\n    ...\n    location / {\n        proxy_pass http://gifty_backend;\n    }\n}\n</code></pre></p>"},{"location":"en/engineering/deployment/#2-permissions","title":"2. Permissions","text":"<p>The user GitHub connects with via SSH must have permissions to:</p> <ul> <li>Execute <code>docker-compose</code>.</li> <li>Overwrite files in <code>/etc/nginx/conf.d/</code>.</li> <li>Execute <code>sudo nginx -s reload</code> without a password (or via appropriate sudoers).</li> </ul>"},{"location":"en/engineering/deployment/#github-secrets-configuration","title":"GitHub Secrets Configuration","text":"<p>The following secrets must be set in the repository settings (Settings -&gt; Secrets):</p> Secret Description <code>PROD_SSH_HOST</code> Server IP or domain <code>PROD_SSH_PORT</code> SSH port (if not 22) <code>PROD_SSH_USER</code> Username for connection <code>PROD_SSH_KEY</code> Private SSH key <code>PROD_ENV_FILE</code> Contents of the production <code>.env</code> file"},{"location":"en/engineering/deployment/#deployment-monitoring","title":"Deployment Monitoring","text":"<p>The status of the current deployment can be tracked in the Actions tab on GitHub. </p>"},{"location":"en/engineering/deployment/#documentation-deployment","title":"Documentation Deployment","text":"<p>The documentation deployment process is defined in <code>.github/workflows/docs.yml</code> and is tied to the <code>documentation</code> branch.</p>"},{"location":"en/engineering/deployment/#workflow-rules","title":"Workflow Rules:","text":"<ol> <li>Primary Branch: <code>documentation</code>. Only pushes to this branch trigger a site update at <code>dev.giftyai.ru</code>.</li> <li>Work Branches: <code>documentation/*</code>. Pushes to these branches trigger only a build check (<code>mkdocs build</code>) to ensure no errors exist.</li> <li>Pull Request: Creating a PR into the <code>documentation</code> branch also triggers a build check. Deployment happens only after the PR is merged.</li> </ol>"},{"location":"en/overview/","title":"Architecture Overview","text":"<p>The Gifty system consists of several key components interacting with each other:</p> graph TD     Parser[Scrapers / Scrapy] --&gt;|JSON Data| RabbitMQ[RabbitMQ]     RabbitMQ --&gt;|Task| Worker[Scrapy Worker]     Worker --&gt;|Batch| API[Core API / FastAPI]     API --&gt;|Prompt| LLM[Gifty Intelligence / External API]     LLM --&gt;|Score / Class| API     API --&gt;|Save| DB[(PostgreSQL + pgvector)]     Frontend[Web App / Next.js] --&gt;|Quiz| API     API --&gt;|Search| DB"},{"location":"en/overview/#main-layers","title":"Main Layers","text":"<ol> <li>Data Parsing: Collecting product information from donor sites.</li> <li>Processing &amp; Enrichment: Using LLM to score giftability and automatically map categories.</li> <li>Vectorization: Transforming product descriptions into vectors for semantic search.</li> <li>Recommendation Engine: Finding the most suitable vectors based on the user's questionnaire.</li> <li>Interface: Web application for user interaction.</li> </ol>"},{"location":"en/overview/#infrastructure-cicd","title":"Infrastructure &amp; CI/CD","text":"<p>The project is deployed using Docker Compose and follows modern automation practices:</p> <ul> <li>GitHub Actions: Full CI (Continuous Integration) cycle on every push. Tests run first, followed by deployment.</li> <li>Blue-Green Deployment: A deployment strategy without service interruption. The system switches between two containers on different ports only after a successful Health Check.</li> <li>Nginx Proxy: An external proxy on the host that provides SSL and seamless version switching via upstream port updates.</li> </ul>"},{"location":"en/parsing/architecture/","title":"Professional Parsing Architecture v2.1","text":"<p>This document describes the target architecture of the data collection system (Scraping System) for the Gifty project. We are moving from a monolithic scraper execution to a distributed microservice architecture.</p>"},{"location":"en/parsing/architecture/#1-general-architecture-the-big-picture","title":"1. General Architecture (The Big Picture)","text":"<p>The system is divided into three logical layers: 1.  Orchestration (Brain): Plans what and when to parse. 2.  Execution (Muscles): Isolated Scrapy workers. 3.  Storage &amp; Processing (Memory): Data ingestion, validation, and storage.</p> sequenceDiagram     participant S as Scheduler     participant Q as RabbitMQ     participant W as Scrapy Worker     participant T as Target Site     participant A as Ingestion API     participant DB as Postgres      S-&gt;&gt;S: Scan Due Sources     S-&gt;&gt;Q: Hub/List Task     Q-&gt;&gt;W: Pick Up     W-&gt;&gt;T: Fetch Content     T--&gt;&gt;W: HTML     W-&gt;&gt;W: Extract Links/Items     W-&gt;&gt;A: Batch Ingest     A-&gt;&gt;A: Validate/Clean     A-&gt;&gt;DB: Upsert Products     A-&gt;&gt;DB: Update Source Stats  <p>Communication: RabbitMQ.</p>"},{"location":"en/parsing/architecture/#2-orchestration-layer-scheduler","title":"2. Orchestration Layer (Scheduler)","text":""},{"location":"en/parsing/architecture/#21-source-classification-source-types","title":"2.1 Source Classification (Source Types)","text":"<p>The system distinguishes between different page types as they require different processing strategies. A <code>type</code> field is introduced in the database:</p> <ol> <li> <p>Hub / Category List (<code>hub</code>):</p> <ul> <li>Example: <code>site.com/catalog/gifts</code> (grid of categories like \"For Mom\", \"For Dad\").</li> <li>Task: Discovery. Find links to new subcategories and add them to the DB. Does not parse products.</li> <li>Frequency: Rare (weekly/monthly). Site structure changes infrequently.</li> </ul> </li> <li> <p>Product List (<code>list</code>) \u2014 Primary type:</p> <ul> <li>Example: <code>mrgeek.ru/category/all-products/</code>.</li> <li>Task: Extraction. Iterate through pagination, collect brief data (Price, Title, Image) and product card links.</li> <li>Frequency: Daily (every 12-24h).</li> </ul> </li> <li> <p>Single Product (<code>product</code>):</p> <ul> <li>Task: Deep Dive. Get full description, specs, reviews.</li> </ul> </li> <li> <p>Sitemap XML (<code>sitemap</code>):</p> <ul> <li>Task: Bulk Discovery. Allows getting 100% of store links without HTML parsing.</li> </ul> </li> </ol>"},{"location":"en/parsing/architecture/#22-processing-strategies","title":"2.2 Processing Strategies","text":"<p>The <code>strategy</code> field refines the worker behavior: *   <code>deep</code> (Primary): Full synchronization. Go through all pages. Update all found products. *   <code>discovery</code> (Search): Used for <code>type: hub</code>. Find new links, do not collect products.</p>"},{"location":"en/parsing/architecture/#23-parsingsource-data-model","title":"2.3 <code>ParsingSource</code> Data Model","text":"<p>A registry table in PostgreSQL:</p> Field Type Description <code>url</code> String Entry point. <code>type</code> Enum <code>hub</code>, <code>list</code>, <code>product</code>, <code>sitemap</code>. <code>site_key</code> String e.g. <code>mrgeek</code>. Defines the Spider class. <code>priority</code> Int 1-100. Affects ordering in RabbitMQ. <code>refresh_interval</code> Int Base frequency (hours). <code>next_sync_at</code> DateTime Next run time (indexed)."},{"location":"en/parsing/architecture/#implementation-status","title":"Implementation Status","text":""},{"location":"en/parsing/architecture/#3-execution-layer-scraping-workers","title":"3. Execution Layer (Scraping Workers)","text":"<p>Microservice based on Scrapy. Processes tasks from the queue.</p>"},{"location":"en/parsing/architecture/#worker-workflow","title":"Worker Workflow","text":"<ol> <li>Consume: Receives a JSON task.</li> <li>Select Spider: Runs the appropriate spider class.</li> <li>Crawl: Proxy rotation, User-Agent rotation, Throttling.</li> <li>Output: Sends batches to the API.</li> </ol>"},{"location":"en/parsing/architecture/#implementation-status_1","title":"Implementation Status","text":""},{"location":"en/parsing/architecture/#4-ingestion-layer-ingestion-api","title":"4. Ingestion Layer (Ingestion API)","text":"<p>Parsers do not write to the DB directly. The API (<code>POST /internal/ingest</code>) acts as a gatekeeper: 1.  Validation: Filters out broken items. 2.  Normalization: Currency conversion, HTML cleaning. 3.  Upsert: Updates or creates products. 4.  Feedback: Records stats for the Scheduler.</p>"},{"location":"en/parsing/architecture/#implementation-status_2","title":"Implementation Status","text":""},{"location":"en/parsing/architecture/#5-implementation-roadmap","title":"5. Implementation Roadmap","text":"<ol> <li>MVP: Set up RabbitMQ + Scrapy project + 1 spider (<code>list</code>).</li> <li>DB: Create <code>ParsingSource</code> table.</li> <li>Discovery: Implement <code>hub</code> spiders for auto-filling the link database.</li> <li>Scale: Connect paid proxies and Playwright for JS-heavy sites.</li> </ol>"},{"location":"en/parsing/architecture/#6-testing-and-deployment-cicd","title":"6. Testing and Deployment (CI/CD)","text":"<p>Scraper development requires a specific approach to testing, as websites change constantly.</p>"},{"location":"en/parsing/architecture/#61-local-testing-fixture-tests","title":"6.1 Local Testing (Fixture Tests)","text":"<p>We do not test on live sites in CI (it's unreliable). 1.  The developer saves the HTML page to a file: <code>tests/fixtures/mrgeek.html</code>. 2.  Writes a test that runs the Spider against this file. 3.  Verifies that exactly 36 items are extracted and fields (Price, Title) are not empty.</p>"},{"location":"en/parsing/architecture/#62-update-process","title":"6.2 Update Process","text":"<p>Scraper Service is a stateless container. 1.  On code update, a new Docker image is built. 2.  Workers are restarted gradually (Rolling Update). 3.  Tasks in RabbitMQ are not lost: if a worker dies during processing, the task returns to the queue.</p>"},{"location":"en/parsing/architecture/#implementation-status_3","title":"Implementation Status","text":""},{"location":"en/parsing/guide/","title":"Creating New Parsers \ud83d\udd77\ufe0f","text":"<p>In Gifty, data collection is automated using Scrapy. For rapid development, we use a base class that handles boilerplate tasks related to task queues and API integration.</p>"},{"location":"en/parsing/guide/#quick-start","title":"\ud83d\ude80 Quick Start","text":""},{"location":"en/parsing/guide/#1-environment-setup","title":"1. Environment Setup","text":"<p>Make sure you have the development dependencies installed: <pre><code>pip install -r requirements.txt\n</code></pre></p>"},{"location":"en/parsing/guide/#2-create-spider-file","title":"2. Create Spider File","text":"<p>Create a new file in the <code>services/gifty_scraper/spiders/</code> directory. Name it after the target website, e.g., <code>ozon.py</code> or <code>my_shop.py</code>.</p>"},{"location":"en/parsing/guide/#3-write-core-logic","title":"3. Write Core Logic","text":"<p>Inherit from <code>GiftyBaseSpider</code> to minimize template code.</p> <pre><code>from gifty_scraper.base_spider import GiftyBaseSpider\n\nclass MyShopSpider(GiftyBaseSpider):\n    name = \"my_shop\"        # Unique name for console execution\n    allowed_domains = [\"myshop.ru\"]\n    site_key = \"myshop\"    # Key used by the scheduler to find this spider\n\n    def parse_catalog(self, response):\n        # Locate product card containers\n        items = response.css('.product-card')\n\n        for item in items:\n            yield self.create_product(\n                title=item.css('.title::text').get().strip(),\n                product_url=response.urljoin(item.css('a::attr(href)').get()),\n                price=item.css('.price-value::text').re_first(r'(\\d+)'),\n                image_url=item.css('img::attr(src)').get(),\n                merchant=\"My Shop\",\n                raw_data={\"source\": \"scrapy_v1\"}\n            )\n\n        # Handle pagination (if strategy=\"deep\")\n        if self.strategy == \"deep\":\n            next_page = response.css('a.next-btn::attr(href)').get()\n            if next_page:\n                yield response.follow(next_page, self.parse_catalog)\n</code></pre>"},{"location":"en/parsing/guide/#testing-and-debugging","title":"\ud83d\udee0\ufe0f Testing and Debugging","text":"<p>Use the provided script to verify logic without running the full infrastructure (Docker/API):</p> <pre><code>python3 scripts/test_spider.py my_shop \"https://myshop.ru/catalog\" --limit 10\n</code></pre> <ul> <li><code>--limit</code>: Limits collection (e.g., first 10 items).</li> <li><code>--output</code>: Result filename (defaults to <code>test_results.json</code>).</li> </ul> <p>Check the generated JSON file \u2014 if it contains data, your selectors are working correctly.</p>"},{"location":"en/parsing/guide/#system-registration","title":"\u26d3\ufe0f System Registration","text":"<p>To enable the system to use the new spider automatically:</p>"},{"location":"en/parsing/guide/#1-update-the-worker","title":"1. Update the Worker","text":"<p>Open <code>services/run_worker.py</code> and add your class to the <code>SPIDERS</code> dictionary:</p> <pre><code>from gifty_scraper.spiders.my_shop import MyShopSpider\n\nSPIDERS = {\n    \"mrgeek\": MrGeekSpider,\n    \"myshop\": MyShopSpider,  # &lt;-- Add here\n}\n</code></pre>"},{"location":"en/parsing/guide/#2-add-source-to-database","title":"2. Add Source to Database","text":"<p>To start receiving tasks from the scheduler, create an entry in the <code>parsing_sources</code> table:</p> <pre><code>INSERT INTO parsing_sources (url, type, site_key, priority, refresh_interval_hours, is_active)\nVALUES ('https://myshop.ru/catalog', 'list', 'myshop', 50, 24, true);\n</code></pre>"},{"location":"en/parsing/guide/#best-practices","title":"\ud83d\udca1 Best Practices","text":"<ol> <li>Throttling: Default delay is 1s. If blocked, increase <code>DOWNLOAD_DELAY</code> in <code>settings.py</code>.</li> <li>CSS vs XPath: Use CSS selectors wherever possible for better readability.</li> <li>Images: Always ensure <code>image_url</code> is an absolute URL (use <code>response.urljoin</code>).</li> <li>Batching: Our Pipeline automatically batches items (default 50) before sending them to the API to save resources.</li> </ol>"},{"location":"en/recommendation/intelligence_api/","title":"Gifty Intelligence API Contract","text":"<p>\u042d\u0442\u043e\u0442 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442 \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 API, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0434\u043e\u043b\u0436\u0435\u043d \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0442\u044c \u0432\u043d\u0435\u0448\u043d\u0438\u0439 \u0441\u0435\u0440\u0432\u0438\u0441 \u0438\u043d\u0442\u0435\u043b\u043b\u0435\u043a\u0442\u0430 (<code>api.giftyai.ru</code>) \u0434\u043b\u044f \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u0441 \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u043c \u0431\u044d\u043a\u0435\u043d\u0434\u043e\u043c Gifty.</p> <p>\u0411\u0430\u0437\u043e\u0432\u044b\u0439 URL: <code>https://api.giftyai.ru</code> \u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f: Bearer Token (\u0432 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0435 <code>Authorization</code>)</p>"},{"location":"en/recommendation/intelligence_api/#1","title":"1. \u041a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439","text":"<p>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043c\u0430\u043f\u043f\u0438\u043d\u0433\u0430 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0439 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u0441 \u0441\u0430\u0439\u0442\u043e\u0432-\u0434\u043e\u043d\u043e\u0440\u043e\u0432 \u0432\u043e \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u044e\u044e \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 Gifty.</p> <p>\u041c\u0435\u0442\u043e\u0434: <code>POST</code> \u041f\u0443\u0442\u044c: <code>/v1/classify/categories</code></p> <p>Request Body: <pre><code>{\n  \"external_names\": [\"\u041a\u0440\u0443\u0436\u043a\u0438 \u043f\u0440\u0438\u043a\u043e\u043b\u044c\u043d\u044b\u0435\", \"\u0413\u0430\u0434\u0436\u0435\u0442\u044b \u0434\u043b\u044f \u0434\u043e\u043c\u0430\"],\n  \"internal_categories\": [\n    {\"id\": 1, \"name\": \"\u041a\u0443\u0445\u043d\u044f\"},\n    {\"id\": 2, \"name\": \"\u042d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u0438\u043a\u0430\"}\n  ]\n}\n</code></pre></p> <p>Response Body: <pre><code>{\n  \"mappings\": [\n    {\"external_name\": \"\u041a\u0440\u0443\u0436\u043a\u0438 \u043f\u0440\u0438\u043a\u043e\u043b\u044c\u043d\u044b\u0435\", \"internal_category_id\": 1},\n    {\"external_name\": \"\u0413\u0430\u0434\u0436\u0435\u0442\u044b \u0434\u043b\u044f \u0434\u043e\u043c\u0430\", \"internal_category_id\": 2}\n  ]\n}\n</code></pre></p>"},{"location":"en/recommendation/intelligence_api/#2-giftability","title":"2. \u0421\u043a\u043e\u0440\u0440\u0438\u043d\u0433 \u0442\u043e\u0432\u0430\u0440\u0430 (Giftability)","text":"<p>\u041e\u0446\u0435\u043d\u043a\u0430 \u0442\u043e\u0433\u043e, \u043d\u0430\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0442\u043e\u0432\u0430\u0440 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0445\u043e\u0440\u043e\u0448\u0438\u043c \u043f\u043e\u0434\u0430\u0440\u043a\u043e\u043c, \u0438 \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u043f\u043e\u044f\u0441\u043d\u0435\u043d\u0438\u044f.</p> <p>\u041c\u0435\u0442\u043e\u0434: <code>POST</code> \u041f\u0443\u0442\u044c: <code>/v1/products/score</code></p> <p>Request Body: <pre><code>{\n  \"title\": \"\u041d\u0430\u0431\u043e\u0440 \u0434\u043b\u044f \u0432\u044b\u0440\u0430\u0449\u0438\u0432\u0430\u043d\u0438\u044f \u043a\u0440\u0438\u0441\u0442\u0430\u043b\u043b\u043e\u0432\",\n  \"description\": \"\u0420\u0430\u0437\u0432\u0438\u0432\u0430\u044e\u0449\u0438\u0439 \u043d\u0430\u0431\u043e\u0440 \u0434\u043b\u044f \u0434\u0435\u0442\u0435\u0439...\",\n  \"price\": 1500.0,\n  \"category\": \"\u0418\u0433\u0440\u0443\u0448\u043a\u0438\"\n}\n</code></pre></p> <p>Response Body: <pre><code>{\n  \"gift_score\": 9.2,\n  \"reasoning\": \"\u041e\u0442\u043b\u0438\u0447\u043d\u044b\u0439 \u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043f\u043e\u0434\u0430\u0440\u043e\u043a \u0434\u043b\u044f \u0434\u0435\u0442\u0435\u0439 \u043c\u043b\u0430\u0434\u0448\u0435\u0433\u043e \u0448\u043a\u043e\u043b\u044c\u043d\u043e\u0433\u043e \u0432\u043e\u0437\u0440\u0430\u0441\u0442\u0430. \u0420\u0430\u0437\u0432\u0438\u0432\u0430\u0435\u0442 \u043b\u044e\u0431\u043e\u0437\u043d\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c.\",\n  \"tags\": [\"\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u0435\", \"\u0434\u0435\u0442\u0438\", \"\u043d\u0430\u0443\u043a\u0430\"]\n}\n</code></pre></p>"},{"location":"en/recommendation/query_rules/","title":"Gift query rules v1","text":"<p>\u0426\u0435\u043b\u044c: \u043e\u043f\u0438\u0441\u0430\u0442\u044c \u0441\u0442\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 ruleset \u0434\u043b\u044f \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0445 \u043f\u043e\u0438\u0441\u043a\u043e\u0432\u044b\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0432 Takprodam Publisher API \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u043e\u0442\u0432\u0435\u0442\u043e\u0432 \u043a\u0432\u0438\u0437\u0430.</p>"},{"location":"en/recommendation/query_rules/#_1","title":"\u0424\u043e\u0440\u043c\u0430\u0442 \u0438 \u043f\u043e\u043b\u044f","text":"<p>\u0424\u0430\u0439\u043b: <code>config/gift_query_rules.v1.yaml</code></p> <p>\u0412\u0435\u0440\u0445\u043d\u0438\u0439 \u0443\u0440\u043e\u0432\u0435\u043d\u044c:</p> <ul> <li><code>version</code>: \u0432\u0435\u0440\u0441\u0438\u044f \u043f\u0440\u0430\u0432\u0438\u043b.</li> <li><code>meta</code>: \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 ruleset.</li> <li><code>limits</code>: \u043b\u0438\u043c\u0438\u0442\u044b \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438.</li> <li><code>age_segments</code>: \u0441\u0435\u0433\u043c\u0435\u043d\u0442\u044b \u043f\u043e \u0432\u043e\u0437\u0440\u0430\u0441\u0442\u0443 \u0441 <code>age_min</code>/<code>age_max</code>, <code>base_queries</code> \u0438 <code>vibes</code>.</li> <li><code>relationship_map</code>: \u043c\u0430\u043f\u043f\u0438\u043d\u0433 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439.</li> <li><code>occasion_map</code>: \u043c\u0430\u043f\u043f\u0438\u043d\u0433 \u043f\u043e\u0432\u043e\u0434\u043e\u0432.</li> <li><code>interests_map</code>: \u043c\u0430\u043f\u043f\u0438\u043d\u0433 \u0438\u043d\u0442\u0435\u0440\u0435\u0441\u043e\u0432.</li> <li><code>gender_map</code>: \u043c\u0430\u043f\u043f\u0438\u043d\u0433 \u043f\u043e\u043b\u0430 \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u044f (male/female/unisex).</li> <li><code>description_keywords_map</code>: \u0441\u043b\u043e\u0432\u0430\u0440\u044c \u043f\u043e\u0434\u0441\u0442\u0440\u043e\u043a/\u0441\u0442\u0435\u043c\u043e\u0432 \u0438\u0437 \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e\u0433\u043e \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u044f -&gt; queries.</li> <li><code>banned</code>: \u0437\u0430\u043f\u0440\u0435\u0442\u044b \u0438 \u043d\u0435\u0433\u0430\u0442\u0438\u0432\u043d\u044b\u0435 \u043a\u043b\u044e\u0447\u0435\u0432\u044b\u0435 \u0441\u043b\u043e\u0432\u0430.</li> </ul>"},{"location":"en/recommendation/query_rules/#_2","title":"\u0421\u0435\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u043f\u043e \u0432\u043e\u0437\u0440\u0430\u0441\u0442\u0443","text":"<p>\u0412\u044b\u0431\u043e\u0440 \u0441\u0435\u0433\u043c\u0435\u043d\u0442\u0430 \u043e\u0434\u043d\u043e\u0437\u043d\u0430\u0447\u043d\u044b\u0439: \u0431\u0435\u0440\u0435\u0442\u0441\u044f \u043f\u0435\u0440\u0432\u044b\u0439 <code>age_segments.*</code>, \u0433\u0434\u0435 <code>age_min &lt;= recipient_age &lt;= age_max</code>.</p>"},{"location":"en/recommendation/query_rules/#buckets","title":"\u041e\u0431\u044a\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 buckets","text":"<p>\u0424\u043e\u0440\u043c\u0438\u0440\u0443\u0439\u0442\u0435 \u043a\u0430\u043d\u0434\u0438\u0434\u0430\u0442\u044b \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0438\u0437 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0445 buckets:</p> <ol> <li><code>age_segments.&lt;segment&gt;.base_queries</code></li> <li><code>age_segments.&lt;segment&gt;.vibes.&lt;vibe&gt;.queries</code> (\u0435\u0441\u043b\u0438 vibe \u0443\u043a\u0430\u0437\u0430\u043d)</li> <li><code>interests_map.&lt;interest&gt;.queries</code> \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e interest</li> <li><code>gender_map.&lt;gender&gt;.queries</code> (\u0435\u0441\u043b\u0438 gender \u0443\u043a\u0430\u0437\u0430\u043d)</li> <li><code>description_keywords_map</code> \u043f\u043e \u043f\u043e\u0434\u0441\u0442\u0440\u043e\u043a\u0430\u043c \u0438\u0437 <code>interests_description</code></li> <li><code>relationship_map.&lt;relationship&gt;.queries</code></li> <li><code>occasion_map.&lt;occasion&gt;.queries</code></li> </ol> <p>\u0414\u0430\u043b\u0435\u0435 \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u044f\u0439\u0442\u0435, \u0443\u0431\u0438\u0440\u0430\u0439\u0442\u0435 \u0434\u0443\u0431\u043b\u0438, \u0444\u0438\u043b\u044c\u0442\u0440\u0443\u0439\u0442\u0435 banned, \u0437\u0430\u0442\u0435\u043c \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0439\u0442\u0435 \u043b\u0438\u043c\u0438\u0442\u044b.</p>"},{"location":"en/recommendation/query_rules/#_3","title":"\u041b\u0438\u043c\u0438\u0442\u044b","text":"<ul> <li><code>max_queries_per_bucket</code>: \u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c \u0432\u0437\u044f\u0442\u044c \u0438\u0437 \u043a\u0430\u0436\u0434\u043e\u0433\u043e bucket.</li> <li><code>max_queries_total</code>: \u0432\u0435\u0440\u0445\u043d\u0438\u0439 \u043f\u0440\u0435\u0434\u0435\u043b \u0438\u0442\u043e\u0433\u043e\u0432\u043e\u0433\u043e \u0441\u043f\u0438\u0441\u043a\u0430.</li> <li><code>min_queries_total</code>: \u043d\u0438\u0436\u043d\u0438\u0439 \u043f\u0440\u0435\u0434\u0435\u043b, \u043f\u0440\u0438 \u043d\u0435\u0445\u0432\u0430\u0442\u043a\u0435 \u0434\u043e\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u0431\u0440\u0430\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 \u0438\u0437 base \u0438\u043b\u0438 interest buckets.</li> <li><code>max_keywords_from_description</code>: \u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c \u043a\u043b\u044e\u0447\u0435\u0432\u044b\u0445 \u0441\u043b\u043e\u0432 \u0438\u0437 <code>interests_description</code>.</li> </ul>"},{"location":"en/recommendation/query_rules/#banned-negative_keywords","title":"Banned \u0438 negative_keywords","text":"<ul> <li><code>banned.banned_queries</code> \u0438\u0441\u043a\u043b\u044e\u0447\u0430\u044e\u0442\u0441\u044f \u0434\u043e \u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0438\u0442\u043e\u0433\u043e\u0432\u043e\u0433\u043e \u0441\u043f\u0438\u0441\u043a\u0430.</li> <li><code>banned.negative_keywords</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u0434\u043b\u044f \u043f\u043e\u0441\u0442-\u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432 Takprodam (\u0442\u043e\u0432\u0430\u0440\u044b \u0441 \u0442\u0430\u043a\u0438\u043c\u0438 \u043f\u043e\u0434\u0441\u0442\u0440\u043e\u043a\u0430\u043c\u0438 \u0438\u0441\u043a\u043b\u044e\u0447\u0430\u044e\u0442\u0441\u044f).</li> </ul>"},{"location":"en/recommendation/query_rules/#_4","title":"\u041f\u0440\u0438\u043c\u0435\u0440\u044b","text":""},{"location":"en/recommendation/query_rules/#8-vibe-fun","title":"\u0420\u0435\u0431\u0435\u043d\u043e\u043a 8 \u043b\u0435\u0442, vibe: fun","text":"<ul> <li>segment: <code>child</code></li> <li>buckets: child.base + child.vibes.fun + relationship + occasion + interests</li> <li>\u043f\u0440\u0438\u043c\u0435\u0440 \u0438\u0442\u043e\u0433\u043e\u0432\u044b\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432: <code>\u043d\u0430\u0441\u0442\u043e\u043b\u044c\u043d\u0430\u044f \u0438\u0433\u0440\u0430</code>, <code>\u043a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440</code>, <code>\u0440\u0430\u0434\u0438\u043e\u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c\u0430\u044f \u043c\u0430\u0448\u0438\u043d\u043a\u0430</code>, <code>\u043d\u0430\u0431\u043e\u0440 \u0444\u043e\u043a\u0443\u0441\u043e\u0432</code>, <code>\u0441\u043b\u0430\u0439\u043c \u043d\u0430\u0431\u043e\u0440</code></li> </ul>"},{"location":"en/recommendation/query_rules/#32-vibe-cozy","title":"\u0412\u0437\u0440\u043e\u0441\u043b\u044b\u0439 32 \u0433\u043e\u0434\u0430, vibe: cozy","text":"<ul> <li>segment: <code>adult</code></li> <li>buckets: adult.base + adult.vibes.cozy + relationship + occasion + interests</li> <li>\u043f\u0440\u0438\u043c\u0435\u0440 \u0438\u0442\u043e\u0433\u043e\u0432\u044b\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432: <code>\u043f\u043b\u0435\u0434</code>, <code>\u0430\u0440\u043e\u043c\u0430\u0441\u0432\u0435\u0447\u0430</code>, <code>\u0434\u0438\u0444\u0444\u0443\u0437\u043e\u0440</code>, <code>\u043f\u043e\u0434\u0443\u0448\u043a\u0430</code>, <code>\u043d\u043e\u0447\u043d\u0438\u043a</code></li> </ul>"},{"location":"en/recommendation/query_rules/#mature-60-vibe-practical-interest-health","title":"Mature 60 \u043b\u0435\u0442, vibe: practical, interest: health","text":"<ul> <li>segment: <code>mature</code></li> <li>buckets: mature.base + mature.vibes.practical + interests.health</li> <li>\u043f\u0440\u0438\u043c\u0435\u0440 \u0438\u0442\u043e\u0433\u043e\u0432\u044b\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432: <code>\u043c\u0430\u0441\u0441\u0430\u0436\u0435\u0440</code>, <code>\u0442\u043e\u043d\u043e\u043c\u0435\u0442\u0440</code>, <code>\u043e\u0440\u0442\u043e\u043f\u0435\u0434\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043f\u043e\u0434\u0443\u0448\u043a\u0430</code>, <code>\u0442\u0435\u0440\u043c\u043e\u0441</code>, <code>\u0447\u0430\u0439\u043d\u0438\u043a</code></li> </ul>"}]}